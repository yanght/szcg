//>>built
define("dgrid/List",["dojo/_base/array","dojo/_base/kernel","dojo/_base/declare","dojo/on","dojo/aspect","dojo/has","./util/misc","dojo/has!touch?./TouchScroll","xstyle/has-class","put-selector/put","dojo/_base/sniff","xstyle/css!./css/dgrid.css"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){_9("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var _b;var _c=_a(document.getElementsByTagName("head")[0],"style"),_d=[],_e="dgrid-row-odd",_f="dgrid-row-even";_c=_c.sheet||_c.styleSheet;function _10(_11,css){var _12=_d.length;_d[_12]=(_c.cssRules||_c.rules).length;_c.addRule?_c.addRule(_11,css):_c.insertRule(_11+"{"+css+"}",_d[_12]);return {remove:function(){_13(_12);}};};function _13(_14){var _15=_d[_14],i,l=_d.length;if(_15===undefined){return;}_c.deleteRule?_c.deleteRule(_15):_c.removeRule(_15);_d[_14]=undefined;for(i=_14;i<l;i++){if(_d[i]>_15){_d[i]--;}}};function _16(id){return document.getElementById(id);};function _17(_18,_19,_1a,_1b){var _1c,_1d,_1e;_1e=_1d=_18.element;_19=_19||1;do{if(_1c=_1d[_19<0?"previousSibling":"nextSibling"]){do{_1d=_1c;if(((_1d&&_1d.className)+" ").indexOf(_1a+" ")>-1){_1e=_1d;_19+=_19<0?1:-1;break;}}while(_1c=(!_1b||!_1d.hidden)&&_1d[_19<0?"lastChild":"firstChild"]);}else{if((_1d=_1d.parentNode)==this.domNode||(_1d.className+" ").indexOf("dgrid-row ")>-1){break;}}}while(_19);return _1e;};var _1f=0;function _20(){return "dgrid_"+_1f++;};var _21=_6("ie")<7&&!_6("quirks")?function(_22){var _23,w,h,_24;if(!_22._started){return;}_23=document.documentElement;w=_23.clientWidth;h=_23.clientHeight;_24=_22._prevWinDims||[];if(_24[0]!==w||_24[1]!==h){_22.resize();_22._prevWinDims=[w,h];}}:function(_25){_25._started&&_25.resize();};return _3("dgrid.List",_8?[_8]:[],{tabableHeader:false,showHeader:false,showFooter:false,maintainOddEven:true,postscript:function(_26,_27){var _28=this;(this._Row=function(id,_29,_2a){this.id=id;this.data=_29;this.element=_2a;}).prototype.remove=function(){_28.removeRow(this.element);};if(_27){this.srcNodeRef=_27=_27.nodeType?_27:_16(_27);}this.create(_26,_27);},listType:"list",create:function(_2b,_2c){if(_2b){this.params=_2b;_3.safeMixin(this,_2b);this._sort=_2b.sort||[];delete this.sort;}else{this._sort=[];}var _2d=this.domNode=_2c||_a("div");this.observers=[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=_2d.id=_2d.id||this.id||_20();this.buildRendering();this.postCreate&&this.postCreate();delete this.srcNodeRef;if(this.domNode.offsetHeight){this.startup();}},buildRendering:function(){var _2e=this.domNode,_2f=this,_30,_31,_32,_33,_34;_34=this.isRTL=(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase()=="rtl";_a(_2e,"[role=grid].ui-widget.dgrid.dgrid-"+this.listType);_30=this.headerNode=_a(_2e,"div.dgrid-header.dgrid-header-row.ui-widget-header"+(this.showHeader?"":".dgrid-header-hidden"));if(_6("quirks")||_6("ie")<8){_31=_a(_2e,"div.dgrid-spacer");}_32=this.bodyNode=this.touchNode=_a(_2e,"div.dgrid-scroller");_32.tabIndex=-1;this.headerScrollNode=_a(_2e,"div.dgrid-header-scroll.dgrid-scrollbar-width.ui-widget-header");_33=this.footerNode=_a("div.dgrid-footer");if(!this.showFooter){_33.style.display="none";}_a(_2e,_33);if(_34){_2e.className+=" dgrid-rtl"+(_6("webkit")?"":" dgrid-rtl-nonwebkit");}_4(_32,"scroll",function(_35){_30.scrollLeft=_32.scrollLeft;_35.stopPropagation();_4.emit(_2e,"scroll",{scrollTarget:_32});});this.configStructure();this.renderHeader();this.contentNode=_a(this.bodyNode,"div.dgrid-content.ui-widget-content");this._listeners.push(this._resizeHandle=_4(window,"resize",_7.debounce(_21)));},startup:function(){this.inherited(arguments);if(this._started){return;}this._started=true;this.resize();this.set("sort",this._sort);},configStructure:function(){},resize:function(){var _36=this.bodyNode,_37=this.headerNode,_38=this.footerNode,_39=_37.offsetHeight,_3a=this.showFooter?_38.offsetHeight:0,_3b=_6("quirks")||_6("ie")<7;this.headerScrollNode.style.height=_36.style.marginTop=_39+"px";if(_3a){_36.style.marginBottom=_3a+"px";}if(_3b){_36.style.height="";_36.style.height=Math.max((this.domNode.offsetHeight-_39-_3a),0)+"px";if(_3a){_38.style.bottom="1px";setTimeout(function(){_38.style.bottom="";},0);}}if(!_b){var _3c=_a(document.body,"div.dgrid-scrollbar-measure");_b=_3c.offsetWidth-_3c.clientWidth;_a(_3c,"!");if(_6("ie")===7){_b++;}this.addCssRule(".dgrid-scrollbar-width","width: "+_b+"px");this.addCssRule(".dgrid-scrollbar-height","height: "+_b+"px");if(_b!=17&&!_3b){this.addCssRule(".dgrid-header","right: "+_b+"px");this.addCssRule(".dgrid-rtl-nonwebkit .dgrid-header","left: "+_b+"px");}}if(_3b){_37.style.width=_36.clientWidth+"px";setTimeout(function(){_37.scrollLeft=_36.scrollLeft;},0);}},addCssRule:_10,on:function(_3d,_3e){var _3f=_4(this.domNode,_3d,_3e);if(!_6("dom-addeventlistener")){this._listeners.push(_3f);}},cleanup:function(){var _40=this.observers,i;for(i in this._rowIdToObject){if(this._rowIdToObject[i]!=this.columns){var _41=_16(i);if(_41){this.removeRow(_41,true);}}}for(i=0;i<_40.length;i++){var _42=_40[i];_42&&_42.cancel();}this.observers=[];this.preload=null;},destroy:function(){for(var i=this._listeners.length;i--;){this._listeners[i].remove();}delete this._listeners;this.cleanup();_a("!",this.domNode);},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";},newRow:function(_43,_44,to,_45){if(_44.parentNode){var i=_45.start+to;var row=this.insertRow(_43,_44.parentNode,_44,i,_45);_a(row,".ui-state-highlight");setTimeout(function(){_a(row,"!ui-state-highlight");},250);return row;}},adjustRowIndices:function(_46){if(this.maintainOddEven){var _47=_46;var _48=_47.rowIndex;do{if(_47.rowIndex>-1){_a(_47,"."+(_48%2==1?_e:_f)+"!"+(_48%2==0?_e:_f));_47.rowIndex=_48++;}}while((_47=_47.nextSibling)&&_47.rowIndex!=_48);}},renderArray:function(_49,_4a,_4b){_4b=_4b||{};var _4c=this,_4d=_4b.start||0,row,_4e,_4f;if(!_4a){this._lastCollection=_49;}if(_49.observe){var _50=this.observers.push(_49.observe(function(_51,_52,to){var _53;if(_52>-1&&_4e[_52]){row=_4e.splice(_52,1)[0];if(row.parentNode==_4f){_53=row.nextSibling;if(_53){_53.rowIndex--;_4c.removeRow(row);}}if(_4c._processScroll){_4c._processScroll();}}if(to>-1){row=_4c.newRow(_51,_4e[to]||(_4e[to-1]&&_4e[to-1].nextSibling)||_4a,to,_4b);if(row){row.observerIndex=_50;_4e.splice(to,0,row);if(!_53||to<_53.rowIndex){_53=row;}}_4b.count++;}_52!=to&&_53&&_4c.adjustRowIndices(_53);},true))-1;}var _54=document.createDocumentFragment();if(_49.map){_4e=_49.map(_55,console.error);if(_4e.then){return _4e.then(_56);}}else{_4e=[];for(var i=0,l=_49.length;i<l;i++){_4e[i]=_55(_49[i]);}}var _57;function _55(_58){_57=_4c.insertRow(_58,_54,null,_4d++,_4b);_57.observerIndex=_50;return _57;};function _56(_59){_4f=_4a?_4a.parentNode:_4c.contentNode;if(_4f){_4f.insertBefore(_54,_4a||null);_57=_59[_59.length-1];_57&&_4c.adjustRowIndices(_57);}return (_4e=_59);};return _56(_4e);},_autoId:0,renderHeader:function(){},insertRow:function(_5a,_5b,_5c,i,_5d){var id=this.id+"-row-"+((this.store&&this.store.getIdentity)?this.store.getIdentity(_5a):this._autoId++);var row=_16(id);if(!row||(_5c&&row.parentNode!=_5c.parentNode)){if(row){this.removeRow(row);}row=this.renderRow(_5a,_5d);row.className=(row.className||"")+" ui-state-default dgrid-row "+(i%2==1?_e:_f);this._rowIdToObject[row.id=id]=_5a;}_5b.insertBefore(row,_5c);row.rowIndex=i;return row;},renderRow:function(_5e,_5f){return _a("div",""+_5e);},removeRow:function(_60,_61){if(!_61){_a(_60,"!");}},row:function(_62){var id;if(_62 instanceof this._Row){return _62;}if(_62.target&&_62.target.nodeType){_62=_62.target;}if(_62.nodeType){var _63;do{var _64=_62.id;if((_63=this._rowIdToObject[_64])){return new this._Row(_64.substring(this.id.length+5),_63,_62);}_62=_62.parentNode;}while(_62&&_62!=this.domNode);return;}if(typeof _62=="object"){id=this.store.getIdentity(_62);}else{id=_62;_62=this._rowIdToObject[this.id+"-row-"+id];}return new this._Row(id,_62,_16(this.id+"-row-"+id));},cell:function(_65){return {row:this.row(_65)};},_move:_17,up:function(row,_66,_67){return this.row(_17(row,-(_66||1),"dgrid-row",_67));},down:function(row,_68,_69){return this.row(_17(row,_68||1,"dgrid-row",_69));},get:function(_6a){var fn="_get"+_6a.charAt(0).toUpperCase()+_6a.slice(1);if(typeof this[fn]==="function"){return this[fn].apply(this,[].slice.call(arguments,1));}if(!1&&typeof this[fn+"Attr"]==="function"){console.warn("dgrid: Use "+fn+" instead of "+fn+"Attr for getting "+_6a);}return this[_6a];},set:function(_6b,_6c){if(typeof _6b==="object"){for(var k in _6b){this.set(k,_6b[k]);}}else{var fn="_set"+_6b.charAt(0).toUpperCase()+_6b.slice(1);if(typeof this[fn]==="function"){this[fn].apply(this,[].slice.call(arguments,1));}else{if(!1&&typeof this[fn+"Attr"]==="function"){console.warn("dgrid: Use "+fn+" instead of "+fn+"Attr for setting "+_6b);}this[_6b]=_6c;}}return this;},_setSort:function(_6d,_6e){this._sort=typeof _6d!="string"?_6d:[{attribute:_6d,descending:_6e}];this.refresh();if(this._lastCollection){if(_6d.length){if(typeof _6d!="string"){_6e=_6d[0].descending;_6d=_6d[0].attribute;}this._lastCollection.sort(function(a,b){var _6f=a[_6d],_70=b[_6d];if(_6f===undefined){_6f="";}if(_70===undefined){_70="";}return _6f==_70?0:(_6f>_70==!_6e?1:-1);});}this.renderArray(this._lastCollection);}},sort:function(_71,_72){_2.deprecated("sort(...)","use set(\"sort\", ...) instead","dgrid 1.0");this.set("sort",_71,_72);},_getSort:function(){return this._sort;},_setShowHeader:function(_73){this.showHeader=_73;_a(this.headerNode,(_73?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();},setShowHeader:function(_74){_2.deprecated("setShowHeader(...)","use set(\"showHeader\", ...) instead","dgrid 1.0");this.set("showHeader",_74);}});});