/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
define("esri/utils",["dijit","dojo","dojox","dojo/require!dojo/io/script,esri/graphic,dojo/_base/url"],function(_1,_2,_3){_2.provide("esri.utils");_2.require("dojo.io.script");_2.require("esri.graphic");_2.require("dojo._base.url");esri.show=function(_4){if(_4){_4.style.display="block";}};esri.hide=function(_5){if(_5){_5.style.display="none";}};esri.toggle=function(_6){_6.style.display=_6.style.display==="none"?"block":"none";};esri.valueOf=function(_7,_8){var i;for(i in _7){if(_7[i]==_8){return i;}}return null;};esri.substitute=(function(){var _9="${*}",_a=["NumberFormat","DateString","DateFormat"];function _b(_c){return esri._isDefined(_c)?_c:"";};function _d(_e,_f,_10){var _11=_10.match(/([^\(]+)(\([^\)]+\))?/i);var _12=_2.trim(_11[1]);var _13=_2.fromJson((_11[2]?_2.trim(_11[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})"));var _14=_f[_e];if(_2.indexOf(_a,_12)===-1){var ref=_2.getObject(_12);if(_2.isFunction(ref)){_14=ref(_14,_e,_f);}}else{if(typeof _14==="number"||(typeof _14==="string"&&_14&&!isNaN(Number(_14)))){_14=Number(_14);switch(_12){case "NumberFormat":if(_2.getObject("dojo.number.format")){return _2.number.format(_14,_13);}break;case "DateString":var _15=new Date(_14);if(_13.local||_13.systemLocale){if(_13.systemLocale){return _15.toLocaleDateString()+(_13.hideTime?"":(" "+_15.toLocaleTimeString()));}else{return _15.toDateString()+(_13.hideTime?"":(" "+_15.toTimeString()));}}else{_15=_15.toUTCString();if(_13.hideTime){_15=_15.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,"");}return _15;}break;case "DateFormat":if(_2.getObject("dojo.date.locale.format")){return _2.date.locale.format(new Date(_14),_13);}break;}}}return _b(_14);};return function(_16,_17,_18){var _19,_1a,_1b;if(esri._isDefined(_18)){if(_2.isObject(_18)){_19=_18.first;_1a=_18.dateFormat;_1b=_18.numberFormat;}else{_19=_18;}}if(!_17||_17===_9){var s=[],val,i;for(i in _16){val=_16[i];if(_1a&&_2.indexOf(_1a.properties||"",i)!==-1){val=_d(i,_16,_1a.formatter||"DateString");}else{if(_1b&&_2.indexOf(_1b.properties||"",i)!==-1){val=_d(i,_16,_1b.formatter||"NumberFormat");}}s.push(i+" = "+_b(val)+"<br/>");if(_19){break;}}return s.join("");}else{return _2.replace(_17,_2.hitch({obj:_16},function(_1c,key){var _1d=key.split(":");if(_1d.length>1){key=_1d[0];_1d.shift();return _d(key,this.obj,_1d.join(":"));}else{if(_1a&&_2.indexOf(_1a.properties||"",key)!==-1){return _d(key,this.obj,_1a.formatter||"DateString");}if(_1b&&_2.indexOf(_1b.properties||"",key)!==-1){return _d(key,this.obj,_1b.formatter||"NumberFormat");}}return _b(this.obj[key]);}),/\$\{([^\}]+)\}/g);}};}());esri.documentBox=_2.isIE?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight};esri.urlToObject=function(url){var iq=url.indexOf("?");if(iq===-1){return {path:url,query:null};}else{return {path:url.substring(0,iq),query:_2.queryToObject(url.substring(iq+1))};}};esri._getProxyUrl=function(_1e){var _1f=esri.config.defaults.io.proxyUrl,_20,_21,_22;if(!_1f){console.log(esri.bundle.io.proxyNotSet);throw new Error(esri.bundle.io.proxyNotSet);}if(_1e&&window.location.href.toLowerCase().indexOf("https:")!==0){_21=_1f;if(_21.toLowerCase().indexOf("http")!==0){_21=esri._getAbsoluteUrl(_21);}_21=_21.replace(/^http:/i,"https:");if(esri._canDoXOXHR(_21)){_1f=_21;_22=1;}}_20=esri.urlToObject(_1f);_20._xo=_22;return _20;};esri._getProxiedUrl=function(url){if(esri.config.defaults.io.alwaysUseProxy){var _23=esri._getProxyUrl(),_24=esri.urlToObject(url);url=_23.path+"?"+_24.path;var _25=_2.objectToQuery(_2.mixin(_23.query||{},_24.query));if(_25){url+=("?"+_25);}}return url;};esri._hasSameOrigin=function(_26,_27,_28){_26=_26.toLowerCase();_27=_27.toLowerCase();var _29=window.location.href.toLowerCase();_26=_26.indexOf("http")===0?new _2._Url(_26):(_29=new _2._Url(_29));_27=_27.indexOf("http")===0?new _2._Url(_27):(_2.isString(_29)?new _2._Url(_29):_29);return ((_28||(_26.scheme===_27.scheme))&&_26.host===_27.host&&_26.port===_27.port);};esri._canDoXOXHR=function(url,_2a){var _2b=false,_2c=esri._hasSameOrigin,_2d=esri.config.defaults.io.corsEnabledServers,_2e,_2f=-1;if(esri._hasCors&&_2d&&_2d.length){_2b=_2.some(_2d,function(_30,idx){_2e=(_2.trim(_30).toLowerCase().indexOf("http")!==0);if(_2c(url,_2e?("http://"+_30):_30)||(_2e&&_2c(url,"https://"+_30))){_2f=idx;return true;}return false;});}return _2a?_2f:_2b;};esri.request=function(req,_31){var dfd,_32=req.form,_33=_31&&_31.disableIdentityLookup,_34=_31&&_31._preLookup,_35=_32&&_32.append,_36=_32&&(_32.elements?_2.some(_32.elements,function(el){return el.type==="file";}):_35),_37=(req.url.toLowerCase().indexOf("token=")!==-1||(req.content&&req.content.token)||(_36&&_2.some(_32.elements,function(el){return el.name==="token";})))?1:0;esri._detectCors(req.url);if(req._usrDfd){dfd=req._usrDfd;}else{dfd=new _2.Deferred(esri._dfdCanceller);dfd.addBoth(function(_38){if(_38&&(!_2.isIE||!_38.nodeType)){_38._ssl=req._ssl;}});var ld=req.load,_39=req.error;if(ld){dfd.addCallback(function(_3a){var _3b=dfd._pendingDfd,_3c=_3b&&_3b.ioArgs,_3d=_3c&&_3c.args;return ld.call(_3d,_3a,_3c);});}if(_39){dfd.addErrback(function(_3e){var _3f=dfd._pendingDfd,_40=_3f&&_3f.ioArgs,_41=_40&&_40.args;return _39.call(_41,_3e,_40);});}}if(esri.id&&!_37&&!req._token&&!esri.id._isPublic(req.url)&&(!_33||_34)){var _42=esri.id.findCredential(req.url);if(_42){req._token=_42.token;req._ssl=_42.ssl;}}dfd._pendingDfd=esri._request(req,_31,_36,_35);if(!dfd._pendingDfd){dfd.ioArgs=dfd._pendingDfd&&dfd._pendingDfd.ioArgs;var err=new Error("Deferred object is missing");err.log=_2.config.isDebug;req._usrDfd=null;dfd.errback(err);dfd._pendingDfd=null;return dfd;}dfd._pendingDfd.addCallback(function(_43){dfd.ioArgs=dfd._pendingDfd&&dfd._pendingDfd.ioArgs;req._usrDfd=null;dfd.callback(_43);dfd._pendingDfd=null;}).addErrback(function(_44){if(_44&&_44.code==403&&_44.message&&_44.message.toLowerCase().indexOf("ssl")>-1&&_44.message.toLowerCase().indexOf("permission")===-1){if(!req._ssl){req._ssl=req._sslFromServer=true;req._usrDfd=dfd;esri.request(req,_31);return;}}else{if(_44&&_44.status==415){var _45=esri._disableCors(req.url);if(!req._err415){req._err415=1;req._usrDfd=dfd;esri.request(req,_31);return;}}else{if(esri.id&&_2.indexOf(esri.id._errorCodes,_44.code)!==-1&&!esri.id._isPublic(req.url)&&!_33){dfd._pendingDfd=esri.id.getCredential(req.url,{token:req._token,error:_44});dfd._pendingDfd.addCallback(function(_46){req._token=_46.token;req._usrDfd=dfd;req._ssl=req._sslFromServer||_46.ssl;esri.request(req,_31);}).addErrback(function(_47){req._usrDfd=null;dfd.errback(_47);dfd._pendingDfd=null;});return;}}}dfd.ioArgs=dfd._pendingDfd&&dfd._pendingDfd.ioArgs;req._usrDfd=null;dfd.errback(_44);dfd._pendingDfd=null;});return dfd;};esri._request=function(req,_48,_49,_4a){var _4b=false,_4c=false;if(esri._isDefined(_48)){if(_2.isObject(_48)){_4b=!!_48.useProxy;_4c=!!_48.usePost;}else{_4b=!!_48;}}req=_2.mixin({},req);if(req._ssl){req.url=req.url.replace(/^http:/i,"https:");}var _4d=req.content,_4e=req.url,_4f=_49&&req.form,_50=esri.config.defaults.io;req.load=function(_51){var err;if(_51){if(_51.error){err=_2.mixin(new Error(),_51.error);err.log=_2.config.isDebug;}else{if(_51.status==="error"){err=_2.mixin(new Error(),{code:_51.code,message:_51.messages&&_51.messages.join&&_51.messages.join(".")});err.log=_2.config.isDebug;}}}return err||_51;};req.error=function(_52,io){if(io&&io.xhr){io.xhr.abort();}if(!(_52 instanceof Error)){_52=_2.mixin(new Error(),_52);}_52.log=_2.config.isDebug;_50.errorHandler(_52,io);return _52;};if(req._token){req.content=req.content||{};req.content.token=req._token;}var len=0;if(_4d&&_4e){len=_2.objectToQuery(_4d).length+_4e.length+1;}req.timeout=esri._isDefined(req.timeout)?req.timeout:_50.timeout;req.handleAs=req.handleAs||"json";try{var _53,_54,_55=esri._reqPreCallback,_56=esri._canDoXOXHR(req.url)&&!(/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(req.url)),_57=(esri._hasSameOrigin(req.url,window.location.href)||_56),_58=(_4c||_49||len>_50.postLength)?true:false,_59=(!_57&&req.handleAs.indexOf("json")!==-1&&req.callbackParamName&&!_49)?true:false,_5a=(_50.alwaysUseProxy||_4b||((!_59||_58)&&!_57))?true:false;if(_49&&!esri._hasFileUpload&&!_5a&&_56){_5a=true;}if(_5a){_53=esri._getProxyUrl(_2.trim(_4e).toLowerCase().indexOf("https:")===0);_54=_53.path;if(_53._xo){_56=true;}if(!_58&&(_54.length+1+len)>_50.postLength){_58=true;}req.url=_54+"?"+_4e;if(_58){req.content=_2.mixin(_53.query||{},_4d);}else{var _5b=_2.objectToQuery(_2.mixin(_53.query||{},_4d));if(_5b){req.url+=("?"+_5b);}req.content=null;}}if(_59&&!_58){if(!esri._isDefined(req.isAsync)&&_2.isFF<4){req.isAsync=true;}return _2.io.script.get(_55?_55(req):req);}else{var _5c=req.headers;if(_56&&(!_5c||!_5c.hasOwnProperty("X-Requested-With"))){_5c=req.headers=(_5c||{});_5c["X-Requested-With"]=null;}if(_49){var _5d=req.callbackParamName||"callback.html",_5e=req.callbackElementName||"textarea",_5f,_60,_61,i,il=_4f.elements?_4f.elements.length:0,el;_4d=req.content;if(_4d){for(_5f in _4d){_61=_4d[_5f];if(esri._isDefined(_61)){_60=null;for(i=0;i<il;i++){el=_4f.elements[i];if(el.name===_5f){_60=el;break;}}if(_60){_60.value=_61;}else{if(_4a){_4f.append(_5f,_61);}else{_4f.appendChild(_2.create("input",{type:"hidden",name:_5f,value:_61}));}}}}}if(esri._hasFileUpload){_2.forEach(_4f.elements,function(el){if(el.name===_5d){_4f.removeChild(el);}});req.contentType=false;req.postData=_4a?_4f:new FormData(_4f);delete req.form;}else{_4f.enctype="multipart/form-data";if(_2.isIE<9){_4f.encoding="multipart/form-data";}_4f.method="post";if(!_2.some(_4f.elements,function(el){return el.name===_5d;})){_4f.appendChild(_2.create("input",{type:"hidden",name:_5d,value:_5e}));}if(_4e.toLowerCase().indexOf("addattachment")!==-1||_4e.toLowerCase().indexOf("updateattachment")!==-1){req.url=_4e+((_4e.indexOf("?")===-1)?"?":"&")+_5d+"="+_5e;if(_5a){req.url=_54+"?"+req.url;}}delete req.content;}}req=_55?_55(req):req;if(_58){if(_49&&!esri._hasFileUpload){return _2.io.iframe.send(req);}else{return _2.rawXhrPost(req);}}else{return _2.xhrGet(req);}}}catch(e){var dfd=new _2.Deferred();dfd.errback(req.error(e));return dfd;}};esri._disableCors=function(url){var _62=esri.config.defaults.io,_63=_62._processedCorsServers,_64=new _2._Url(url),_65=-1;_64=(_64.host+(_64.port?(":"+_64.port):"")).toLowerCase();_65=esri._canDoXOXHR(url,true);if(_65>-1){_62.corsEnabledServers.splice(_65,1);}_63[_64]=1;return _65;};esri._detectCors=function(url){var _66=esri.config.defaults.io,_67=_66._processedCorsServers;if(!_66.corsDetection){return;}try{var _68=new _2._Url(url);_68=(_68.host+(_68.port?(":"+_68.port):"")).toLowerCase();if(esri._hasCors&&(url&&url.toLowerCase().indexOf("/rest/services")!==-1)&&(!esri._hasSameOrigin(url,window.location.href)&&!esri._canDoXOXHR(url))&&!_67[_68]){_67[_68]=-1;_2.xhrGet({url:url.substring(0,url.toLowerCase().indexOf("/rest/")+"/rest/".length)+"info",content:{f:"json"},failOk:true,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(_69){if(_69){_67[_68]=2;if(!esri._canDoXOXHR(url)){_66.corsEnabledServers.push(_68);}}else{_67[_68]=1;}},function(_6a){_67[_68]=1;});}}catch(e){console.log("esri._detectCors: an unknown error occurred while detecting CORS support");}};esri.setRequestPreCallback=function(_6b){esri._reqPreCallback=_6b;};esri._getParts=function(arr,obj,cb){return [_2.isString(arr)?arr.split(""):arr,obj||_2.global,_2.isString(cb)?new Function("item","index","array",cb):cb];};esri.filter=function(arr,_6c,_6d){var _6e=esri._getParts(arr,_6d,_6c),_6f={},i;arr=_6e[0];for(i in arr){if(_6e[2].call(_6e[i],arr[i],i,arr)){_6f[i]=arr[i];}}return _6f;};esri.TileUtils=(function(){function _70(map,ti,_71){var wd=map.width,ht=map.height,ew=_71.xmax-_71.xmin,eh=_71.ymax-_71.ymin,_72=map.getMinZoom(),_73=map.getMaxZoom(),ed=-1,_74=ti.lods,i,abs=Math.abs,lod,cl,ced;_72=(_72>-1)?_72:0;_73=(_73>-1)?_73:(_74.length-1);for(i=_72;i<=_73;i++){cl=_74[i];if(!cl){continue;}ced=ew>eh?abs(eh-(ht*cl.resolution)):abs(ew-(wd*cl.resolution));if(ed<0||ced<=ed){lod=cl;ed=ced;}else{break;}}return lod;};function _75(map,_76,lod){var res=lod.resolution,cx=(_76.xmin+_76.xmax)/2,cy=(_76.ymin+_76.ymax)/2,_77=(map.width/2)*res,_78=(map.height/2)*res;return new esri.geometry.Extent(cx-_77,cy-_78,cx+_77,cy+_78,_76.spatialReference);};function _79(map,ti,_7a,lod){var res=lod.resolution,tw=ti.width,th=ti.height,to=ti.origin,mv=map.__visibleDelta,_7b=Math.floor,tmw=tw*res,tmh=th*res,tr=_7b((to.y-_7a.y)/tmh),tc=_7b((_7a.x-to.x)/tmw),_7c=to.x+(tc*tmw),_7d=to.y-(tr*tmh),oX=_7b(Math.abs((_7a.x-_7c)*tw/tmw))+mv.x,oY=_7b(Math.abs((_7a.y-_7d)*th/tmh))+mv.y;return {point:_7a,coords:{row:tr,col:tc},offsets:{x:oX,y:oY}};};return {_addFrameInfo:function(_7e,_7f){var _80,_81,_82=2*_7f.origin[1],_83=_7f.origin[0],_84=_7e.origin.x,_85=_7e.width,_86;_2.forEach(_7e.lods,function(lod){_80=Math.round(_82/lod.resolution);_81=Math.ceil(_80/_85);_86=Math.floor((_83-_84)/(_85*lod.resolution));if(!lod._frameInfo){lod._frameInfo=[_81,_86,_86+_81-1,_80];}});},getContainingTileCoords:function(ti,_87,lod){var to=ti.origin,res=lod.resolution,tmw=ti.width*res,tmh=ti.height*res,tc=Math.floor((_87.x-to.x)/tmw),tr=Math.floor((to.y-_87.y)/tmh);return {row:tr,col:tc};},getCandidateTileInfo:function(map,ti,_88){var lod=_70(map,ti,_88),adj=_75(map,_88,lod),ct=_79(map,ti,new esri.geometry.Point(adj.xmin,adj.ymax,_88.spatialReference),lod);return {tile:ct,lod:lod,extent:adj};},getTileExtent:function(ti,_89,row,col){var to=ti.origin,lod=ti.lods[_89],res=lod.resolution,tw=ti.width,th=ti.height;return new esri.geometry.Extent(((col*res)*tw)+to.x,to.y-((row+1)*res)*th,(((col+1)*res)*tw)+to.x,to.y-((row*res)*th),ti.spatialReference);}};}());esri.graphicsExtent=function(_8a){var g=_8a[0].geometry,_8b=g.getExtent(),ext,i,il=_8a.length;if(_8b===null){_8b=new esri.geometry.Extent(g.x,g.y,g.x,g.y,g.spatialReference);}for(i=1;i<il;i++){ext=(g=_8a[i].geometry).getExtent();if(ext===null){ext=new esri.geometry.Extent(g.x,g.y,g.x,g.y,g.spatialReference);}_8b=_8b.union(ext);}if(_8b.getWidth()<=0&&_8b.getHeight()<=0){return null;}return _8b;};esri.getGeometries=function(_8c){return _2.map(_8c,function(_8d){return _8d.geometry;});};esri._encodeGraphics=function(_8e,_8f){var _90=[],_91,enc,_92;_2.forEach(_8e,function(g,i){_91=g.toJson();enc={};if(_91.geometry){_92=_8f&&_8f[i];enc.geometry=_92&&_92.toJson()||_91.geometry;}if(_91.attributes){enc.attributes=_91.attributes;}_90[i]=enc;});return _90;};esri._serializeLayerDefinitions=function(_93){var _94=[],_95=false,re=/[:;]/;if(_93){_2.forEach(_93,function(_96,i){if(_96){_94.push([i,_96]);if(!_95&&re.test(_96)){_95=true;}}});if(_94.length>0){var _97;if(_95){_97={};_2.forEach(_94,function(_98){_97[_98[0]]=_98[1];});_97=_2.toJson(_97);}else{_97=[];_2.forEach(_94,function(_99){_97.push(_99[0]+":"+_99[1]);});_97=_97.join(";");}return _97;}}return null;};esri._serializeTimeOptions=function(_9a,ids){if(!_9a){return;}var _9b=[];_2.forEach(_9a,function(_9c,i){if(_9c){var _9d=_9c.toJson();if(ids&&_2.indexOf(ids,i)!==-1){_9d.useTime=false;}_9b.push("\""+i+"\":"+_2.toJson(_9d));}});if(_9b.length){return "{"+_9b.join(",")+"}";}};esri.isDefined=esri._isDefined=function(_9e){return (_9e!==undefined)&&(_9e!==null);};esri._sanitize=function(obj,_9f){var _a0;if(_9f){for(_a0 in obj){if(obj.hasOwnProperty(_a0)){if(obj[_a0]===undefined||obj[_a0]===null){delete obj[_a0];}else{if(obj[_a0] instanceof Object){esri._sanitize(obj[_a0],true);}}}}}else{for(_a0 in obj){if(obj.hasOwnProperty(_a0)){if(obj[_a0]===undefined){delete obj[_a0];}}}}return obj;};esri._dfdCanceller=function(dfd){dfd.canceled=true;var _a1=dfd._pendingDfd;if(dfd.fired===-1&&_a1&&_a1.fired===-1){_a1.cancel();}dfd._pendingDfd=null;};esri._fixDfd=function(dfd){var _a2=dfd.then;dfd.then=function(_a3,b,c){if(_a3){var _a4=_a3;_a3=function(_a5){if(_a5&&_a5._argsArray){return _a4.apply(null,_a5);}return _a4(_a5);};}return _a2.call(this,_a3,b,c);};return dfd;};esri._resDfd=function(dfd,_a6,_a7){var _a8=_a6.length;if(_a8===1){if(_a7){dfd.errback(_a6[0]);}else{dfd.callback(_a6[0]);}}else{if(_a8>1){_a6._argsArray=true;dfd.callback(_a6);}else{dfd.callback();}}};esri._createWrappers=function(_a9){var _aa=_2.getObject(_a9+".prototype");_2.forEach(_aa.__msigns,function(sig){var _ab=_aa[sig.n];_aa[sig.n]=function(){var _ac=this,_ad=[],i,_ae=new _2.Deferred(esri._dfdCanceller);if(sig.f){esri._fixDfd(_ae);}for(i=0;i<sig.c;i++){_ad[i]=arguments[i];}var _af={dfd:_ae};_ad.push(_af);var _b0,_b1=[],_b2;if(_ac.normalization&&!_ac._isTable){_b0=esri._disassemble(_ad,sig.a);_2.forEach(_b0,function(_b3){_b1=_b1.concat(_b3.value);});if(_b1.length){_b2=esri.geometry.normalizeCentralMeridian(_b1,esri.config.defaults.geometryService);}}if(_b2){_ae._pendingDfd=_b2;_b2.addCallbacks(function(_b4){if(_ae.canceled){return;}_af.assembly=esri._reassemble(_b4,_b0);_ae._pendingDfd=_ab.apply(_ac,_ad);},function(err){var _b5=_ac.declaredClass;if(_b5&&_b5.indexOf("FeatureLayer")!==-1){_ac._resolve([err],null,_ad[sig.e],_ae,true);}else{_ac._errorHandler(err,_ad[sig.e],_ae);}});}else{_ae._pendingDfd=_ab.apply(_ac,_ad);}return _ae;};});};esri._disassemble=function(_b6,_b7){var _b8=[];_2.forEach(_b7,function(_b9){var _ba=_b9.i,arg=_b6[_ba],_bb=_b9.p,_bc;if(!_2.isObject(arg)||!arg){return;}if(_bb){if(_bb[0]==="*"){for(_bc in arg){if(arg.hasOwnProperty(_bc)){esri._addToBucket(arg[_bc],_b8,_ba,_bc);}}}else{_2.forEach(_bb,function(_bd){esri._addToBucket(_2.getObject(_bd,false,arg),_b8,_ba,_bd);});}}else{esri._addToBucket(arg,_b8,_ba);}});return _b8;};esri._addToBucket=function(_be,_bf,_c0,_c1){var _c2=false,_c3;if(_2.isObject(_be)&&_be){if(_2.isArray(_be)){if(_be.length){_c3=_be[0]&&_be[0].declaredClass;if(_c3&&_c3.indexOf("Graphic")!==-1){_be=_2.map(_be,function(_c4){return _c4.geometry;});_c2=_be.length?true:false;}else{if(_c3&&_c3.indexOf("esri.geometry.")!==-1){_c2=true;}}}}else{_c3=_be.declaredClass;if(_c3&&_c3.indexOf("FeatureSet")!==-1){_be=_2.map(_be.features||[],function(_c5){return _c5.geometry;});_c2=_be.length?true:false;}else{if(_c3&&_c3.indexOf("esri.geometry.")!==-1){_c2=true;}}}}if(_c2){_bf.push({index:_c0,property:_c1,value:_be});}};esri._reassemble=function(_c6,_c7){var idx=0,_c8={};_2.forEach(_c7,function(_c9){var _ca=_c9.index,_cb=_c9.property,_cc=_c9.value,len=_cc.length||1;var _cd=_c6.slice(idx,idx+len);if(!_2.isArray(_cc)){_cd=_cd[0];}idx+=len;delete _c9.value;if(_cb){_c8[_ca]=_c8[_ca]||{};_c8[_ca][_cb]=_cd;}else{_c8[_ca]=_cd;}});return _c8;};esri.setScrollable=function(_ce){var _cf=0,_d0=0,_d1=0,_d2=0,_d3=0,_d4=0;return [_2.connect(_ce,"ontouchstart",function(evt){_cf=evt.touches[0].screenX;_d0=evt.touches[0].screenY;_d1=_ce.scrollWidth;_d2=_ce.scrollHeight;_d3=_ce.clientWidth;_d4=_ce.clientHeight;}),_2.connect(_ce,"ontouchmove",function(evt){evt.preventDefault();var _d5=_ce.firstChild;if(_d5 instanceof Text){_d5=_ce.childNodes[1];}var _d6=_d5._currentX||0,_d7=_d5._currentY||0;_d6+=(evt.touches[0].screenX-_cf);if(_d6>0){_d6=0;}else{if(_d6<0&&(Math.abs(_d6)+_d3)>_d1){_d6=-1*(_d1-_d3);}}_d5._currentX=_d6;_d7+=(evt.touches[0].screenY-_d0);if(_d7>0){_d7=0;}else{if(_d7<0&&(Math.abs(_d7)+_d4)>_d2){_d7=-1*(_d2-_d4);}}_d5._currentY=_d7;_2.style(_d5,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+_d6+"px, "+_d7+"px)"});_cf=evt.touches[0].screenX;_d0=evt.touches[0].screenY;})];};esri._getAbsoluteUrl=function(url){if(_2.isString(url)&&url.indexOf("http://")===-1&&url.indexOf("https://")===-1){if(url.indexOf("//")===0){return window.location.protocol+url;}else{if(url.indexOf("/")===0){return window.location.protocol+"//"+window.location.host+url;}else{return esri._appBaseUrl+url;}}}return url;};esri._getDefaultVisibleLayers=function(_d8){var _d9=[],i;if(!_d8){return _d9;}for(i=0;i<_d8.length;i++){if(_d8[i].parentLayerId>=0&&_2.indexOf(_d9,_d8[i].parentLayerId)===-1){continue;}if(_d8[i].defaultVisibility){_d9.push(_d8[i].id);}}return _d9;};esri._getLayersForScale=function(_da,_db){var _dc=[];if(_da>0&&_db){var i;for(i=0;i<_db.length;i++){if(_db[i].parentLayerId>=0&&_2.indexOf(_dc,_db[i].parentLayerId)===-1){continue;}if(_db[i].id>=0){var _dd=true,_de=_db[i].maxScale,_df=_db[i].minScale;if(_de>0||_df>0){if(_de>0&&_df>0){_dd=_de<=_da&&_da<=_df;}else{if(_de>0){_dd=_de<=_da;}else{if(_df>0){_dd=_da<=_df;}}}}if(_dd){_dc.push(_db[i].id);}}}}return _dc;};});