/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
define("esri/MouseEvents",["dojo/_base/declare","dojo/_base/html","dojo/_base/lang","dojo/_base/sniff","dojo/_base/connect","dojo/_base/event","esri","esri/Evented","esri/geometry"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9=_5.connect,_a=_5.disconnect,_b=_7.geometry;var _c=_1([_8],{doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:_4("mac")!==-1?1:3,wheelDivisor:_4("chrome")<2?360:120,preventPageScroll:true,map:null,constructor:function(_d,_e){this.registerConnectEvents({"click":["Click"],"double-click":["DblClick"],"key-down":["KeyDown"],"key-up":["KeyUp"],"mouse-down":["MouseDown"],"mouse-drag":["MouseDrag"],"mouse-drag-end":["MouseDragEnd"],"mouse-drag-start":["MouseDragStart"],"mouse-move":["MouseMove"],"mouse-out":["MouseOut"],"mouse-over":["MouseOver"],"mouse-up":["MouseUp"],"mouse-wheel":["MouseWheel"]},{normalized:true});this.node=_d;_3.mixin(this,_e);var _f=function(evt){_6.stop(evt);return false;};if(_4("mozilla")){_2.style(_d,"MozUserSelect","none");}this._handles=[_9(_d,"onselectstart",_f),_9(_d,"ondragstart",_f),_9(_d,"onmouseenter",this,this._onMouseEnterHandler),_9(_d,"onmouseleave",this,this._onMouseLeaveHandler),_9(_d,"onmousedown",this,this._onMouseDownHandler),_9(_d,"onclick",this,this._onClickHandler),_9(_d,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=_9(_d,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=_9(_d,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=_3.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;var map=this.map;this.preventPageScroll=map?(map.isScrollWheelZoom||map.isScrollWheelPan):this.preventPageScroll;this.enableMouseWheel(false);},_fire:function(_10,evt){if(this[_10]){this[_10](evt);}if(this.map){if(this.map[_10]){this.map[_10](evt);}}},_processEvent:function(evt){evt=_6.fix(evt,evt.target);var map=this.map,pos=map&&map.position;if(pos){if(evt.type==="DOMMouseScroll"&&_4("ff")<3){evt.screenPoint=new _b.ScreenPoint(window.scrollX+evt.screenX-pos.x,window.scrollY+evt.screenY-pos.y);}else{evt.screenPoint=new _b.ScreenPoint(evt.pageX-pos.x,evt.pageY-pos.y);}evt.mapPoint=map.extent?map.toMap(evt.screenPoint):new _b.Point();}evt.numPoints=0;return evt;},_onMouseEnterHandler:function(evt){_a(this._onKeyDown_connect);_a(this._onKeyUp_connect);this._onKeyDown_connect=_9(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=_9(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(evt));},_onMouseLeaveHandler:function(evt){_a(this._onKeyDown_connect);_a(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(evt));},_onMouseMoveHandler:function(evt){if(this._dragEnd){this._dragEnd=false;return;}this._fire("onMouseMove",this._processEvent(evt));},_onMouseDownHandler:function(evt){_a(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=null;if(this.node.setCapture){this.node.setCapture(false);}this._onMouseDragHandler_connect=_9(document,"onmousemove",this,this._onMouseDragHandler);this._startX=evt.pageX;this._startY=evt.pageY;this._fire("onMouseDown",this._processEvent(evt));},_onMouseUpHandler:function(evt){var _11=this.node;if(_11.releaseCapture){_11.releaseCapture();}_a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;_a(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=_9(_11,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(evt));},_onMouseDragHandler:function(evt){_a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=_9(document,"onmousemove",this,this._onMouseDraggingHandler);_a(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=_9(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=_9(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(evt));},_onMouseDraggingHandler:function(evt){_6.stop(evt);this._fire("onMouseDrag",this._processEvent(evt));},_onDragMouseUpHandler:function(evt){var _12=this.node;if(_12.releaseCapture){_12.releaseCapture();}this._dragEnd=true;_a(this._docLeaveConnect);_a(this._onMouseDragHandler_connect);_a(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=_9(_12,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=_9(_12,"onmouseup",this,this._onMouseUpHandler);evt=this._processEvent(evt);this._fire("onMouseDragEnd",evt);this._fire("onMouseUp",evt);},_onDocMouseOut:function(evt){var _13=evt.relatedTarget,_14=evt.relatedTarget&&evt.relatedTarget.nodeName.toLowerCase();if(!_13||(_4("chrome")&&_14==="html")){this._onDragMouseUpHandler(evt);}},_onClickHandler:function(evt){evt=this._processEvent(evt);if(evt.pageX!==this._startX||evt.pageY!==this._startY){return;}clearTimeout(this._clickTimer);this._clickEvent=_3.mixin({},evt);this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration);},_fireClickEvent:function(){clearTimeout(this._clickTimer);if(_4("ie")<9){var GL=_3.getObject("layers.GraphicsLayer",false,_7);if(GL){this._clickEvent.graphic=GL._clicked;delete GL._clicked;}}this._fire("onClick",this._clickEvent);},_onDblClickHandler:function(evt){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(evt));},_onMouseWheelHandler:function(evt){var map=this.map,_15=map?(map.isScrollWheelZoom||map.isScrollWheelPan):this.preventPageScroll;if(_15){_6.stop(evt);}var _16=_4("ie")||_4("webkit")?evt.wheelDelta/this.wheelDivisor:-evt.detail/this.mozWheelDivisor,_17=Math.abs(_16);if(_17<=this.minWheelValue){_17=this.minWheelValue;}else{_17=this.maxWheelValue;}evt.value=_16<0?-_17:_17;this._fire("onMouseWheel",this._processEvent(evt));},_onKeyDownHandler:function(evt){this._fire("onKeyDown",evt);},_onKeyUpHandler:function(evt){this._fire("onKeyUp",evt);},enableMouseWheel:function(_18){_a(this._scrollHandle);this._scrollHandle=_9(this.node,(_4("ff")||_4("mozilla"))?(_18?"MozMousePixelScroll":"DOMMouseScroll"):"onmousewheel",this,this._onMouseWheelHandler);},setImmediateClick:function(_19){this.doubleClickDuration=_19?0:this._initialDuration;},destroy:function(){var _1a=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),i;for(i=0;i<_1a.length;i++){_a(_1a[i]);}clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null;}});if(_4("extend-esri")){_7.MouseEvents=_c;}return _c;});