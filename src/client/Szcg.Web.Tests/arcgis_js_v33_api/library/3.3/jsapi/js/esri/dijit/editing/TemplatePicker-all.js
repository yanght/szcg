/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var _a=_6("dojox.grid.DataGrid",_7,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _8(this);},get:function(_b,_c){if(_c&&this.field=="_item"&&!this.fields){return _c;}else{if(_c&&this.fields){var _d=[];var s=this.grid.store;_2.forEach(this.fields,function(f){_d=_d.concat(s.getValues(_c,f));});return _d;}else{if(!_c&&typeof _b==="string"){return this.inherited(arguments);}}}return (!_c?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_c:this.grid.store.getValue(_c,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _e=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_e=true;}if(!this.updating){this.beginUpdate();_e=true;}if(_e){var _f=this;this._endUpdateDelay=setTimeout(function(){delete _f._endUpdateDelay;_f.endUpdate();},this.updateDelay);}}},_onSet:function(_10,_11,_12,_13){this._checkUpdateStatus();var idx=this.getItemIndex(_10);if(idx>-1){this.updateRow(idx);}},_createItem:function(_14,_15){var _16=this._hasIdentity?this.store.getIdentity(_14):_4.toJson(this.query)+":idx:"+_15+":sort:"+_4.toJson(this.getSortProps());var o=this._by_idty[_16]={idty:_16,item:_14};return o;},_addItem:function(_17,_18,_19){this._by_idx[_18]=this._createItem(_17,_18);if(!_19){this.updateRow(_18);}},_onNew:function(_1a,_1b){this._checkUpdateStatus();var _1c=this.get("rowCount");this._addingItem=true;this.updateRowCount(_1c+1);this._addingItem=false;this._addItem(_1a,_1c);this.showMessage();},_onDelete:function(_1d){this._checkUpdateStatus();var idx=this._getItemIndex(_1d,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_1e,_1f,_20){if(this._requestsPending(0)){return;}this._setQuery(_1f,_20);this._setStore(_1e);this._refresh(true);},setQuery:function(_21,_22){if(this._requestsPending(0)){return;}this._setQuery(_21,_22);this._refresh(true);},setItems:function(_23){this.items=_23;this._setStore(this.store);this._refresh(true);},_setQuery:function(_24,_25){this.query=_24;this.queryOptions=_25||this.queryOptions;},_setStore:function(_26){if(this.store&&this._store_connects){_2.forEach(this._store_connects,this.disconnect,this);}this.store=_26;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(_27,req){if(!this.scroller){return;}if(this.rowCount!=_27){if(req.isRender){this.scroller.init(_27,this.keepRows,this.rowsPerPage);this.rowCount=_27;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(_27);}}if(!_27){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_28,req){if(!this.scroller){return;}if(_28&&_28.length>0){_2.forEach(_28,function(_29,idx){this._addItem(_29,req.start+idx,true);},this);this.updateRows(req.start,_28.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(_5("ie")){_9.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_2a,_2b){_2a=_2a||0;if(this.store&&!this._pending_requests[_2a]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_2a]=true;try{if(this.items){var _2c=this.items;var _2d=this.store;this.rowsPerPage=_2c.length;var req={start:_2a,count:this.rowsPerPage,isRender:_2b};this._onFetchBegin(_2c.length,req);var _2e=0;_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2e++;}});if(_2e===0){this._onFetchComplete(_2c,req);}else{var _2f=function(_30){_2e--;if(_2e===0){this._onFetchComplete(_2c,req);}};_2.forEach(_2c,function(i){if(!_2d.isItemLoaded(i)){_2d.loadItem({item:i,onItem:_2f,scope:this});}},this);}}else{this.store.fetch({start:_2a,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_2b,onBegin:_3.hitch(this,"_onFetchBegin"),onComplete:_3.hitch(this,"_onFetchComplete"),onError:_3.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_2a,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var _31=this._by_idx[idx];if(!_31||(_31&&!_31.item)){this._preparePage(idx);return null;}return _31.item;},getItemIndex:function(_32){return this._getItemIndex(_32,false);},_getItemIndex:function(_33,_34){if(!_34&&!this.store.isItem(_33)){return -1;}var _35=this._hasIdentity?this.store.getIdentity(_33):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((_35&&d.idty==_35)||(d.item===_33))){return i;}}return -1;},filter:function(_36,_37){this.query=_36;if(_37){this._clearData();}this._fetch();},_getItemAttr:function(idx,_38){var _39=this.getItem(idx);return (!_39?this.fetchText:this.store.getValue(_39,_38));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_3a){return this._pending_requests[_3a];},_rowToPage:function(_3b){return (this.rowsPerPage?Math.floor(_3b/this.rowsPerPage):_3b);},_pageToRow:function(_3c){return (this.rowsPerPage?this.rowsPerPage*_3c:_3c);},_preparePage:function(_3d){if((_3d<this._bop||_3d>=this._eop)&&!this._addingItem){var _3e=this._rowToPage(_3d);this._needPage(_3e);this._bop=_3e*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_3f){if(!this._pages[_3f]){this._pages[_3f]=true;this._requestPage(_3f);}},_requestPage:function(_40){var row=this._pageToRow(_40);var _41=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_41>0){this._requests++;if(!this._requestsPending(row)){setTimeout(_3.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_42){return _42.field;},_refresh:function(_43){this._clearData();this._fetch(0,_43);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var _44=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof _44=="undefined"){_44=si;}else{_44=si?!_44:_44;}return [{attribute:c.field,descending:_44}];}},styleRowState:function(_45){if(this.store&&this.store.getState){var _46=this.store.getState(_45.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_46[s]){c=" dojoxGridRow-"+s;break;}}_45.customClasses+=c;}},onStyleRow:function(_47){this.styleRowState(_47);this.inherited(arguments);},canEdit:function(_48,_49){return this._canEdit;},_copyAttr:function(idx,_4a){var row={};var _4b={};var src=this.getItem(idx);return this.store.getValue(src,_4a);},doStartEdit:function(_4c,_4d){if(!this._cache[_4d]){this._cache[_4d]=this._copyAttr(_4d,_4c.field);}this.onStartEdit(_4c,_4d);},doApplyCellEdit:function(_4e,_4f,_50){this.store.fetchItemByIdentity({identity:this._by_idx[_4f].idty,onItem:_3.hitch(this,function(_51){var _52=this.store.getValue(_51,_50);if(typeof _52=="number"){_4e=isNaN(_4e)?_4e:parseFloat(_4e);}else{if(typeof _52=="boolean"){_4e=_4e=="true"?true:_4e=="false"?false:_4e;}else{if(_52 instanceof Date){var _53=new Date(_4e);_4e=isNaN(_53.getTime())?_4e:_53;}}}this.store.setValue(_51,_50,_4e);this.onApplyCellEdit(_4e,_4f,_50);})});},doCancelEdit:function(_54){var _55=this._cache[_54];if(_55){this.updateRow(_54);delete this._cache[_54];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_56,_57){var _58=this._cache[_56];this.onApplyEdit(_56);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=_3.hitch(this,function(_59){if(_59.length){_2.forEach(_59,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_a.cell_markupFactory=function(_5a,_5b,_5c){var _5d=_3.trim(_9.attr(_5b,"field")||"");if(_5d){_5c.field=_5d;}_5c.field=_5c.field||_5c.name;var _5e=_3.trim(_9.attr(_5b,"fields")||"");if(_5e){_5c.fields=_5e.split(",");}if(_5a){_5a(_5b,_5c);}};_a.markupFactory=function(_5f,_60,_61,_62){return _7.markupFactory(_5f,_60,_61,_3.partial(_a.cell_markupFactory,_62));};return _a;});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_63,_64,_65,_66,_67,has,_68,_69,_6a){return _65("dojox.grid._FocusManager",null,{constructor:function(_6b){this.grid=_6b;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_66.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_66.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_66.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_66.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_66.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_66.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_66.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_66.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_66.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_63.forEach(this._connects,_66.disconnect);_63.forEach(this._headerConnects,_66.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_6c,_6d){return (this.cell==_6c)&&(this.rowIndex==_6d);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _63.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_6e){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){_6a.toggleClass(n,this.focusClass,_6e);if(_6e){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){_69.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){_6a.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}_69.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_63.forEach(this._headerConnects,_66.disconnect);this._headerConnects=[];var _6f=this._findHeaderCells();for(var i=0;i<_6f.length;i++){this._headerConnects.push(_66.connect(_6f[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_66.connect(_6f[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _70=_68("th",this.grid.viewsHeaderNode);var _71=[];for(var i=0;i<_70.length;i++){var _72=_70[i];var _73=_6a.hasAttr(_72,"tabIndex");var _74=_6a.attr(_72,"tabIndex");if(_73&&_74<0){_71.push(_72);}}return _71;},_setActiveColHeader:function(_75,_76,_77){this.grid.domNode.setAttribute("aria-activedescendant",_75.id);if(_77!=null&&_77>=0&&_77!=_76){_6a.toggleClass(this._findHeaderCells()[_77],this.focusClass,false);}_6a.toggleClass(_75,this.focusClass,true);this._colHeadNode=_75;this._colHeadFocusIdx=_76;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var _78=(this.cell?this._scrollInfo(this.cell):null);if(!_78||!_78.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(_78.n&&_78.sr){if(_78.n.offsetLeft+_78.n.offsetWidth>_78.sr.l+_78.sr.w){_78.s.scrollLeft=_78.n.offsetLeft+_78.n.offsetWidth-_78.sr.w;}else{if(_78.n.offsetLeft<_78.sr.l){_78.s.scrollLeft=_78.n.offsetLeft;}}}if(_78.r&&_78.sr){if(rt+_78.r.offsetHeight>_78.sr.t+_78.sr.h){this.grid.setScrollTop(rt+_78.r.offsetHeight-_78.sr.h);}else{if(rt<_78.sr.t){this.grid.setScrollTop(rt);}}}return _78.s.scrollLeft;},_scrollInfo:function(_79,_7a){if(_79){var cl=_79,sbn=cl.view.scrollboxNode,_7b={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:_7b,n:(_7a?_7a:_79.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_7c){var _7d=null;if(this._colHeadNode){var _7e=this.grid.getCell(_7c);if(!_7e){return;}_7d=this._scrollInfo(_7e,_7e.getNode(0));}if(_7d&&_7d.s&&_7d.sr&&_7d.n){var _7f=_7d.sr.l+_7d.sr.w;if(_7d.n.offsetLeft+_7d.n.offsetWidth>_7f){_7d.s.scrollLeft=_7d.n.offsetLeft+_7d.n.offsetWidth-_7d.sr.w;}else{if(_7d.n.offsetLeft<_7d.sr.l){_7d.s.scrollLeft=_7d.n.offsetLeft;}else{if(has("ie")<=7&&_7e&&_7e.view.headerNode){_7e.view.headerNode.scrollLeft=_7d.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _80=this.focusView;if(!_80){for(var i=0,_81;(_81=this.grid.views.views[i]);i++){if(_81.headerNode){_80=_81;break;}}}return (_80&&_6a.getComputedStyle(_80.headerNode).display=="none");},colSizeAdjust:function(e,_82,_83){var _84=this._findHeaderCells();var _85=this.focusView;if(!_85||!_85.header.tableMap.map){for(var i=0,_86;(_86=this.grid.views.views[i]);i++){if(_86.header.tableMap.map){_85=_86;break;}}}var _87=_84[_82];if(!_85||(_82==_84.length-1&&_82===0)){return;}_85.content.baseDecorateEvent(e);e.cellNode=_87;e.cellIndex=_85.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(_85.header.canResize(e)){var _88={l:_83};var _89=_85.header.colResizeSetup(e,false);_85.header.doResizeColumn(_89,null,_88);_85.update();}},styleRow:function(_8a){return;},setFocusIndex:function(_8b,_8c){this.setFocusCell(this.grid.getCell(_8c),_8b);},setFocusCell:function(_8d,_8e){if(_8d&&!this.isFocusCell(_8d,_8e)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_8d;this.rowIndex=_8e;this._focusifyCellNode(true);}if(has("opera")){setTimeout(_64.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _8f=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_8f.editable||this.grid.canEdit&&!this.grid.canEdit(_8f,row))){this.cell=_8f;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _90=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_90.editable){this.cell=_90;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_91,_92){var _93=_92<0?-1:1;if(this.isNavHeader()){var _94=this._findHeaderCells();var _95=currentIdx=_63.indexOf(_94,this._colHeadNode);currentIdx+=_92;while(currentIdx>=0&&currentIdx<_94.length&&_94[currentIdx].style.display=="none"){currentIdx+=_93;}if((currentIdx>=0)&&(currentIdx<_94.length)){this._setActiveColHeader(_94[currentIdx],currentIdx,_95);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_91));if(_91){if(_91>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_91<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_92));var _96=this.grid.getCell(col);while(col>=0&&col<cc&&_96&&_96.hidden===true){col+=_93;_96=this.grid.getCell(col);}if(!_96||_96.hidden===true){col=i;}var n=_96.getNode(row);if(!n&&_91){if((row+_91)>=0&&(row+_91)<=rc){this.move(_91>0?++_91:--_91,_92);}return;}else{if((!n||_6a.style(n,"display")==="none")&&_92){if((col+_92)>=0&&(col+_92)<=cc){this.move(_91,_92>0?++_92:--_92);}return;}}this.setFocusIndex(row,col);if(_91){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_67.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_67.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){_6a.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _97=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_67.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_67.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_98){this.tabbingOut=true;_98.focus();},focusGridView:function(){_69.fire(this.focusView,"focus");},focusGrid:function(_99){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _9a=true;var _9b=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_9b){var _9c=0;var _9d=this.grid.getCell(_9c);if(_9d.hidden){_9c=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_9c);}else{if(this.cell&&!_9b){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_9a=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _9a;},focusHeader:function(){var _9e=this._findHeaderCells();var _9f=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_9e[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_9e.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_9e[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_9f);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){_6a.removeClass(this._colHeadNode,this.focusClass);_6a.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _a0=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_a0);this._contextMenuBindNode=_a0;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_67.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_67.stop(e);},doBlur:function(e){_67.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_67.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_67.stop(e);},doLastNodeBlur:function(e){_67.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,_6a.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_67.stop(e);},doColHeaderBlur:function(e){_6a.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/toolbars/_VertexEditor":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Menu,esri/toolbars/_VertexMover"],function(_a1,_a2,_a3){_a2.provide("esri.toolbars._VertexEditor");_a2.require("dijit.Menu");_a2.require("esri.toolbars._VertexMover");_a2.declare("esri.toolbars._GraphicVertexEditor",null,{constructor:function(_a4,map,_a5){this.graphic=_a4;this.map=map;this.toolbar=_a5;var _a6=_a5._options;this._symbol1=_a6.vertexSymbol;this._symbol2=_a6.ghostVertexSymbol;var _a7=_a6.ghostLineSymbol;this._lineStroke={style:_a7.style,width:_a7.width,color:_a7.color};this._canDel=_a6.allowDeleteVertices;this._canAdd=_a6.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_a8){if(_a8){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_a2.connect(esri.toolbars.VertexMover,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_a2.connect(esri.toolbars.VertexMover,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _a9=this._getGraphicsLayer();this._mouseOverHandle=_a2.connect(_a9,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_a2.connect(_a9,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new _a1.Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _aa=(this._ctxDelete=new _a1.MenuItem({label:esri.bundle.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_a2.connect(_aa,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_aa);this._ctxMenu.startup();}},_removeControllers:function(){_a2.disconnect(this._firstMoveHandle);_a2.disconnect(this._moveStopHandle);_a2.disconnect(this._mouseOverHandle);_a2.disconnect(this._mouseOutHandle);_a2.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_ab,_ac,_ad){var i,j,_ae=this.graphic,_af=[];for(i=0;i<_ab.length;i++){var _b0=_ab[i],_b1=[];for(j=0;j<_b0.length;j++){_b1.push(new esri.toolbars.VertexMover(_b0[j],_ac,_ae,i,j,_b0.length,this,_ad));}_af.push(_b1);}return _af;},_remove:function(_b2){if(_b2){_a2.forEach(_b2,function(_b3){_a2.forEach(_b3,function(_b4){_b4.destroy();});});}},_refresh:function(_b5){if(_b5){_a2.forEach(_b5,function(_b6){_a2.forEach(_b6,function(_b7){_b7.refresh();});});}},_isNew:function(_b8){return (_a2.indexOf(this._vertexMovers[_b8.segIndex],_b8)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _b9=this._selectedMover,_ba=_b9.ptIndex;this._updateRelatedGraphic(_b9,_b9.relatedGraphic,_b9.graphic.geometry,_b9.segIndex,_b9.ptIndex,_b9.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_b9);}this._deleteVertex(_b9);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _bb=evt.graphic,_bc=this._findMover(_bb);if(_bc){this.toolbar.onVertexMouseOver(this.graphic,_bc._getInfo());if(!_bc._placeholder){this._selectedMover=_bc;if(this._canDel){this._bindCtxNode(_bb.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _bd=evt.graphic,_be=this._findMover(_bd);if(_be){this.toolbar.onVertexMouseOut(this.graphic,_be._getInfo());}},_bindCtxNode:function(_bf){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(_bf);this._bindNode=_bf;},_unbindCtxNode:function(){var _c0=this._bindNode;if(_c0){this._ctxMenu.unBindDomNode(_c0);}},_findMover:function(_c1){var i,_c2=[],_c3=this._mpVertexMovers;_a2.forEach(this._vertexMovers,function(_c4){_c2=_c2.concat(_c4);});if(_c3){_a2.forEach(_c3,function(_c5){_c2=_c2.concat(_c5);});}for(i=0;i<_c2.length;i++){var _c6=_c2[i];if(_c6.graphic===_c1){return _c6;}}},_firstMoveHandler:function(_c7){if(!this._isNew(_c7)&&this._canAdd){this._hideRelatedMidpoints(_c7);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_c8,tx){var add=this._isNew(_c8);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_c8);}return;}this._updateRelatedGraphic(_c8,_c8.relatedGraphic,_c8.graphic.geometry,_c8.segIndex,_c8.ptIndex,_c8.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_c8);}else{this._repositionRelatedMidpoints(_c8);this._showRelatedMidpoints(_c8);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_c9){var i,_ca=this._getAdjacentMidpoints(_c9.ptIndex,_c9.segLength),_cb=this._mpVertexMovers[_c9.segIndex];for(i=0;i<_ca.length;i++){var mvr=_cb[_ca[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_cc){var i,_cd=this._getAdjacentMidpoints(_cc.ptIndex,_cc.segLength),_ce=this._mpVertexMovers[_cc.segIndex];for(i=0;i<_cd.length;i++){_ce[_cd[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_cf){var i,_d0=this._getAdjacentMidpoints(_cf.ptIndex,_cf.segLength),_d1=this._mpVertexMovers[_cf.segIndex];for(i=0;i<_d0.length;i++){var _d2=this._getAdjacentVertices(_d0[i],_cf.segLength);var _d3=_cf.relatedGraphic.geometry.getPoint(_cf.segIndex,_d2[0]),_d4=_cf.relatedGraphic.geometry.getPoint(_cf.segIndex,_d2[1]);var _d5=new esri.geometry.Point({x:(_d3.x+_d4.x)/2,y:(_d3.y+_d4.y)/2,spatialReference:_d3.spatialReference.toJson()});_d1[_d0[i]].graphic.setGeometry(_d5);}},_addMidpoints:function(_d6){var _d7=_d6.segIndex,_d8=_d6.ptIndex,_d9=_d6.segLength;var _da=_d8+1;var i,_db=_d9+1;this._mpVertexMovers[_d7].splice(_d8,1);var _dc=this._vertexMovers[_d7];for(i=0;i<_da;i++){_dc[i].segLength+=1;}for(i=_da;i<_dc.length;i++){_dc[i].ptIndex+=1;_dc[i].segLength+=1;}_d6.ptIndex=_da;_d6.segLength=_dc.length+1;_dc.splice(_da,0,_d6);_d6.graphic.setSymbol(this._symbol1);_dc=this._mpVertexMovers[_d7];for(i=0;i<_d8;i++){_dc[i].segLength+=1;}for(i=_d8;i<_d9-1;i++){_dc[i].ptIndex+=1;_dc[i].segLength+=1;}var _dd=this._getAdjacentVertices(_d8,_db);var _de=this._getAdjacentVertices(_d8+1,_db);var _df,_e0;_df=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_dd[0]);_e0=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_dd[1]);var _e1=new esri.geometry.Point({x:(_df.x+_e0.x)/2,y:(_df.y+_e0.y)/2,spatialReference:_df.spatialReference.toJson()});_df=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_de[0]);_e0=_d6.relatedGraphic.geometry.getPoint(_d6.segIndex,_de[1]);var _e2=new esri.geometry.Point({x:(_df.x+_e0.x)/2,y:(_df.y+_e0.y)/2,spatialReference:_df.spatialReference.toJson()});var _e3=new esri.toolbars.VertexMover(_e1,this._symbol2,this.graphic,_d6.segIndex,_d8,_db,this,true);var _e4=new esri.toolbars.VertexMover(_e2,this._symbol2,this.graphic,_d6.segIndex,_d8+1,_db,this,true);_dc.splice(_d8,0,_e3,_e4);},_deleteVertex:function(_e5){var i,_e6=_e5.segIndex,_e7=_e5.ptIndex;var _e8=this._vertexMovers[_e6];for(i=0;i<_e7;i++){_e8[i].segLength-=1;}for(i=_e7+1;i<_e8.length;i++){var mvr=_e8[i];mvr.ptIndex-=1;mvr.segLength-=1;}_e8.splice(_e7,1);var _e9=_e5._getInfo();_e5.destroy();this.toolbar.onVertexDelete(this.graphic,_e9);}});_a2.mixin(esri.toolbars._GraphicVertexEditor,{create:function(_ea,map,_eb){var _ec=_ea.geometry.type;switch(_ec){case "multipoint":return new esri.toolbars._MultipointVertexEditor(_ea,map,_eb);break;case "polyline":return new esri.toolbars._PolylineVertexEditor(_ea,map,_eb);break;case "polygon":return new esri.toolbars._PolygonVertexEditor(_ea,map,_eb);break;}}});_a2.declare("esri.toolbars._MultipointVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:1,constructor:function(){this._moveStartHandle=_a2.connect(esri.toolbars.VertexMover,"onMoveStart",this,this._moveStartHandler);_a2.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_a2.disconnect(this._moveStartHandle);},_getSegments:function(_ed){var i,_ee=_ed.points,_ef=[],sr=_ed.spatialReference;for(i=0;i<_ee.length;i++){var _f0=_ee[i];_ef.push(new esri.geometry.Point({x:_f0[0],y:_f0[1],spatialReference:sr.toJson()}));}return [_ef];},_getMidpointSegments:function(_f1){return [];},_getControlPoints:function(_f2,_f3,_f4,_f5,_f6){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _f7=evt.graphic,_f8=this._findMover(evt);if(_f8){this.toolbar.onVertexMouseOver(_f7,_f8._getInfo());this._selectedMover=_f8;if(this._canDel){this._bindCtxNode(_f8.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _f9=evt.graphic,_fa=this._findMover(evt);if(_fa){this.toolbar.onVertexMouseOut(_f9,_fa._getInfo());}},_findMover:function(evt){var i,_fb=[].concat(this._vertexMovers[0]),_fc=evt.target;for(i=0;i<_fb.length;i++){var _fd=_fb[i];if(_fd.graphic.getDojoShape().getNode()===_fc){return _fd;}}},_moveStartHandler:function(_fe){var _ff=_fe.relatedGraphic.geometry,_100=_fe.ptIndex;var _101=_fe.segLength-1;var _102=_ff.points;var _103=_102.splice(_100,1);_102.push(_103[0]);var j,_104=this._vertexMovers[0];for(j=_101;j>_100;j--){_104[j].ptIndex-=1;}_103=_104.splice(_100,1);_104.push(_103[0]);_103[0].ptIndex=_101;},_moveStopHandler:function(_105){this._updateRelatedGraphic(_105,_105.relatedGraphic,_105.graphic.geometry,_105.segIndex,_105.ptIndex,_105.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_106,_107,_108,_109,_10a,_10b,add,del){var geom=_107.geometry;if(del){geom.removePoint(_10a);}else{geom.setPoint(_10a,_108);}_107.setGeometry(geom);},_deleteMidpoints:function(_10c){}});_a2.declare("esri.toolbars._PolylineVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:2,_getSegments:function(_10d){var i,j,_10e=_10d.paths,_10f=[];for(i=0;i<_10e.length;i++){var path=_10e[i],_110=[];for(j=0;j<path.length;j++){_110.push(_10d.getPoint(i,j));}_10f.push(_110);}return _10f;},_getMidpointSegments:function(_111){var i,j,_112=_111.paths,_113=[],sr=_111.spatialReference;for(i=0;i<_112.length;i++){var path=_112[i],_114=[];for(j=0;j<path.length-1;j++){var _115=_111.getPoint(i,j),_116=_111.getPoint(i,j+1);var midX=(_115.x+_116.x)/2,midY=(_115.y+_116.y)/2;var _117=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_114.push(_117);}_113.push(_114);}return _113;},_getControlPoints:function(_118,_119,_11a,_11b,_11c){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_118)){idx1=_11b;idx2=_11b+1;if(idx1>=0){pt1=map.toScreen(_119.getPoint(_11a,idx1));}if(idx2<=_11c){pt2=map.toScreen(_119.getPoint(_11a,idx2));}}else{idx1=_11b-1;idx2=_11b+1;if(idx1>=0){pt1=map.toScreen(_119.getPoint(_11a,idx1));}if(idx2<_11c){pt2=map.toScreen(_119.getPoint(_11a,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_11d,_11e){var _11f=[];var idx1=_11d-1;if(idx1>=0){_11f.push(idx1);}var idx2=_11d;if(idx2<_11e-1){_11f.push(idx2);}return _11f;},_getAdjacentVertices:function(_120,_121){return [_120,_120+1];},_deleteMidpoints:function(_122){var _123=_122.segIndex,_124=_122.ptIndex,_125=_122.segLength;var _126=this._mpVertexMovers[_123],_127=_126.length-1;var _128=this._getAdjacentMidpoints(_124,_125).sort();var i,min=_128[0];for(i=0;i<min;i++){_126[i].segLength-=1;}for(i=min+1;i<_126.length;i++){var mvr=_126[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_128.length===1){_126.splice(min,1)[0].destroy();}else{var _129=this._getAdjacentVertices(min,_127);var _12a=_122.relatedGraphic.geometry.getPoint(_122.segIndex,_129[0]);var _12b=_122.relatedGraphic.geometry.getPoint(_122.segIndex,_129[1]);var _12c=new esri.geometry.Point({x:(_12a.x+_12b.x)/2,y:(_12a.y+_12b.y)/2,spatialReference:_12a.spatialReference.toJson()});var mvr1=new esri.toolbars.VertexMover(_12c,this._symbol2,this.graphic,_122.segIndex,min,_127,this,true);var _12d=_126.splice(min,_128.length,mvr1);for(i=0;i<_12d.length;i++){_12d[i].destroy();}}},_updateRelatedGraphic:function(_12e,_12f,_130,_131,_132,_133,add,del){var geom=_12f.geometry;if(add){geom.insertPoint(_131,_132+1,esri.geometry.fromJson(_130.toJson()));}else{if(del){geom.removePoint(_131,_132);}else{geom.setPoint(_131,_132,esri.geometry.fromJson(_130.toJson()));}}_12f.setGeometry(geom);}});_a2.declare("esri.toolbars._PolygonVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:3,_getSegments:function(_134){var i,j,_135=_134.rings,_136=[];for(i=0;i<_135.length;i++){var ring=_135[i],_137=[];for(j=0;j<ring.length-1;j++){_137.push(_134.getPoint(i,j));}_136.push(_137);}return _136;},_getMidpointSegments:function(_138){var i,j,_139=_138.rings,_13a=[],sr=_138.spatialReference;for(i=0;i<_139.length;i++){var ring=_139[i],_13b=[];for(j=0;j<ring.length-1;j++){var _13c=_138.getPoint(i,j),_13d=_138.getPoint(i,j+1);var midX=(_13c.x+_13d.x)/2,midY=(_13c.y+_13d.y)/2;var _13e=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_13b.push(_13e);}_13a.push(_13b);}return _13a;},_getControlPoints:function(_13f,_140,_141,_142,_143){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_13f)){idx1=_142;idx2=(_142+1)%_143;}else{idx1=_142-1;idx1=idx1<0?(_143+idx1)%_143:idx1;idx2=(_142+1)%_143;}pt1=map.toScreen(_140.getPoint(_141,idx1));pt2=map.toScreen(_140.getPoint(_141,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_144,_145){var idx1=_144-1;idx1=idx1<0?(_145+idx1)%_145:idx1;var idx2=_144;return [idx1,idx2];},_getAdjacentVertices:function(_146,_147){return [_146,(_146+1)%_147];},_deleteMidpoints:function(_148){var _149=_148.segIndex,_14a=_148.ptIndex,_14b=_148.segLength;var _14c=this._mpVertexMovers[_149],_14d=_14c.length-1,_14e=this._getAdjacentMidpoints(_14a,_14b).sort(),_14f,_150,_151,_152,i,mvr1,mvr,min=_14e[0],max=_14e[_14e.length-1];if(_14a===0){_14f=this._getAdjacentVertices(_14d-1,_14d);_150=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[0]);_151=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[1]);_152=new esri.geometry.Point({x:(_150.x+_151.x)/2,y:(_150.y+_151.y)/2,spatialReference:_150.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_152,this._symbol2,this.graphic,_148.segIndex,_14d-1,_14d,this,true);_14c.splice(max,1,mvr1)[0].destroy();_14c.splice(min,1)[0].destroy();for(i=0;i<_14c.length-1;i++){mvr=_14c[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_14f=this._getAdjacentVertices(min,_14d);_150=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[0]);_151=_148.relatedGraphic.geometry.getPoint(_148.segIndex,_14f[1]);_152=new esri.geometry.Point({x:(_150.x+_151.x)/2,y:(_150.y+_151.y)/2,spatialReference:_150.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_152,this._symbol2,this.graphic,_148.segIndex,min,_14d,this,true);var _153=_14c.splice(min,_14e.length,mvr1);for(i=0;i<_153.length;i++){_153[i].destroy();}for(i=0;i<min;i++){_14c[i].segLength-=1;}for(i=min+1;i<_14c.length;i++){mvr=_14c[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_154,_155,_156,_157,_158,_159,add,del){var geom=_155.geometry;if(add){geom.insertPoint(_157,_158+1,esri.geometry.fromJson(_156.toJson()));}else{if(del){geom.removePoint(_157,_158);if(_158===0){geom.setPoint(_157,_159-1,esri.geometry.fromJson(geom.getPoint(_157,0).toJson()));}}else{geom.setPoint(_157,_158,esri.geometry.fromJson(_156.toJson()));if(_158===0){geom.setPoint(_157,_159,esri.geometry.fromJson(_156.toJson()));}}}_155.setGeometry(geom);}});});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_15a,_15b,_15c,_15d,lang,dom,_15e,_15f,_160,on,_161,dnd,_162){var _163=_15b("dojo.dnd.Selector",_162,{constructor:function(node,_164){if(!_164){_164={};}this.singular=_164.singular;this.autoSync=_164.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_161.press,lang.hitch(this,"onMouseDown")),on(this.node,_161.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _160();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_15e.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_15d.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_163.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_15a.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_165,data,_166,_167){var _168=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_168.call(this,item,hint);if(_165){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_163.superclass.insertNodes.call(this,data,_166,_167);this._normalizedCreator=_168;return this;},destroy:function(){_163.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_15f.isLeft(e)){_15c.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_15c.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_161.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _163;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_169,_16a,dom,_16b,_16c,lang,_16d,on,_16e,_16f,pm,_170,_171,_172,_173){return _16a("dijit._MenuBase",[_171,_173,_172],{parentMenu:null,popupDelay:500,autoFocus:false,postCreate:function(){var self=this,_174=function(node){return _16c.contains(node,"dijitMenuItem");};this.own(on(this.containerNode,on.selector(_174,_16d.enter),function(){self.onItemHover(_170.byNode(this));}),on(this.containerNode,on.selector(_174,_16d.leave),function(){self.onItemUnhover(_170.byNode(this));}),on(this.containerNode,on.selector(_174,_16f),function(evt){self.onItemClick(_170.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _175=this._getTopMenu();if(_175&&_175._isMenuBar){_175.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _176=this.currentPopup.parentMenu;if(_176.focusedChild){_176.focusedChild._setSelected(false);}_176.focusedChild=this.currentPopup.from_item;_176.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _177=item.popup;if(_177){this._stopPendingCloseTimer(_177);_177._pendingClose_timer=this.defer(function(){_177._pendingClose_timer=null;if(_177.parentMenu){_177.parentMenu.currentPopup=null;}pm.close(_177);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_178){if(_178._pendingClose_timer){_178._pendingClose_timer=_178._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_179){this._stopPopupTimer();var _17a=this.focusedChild;if(!_17a){return;}var _17b=_17a.popup;if(!_17b.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_17b.parentMenu=this;_17b.from_item=_17a;var self=this;pm.open({parent:this,popup:_17b,around:_17a.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_17a);self._cleanUp();_17a._setSelected(true);self.focusedChild=_17a;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_17b;_17b.connect(_17b.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_179&&_17b.focus){_17b._focus_timer=this.defer(lang.hitch(_17b,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_16c.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_16c.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_169.indexOf(this._focusManager.activeStack,this.id)>=0){_16b.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_17c,lang,has,_17d,_17e,_17f,_180){var dhm=lang.getObject("dojox.html.metrics",true);var _181=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _182={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_17f.doc.documentElement.style.fontSize="100%";}var div=_17f.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_17f.body().appendChild(div);for(var p in _182){ds.fontSize=p;_182[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_17f.body().removeChild(div);div=null;return _182;};var _183=null;dhm.getCachedFontMeasurements=function(_184){if(_184||!_183){_183=dhm.getFontMeasurements();}return _183;};var _185=null,_186={};dhm.getTextBox=function(text,_187,_188){var m,s;if(!_185){m=_185=_17f.doc.createElement("div");var c=_17f.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_17f.body().appendChild(c);}else{m=_185;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_187){for(var i in _187){if(i in _186){continue;}s[i]=_187[i];}}if(arguments.length>2&&_188){m.className=_188;}m.innerHTML=text;var box=_180.position(m);box.w=m.parentNode.scrollWidth;return box;};var _189={w:16,h:16};dhm.getScrollbar=function(){return {w:_189.w,h:_189.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_18a){var f=dhm._fontResizeNode=_17f.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_181._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_181._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_17f.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_17e.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_17d(function(){try{var n=_17f.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_17f.body().appendChild(n);_189.w=n.offsetWidth-n.clientWidth;_189.h=n.offsetHeight-n.clientHeight;_17f.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _17c.config&&!!_17c.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_18b,_18c){return _18b("dojox.grid._RowSelector",_18c,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_18d,_18e){var w=this.contentWidth||0;_18e.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_18f,_190){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_18f)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_18f)){n.push("dojoxGridRowbarSelected");}_190.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_191,_192,_193,lang,win,_194,_195,has,keys,on,_196,_197,dnd,_198,_199){var _19a=_192("dojo.dnd.Manager",[_195],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_19b){if(this.avatar){this.target=(_19b&&_19b.targetState!="Disabled")?_19b:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_196.publish("/dnd/source/over",_19b);},outSource:function(_19c){if(this.avatar){if(this.target==_19c){this.target=null;this.canDropFlag=false;this.avatar.update();_196.publish("/dnd/source/over",null);}}else{_196.publish("/dnd/source/over",null);}},startDrag:function(_19d,_19e,copy){_198.autoScrollStart(win.doc);this.source=_19d;this.nodes=_19e;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_196.publish("/dnd/start",_19d,_19e,this.copy);this.events=[on(win.doc,_197.move,lang.hitch(this,"onMouseMove")),on(win.doc,_197.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_193.stop),on(win.body(),"selectstart",_193.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_194.add(win.body(),c);},canDrop:function(flag){var _19f=Boolean(this.target&&flag);if(this.canDropFlag!=_19f){this.canDropFlag=_19f;this.avatar.update();}},stopDrag:function(){_194.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_191.forEach(this.events,function(_1a0){_1a0.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _199(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_198.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_196.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_196.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_196.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_196.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_194.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_19a.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _19a();}return dnd._manager;};return _19a;});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_1a1,_1a2,lang,_1a3){return _1a1("dojox.grid.Selection",null,{constructor:function(_1a4){this.grid=_1a4;this.selected=[];this.setMode(_1a4.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_1a5){return this.grid.onCanSelect(_1a5);},onCanDeselect:function(_1a6){return this.grid.onCanDeselect(_1a6);},onSelected:function(_1a7){},onDeselected:function(_1a8){},onChanging:function(){},onChanged:function(){},isSelected:function(_1a9){if(this.mode=="none"){return false;}return this.selected[_1a9];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_1aa){if(this.mode=="none"){return -1;}for(var i=_1aa+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _1ab=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_1ab.push(i);}}return _1ab;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_1ac){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_1ac);this.addToSelection(_1ac);}else{this.toggleSelect(_1ac);}},addToSelection:function(_1ad){if(this.mode=="none"){return;}if(lang.isArray(_1ad)){_1a2.forEach(_1ad,this.addToSelection,this);return;}_1ad=Number(_1ad);if(this.selected[_1ad]){this.selectedIndex=_1ad;}else{if(this.onCanSelect(_1ad)!==false){this.selectedIndex=_1ad;var _1ae=this.grid.getRowNode(_1ad);if(_1ae){_1a3.set(_1ae,"aria-selected","true");}this._beginUpdate();this.selected[_1ad]=true;this.onSelected(_1ad);this._endUpdate();}}},deselect:function(_1af){if(this.mode=="none"){return;}if(lang.isArray(_1af)){_1a2.forEach(_1af,this.deselect,this);return;}_1af=Number(_1af);if(this.selectedIndex==_1af){this.selectedIndex=-1;}if(this.selected[_1af]){if(this.onCanDeselect(_1af)===false){return;}var _1b0=this.grid.getRowNode(_1af);if(_1b0){_1a3.set(_1b0,"aria-selected","false");}this._beginUpdate();delete this.selected[_1af];this.onDeselected(_1af);this._endUpdate();}},setSelected:function(_1b1,_1b2){this[(_1b2?"addToSelection":"deselect")](_1b1);},toggleSelect:function(_1b3){if(lang.isArray(_1b3)){_1a2.forEach(_1b3,this.toggleSelect,this);return;}this.setSelected(_1b3,!this.selected[_1b3]);},_range:function(_1b4,inTo,func){var s=(_1b4>=0?_1b4:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_1b5,inTo){this._range(_1b5,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_1b6,inTo){this._range(_1b6,inTo,lang.hitch(this,"deselect"));},insert:function(_1b7){this.selected.splice(_1b7,0,false);if(this.selectedIndex>=_1b7){this.selectedIndex++;}},remove:function(_1b8){this.selected.splice(_1b8,1);if(this.selectedIndex>=_1b8){this.selectedIndex--;}},deselectAll:function(_1b9){for(var i in this.selected){if((i!=_1b9)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_1ba,_1bb,_1bc){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_1ba);}else{var _1bd=this.selectedIndex;if(!_1bb){this.deselectAll(_1ba);}if(_1bc){this.selectRange(_1bd,_1ba);}else{if(_1bb){this.toggleSelect(_1ba);}else{this.addToSelection(_1ba);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"esri/toolbars/_Box":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/Moveable,dojox/gfx/matrix"],function(_1be,dojo,_1bf){dojo.provide("esri.toolbars._Box");dojo.require("dojox.gfx.Moveable");dojo.require("dojox.gfx.matrix");dojo.declare("esri.toolbars._Box",null,{constructor:function(_1c0,map,_1c1,_1c2,_1c3,_1c4){this._graphic=_1c0;this._map=map;this._toolbar=_1c1;this._scale=_1c2;this._rotate=_1c3;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_1c4;var _1c5=_1c1._options;this._markerSymbol=_1c5.boxHandleSymbol;this._lineSymbol=_1c5.boxLineSymbol;this._moveStartHandler=dojo.hitch(this,this._moveStartHandler);this._firstMoveHandler=dojo.hitch(this,this._firstMoveHandler);this._moveStopHandler=dojo.hitch(this,this._moveStopHandler);this._moveHandler=dojo.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){dojo.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){dojo.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){dojo.forEach(this._connects,dojo.disconnect,dojo);}var _1c6=this._toolbar._scratchGL;if(this._anchors){dojo.forEach(this._anchors,function(info){_1c6.remove(info.graphic);var mov=info.moveable;if(mov){mov.destroy();}});}if(this._box){_1c6.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_1c7=this._toolbar._scratchGL;var _1c8=this._getBoxCoords();var _1c9=new esri.geometry.Polyline(map.spatialReference);var path=dojo.clone(dojo.filter(_1c8,function(pt,_1ca){return (_1ca!==8&&_1ca%2===0);}));if(path[0]){path.push([path[0][0],path[0][1]]);}_1c9.addPath(path);if(this._rotate){_1c9.addPath([_1c8[1],_1c8[8]]);}if(this._box){this._box.setGeometry(_1c9);}else{this._box=new esri.Graphic(_1c9,this._lineSymbol);_1c7.add(this._box);}if(this._anchors){dojo.forEach(this._anchors,function(info,_1cb){if(!this._scale){_1cb=8;}var _1cc=new esri.geometry.Point(_1c8[_1cb],map.spatialReference);info.graphic.setGeometry(_1cc);var mov=info.moveable,_1cd=info.graphic.getDojoShape();if(_1cd){if(!mov){info.moveable=this._getMoveable(info.graphic,_1cb);}else{if(_1cd!==mov.shape){mov.destroy();info.moveable=this._getMoveable(info.graphic,_1cb);}}}},this);}else{this._anchors=[];this._connects=[];dojo.forEach(_1c8,function(_1ce,_1cf){if(!this._scale&&_1cf<8){return;}_1ce=new esri.geometry.Point(_1ce,map.spatialReference);var _1d0=new esri.Graphic(_1ce,this._markerSymbol);_1c7.add(_1d0);this._anchors.push({graphic:_1d0,moveable:this._getMoveable(_1d0,_1cf)});},this);}},_getBoxCoords:function(_1d1){var _1d2=this._graphic,map=this._map,bbox=this._getTransformedBoundingBox(_1d2),_1d3=[],pt,next,_1d4;dojo.forEach(bbox,function(_1d5,_1d6,arr){pt=_1d5;next=arr[_1d6+1];if(!next){next=arr[0];}_1d4={x:(pt.x+next.x)/2,y:(pt.y+next.y)/2};if(!_1d1){pt=map.toMap(pt);_1d4=map.toMap(_1d4);}_1d3.push([pt.x,pt.y]);_1d3.push([_1d4.x,_1d4.y]);});if(this._rotate){var _1d7=dojo.clone(_1d3[1]);_1d7=_1d1?{x:_1d7[0],y:_1d7[1]}:map.toScreen({x:_1d7[0],y:_1d7[1],spatialReference:map.spatialReference});_1d7.y-=this._toolbar._options.rotateHandleOffset;if(!_1d1){_1d7=map.toMap(_1d7);}_1d3.push([_1d7.x,_1d7.y]);}return _1d3;},_getTransformedBoundingBox:function(_1d8){var map=this._map,_1d9=_1d8.geometry.getExtent(),_1da=_1d8.geometry.spatialReference,_1db=new esri.geometry.Point(_1d9.xmin,_1d9.ymax,_1da),_1dc=new esri.geometry.Point(_1d9.xmax,_1d9.ymin,_1da);_1db=map.toScreen(_1db);_1dc=map.toScreen(_1dc);return [{x:_1db.x,y:_1db.y},{x:_1dc.x,y:_1db.y},{x:_1dc.x,y:_1dc.y},{x:_1db.x,y:_1dc.y}];},_getAllGraphics:function(){var _1dd=[this._box];if(this._anchors){dojo.forEach(this._anchors,function(_1de){_1dd.push(_1de.graphic);});}_1dd=dojo.filter(_1dd,esri._isDefined);return _1dd;},_getMoveable:function(_1df,_1e0){var _1e1=_1df.getDojoShape();if(!_1e1){return;}var _1e2=new _1bf.gfx.Moveable(_1e1);_1e2._index=_1e0;this._connects.push(dojo.connect(_1e2,"onMoveStart",this._moveStartHandler));this._connects.push(dojo.connect(_1e2,"onFirstMove",this._firstMoveHandler));this._connects.push(dojo.connect(_1e2,"onMoveStop",this._moveStopHandler));_1e2.onMove=this._moveHandler;var node=_1e1.getEventSource();if(node){dojo.style(node,"cursor",this._toolbar._cursors["box"+_1e0]);}return _1e2;},_moveStartHandler:function(_1e3){this._toolbar["on"+(_1e3.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_1e4){var _1e5=_1e4.host._index,_1e6=(this._wrapOffset=_1e4.host.shape._wrapOffsets[0]||0),_1e7=this._graphic.getLayer()._div.getTransform(),mx=_1bf.gfx.matrix,_1e8,_1e9,_1ea,_1eb=dojo.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_1e6,y:arr[1]};});_1ea={x:_1eb[1].x,y:_1eb[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_1e7),_1ea);if(_1e5===8){_1e8=mx.multiplyPoint(mx.invert(_1e7),_1eb[1]);this._startLine=[this._centerCoord,_1e8];this._moveLine=dojo.clone(this._startLine);}else{_1e8=mx.multiplyPoint(mx.invert(_1e7),_1eb[_1e5]);_1e9=mx.multiplyPoint(mx.invert(_1e7),_1eb[(_1e5+4)%8]);this._firstMoverToCenter=Math.sqrt((_1e8.x-this._centerCoord.x)*(_1e8.x-this._centerCoord.x)+(_1e8.y-this._centerCoord.y)*(_1e8.y-this._centerCoord.y));this._startBox=_1e9;this._startBox.width=(_1eb[4].x-_1eb[0].x);this._startBox.height=(_1eb[4].y-_1eb[0].y);this._moveBox=dojo.clone(this._startBox);this._xfactor=_1e8.x>_1e9.x?1:-1;this._yfactor=_1e8.y>_1e9.y?1:-1;if(_1e5===1||_1e5===5){this._xfactor=0;}else{if(_1e5===3||_1e5===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_1e5===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_1ec,_1ed){var _1ee=_1ec.host._index,args=this._defaultEventArgs,_1ef,move,tx,pt,_1f0,_1f1,_1f2,_1f3=0,_1f4=0,_1f5,_1f6,_1f7;args.angle=0;args.scaleX=1;args.scaleY=1;if(_1ee===8){_1ef=this._startLine;move=this._moveLine;pt=move[1];pt.x+=_1ed.dx;pt.y+=_1ed.dy;_1f0=this._getAngle(_1ef,move);tx=_1bf.gfx.matrix.rotategAt(_1f0,_1ef[0]);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.angle=_1f0;args.around=_1ef[0];}else{_1ef=this._startBox;move=this._moveBox;move.width+=(_1ed.dx*this._xfactor);move.height+=(_1ed.dy*this._yfactor);if(this._uniformScaling){_1f5=move.x+this._xfactor*move.width;_1f6=move.y+this._yfactor*move.height;_1f7=Math.sqrt((_1f5-this._centerCoord.x)*(_1f5-this._centerCoord.x)+(_1f6-this._centerCoord.y)*(_1f6-this._centerCoord.y));_1f1=_1f2=_1f7/this._firstMoverToCenter;_1f3=this._xfactor*_1ef.width/2;_1f4=this._yfactor*_1ef.height/2;}else{_1f1=move.width/_1ef.width;_1f2=move.height/_1ef.height;}if(isNaN(_1f1)||_1f1===Infinity||_1f1===-Infinity){_1f1=1;}if(isNaN(_1f2)||_1f2===Infinity||_1f2===-Infinity){_1f2=1;}tx=_1bf.gfx.matrix.scaleAt(_1f1,_1f2,_1ef.x+_1f3,_1ef.y+_1f4);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.scaleX=_1f1;args.scaleY=_1f2;args.around={x:_1ef.x+_1f3,y:_1ef.y+_1f4};}this._toolbar["on"+(_1ee===8?this._rotateEvent:this._scaleEvent)](this._graphic,args);},_moveStopHandler:function(_1f8){var _1f9=this._graphic,_1fa=this._toolbar,_1fb=_1fa._geo?esri.geometry.geographicToWebMercator(_1f9.geometry):_1f9.geometry,_1fc=_1fb.spatialReference,_1fd=_1f9.getDojoShape(),_1fe=_1fd.getTransform(),_1ff=_1f9.getLayer()._div.getTransform();_1fb=_1fb.toJson();this._updateSegments(_1fb.paths||_1fb.rings,_1fe,_1ff,_1fc);_1fd.setTransform(null);_1fb=esri.geometry.fromJson(_1fb);_1f9.setGeometry(_1fa._geo?esri.geometry.webMercatorToGeographic(_1fb,true):_1fb);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_1fa._endOperation("BOX");this._defaultEventArgs.transform=_1fe;_1fa["on"+(_1f8.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_200,_201,_202,_203){var mx=_1bf.gfx.matrix,map=this._map,_204=this._wrapOffset||0;dojo.forEach(_200,function(_205){dojo.forEach(_205,function(_206){var _207=map.toScreen({x:_206[0],y:_206[1],spatialReference:_203},true);_207.x+=_204;_207=mx.multiplyPoint([_202,_201,mx.invert(_202)],_207);_207.x-=_204;var _208=map.toMap(_207);_206[0]=_208.x;_206[1]=_208.y;});});},_getAngle:function(_209,_20a){var _20b=Math.atan2(_209[0].y-_209[1].y,_209[0].x-_209[1].x)*180/Math.PI,_20c=Math.atan2(_20a[0].y-_20a[1].y,_20a[0].x-_20a[1].x)*180/Math.PI;return _20c-_20b;}});});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_20d,has,_20e){return _20d("dojox.grid._ViewManager",null,{constructor:function(_20f){this.grid=_20f;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_210){_210.idx=this.views.length;this.views.push(_210);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _211=[];for(var i=0,v;v=this.views[i];i++){_211.push(v.contentNode);}return _211;},forEach:function(_212){for(var i=0,v;v=this.views[i];i++){_212(v,i);}},onEach:function(_213,_214){_214=_214||[];for(var i=0,v;v=this.views[i];i++){if(_213 in v){v[_213].apply(v,_214);}}},normalizeHeaderNodeHeight:function(){var _215=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_215.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_215);},normalizeRowNodeHeights:function(_216){var h=0;var _217=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_216.length<=1){return;}for(var i=0,n;(n=_216[i]);i++){if(!_20e.contains(n,"dojoxGridNonNormalizedCell")){_217[i]=n.firstChild.offsetHeight;h=Math.max(h,_217[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_216[i]);i++){if(_217[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_218){var _219=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_218));i++){n.firstChild.style.height="";_219.push(n);}this.normalizeRowNodeHeights(_219);},getViewWidth:function(_21a){return this.views[_21a].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_21b){_21b.headerContentNode.style.height="";});var h=0;this.forEach(function(_21c){h=Math.max(_21c.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_21d){h=Math.max(_21d.domNode.offsetHeight,h);});return h;},findClient:function(_21e){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _21f=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_21f(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_21f(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_21f(v,l);}return l;},renderRow:function(_220,_221,_222){var _223=[];for(var i=0,v,n,_224;(v=this.views[i])&&(n=_221[i]);i++){_224=v.renderRow(_220);n.appendChild(_224);_223.push(_224);}if(!_222){this.normalizeRowNodeHeights(_223);}},rowRemoved:function(_225){this.onEach("rowRemoved",[_225]);},updateRow:function(_226,_227){for(var i=0,v;v=this.views[i];i++){v.updateRow(_226);}if(!_227){this.renormalizeRow(_226);}},updateRowStyles:function(_228){this.onEach("updateRowStyles",[_228]);},setScrollTop:function(_229){var top=_229;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_229);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/toolbars/_GraphicMover":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_22a,dojo,_22b){dojo.provide("esri.toolbars._GraphicMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars._Mover",_22b.gfx.Mover,{constructor:function(_22c,e,host){this.__e=e;}});dojo.declare("esri.toolbars._GraphicMover",null,{constructor:function(_22d,map,_22e){this.graphic=_22d;this.map=map;this.toolbar=_22e;this._enableGraphicMover();this._moved=false;},refresh:function(_22f){var _230=this.graphic.getDojoShape();if(_230&&(_22f||!_230._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _231=this.graphic,_232=_231.getDojoShape();if(_232){_232._hostGraphic=_231;this._moveable=new _22b.gfx.Moveable(_232,{mover:esri.toolbars._Mover});this._moveStartHandle=dojo.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=dojo.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=dojo.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_232.getEventSource();if(node){dojo.style(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _233=this._moveable;if(_233){dojo.disconnect(this._moveStartHandle);dojo.disconnect(this._firstMoveHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._moveStopHandle);var _234=_233.shape;if(_234){_234._hostGraphic=null;var node=_234.getEventSource();if(node){dojo.style(node,"cursor",null);}}_233.destroy();}this._moveable=null;},_moveStartHandler:function(){var _235=this.graphic,map=this.map;this._startTx=_235.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_235);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_236){this.toolbar.onGraphicMove(this.graphic,_236.shape.getTransform());},_moveStopHandler:function(_237){var _238=this.graphic,_239=this.toolbar,map=this.map,mx=_22b.gfx.matrix,_23a=_239._geo?esri.geometry.geographicToWebMercator(_238.geometry):_238.geometry,type=_23a.type,_23b=_238.getDojoShape(),tx=_23b.getTransform();if(dojo.toJson(tx)!==dojo.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _23c=[tx,mx.invert(this._startTx)],_23d;if(map.snappingManager){_23d=map.snappingManager._snappingPoint;}_23a=_23d||map.toMap(mx.multiplyPoint(_23c,map.toScreen(_23a,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_23a=this._updatePolyGeometry(_23a,_23a.paths,tx);break;case "polygon":_23a=this._updatePolyGeometry(_23a,_23a.rings,tx);break;}_23b.setTransform(null);_238.setGeometry(_239._geo?esri.geometry.webMercatorToGeographic(_23a,true):_23a);}else{this._moved=false;}_239._endOperation("MOVE");_239.onGraphicMoveStop(_238,tx);if(!this._moved){var e=_237.__e,_23e=this.map.position,pt=new esri.geometry.ScreenPoint(e.pageX-_23e.x,e.pageY-_23e.y);_239.onGraphicClick(_238,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_23f,_240,_241){var map=this.map,_242=_23f.getPoint(0,0),_243=map.toMap(map.toScreen(_242).offset(_241.dx,_241.dy)),_244=_243.x-_242.x,_245=_243.y-_242.y,i,j,seg,_246;for(i=0;i<_240.length;i++){seg=_240[i];for(j=0;j<seg.length;j++){_246=_23f.getPoint(i,j);_23f.setPoint(i,j,_246.offset(_244,_245));}}return _23f;}});});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_247){return _247.grid.cells;});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_248,_249,_24a,lang,_24b){return _249("dojox.grid._Layout",null,{constructor:function(_24c){this.grid=_24c;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_24d,_24e,_24f,_250,_251){var _252=this.structure[_24d].cells[0];var _253=this.structure[_24e].cells[0];var cell=null;var _254=0;var _255=0;for(var i=0,c;c=_252[i];i++){if(c.index==_24f){_254=i;break;}}cell=_252.splice(_254,1)[0];cell.view=this.grid.views.views[_24e];for(i=0,c=null;c=_253[i];i++){if(c.index==_250){_255=i;break;}}if(!_251){_255+=1;}_253.splice(_255,0,cell);var _256=this.grid.getCell(this.grid.getSortIndex());if(_256){_256._currentlySorted=this.grid.getSortAsc();}this.cells=[];_24f=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_24f;this.cells.push(c);if("_currentlySorted" in c){var si=_24f+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_24f++;}}}_24a.forEach(this.cells,function(c){var _257=c.markup[2].split(" ");var _258=parseInt(_257[1].substring(5));if(_258!=c.index){_257[1]="idx=\""+c.index+"\"";c.markup[2]=_257.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_259,_25a){var cell=this.cells[_259];if(cell.hidden==_25a){cell.hidden=!_25a;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_24b.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_25b,_25c,_25d){var self=this;var _25e=function(_25f){var w=0;if(_25f.colSpan>1){w=0;}else{w=_25f.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _260={grid:this.grid,subrow:_25b,layoutIndex:_25c,index:this.cells.length};if(_25d&&_25d instanceof _248.grid.cells._Base){var _261=lang.clone(_25d);_260.unitWidth=_25e(_261._props);_261=lang.mixin(_261,this._defaultCellProps,_25d._props,_260);return _261;}var _262=_25d.type||_25d.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_248.grid.cells.Cell;if(lang.isString(_262)){_262=lang.getObject(_262);}_260.unitWidth=_25e(_25d);return new _262(lang.mixin({},this._defaultCellProps,_25d,_260));},addRowDef:function(_263,_264){var _265=[];var _266=0,_267=0,_268=true;for(var i=0,def,cell;(def=_264[i]);i++){cell=this.addCellDef(_263,i,def);_265.push(cell);this.cells.push(cell);if(_268&&cell.relWidth){_266+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_267+=window.parseInt(w,10);}else{if(w=="auto"){_268=false;}}}}}if(_266&&_268){_24a.forEach(_265,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_266)*(100-_267))+"%";}});}return _265;},addRowsDef:function(_269){var _26a=[];if(lang.isArray(_269)){if(lang.isArray(_269[0])){for(var i=0,row;_269&&(row=_269[i]);i++){_26a.push(this.addRowDef(i,row));}}else{_26a.push(this.addRowDef(0,_269));}}return _26a;},addViewDef:function(_26b){this._defaultCellProps=_26b.defaultCell||{};if(_26b.width&&_26b.width=="auto"){delete _26b.width;}return lang.mixin({},_26b,{cells:this.addRowsDef(_26b.rows||_26b.cells)});},setStructure:function(_26c){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_248._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _26d=this.grid.rowSelector;if(_26d=="false"){sel=null;}else{if(_26d!="true"){sel["width"]=_26d;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _26e=function(def){return ("name" in def||"field" in def||"get" in def);};var _26f=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_26e(def[0])){return true;}}return false;};var _270=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_26e(def))));};if(lang.isArray(_26c)){var _271=false;for(var i=0,st;(st=_26c[i]);i++){if(_270(st)){_271=true;break;}}if(!_271){s.push(this.addViewDef({cells:_26c}));}else{for(i=0;(st=_26c[i]);i++){if(_26f(st)){s.push(this.addViewDef({cells:st}));}else{if(_270(st)){s.push(this.addViewDef(st));}}}}}else{if(_270(_26c)){s.push(this.addViewDef(_26c));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(dojo,_272,_273,_274,_275,lang,_276,has,_277,win,_278,_279,_27a,_27b,_27c,util,html,_27d,_27e,_27f){var _280=function(_281,_282){return _281.style.cssText==undefined?_281.getAttribute("style"):_281.style.cssText;};var _283=_274("dojox.grid._View",[_27a,_27b],{defaultWidth:"18em",viewWidth:"",templateString:_278,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_27d._HeaderBuilder,_contentBuilderClass:_27d._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){html.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);html.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_284){var vs=(this.structure=_284);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_285){if(_285){_275.forEach(_277("[widgetId]",_285).map(_272.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_286,_287){this._onBeforeRow(_286,_287);if(_286>=0){this._cleanupRowWidgets(this.getRowNode(_286));}},onAfterRow:function(_288,_289,_28a){this._onAfterRow(_288,_289,_28a);var g=this.grid;_275.forEach(_277(".dojoxGridStubNode",_28a),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _28b=window.parseInt(html.attr(n,"cellIdx"),10);var _28c=g.getCell(_28b);var w=_272.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}dojo.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _28d=this.hasVScrollbar();var _28e=html.style(this.scrollboxNode,"overflow");if(this.noscroll||!_28e||_28e=="hidden"){_28d=false;}else{if(_28e=="scroll"){_28d=true;}}return (_28d?_27c.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?h.firstChild.offsetWidth:0;},setColumnsWidth:function(_28f){this.headerContentNode.firstChild.style.width=_28f+"px";if(this.viewWidth){this.viewWidth=_28f+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,html._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _290=this.grid.layout.cells;var _291=lang.hitch(this,function(node,_292){!this.grid.isLeftToRight()&&(_292=!_292);var inc=_292?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_290[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_290[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _293="dojoxGrid_bottomMarker";var _294="dojoxGrid_topMarker";if(this.bottomMarker){html.destroy(this.bottomMarker);}this.bottomMarker=html.byId(_293);if(this.topMarker){html.destroy(this.topMarker);}this.topMarker=html.byId(_294);if(!this.bottomMarker){this.bottomMarker=html.create("div",{"id":_293,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=html.create("div",{"id":_294,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=html.contentBox(this.bottomMarker);var _295=html.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _279(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:lang.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_279.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:lang.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_279.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:lang.hitch(this,function(_296){var src=this.source;if(src.current==src.targetAnchor&&src.before==_296){return;}if(src.targetAnchor&&_291(src.targetAnchor,src.before)){src._removeItemClass(_291(src.targetAnchor,src.before),src.before?"After":"Before");}_279.prototype._markTargetAnchor.call(src,_296);var _297=_296?src.targetAnchor:_291(src.targetAnchor,src.before);var _298=0;if(!_297){_297=src.targetAnchor;_298=html.contentBox(_297).w+this.arrowDim.w/2+2;}var pos=html.position(_297,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_298);html.style(this.bottomMarker,"visibility","visible");html.style(this.topMarker,"visibility","visible");html.style(this.bottomMarker,{"left":left+"px","top":(_295+pos.y)+"px"});html.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_291(src.targetAnchor,src.before)){src._addItemClass(_291(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:lang.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_291(src.targetAnchor,src.before)){src._removeItemClass(_291(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_279.prototype._unmarkTargetAnchor.call(src);}),destroy:lang.hitch(this,function(){_276.disconnect(this._source_conn);_276.unsubscribe(this._source_sub);_279.prototype.destroy.call(this.source);if(this.bottomMarker){html.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){html.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:lang.hitch(this,function(){_279.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_276.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_276.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){html.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_299,_29a,copy){if(_27f.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _29b=this.grid.views.views;var _29c=_29b[_299.viewIndex];var _29d=_29b[this.index];if(_29d!=_29c){_29c.convertColPctToFixed();_29d.convertColPctToFixed();}},_onDndDrop:function(_29e,_29f,copy){if(_27f.manager().target!==this.source){if(_27f.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _2a0=function(n){return n?html.attr(n,"idx"):null;};var w=html.marginBox(_29f[0]).w;if(_29e.viewIndex!==this.index){var _2a1=this.grid.views.views;var _2a2=_2a1[_29e.viewIndex];var _2a3=_2a1[this.index];if(_2a2.viewWidth&&_2a2.viewWidth!="auto"){_2a2.setColumnsWidth(_2a2.getColumnsWidth()-w);}if(_2a3.viewWidth&&_2a3.viewWidth!="auto"){_2a3.setColumnsWidth(_2a3.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _2a4=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_2a4.moveColumn(_29e.viewIndex,idx,_2a0(_29f[0]),_2a0(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_2a5){var n=_2a5.name||_2a5.grid.getCellName(_2a5);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_2a5.index!=_2a5.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_2a5.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_2a5.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_2a6){var _2a7=this._hasHScroll||false;if(this._hasHScroll==undefined||_2a6){if(this.noscroll){this._hasHScroll=false;}else{var _2a8=html.style(this.scrollboxNode,"overflow");if(_2a8=="hidden"){this._hasHScroll=false;}else{if(_2a8=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_2a7!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_2a9){var _2aa=this._hasVScroll||false;if(this._hasVScroll==undefined||_2a9){if(this.noscroll){this._hasVScroll=false;}else{var _2ab=html.style(this.scrollboxNode,"overflow");if(_2ab=="hidden"){this._hasVScroll=false;}else{if(_2ab=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_2aa!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _2ac=false;this.grid.initialWidth="";var _2ad=_277("th",this.headerContentNode);var _2ae=_275.map(_2ad,function(c,vIdx){var w=c.style.width;html.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_2ac=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return html.contentBox(c).w;});if(_2ac){_275.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _2af=cell.view.getHeaderCellNode(cell.index);if(_2af&&html.hasAttr(_2af,"vIdx")){var vIdx=window.parseInt(html.attr(_2af,"vIdx"));this.setColWidth(idx,_2ae[vIdx]);html.removeAttr(_2af,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_2b0){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _2b1=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_2b0||(this.noscroll&&_2b1())){h-=_27c.getScrollbar().h;}util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_2b2){var _2b3=this.createRowNode(_2b2);this.buildRow(_2b2,_2b3);return _2b3;},createRowNode:function(_2b4){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _273.grid._RowSelector){html.attr(node,"role","presentation");}else{html.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[util.gridViewTag]=this.id;node[util.rowIndexTag]=_2b4;this.rowNodes[_2b4]=node;return node;},buildRow:function(_2b5,_2b6){this.buildRowContent(_2b5,_2b6);this.styleRow(_2b5,_2b6);},buildRowContent:function(_2b7,_2b8){_2b8.innerHTML=this.content.generateHtml(_2b7,_2b7);if(this.flexCells&&this.contentWidth){_2b8.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[_2b7,this.structure.cells,_2b8]);},rowRemoved:function(_2b9){if(_2b9>=0){this._cleanupRowWidgets(this.getRowNode(_2b9));}this.grid.edit.save(this,_2b9);delete this.rowNodes[_2b9];},getRowNode:function(_2ba){return this.rowNodes[_2ba];},getCellNode:function(_2bb,_2bc){var row=this.getRowNode(_2bb);if(row){return this.content.getCellNode(row,_2bc);}},getHeaderCellNode:function(_2bd){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_2bd);}},styleRow:function(_2be,_2bf){_2bf._style=_280(_2bf);this.styleRowNode(_2be,_2bf);},styleRowNode:function(_2c0,_2c1){if(_2c1){this.doStyleRowNode(_2c0,_2c1);}},doStyleRowNode:function(_2c2,_2c3){this.grid.styleRowNode(_2c2,_2c3);},updateRow:function(_2c4){var _2c5=this.getRowNode(_2c4);if(_2c5){_2c5.style.height="";this.buildRow(_2c4,_2c5);}return _2c5;},updateRowStyles:function(_2c6){this.styleRowNode(_2c6,this.getRowNode(_2c6));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_2c7){if(has("ff")>=13){this._nativeScroll=true;}var _2c8=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_2c8&&this.firstScroll==1)||(_2c8&&this.firstScroll===0)){var s=html.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_2c8?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_2c9){this.lastTop=_2c9;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_2c9;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_2ca,_2cb){this.grid.setCellWidth(_2ca,_2cb+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _2cc=_274("dojox.grid._GridAvatar",_27e,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _2cd=this.manager.source,node;if(_2cd.creator){node=_2cd._normalizedCreator(_2cd.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _2ce,_2cf;if(node.tagName.toLowerCase()=="tr"){_2ce=dd.createElement("table");_2cf=dd.createElement("tbody");_2cf.appendChild(node);_2ce.appendChild(_2cf);node=_2ce;}else{if(node.tagName.toLowerCase()=="th"){_2ce=dd.createElement("table");_2cf=dd.createElement("tbody");var r=dd.createElement("tr");_2ce.cellPadding=_2ce.cellSpacing="0";r.appendChild(node);_2cf.appendChild(r);_2ce.appendChild(_2cf);node=_2ce;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);html.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_27f.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_27f.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _2d0=_27f.manager().makeAvatar;_27f.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!html.hasClass(win.body(),"dijit_a11y")){return new _2cc(this);}return _2d0.call(_27f.manager());};return _283;});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_2d1,dom,_2d2,_2d3,_2d4,has,_2d5,_2d6,_2d7,_2d8,_2d9){return _2d1("dijit.MenuItem",[_2d5,_2d6,_2d7,_2d8],{templateString:_2d9,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_2da){if(_2da&&!("label" in this.params)){this.set("label",_2da.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _2db=this.id+"_text";_2d2.set(this.containerNode,"id",_2db);if(this.accelKeyNode){_2d2.set(this.accelKeyNode,"id",this.id+"_accel");_2db+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_2db);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_2dc){_2d3.toggle(this.domNode,"dijitMenuItemSelected",_2dc);},setLabel:function(_2dd){_2d4.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_2dd);},setDisabled:function(_2de){_2d4.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_2de);},_setDisabledAttr:function(_2df){this.focusNode.setAttribute("aria-disabled",_2df?"true":"false");this._set("disabled",_2df);},_setAccelKeyAttr:function(_2e0){this.accelKeyNode.style.display=_2e0?"":"none";this.accelKeyNode.innerHTML=_2e0;_2d2.set(this.containerNode,"colSpan",_2e0?"1":"2");this._set("accelKey",_2e0);},_setTextDirAttr:function(_2e1){if(!this._created||this.textDir!=_2e1){this._set("textDir",_2e1);this.applyTextDir(this.focusNode,this.label);}}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_2e2,lang,_2e3){var _2e4=function(_2e5,_2e6){if(_2e5.style.cssText==undefined){_2e5.setAttribute("style",_2e6);}else{_2e5.style.cssText=_2e6;}};return _2e2("dojox.grid._RowManager",null,{constructor:function(_2e7){this.grid=_2e7;},linesToEms:2,overRow:-2,prepareStylingRow:function(_2e8,_2e9){return {index:_2e8,node:_2e9,odd:Boolean(_2e8&1),selected:!!this.grid.selection.isSelected(_2e8),over:this.isOver(_2e8),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_2ea,_2eb){var row=this.prepareStylingRow(_2ea,_2eb);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_2ec){var i=_2ec;i.node.className=i.customClasses;var h=i.node.style.height;_2e4(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_2ed){this.grid.updateRowStyles(_2ed);},setOverRow:function(_2ee){var last=this.overRow;this.overRow=_2ee;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_2ef){return (this.overRow==_2ef&&!_2e3.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_2f0,win,dom,_2f1,_2f2,_2f3,has,_2f4){return _2f0("dojo.dnd.Avatar",null,{constructor:function(_2f5){this.manager=_2f5;this.construct();},construct:function(){var a=_2f3.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_2f6=this.manager.source,node,b=_2f3.create("tbody",null,a),tr=_2f3.create("tr",null,b),td=_2f3.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_2f3.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_2f3.create("span",{innerHTML:_2f6.generateText?this._generateText():""},td);_2f1.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_2f6.creator){node=_2f6._normalizedCreator(_2f6.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _2f7=_2f3.create("table"),_2f8=_2f3.create("tbody",null,_2f7);_2f8.appendChild(node);node=_2f7;}}node.id="";tr=_2f3.create("tr",null,b);td=_2f3.create("td",null,tr);td.appendChild(node);_2f1.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_2f3.destroy(this.node);this.node=false;},update:function(){_2f2.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_2f4(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_2f9,arr,_2fa,_2fb,_2fc,_2fd,win,_2fe,_2ff){return _2f9("dojox.gfx.Moveable",null,{constructor:function(_300,_301){this.shape=_300;this.delay=(_301&&_301.delay>0)?_301.delay:0;this.mover=(_301&&_301.mover)?_301.mover:_2fe;this.leftButtonOnly=_301&&_301.leftButtonOnly;this.events=[this.shape.connect(_2fc.press,this,"onMouseDown")];},destroy:function(){arr.forEach(this.events,this.shape.disconnect,this.shape);this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_2fc.move,this,"onMouseMove"),this.shape.connect(_2fc.release,this,"onMouseUp"));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_2ff.isLeft(e)){new this.mover(this.shape,e,this);}}_2fa.stop(e);},onMouseMove:function(e){if(Math.abs(e.clientX-this._lastX)>this.delay||Math.abs(e.clientY-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_2fa.stop(e);},onMouseUp:function(e){this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());},onMoveStart:function(_302){_2fb.publish("/gfx/move/start",_302);_2fd.add(win.body(),"dojoMove");},onMoveStop:function(_303){_2fb.publish("/gfx/move/stop",_303);_2fd.remove(win.body(),"dojoMove");},onFirstMove:function(_304){},onMove:function(_305,_306){this.onMoving(_305,_306);this.shape.applyLeftTransform(_306);this.onMoved(_305,_306);},onMoving:function(_307,_308){},onMoved:function(_309,_30a){}});});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_30b,_30c,_30d,_30e,_30f,_310,_311,_312,_313,_314,_315,_316,util,_317,_318,_319,_31a,_31b,_31c,lang,has,_31d,html,_31e){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _31f=_30c("dojox.grid._Grid",[_317,_318,_30d],{templateString:_31a,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_30f,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_31d.initOnFontResize();this.connect(_31d,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}},postMixInProperties:function(){this.inherited(arguments);var _320=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_31b.substitute(this.loadingMessage,_320);this.errorMessage=_31b.substitute(this.errorMessage,_320);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_31c.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_321){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_321){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _312(this);this.focus=new _313(this);this.edit=new _314(this);},createSelection:function(){this.selection=new _315(this);},createScroller:function(){this.scroller=new _30e();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_322){},createViews:function(){this.views=new _311(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_323,idx){var c=lang.getObject(_323);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_30b._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_324){var s=_324;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_325){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_325);},getColumnTogglingItems:function(){var _326,_327=[];_326=_31c.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _319({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_328){if(self.layout.setColumnVisibility(this._gridCell.index,_328)){var _329=this._gridCell.menuItems;if(_329.length>1){_31c.forEach(_329,function(item){if(item!==this){item.setAttribute("checked",_328);}},this);}_328=_31c.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_31c.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_328.length==1){_31c.forEach(_328[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _32a=_31c.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_32a,1);delete this._gridCell;_319.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_327.push(item);}return item;},this);if(_327.length==1){_327[0].set("disabled",true);}return _326;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_31c.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_31c.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_32b){this.setScrollTop(0);},getItem:function(_32c){return null;},showMessage:function(_32d){if(_32d){this.messagesNode.innerHTML=_32d;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_32e,_32f){if(dojo.isIE&&!_32e&&!_32f&&this._autoHeight){return;}this._pendingChangeSize=_32e;this._pendingResultSize=_32f;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_330,_331){_330=_330||this._pendingChangeSize;_331=_331||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _332=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_332.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_331){_330=_331;}if(!this._autoHeight&&_330){html.marginBox(this.domNode,_330);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=this._parentContentBoxHeight||html._getContentBox(pn).h;this.domNode.style.height=Math.max(0,h)+"px";}}var _333=_31c.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_333&&hh===undefined){hh=this._getHeaderHeight();}}if(_333){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _334=(!this.initialWidth&&this.autoWidth);var w=_334?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_334){this.domNode.style.width=vw+"px";}},adaptHeight:function(_335){var t=_335===undefined?this._getHeaderHeight():_335;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _336=0,_337=0;var _338=_31c.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_336++;}else{_337++;}return (!has);});if(_336>0&&_337>0){_31c.forEach(_338,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_339,_33a){this.views.renderRow(_339,_33a,this._skipRowRenormalize);},rowRemoved:function(_33b){this.views.rowRemoved(_33b);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_33c){_33c=Number(_33c);if(this.updating){this.invalidated[_33c]=true;}else{this.views.updateRow(_33c);this.scroller.rowHeightChanged(_33c);}},updateRows:function(_33d,_33e){_33d=Number(_33d);_33e=Number(_33e);var i;if(this.updating){for(i=0;i<_33e;i++){this.invalidated[i+_33d]=true;}}else{for(i=0;i<_33e;i++){this.views.updateRow(i+_33d,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_33d);}},updateRowCount:function(_33f){if(this.updating){this.invalidated.rowCount=_33f;}else{this.rowCount=_33f;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_33f);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_340){this.views.updateRowStyles(_340);},getRowNode:function(_341){if(this.focus.focusView&&!(this.focus.focusView instanceof _316)){return this.focus.focusView.rowNodes[_341];}else{for(var i=0,_342;(_342=this.views.views[i]);i++){if(!(_342 instanceof _316)){return _342.rowNodes[_341];}}}return null;},rowHeightChanged:function(_343){this.views.renormalizeRow(_343);this.scroller.rowHeightChanged(_343);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_344){if(!this.fastScroll){this.setScrollTop(_344);return;}var _345=Math.abs(this.lastScrollTop-_344);this.lastScrollTop=_344;if(_345>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_344;this.views.setScrollTop(_344);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _346=this;this._pendingScroll=window.setTimeout(function(){delete _346._pendingScroll;_346.finishScrollJob();},200);}else{this.setScrollTop(_344);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_347){this.scroller.scroll(this.views.setScrollTop(_347));},scrollToRow:function(_348){this.setScrollTop(this.scroller.findScrollTop(_348)+1);},styleRowNode:function(_349,_34a){if(_34a){this.rows.styleRowNode(_349,_34a);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_34b){return this.layout.cells[_34b];},setCellWidth:function(_34c,_34d){this.getCell(_34c).unitWidth=_34d;},getCellName:function(_34e){return "Cell "+_34e.index;},canSort:function(_34f){},sort:function(){},getSortAsc:function(_350){_350=_350==undefined?this.sortInfo:_350;return Boolean(_350>0);},getSortIndex:function(_351){_351=_351==undefined?this.sortInfo:_351;return Math.abs(_351)-1;},setSortIndex:function(_352,_353){var si=_352+1;if(_353!=undefined){si*=(_353?1:-1);}else{if(this.getSortIndex()==_352){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_354){if(this.canSort(_354)){this.sortInfo=_354;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_355,_356){this.onStartEdit(_355,_356);},doApplyCellEdit:function(_357,_358,_359){this.onApplyCellEdit(_357,_358,_359);},doCancelEdit:function(_35a){this.onCancelEdit(_35a);},doApplyEdit:function(_35b){this.onApplyEdit(_35b);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_31f.markupFactory=function(_35c,node,ctor,_35d){var _35e=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_35c.structure&&node.nodeName.toLowerCase()=="table"){_35c.structure=_31e("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_35e(cg);}return v;});if(!_35c.structure.length){_35c.structure.push({__span:Infinity,cells:[]});}_31e("thead > tr",node).forEach(function(tr,_35f){var _360=0;var _361=0;var _362;var _363=null;_31e("> th",tr).map(function(th){if(!_363){_362=0;_363=_35c.structure[0];}else{if(_360>=(_362+_363.__span)){_361++;_362+=_363.__span;var _364=_363;_363=_35c.structure[_361];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_360+=cell.colSpan;var _365=html.attr(th,"rowspan");if(_365){cell.rowSpan=_365;}if(html.hasAttr(th,"width")){cell.width=_35e(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_35d){_35d(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_30b.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_363.cells[_35f]){_363.cells[_35f]=[];}_363.cells[_35f].push(cell);});});}return new ctor(_35c,node);};return _31f;});},"dojo/request/iframe":function(){define(["module","require","./watch","./util","./handlers","../_base/lang","../io-query","../query","../has","../dom","../dom-construct","../_base/window"],function(_366,_367,_368,util,_369,lang,_36a,_36b,has,dom,_36c,win){var mid=_366.id.replace(/[\/\.\-]/g,"_"),_36d=mid+"_onload";if(!win.global[_36d]){win.global[_36d]=function(){var dfd=_36e._currentDfd;if(!dfd){_36e._fireNextRequest();return;}var _36f=dfd.response,_370=_36f.options,_371=dom.byId(_370.form)||dfd._tmpForm;if(_371){var _372=dfd._contentToClean;for(var i=0;i<_372.length;i++){var key=_372[i];for(var j=0;j<_371.childNodes.length;j++){var _373=_371.childNodes[j];if(_373.name===key){_36c.destroy(_373);break;}}}dfd._originalAction&&_371.setAttribute("action",dfd._originalAction);if(dfd._originalMethod){_371.setAttribute("method",dfd._originalMethod);_371.method=dfd._originalMethod;}if(dfd._originalTarget){_371.setAttribute("target",dfd._originalTarget);_371.target=dfd._originalTarget;}}if(dfd._tmpForm){_36c.destroy(dfd._tmpForm);delete dfd._tmpForm;}dfd._finished=true;};}function _374(name,_375,uri){if(win.global[name]){return win.global[name];}if(win.global.frames[name]){return win.global.frames[name];}if(!uri){if(has("config-useXDomain")&&!has("config-dojoBlankHtmlUrl")){console.warn("dojo/request/iframe: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}uri=(has("config-dojoBlankHtmlUrl")||_367.toUrl("dojo/resources/blank.html"));}var _376=_36c.place("<iframe id=\""+name+"\" name=\""+name+"\" src=\""+uri+"\" onload=\""+_375+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",win.body());win.global[name]=_376;return _376;};function _377(_378,src,_379){var _37a=win.global.frames[_378.name];if(_37a.contentWindow){_37a=_37a.contentWindow;}try{if(!_379){_37a.location=src;}else{_37a.location.replace(src);}}catch(e){console.log("dojo/request/iframe.setSrc: ",e);}};function doc(_37b){if(_37b.contentDocument){return _37b.contentDocument;}var name=_37b.name;if(name){var _37c=win.doc.getElementsByTagName("iframe");if(_37b.document&&_37c[name].contentWindow&&_37c[name].contentWindow.document){return _37c[name].contentWindow.document;}else{if(win.doc.frames[name]&&win.doc.frames[name].document){return win.doc.frames[name].document;}}}return null;};function _37d(){return _36c.create("form",{name:mid+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},win.body());};function _37e(){var dfd;try{if(_36e._currentDfd||!_36e._dfdQueue.length){return;}do{dfd=_36e._currentDfd=_36e._dfdQueue.shift();}while(dfd&&(dfd.canceled||(dfd.isCanceled&&dfd.isCanceled()))&&_36e._dfdQueue.length);if(!dfd||dfd.canceled||(dfd.isCanceled&&dfd.isCanceled())){_36e._currentDfd=null;return;}var _37f=dfd.response,_380=_37f.options,c2c=dfd._contentToClean=[],_381=dom.byId(_380.form),_382=util.notify,data=_380.data||null,_383;if(!dfd._legacy&&_380.method==="POST"&&!_381){_381=dfd._tmpForm=_37d();}else{if(_380.method==="GET"&&_381&&_37f.url.indexOf("?")>-1){_383=_37f.url.slice(_37f.url.indexOf("?")+1);data=lang.mixin(_36a.queryToObject(_383),data);}}if(_381){if(!dfd._legacy){var _384=_381;while(_384=_384.parentNode&&_384!==win.doc.documentElement){}if(!_384){_381.style.position="absolute";_381.style.left="-1000px";_381.style.top="-1000px";win.body().appendChild(_381);}if(!_381.name){_381.name=mid+"_form";}}if(data){var _385=function(name,_386){_36c.create("input",{type:"hidden",name:name,value:_386},_381);c2c.push(name);};for(var x in data){var val=data[x];if(lang.isArray(val)&&val.length>1){for(var i=0;i<val.length;i++){_385(x,val[i]);}}else{if(!_381[x]){_385(x,val);}else{_381[x].value=val;}}}}var _387=_381.getAttributeNode("action"),_388=_381.getAttributeNode("method"),_389=_381.getAttributeNode("target");if(_37f.url){dfd._originalAction=_387?_387.value:null;if(_387){_387.value=_37f.url;}else{_381.setAttribute("action",_37f.url);}}if(!dfd._legacy){dfd._originalMethod=_388?_388.value:null;if(_388){_388.value=_380.method;}else{_381.setAttribute("method",_380.method);}}else{if(!_388||!_388.value){if(mthdNode){mthdNode.value=_380.method;}else{fn.setAttribute("method",_380.method);}}}dfd._originalTarget=_389?_389.value:null;if(_389){_389.value=_36e._iframeName;}else{_381.setAttribute("target",_36e._iframeName);}_381.target=_36e._iframeName;_382&&_382.emit("send",_37f,dfd.promise.cancel);_36e._notifyStart(_37f);_381.submit();}else{var _38a="";if(_37f.options.data){_38a=_37f.options.data;if(typeof _38a!=="string"){_38a=_36a.objectToQuery(_38a);}}var _38b=_37f.url+(_37f.url.indexOf("?")>-1?"&":"?")+_38a;_382&&_382.emit("send",_37f,dfd.promise.cancel);_36e._notifyStart(_37f);_36e.setSrc(_36e._frame,_38b,true);}}catch(e){dfd.reject(e);}};function _38c(_38d){return !this.isFulfilled();};function _38e(_38f){return !!this._finished;};function _390(_391,_392){if(!_392){try{var _393=_391.options,doc=_36e.doc(_36e._frame),_394=_393.handleAs;if(_394!=="html"){if(_394==="xml"){if(doc.documentElement.tagName.toLowerCase()==="html"){_36b("a",doc.documentElement).orphan();var _395=doc.documentElement.innerText;_395=_395.replace(/>\s+</g,"><");_391.text=lang.trim(_395);}else{_391.data=doc;}}else{_391.text=doc.getElementsByTagName("textarea")[0].value;}_369(_391);}else{_391.data=doc;}}catch(e){_392=e;}}if(_392){this.reject(_392);}else{if(this._finished){this.resolve(_391);}else{this.reject(new Error("Invalid dojo/request/iframe request state"));}}};function last(_396){this._callNext();};var _397={method:"POST"};function _36e(url,_398,_399){var _39a=util.parseArgs(url,util.deepCreate(_397,_398),true);url=_39a.url;_398=_39a.options;if(_398.method!=="GET"&&_398.method!=="POST"){throw new Error(_398.method+" not supported by dojo/request/iframe");}if(!_36e._frame){_36e._frame=_36e.create(_36e._iframeName,_36d+"();");}var dfd=util.deferred(_39a,null,_38c,_38e,_390,last);dfd._callNext=function(){if(!this._calledNext){this._calledNext=true;_36e._currentDfd=null;_36e._fireNextRequest();}};dfd._legacy=_399;_36e._dfdQueue.push(dfd);_36e._fireNextRequest();_368(dfd);return _399?dfd:dfd.promise;};_36e.create=_374;_36e.doc=doc;_36e.setSrc=_377;_36e._iframeName=mid+"_IoIframe";_36e._notifyStart=function(){};_36e._dfdQueue=[];_36e._currentDfd=null;_36e._fireNextRequest=_37e;util.addCommonMethods(_36e,["GET","POST"]);return _36e;});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_39b,_39c,keys,_39d,_39e,_39f){return _39b("dijit.DropDownMenu",[_39f,_39e],{templateString:_39d,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_39c.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_39c.stop(evt);}break;}}});});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_3a0,_3a1){var _3a2={};lang.setObject("dojo.data.util.simpleFetch",_3a2);_3a2.errorHandler=function(_3a3,_3a4){if(_3a4.onError){var _3a5=_3a4.scope||_3a0.global;_3a4.onError.call(_3a5,_3a3,_3a4);}};_3a2.fetchHandler=function(_3a6,_3a7){var _3a8=_3a7.abort||null,_3a9=false,_3aa=_3a7.start?_3a7.start:0,_3ab=(_3a7.count&&(_3a7.count!==Infinity))?(_3aa+_3a7.count):_3a6.length;_3a7.abort=function(){_3a9=true;if(_3a8){_3a8.call(_3a7);}};var _3ac=_3a7.scope||_3a0.global;if(!_3a7.store){_3a7.store=this;}if(_3a7.onBegin){_3a7.onBegin.call(_3ac,_3a6.length,_3a7);}if(_3a7.sort){_3a6.sort(_3a1.createSortFunction(_3a7.sort,this));}if(_3a7.onItem){for(var i=_3aa;(i<_3a6.length)&&(i<_3ab);++i){var item=_3a6[i];if(!_3a9){_3a7.onItem.call(_3ac,item,_3a7);}}}if(_3a7.onComplete&&!_3a9){var _3ad=null;if(!_3a7.onItem){_3ad=_3a6.slice(_3aa,_3ab);}_3a7.onComplete.call(_3ac,_3ad,_3a7);}};_3a2.fetch=function(_3ae){_3ae=_3ae||{};if(!_3ae.store){_3ae.store=this;}this._fetchItems(_3ae,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _3ae;};return _3a2;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_3af,_3b0,_3b1,_3b2,dom,_3b3,_3b4,_3b5,keys,lang,on,has,win,_3b6,pm,_3b7,_3b8){if(has("dijit-legacy-requires")){_3b8(0,function(){var _3b9=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_3af(_3b9);});}return _3b1("dijit.Menu",_3b7,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_3b0.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_3ba){return _3b6.get(this._iframeContentDocument(_3ba))||this._iframeContentDocument(_3ba)["__parent__"]||(_3ba.name&&win.doc.frames[_3ba.name])||null;},_iframeContentDocument:function(_3bb){return _3bb.contentDocument||(_3bb.contentWindow&&_3bb.contentWindow.document)||(_3bb.name&&win.doc.frames[_3bb.name]&&win.doc.frames[_3bb.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _3bc=node,_3bd=this._iframeContentWindow(_3bc);cn=win.body(_3bd.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _3be={node:node,iframe:_3bc};_3b3.set(node,"_dijitMenu"+this.id,this._bindings.push(_3be));var _3bf=lang.hitch(this,function(cn){var _3c0=this.selector,_3c1=_3c0?function(_3c2){return on.selector(_3c0,_3c2);}:function(_3c3){return _3c3;},self=this;return [on(cn,_3c1(this.leftClickToOpen?"click":"contextmenu"),function(evt){_3b2.stop(evt);self._scheduleOpen(this,_3bc,{x:evt.pageX,y:evt.pageY});}),on(cn,_3c1("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_3b2.stop(evt);self._scheduleOpen(this,_3bc);}})];});_3be.connects=cn?_3bf(cn):[];if(_3bc){_3be.onloadHandler=lang.hitch(this,function(){var _3c4=this._iframeContentWindow(_3bc);cn=win.body(_3c4.document);_3be.connects=_3bf(cn);});if(_3bc.addEventListener){_3bc.addEventListener("load",_3be.onloadHandler,false);}else{_3bc.attachEvent("onload",_3be.onloadHandler);}}},unBindDomNode:function(_3c5){var node;try{node=dom.byId(_3c5,this.ownerDocument);}catch(e){return;}var _3c6="_dijitMenu"+this.id;if(node&&_3b3.has(node,_3c6)){var bid=_3b3.get(node,_3c6)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _3c7=b.iframe;if(_3c7){if(_3c7.removeEventListener){_3c7.removeEventListener("load",b.onloadHandler,false);}else{_3c7.detachEvent("onload",b.onloadHandler);}}_3b3.remove(node,_3c6);delete this._bindings[bid];}},_scheduleOpen:function(_3c8,_3c9,_3ca){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_3c8,iframe:_3c9,coords:_3ca});},1);}},_openMyself:function(args){var _3cb=args.target,_3cc=args.iframe,_3cd=args.coords;this.currentTarget=_3cb;if(_3cd){if(_3cc){var ifc=_3b4.position(_3cc,true),_3ce=this._iframeContentWindow(_3cc),_3cf=_3b4.docScroll(_3ce.document);var cs=_3b5.getComputedStyle(_3cc),tp=_3b5.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_3cc,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_3cc,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_3cc,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_3cc,cs.borderTopWidth):0);_3cd.x+=ifc.x+left-_3cf.x;_3cd.y+=ifc.y+top-_3cf.y;}}else{_3cd=_3b4.position(_3cb,true);_3cd.x+=10;_3cd.y+=10;}var self=this;var _3d0=this._focusManager.get("prevNode");var _3d1=this._focusManager.get("curNode");var _3d2=!_3d1||(dom.isDescendant(_3d1,this.domNode))?_3d0:_3d1;function _3d3(){if(self.refocus&&_3d2){_3d2.focus();}pm.close(self);};pm.open({popup:this,x:_3cd.x,y:_3cd.y,onExecute:_3d3,onCancel:_3d3,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_3b0.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_3d4,_3d5,_3d6,_3d7,keys,_3d8,_3d9,_3da,lang){return _3d8("dijit._KeyNavContainer",[_3d6,_3d5],{tabIndex:"0",connectKeyNavHandlers:function(_3db,_3dc){var _3dd=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_3d7.forEach(_3db,function(code){_3dd[code]=prev;});_3d7.forEach(_3dc,function(code){_3dd[code]=next;});_3dd[keys.HOME]=lang.hitch(this,"focusFirstChild");_3dd[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_3d4.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_3d7.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_3de,_3df){this.inherited(arguments);this._startupChild(_3de);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_3e0,last){if(!_3e0){return;}if(this.focusedChild&&_3e0!==this.focusedChild){this._onChildBlur(this.focusedChild);}_3e0.set("tabIndex",this.tabIndex);_3e0.focus(last?"end":"start");this._set("focusedChild",_3e0);},_startupChild:function(_3e1){_3e1.set("tabIndex","-1");this.connect(_3e1,"_onFocus",function(){_3e1.set("tabIndex",this.tabIndex);});this.connect(_3e1,"_onBlur",function(){_3e1.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_3da.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_3da.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_3d9.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_3e2,dir){if(_3e2){_3e2=this._getSiblingOfChild(_3e2,dir);}var _3e3=this.getChildren();for(var i=0;i<_3e3.length;i++){if(!_3e2){_3e2=_3e3[(dir>0)?0:(_3e3.length-1)];}if(_3e2.isFocusable()){return _3e2;}_3e2=this._getSiblingOfChild(_3e2,dir);}return null;}});});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_3e4,_3e5){return _3e4("dijit._Contained",null,{_getSibling:function(_3e6){var node=this.domNode;do{node=node[_3e6+"Sibling"];}while(node&&node.nodeType!=1);return node&&_3e5.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/gfx/move":function(){define("dojox/gfx/move",["dojo/_base/lang","./Mover","./Moveable"],function(lang){return lang.getObject("dojox.gfx.move",true);});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_3e7,lang,_3e8,_3e9,xhr,_3ea,_3eb,_3ec,_3ed){var _3ee=_3e8("dojo.data.ItemFileReadStore",[_3ea],{constructor:function(_3ef){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_3ef.url;this._ccUrl=_3ef.url;this.url=_3ef.url;this._jsonData=_3ef.data;this.data=null;this._datatypeMap=_3ef.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_3f0){return _3ed.fromISOString(_3f0);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_3ef.urlPreventCache!==undefined){this.urlPreventCache=_3ef.urlPreventCache?true:false;}if(_3ef.hierarchical!==undefined){this.hierarchical=_3ef.hierarchical?true:false;}if(_3ef.clearOnClose){this.clearOnClose=true;}if("failOk" in _3ef){this.failOk=_3ef.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_3f1){if(typeof _3f1!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_3f2,_3f3){var _3f4=this.getValues(item,_3f2);return (_3f4.length>0)?_3f4[0]:_3f3;},getValues:function(item,_3f5){this._assertIsItem(item);this._assertIsAttribute(_3f5);return (item[_3f5]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _3f6=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_3f6.push(key);}}return _3f6;},hasAttribute:function(item,_3f7){this._assertIsItem(item);this._assertIsAttribute(_3f7);return (_3f7 in item);},containsValue:function(item,_3f8,_3f9){var _3fa=undefined;if(typeof _3f9==="string"){_3fa=_3eb.patternToRegExp(_3f9,false);}return this._containsValue(item,_3f8,_3f9,_3fa);},_containsValue:function(item,_3fb,_3fc,_3fd){return _3e9.some(this.getValues(item,_3fb),function(_3fe){if(_3fe!==null&&!lang.isObject(_3fe)&&_3fd){if(_3fe.toString().match(_3fd)){return true;}}else{if(_3fc===_3fe){return true;}}});},isItem:function(_3ff){if(_3ff&&_3ff[this._storeRefPropName]===this){if(this._arrayOfAllItems[_3ff[this._itemNumPropName]]===_3ff){return true;}}return false;},isItemLoaded:function(_400){return this.isItem(_400);},loadItem:function(_401){this._assertIsItem(_401.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_402,_403,_404){var _405=[],i,key;if(_402.query){var _406,_407=_402.queryOptions?_402.queryOptions.ignoreCase:false;var _408={};for(key in _402.query){_406=_402.query[key];if(typeof _406==="string"){_408[key]=_3eb.patternToRegExp(_406,_407);}else{if(_406 instanceof RegExp){_408[key]=_406;}}}for(i=0;i<_403.length;++i){var _409=true;var _40a=_403[i];if(_40a===null){_409=false;}else{for(key in _402.query){_406=_402.query[key];if(!this._containsValue(_40a,key,_406,_408[key])){_409=false;}}}if(_409){_405.push(_40a);}}_404(_405,_402);}else{for(i=0;i<_403.length;++i){var item=_403[i];if(item!==null){_405.push(item);}}_404(_405,_402);}},_fetchItems:function(_40b,_40c,_40d){var self=this;if(this._loadFinished){this.filter(_40b,this._getItemsArray(_40b.queryOptions),_40c);}else{if(this._jsonFileUrl!==this._ccUrl){_3e7.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_40b,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_40c)});}else{this._loadInProgress=true;var _40e={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _40f=xhr.get(_40e);_40f.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_40b,self._getItemsArray(_40b.queryOptions),_40c);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_40d(e,_40b);}});_40f.addErrback(function(_410){self._loadInProgress=false;_40d(_410,_40b);});var _411=null;if(_40b.abort){_411=_40b.abort;}_40b.abort=function(){var df=_40f;if(df&&df.fired===-1){df.cancel();df=null;}if(_411){_411.call(_40b);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_40b,this._getItemsArray(_40b.queryOptions),_40c);}catch(e){_40d(e,_40b);}}else{_40d(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_40b);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _412=this._queuedFetches[i],_413=_412.args,_414=_412.filter,_415=_412.findCallback;if(_414){_414(_413,this._getItemsArray(_413.queryOptions),_415);}else{this.fetchItemByIdentity(_413);}}this._queuedFetches=[];}},_getItemsArray:function(_416){if(_416&&_416.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_417){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_418){var _419=false,self=this;function _41a(_41b){return (_41b!==null)&&(typeof _41b==="object")&&(!lang.isArray(_41b)||_419)&&(!lang.isFunction(_41b))&&(_41b.constructor==Object||lang.isArray(_41b))&&(typeof _41b._reference==="undefined")&&(typeof _41b._type==="undefined")&&(typeof _41b._value==="undefined")&&self.hierarchical;};function _41c(_41d){self._arrayOfAllItems.push(_41d);for(var _41e in _41d){var _41f=_41d[_41e];if(_41f){if(lang.isArray(_41f)){var _420=_41f;for(var k=0;k<_420.length;++k){var _421=_420[k];if(_41a(_421)){_41c(_421);}}}else{if(_41a(_41f)){_41c(_41f);}}}}};this._labelAttr=_418.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_418.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_419=true;}_41c(item);item[this._rootItemPropName]=true;}var _422={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _423=item[key];if(_423!==null){if(!lang.isArray(_423)){item[key]=[_423];}}else{item[key]=[null];}}_422[key]=key;}}while(_422[this._storeRefPropName]){this._storeRefPropName+="_";}while(_422[this._itemNumPropName]){this._itemNumPropName+="_";}while(_422[this._reverseRefMap]){this._reverseRefMap+="_";}var _424;var _425=_418.identifier;if(_425){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_425;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_424=item[_425];var _426=_424[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_426)){this._itemsByIdentity[_426]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_425+"].  Value collided: ["+_426+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_425+"].  Value collided: ["+_426+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_424=item[key];for(var j=0;j<_424.length;++j){_423=_424[j];if(_423!==null&&typeof _423=="object"){if(("_type" in _423)&&("_value" in _423)){var type=_423._type;var _427=this._datatypeMap[type];if(!_427){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_427)){_424[j]=new _427(_423._value);}else{if(lang.isFunction(_427.deserialize)){_424[j]=_427.deserialize(_423._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_423._reference){var _428=_423._reference;if(!lang.isObject(_428)){_424[j]=this._getItemByIdentity(_428);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _429=this._arrayOfAllItems[k],_42a=true;for(var _42b in _428){if(_429[_42b]!=_428[_42b]){_42a=false;}}if(_42a){_424[j]=_429;}}}if(this.referenceIntegrity){var _42c=_424[j];if(this.isItem(_42c)){this._addReferenceToMap(_42c,item,key);}}}else{if(this.isItem(_423)){if(this.referenceIntegrity){this._addReferenceToMap(_423,item,key);}}}}}}}},_addReferenceToMap:function(_42d,_42e,_42f){},getIdentity:function(item){var _430=this._features["dojo.data.api.Identity"];if(_430===Number){return item[this._itemNumPropName];}else{var _431=item[_430];if(_431){return _431[0];}}return null;},fetchItemByIdentity:function(_432){var item,_433;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_3e7.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_432});}else{this._loadInProgress=true;var _434={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _435=xhr.get(_434);_435.addCallback(function(data){var _436=_432.scope?_432.scope:_3e7.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_432.identity);if(_432.onItem){_432.onItem.call(_436,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_432.onError){_432.onError.call(_436,error);}}});_435.addErrback(function(_437){self._loadInProgress=false;if(_432.onError){var _438=_432.scope?_432.scope:_3e7.global;_432.onError.call(_438,_437);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_432.identity);if(_432.onItem){_433=_432.scope?_432.scope:_3e7.global;_432.onItem.call(_433,item);}}}}else{item=this._getItemByIdentity(_432.identity);if(_432.onItem){_433=_432.scope?_432.scope:_3e7.global;_432.onItem.call(_433,item);}}},_getItemByIdentity:function(_439){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_439)){item=this._itemsByIdentity[_439];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_439)){item=this._arrayOfAllItems[_439];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _43a=this._features["dojo.data.api.Identity"];if(_43a===Number){return null;}else{return [_43a];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_3e7.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _43b={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _43c=xhr.get(_43b);_43c.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_43c.addErrback(function(_43d){throw _43d;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_3ee,_3ec);return _3ee;});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_43e,_43f,_440,_441,lang,_442,_443,_444,_445,_446,dnd,_447,_448){if(!_441.isAsync){_445(0,function(){var _449=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_449);});}var _44a=_440("dojo.dnd.Source",_447,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_44b){lang.mixin(this,lang.mixin({},_44b));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_442.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_442.add(this.node,"dojoDndTarget");}if(this.horizontal){_442.add(this.node,"dojoDndHorizontal");}this.topics=[_446.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_446.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_446.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_446.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_44c,_44d){if(this==_44c){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_44d.length;++i){var type=_44c.getItem(_44d[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_44e,self){if(_44e){return true;}if(arguments.length<2){self=this==_448.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_44a.superclass.destroy.call(this);_43e.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_44a.superclass.onMouseMove.call(this,e);var m=_448.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _44f=this.getSelectedNodes();if(_44f.length){m.startDrag(this,_44f,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _450=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_443.position(this.current,true);}if(this.horizontal){_450=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_443.isBodyLtr(this.current.ownerDocument);}else{_450=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_450!=this.before){this._markTargetAnchor(_450);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_44a.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_44a.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_451){if(this!==_451){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_448.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_452,_453,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_452?(copy?"Copied":"Moved"):"");}var _454=this.accept&&this.checkAcceptance(_452,_453);this._changeState("Target",_454?"":"Disabled");if(this==_452){_448.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_455,_456,copy,_457){if(this==_457){this.onDrop(_455,_456,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_458,_459,copy){if(this!=_458){this.onDropExternal(_458,_459,copy);}else{this.onDropInternal(_459,copy);}},onDropExternal:function(_45a,_45b,copy){var _45c=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _45c.call(this,_45a.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_45a.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_45a.getItem(node.id);_45a.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_45a.selectNone();}this.insertNodes(true,_45b,this.before,this.current);if(!copy&&this.creator){_45a.deleteSelectedNodes();}this._normalizedCreator=_45c;},onDropInternal:function(_45d,copy){var _45e=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _45e.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_45d,this.before,this.current);this._normalizedCreator=_45e;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_44a.superclass.onOverEvent.call(this);_448.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_44a.superclass.onOutEvent.call(this);_448.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_45f){if(this.current==this.targetAnchor&&this.before==_45f){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_45f;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_444.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_442.contains(node,"dojoDndHandle")){return true;}if(_442.contains(node,"dojoDndItem")||_442.contains(node,"dojoDndIgnore")){break;}}return false;}});return _44a;});},"esri/toolbars/_VertexMover":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_460,dojo,_461){dojo.provide("esri.toolbars._VertexMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars.VertexMover",null,{constructor:function(_462,_463,_464,_465,_466,_467,_468,_469){this.point=_462;this.symbol=_463;this.relatedGraphic=_464;this.segIndex=_465;this.ptIndex=_466;this.segLength=_467;this.editor=_468;this.map=_468.map;this._scratchGL=_468.toolbar._scratchGL;this._placeholder=_469||false;this._type=_464.geometry.type;this._init();this._enable();},refresh:function(_46a){if(_46a||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _46b=new esri.geometry.Point(this.point.toJson());var _46c=new esri.Graphic(_46b,this.symbol);switch(this._type){case "multipoint":_46c._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_46c);break;}this.graphic=_46c;},_enable:function(){var _46d=this.graphic.getDojoShape();if(_46d){_46d._hasMover=true;this._moveable=this._getMoveable(_46d);var node=_46d.getEventSource();if(node){dojo.style(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _46e=this._moveable;if(_46e){dojo.disconnect(this._startHandle);dojo.disconnect(this._firstHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._stopHandle);var _46f=_46e.shape;if(_46f){var node=_46f.getEventSource();if(node){dojo.style(node,"cursor",null);}}_46e.destroy();this._moveable=null;}},_needRefresh:function(){var _470=this.graphic.getDojoShape(),need=false;if(_470){switch(this._type){case "multipoint":var _471=this.relatedGraphic.getDojoShape();if(_471){var _472=_471.children[this.ptIndex];if(_470!==_472){_470=_472;this.graphic._shape=_470;need=true;}}break;case "polyline":case "polygon":need=!_470._hasMover;break;}}return need;},_getMoveable:function(_473){var _474=new _461.gfx.Moveable(_473,dojo.isMac&&dojo.isFF&&!esri.isTouchEnabled&&{leftButtonOnly:true});this._startHandle=dojo.connect(_474,"onMoveStart",this,this._moveStartHandler);this._firstHandle=dojo.connect(_474,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(_474,"onMoving",this,this._movingHandler);this._stopHandle=dojo.connect(_474,"onMoveStop",this,this._moveStopHandler);return _474;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_475){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_475.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_476){var _477=_476.shape;var _478=this._getControlEdges();var _479=this._scratchGL._div;var i,_47a=[],_47b=_476.host.shape._wrapOffsets[0]||0;for(i=0;i<_478.length;i++){var edge=_478[i];edge.x1+=_47b;edge.x2+=_47b;_47a.push([_479.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_477._lines=_47a;_476.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_47c){var _47d=_47c.shape,tx=_47d.getTransform();var i,_47e=_47d._lines;for(i=0;i<_47e.length;i++){var line=_47e[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_47f){var _480=_47f.shape,_481=this.editor.toolbar,tx=_480.getTransform(),map=this.map,host=this.graphic,_482=_481._geo?esri.geometry.geographicToWebMercator(host.geometry):host.geometry;var i,_483=_480._lines;if(_483){for(i=0;i<_483.length;i++){_483[i][0].removeShape();}_480._lines=null;}var ph=false,_484=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_484=false;}var _485;if(map.snappingManager){_485=map.snappingManager._snappingPoint;}var _486=_485||map.toMap(map.toScreen(_482).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_480.setTransform(null);host.setGeometry(_481._geo?esri.geometry.webMercatorToGeographic(_486,true):_486);this.constructor.onMoveStop(this,tx);_481.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_484){_481.onVertexClick(this.relatedGraphic,info);}if(ph){_481.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _487=this.relatedGraphic.geometry;var _488=this.segIndex,_489=this.ptIndex,_48a=this.segLength;var _48b=this._scratchGL._div;var _48c=_48b.getTransform();var sdx=_48c.dx,sdy=_48c.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _48d=[];var _48e=this.editor._getControlPoints(this,_487,_488,_489,_48a);if(_48e[0]){_48d.push({x1:x,y1:y,x2:_48e[0].x-sdx,y2:_48e[0].y-sdy});}if(_48e[1]){_48d.push({x1:x,y1:y,x2:_48e[1].x-sdx,y2:_48e[1].y-sdy});}return _48d;}});dojo.mixin(esri.toolbars.VertexMover,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dijit","dojo","dojox","dojo/require!esri/toolbars/_toolbar,esri/toolbars/_GraphicMover,esri/toolbars/_VertexEditor,esri/toolbars/_Box"],function(_48f,dojo,_490){dojo.provide("esri.toolbars.edit");dojo.require("esri.toolbars._toolbar");dojo.require("esri.toolbars._GraphicMover");dojo.require("esri.toolbars._VertexEditor");dojo.require("esri.toolbars._Box");dojo.declare("esri.toolbars.Edit",esri.toolbars._Toolbar,{constructor:function(map,_491){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _492=esri.isTouchEnabled;this._defaultOptions=dojo.mixin({vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_492?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([128,128,128])),ghostVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_492?18:10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75])),ghostLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DOT,new dojo.Color([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_492?24:16,boxLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new dojo.Color([64,64,64]),1),boxHandleSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,_492?16:9,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75]))},_491||{});},activate:function(tool,_493,_494){this.deactivate();this._graphic=_493;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),_494||{});var MOVE=esri.toolbars.Edit.MOVE,EDIT=esri.toolbars.Edit.EDIT_VERTICES,_495=esri.toolbars.Edit.SCALE,_496=esri.toolbars.Edit.ROTATE,move=false,edit=false,box=false,map=this._map,_497=map.spatialReference,_498=_493.geometry.spatialReference;this._geo=!!(_497&&_498&&!_497.equals(_498)&&_497.isWebMercator()&&_498.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_493);}var _499=((tool&_495)===_495),_49a=((tool&_496)===_496);if(_499||_49a){box=this._enableBoxEditing(_493,_499,_49a);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_493);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] "+esri.bundle.toolbars.edit.invalidType);}this._tool=tool;if(this._tool){this._mapPanEndHandle=dojo.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=dojo.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_493);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_49b=this._graphic;if(!tool){return;}var _49c=!!this._modified;this._clear();dojo.disconnect(this._mapPanEndHandle);dojo.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_49b,{isModified:_49c});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_49d){},onDeactivate:function(tool,_49e,info){},onGraphicMoveStart:function(_49f){},onGraphicFirstMove:function(_4a0){this._modified=true;},onGraphicMove:function(_4a1,_4a2){},onGraphicMoveStop:function(_4a3,_4a4){},onGraphicClick:function(_4a5,info){},onVertexMoveStart:function(_4a6,_4a7){},onVertexFirstMove:function(_4a8,_4a9){this._modified=true;},onVertexMove:function(_4aa,_4ab,_4ac){},onVertexMoveStop:function(_4ad,_4ae,_4af){},onVertexAdd:function(_4b0,_4b1){this._modified=true;},onVertexClick:function(_4b2,_4b3){},onVertexMouseOver:function(_4b4,_4b5){},onVertexMouseOut:function(_4b6,_4b7){},onVertexDelete:function(_4b8,_4b9){this._modified=true;},onScaleStart:function(_4ba){},onScaleFirstMove:function(_4bb){this._modified=true;},onScale:function(_4bc,info){},onScaleStop:function(_4bd,info){},onRotateStart:function(_4be){},onRotateFirstMove:function(_4bf){this._modified=true;},onRotate:function(_4c0,info){},onRotateStop:function(_4c1,info){},_enableMove:function(_4c2){var map=this._map,type=_4c2.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new esri.toolbars._GraphicMover(_4c2,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_4c3){var map=this._map,type=_4c3.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=esri.toolbars._GraphicVertexEditor.create(_4c3,map,this);return true;}return false;},_enableBoxEditing:function(_4c4,_4c5,_4c6){var map=this._map,type=_4c4.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new esri.toolbars._Box(_4c4,map,this,_4c5,_4c6,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _4c7=this._graphicMover;if(_4c7){_4c7.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _4c8=this._vertexEditor;if(_4c8){_4c8.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_4c9){if(_4c9){this._refreshMoveables();}},_refreshMoveables:function(_4ca){var _4cb=dojo.filter([this._graphicMover,this._vertexEditor,this._boxEditor],esri._isDefined);dojo.forEach(_4cb,function(mov){mov.refresh(_4ca);});},_beginOperation:function(_4cc){dojo.forEach(this._getAffectedTools(_4cc),function(tool){tool.suspend();});},_endOperation:function(_4cd){dojo.forEach(this._getAffectedTools(_4cd),function(tool){tool.resume();});},_getAffectedTools:function(_4ce){var _4cf=[];switch(_4ce){case "MOVE":_4cf=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_4cf=[this._boxEditor];break;case "BOX":_4cf=[this._vertexEditor];break;}_4cf=dojo.filter(_4cf,esri._isDefined);return _4cf;}});dojo.mixin(esri.toolbars.Edit,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _4d0={};lang.setObject("dojo.data.util.filter",_4d0);_4d0.patternToRegExp=function(_4d1,_4d2){var rxp="^";var c=null;for(var i=0;i<_4d1.length;i++){c=_4d1.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_4d1.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_4d2){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _4d0;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_4d3,_4d4,lang,win,_4d5,has,_4d6,_4d7,_4d8,util,html){var dg=_4d3.grid;var _4d9=function(td){return td.cellIndex>=0?td.cellIndex:_4d4.indexOf(td.parentNode.cells,td);};var _4da=function(tr){return tr.rowIndex>=0?tr.rowIndex:_4d4.indexOf(tr.parentNode.childNodes,tr);};var _4db=function(_4dc,_4dd){return _4dc&&((_4dc.rows||0)[_4dd]||_4dc.childNodes[_4dd]);};var _4de=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _4df=function(_4e0,_4e1){for(var n=_4e0;n&&_4e1(n);n=n.parentNode){}return n;};var _4e2=function(_4e3){var name=_4e3.toUpperCase();return function(node){return node.tagName!=name;};};var _4e4=util.rowIndexTag;var _4e5=util.gridViewTag;var _4e6=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_4e7,_4e8,_4e9,_4ea){var _4eb=[],html;if(_4ea){var _4ec=_4e7.index!=_4e7.grid.getSortIndex()?"":_4e7.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_4e7.id){_4e7.id=this.grid.id+"Hdr"+_4e7.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_4ec,"id=\"",_4e7.id,"\""];}else{var _4ed=this.grid.editable&&!_4e7.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_4ed];}if(_4e7.colSpan){html.push(" colspan=\"",_4e7.colSpan,"\"");}if(_4e7.rowSpan){html.push(" rowspan=\"",_4e7.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_4e7.classes){html.push(_4e7.classes," ");}if(_4e9){html.push(_4e9," ");}_4eb.push(html.join(""));_4eb.push("");html=["\" idx=\"",_4e7.index,"\" style=\""];if(_4e8&&_4e8[_4e8.length-1]!=";"){_4e8+=";";}html.push(_4e7.styles,_4e8||"",_4e7.hidden?"display:none;":"");if(_4e7.unitWidth){html.push("width:",_4e7.unitWidth,";");}_4eb.push(html.join(""));_4eb.push("");html=["\""];if(_4e7.attrs){html.push(" ",_4e7.attrs);}html.push(">");_4eb.push(html.join(""));_4eb.push("");_4eb.push(_4ea?"</th>":"</td>");return _4eb;},isCellNode:function(_4ee){return Boolean(_4ee&&_4ee!=win.doc&&html.attr(_4ee,"idx"));},getCellNodeIndex:function(_4ef){return _4ef?Number(html.attr(_4ef,"idx")):-1;},getCellNode:function(_4f0,_4f1){for(var i=0,row;((row=_4db(_4f0.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_4f1){return cell;}}}return null;},findCellTarget:function(_4f2,_4f3){var n=_4f2;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_4e5 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_4e5]!=this.view.id))&&(n!=_4f3)){n=n.parentNode;}return n!=_4f3?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_4f4,_4f5){var n=_4f4;while(n&&(n!=this.domNode)&&(!(_4f5 in n)||(_4e5 in n&&n[_4e5]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_4f6){return this.findTarget(_4f6,_4e4);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _4f7=dg._ContentBuilder=lang.extend(function(view){_4e6.call(this,view);},_4e6.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _4f8=this.grid.get,_4f9=this.view.structure.cells;for(var j=0,row;(row=_4f9[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_4f8;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_4fa,_4fb){var html=this.getTableArray(),v=this.view,_4fc=v.structure.cells,item=this.grid.getItem(_4fb);util.fire(this.view,"onBeforeRow",[_4fb,_4fc]);for(var j=0,row;(row=_4fc[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_4fb,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_4e4];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _4fd=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_4e6.call(this,view);},_4e6.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_4fe,_4ff){var html=this.getTableArray(),_500=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_500]);for(var j=0,row;(row=_500[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_501;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_501=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_501[5]=(_4ff!=undefined?_4ff:_4fe(cell));_501[3]=cell.customStyles.join(";");_501[1]=cell.customClasses.join(" ");html.push(_501.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_4df(e.target,_4e2("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_4df(n,_4e2("table"));x-=(table&&table.offsetLeft)||0;}}n=_4df(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_4d5.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_4d5.stop(e);return true;}return false;},colResizeSetup:function(e,_502){var _503=html.contentBox(e.sourceView.headerNode);if(_502){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _504=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_4d8.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_504.h+_503.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _505=[],_506=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_506[i]);i++){_505.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _507=e.grid.views.views;var _508=[];for(var j=view.idx+adj,_509;(_509=_507[j]);j=j+adj){_508.push({node:_509.headerNode,left:window.parseInt(_509.headerNode.style.left)});}var _50a=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_503.w,table:_50a,tw:html.contentBox(_50a).w,spanners:_505,followers:_508};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _4d7(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_4d6.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_50b,_50c,_50d){var _50e=_50d.l;var data={deltaX:_50e,w:_50b.w+(this.grid.isLeftToRight()?_50e:-_50e),vw:_50b.vw+_50e,tw:_50b.tw+_50e};this.dragRecord={inDrag:_50b,mover:_50c,leftTop:_50d};if(data.w>=this.minColWidth){if(!_50c){this.doResizeNow(_50b,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_50f){if(this.dragRecord){var _510=this.dragRecord.leftTop;var _511=this.grid.isLeftToRight()?_510.l:-_510.l;_511+=Math.max(_50f.w+_511,this.minColWidth)-(_50f.w+_511);if(has("webkit")&&_50f.spanners.length){_511+=html._getPadBorderExtents(_50f.spanners[0].node).w;}var data={deltaX:_511,w:_50f.w+_511,vw:_50f.vw+_511,tw:_50f.tw+_511};this.doResizeNow(_50f,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_50f.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_50f.index);},doResizeNow:function(_512,data){_512.view.convertColPctToFixed();if(_512.view.flexCells&&!_512.view.testFlexCells()){var t=_4de(_512.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_512.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_512.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_512.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_512.node.style.width=data.w+"px";_512.view.setColWidth(_512.index,data.w);_512.view.headerNode.style.width=data.vw+"px";_512.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_512.view.headerNode.scrollLeft=_512.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_513){var _514=_513.length;if(!_514){return;}this.map=[];var row;for(var k=0;(row=_513[k]);k++){this.map[k]=[];}for(var j=0;(row=_513[j]);j++){for(var i=0,x=0,cell,_515,_516;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_516=cell.rowSpan||1;_515=cell.colSpan||1;for(var y=0;y<_516;y++){for(var s=0;s<_515;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_515;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_517,_518){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_518&&cell.r==_517){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_519,_51a,_51b){var row=_519&&_519.rows[_51a];return row&&row.cells[_51b];},_findOverlappingNodes:function(_51c,_51d,_51e){var _51f=[];var m=this.getMapCoords(_51d,_51e);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_51c,rw.r,rw.c):null);if(n){_51f.push(n);}}return _51f;},findOverlappingNodes:function(_520){return this._findOverlappingNodes(_4de(_520),_4da(_520.parentNode),_4d9(_520));}});return {_Builder:_4e6,_HeaderBuilder:_4fd,_ContentBuilder:_4f7};});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_521,_522,_523,has,util){return _522("dojox.grid._EditManager",null,{constructor:function(_524){this.grid=_524;if(has("ie")){this.connections=[_523.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_523.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_521.forEach(this.connections,_523.disconnect);},cellFocus:function(_525,_526){if(this.grid.singleClickEdit||this.isEditRow(_526)){this.setEditCell(_525,_526);}else{this.apply();}if(this.isEditing()||(_525&&_525.editable&&_525.alwaysEditing)){this._focusEditor(_525,_526);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_527){if(_527.index==this.info.rowIndex){_527.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_528,_529){return (this.info.rowIndex===_528)&&(this.info.cell.index==_529);},isEditRow:function(_52a){return this.info.rowIndex===_52a;},setEditCell:function(_52b,_52c){if(!this.isEditCell(_52c,_52b.index)&&this.grid.canEdit&&this.grid.canEdit(_52b,_52c)){this.start(_52b,_52c,this.isEditRow(_52c)||_52b.editable);}},_focusEditor:function(_52d,_52e){util.fire(_52d,"focus",[_52e]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_52f,_530,_531){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_530)){this.applyRowEdit();this.grid.updateRow(_530);}if(_531){this.info={cell:_52f,rowIndex:_530};this.grid.doStartEdit(_52f,_530);this.grid.updateRow(_530);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_52f,_530);this._doCatchBoomerang();},_editorDo:function(_532){var c=this.info.cell;if(c&&c.editable){c[_532](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_533,_534,_535){if(this.grid.canEdit(_534,_535)){this.grid.doApplyCellEdit(_533,_535,_534.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_536,_537){var c=this.info.cell;if(this.isEditRow(_536)&&(!_537||c.view==_537)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_538,_539){var c=this.info.cell;if(this.isEditRow(_539)&&c.view==_538&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _53a={};lang.setObject("dojo.data.util.sorter",_53a);_53a.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_53a.createSortFunction=function(_53b,_53c){var _53d=[];function _53e(attr,dir,comp,s){return function(_53f,_540){var a=s.getValue(_53f,attr);var b=s.getValue(_540,attr);return dir*comp(a,b);};};var _541;var map=_53c.comparatorMap;var bc=_53a.basicComparator;for(var i=0;i<_53b.length;i++){_541=_53b[i];var attr=_541.attribute;if(attr){var dir=(_541.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_53d.push(_53e(attr,dir,comp,_53c));}}return function(rowA,rowB){var i=0;while(i<_53d.length){var ret=_53d[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _53a;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","esri/dijit/editing/TemplatePicker":function(){define(["dijit","dojo","dojox","dojo/require!dojo/data/ItemFileReadStore,dojox/grid/DataGrid,dijit/_Widget,dijit/_Templated,dojox/gfx,esri/utils,esri/symbol"],function(_542,dojo,_543){dojo.provide("esri.dijit.editing.TemplatePicker");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojox.grid.DataGrid");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dojox.gfx");dojo.require("esri.utils");dojo.require("esri.symbol");dojo.declare("esri.dijit.editing.TemplatePicker",[_542._Widget,_542._Templated],{widgetsInTemplate:true,templateString:"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>",basePath:dojo.moduleUrl("esri.dijit.editing"),featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_544,_545){_544=_544||{};if(!_544.items&&!_544.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(dojo.version.minor>=4);this._itemWidgets={};if(_544.featureLayers&&_544.featureLayers.length){this._flChanged=1;}this._nls=dojo.getObject("bundle.widgets.templatePicker",false,esri);this.emptyMessage=_544.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=dojo.contentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=dojo.contentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();dojo.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(dojo.isIE<9){this._repaintItems=dojo.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _546=this._selectedCell,info=this._selectedInfo;if(_546){this._rowClicked({cellNode:_546,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_547){var _548=(this.rows==="auto"&&this.columns==="auto"&&_547)?true:false,grid=this.grid,box;if(_548){var _549=this.domNode,id=_549.id,_54a,item=dojo.query("#"+id+".templatePicker div.item")[0];box=dojo.contentBox(_549);item=item&&item.parentNode;if(item){_54a=dojo.coords(item).w;}else{_54a=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_54a);this._columns=this._columns||1;}var _54b=this._rows;this._preprocess();var _54c=this._rows;this._setGridLayout();this._setGridData();if(_54c!==_54b){grid.set("autoHeight",this._rows,false);}if(_548){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_54d=this.getSelected();if(_54d){grid.store.fetch({onComplete:function(its){var _54e=self._locate(_54d,self._selectedInfo,its);var _54f=_54e&&grid.views.views[0].getCellNode(_54e[0],_54e[1]);if(_54f){self._rowClicked({cellNode:_54f,rowIndex:_54e[0],cellIndex:_54e[1]},true);}}});}if(dojo.isIE<9){setTimeout(this._repaintItems,this._ieTimer);}var _550=this.featureLayers,_551=this.items;if((!_550||!_550.length)&&(!_551||!_551.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _552=this.useLegend;if(!this._started||_552!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_553){var _554=this.featureLayers;if(!this._started||_554!==_553){this._flChanged=1;}this.featureLayers=_553;},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _555;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}_555=this._flItems=this._getItemsFromLayers(this.featureLayers);}else{_555=this._itItems=this._getItemsFromItems(this.items);}if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_555.length;dojo.forEach(_555,function(_556){len+=Math.ceil(_556.length/this.columns);},this);}else{dojo.forEach(_555,function(_557){len+=_557.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_555.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{dojo.forEach(_555,function(_558){len+=_558.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_555.length/this.rows);}this._columns=len;}}},_processSelectionLayers:function(){var map,_559,info,_55a,key,_55b,_55c,_55d={};dojo.forEach(this.featureLayers,function(_55e,idx){if(_55e.mode===esri.layers.FeatureLayer.MODE_SELECTION&&_55e._map&&_55e.url&&_55e._params.drawMode&&!_55e.source){_559=dojo.trim(_55e._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_55d[_559]=_55d[_559]||{});_55a=(info.featureLayers=info.featureLayers||{});_55b=(info.indices=info.indices||[]);_55a[idx]=_55e;_55b.push(idx);map=_55e._map;}});if(map){dojo.forEach(map.layerIds,function(_55f){_55f=map.getLayer(_55f);if(_55f&&_55f.url&&(_55f.getImageUrl||_55f.getTileUrl)&&_55f.loaded&&_55f.version>=10.1){_559=dojo.trim(_55f._url.path).replace(/(\/MapServer).*/ig,"$1");key=_559.replace(/^https?:\/\//ig,"").toLowerCase();if(_55d[key]&&(!_55d[key].mapServiceUrl)){info=_55d[key];info.mapServiceUrl=_559;info.mapServiceLayer=_55f;this._legendIndices=this._legendIndices.concat(info.indices);_55c=this._fetchLegend({pickerInstance:this,info:info},key);if(_55c.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_55c);}else{this._processLegendResponse(_55c,info);}}}},this);}},_fetchLegend:function(_560,key){var _561=esri.dijit.editing.TemplatePicker.prototype,_562=_561.legendCache[key];if(!_562){_562=(_561.legendCache[key]=esri.request({url:_560.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_562._contexts=[_560];_562.addBoth(function(_563){if(_562.canceled){return;}_561.legendCache[key]=_563;var _564=_562._contexts;_562._contexts=null;dojo.forEach(_564,function(ctxt){var _565=ctxt.pickerInstance,info=ctxt.info,_566;if(_565._destroyed){return;}dojo.forEach(info.indices,function(idx){_566=dojo.indexOf(_565._loadingIndices,idx);if(_566>-1){_565._loadingIndices.splice(_566,1);}});_566=dojo.indexOf(_565._loadingLegends,_562);if(_566>-1){_565._loadingLegends.splice(_566,1);}_565._processLegendResponse(_563,info);});});}else{if(_562.then){_562._contexts.push(_560);}}return _562;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){dojo.forEach(this._loadingLegends,function(_567){var _568=-1;dojo.some(_567._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_568=idx;}return (_568>-1);},this);if(_568>-1){_567._contexts.splice(_568,1);}},this);}},_processLegendResponse:function(_569,info){if(_569&&!(_569 instanceof Error)){dojo.forEach(info.indices,function(idx){var _56a=info.featureLayers[idx].layerId,i,_56b=info.mapServiceUrl+"/"+_56a+"/images/",_56c=info.mapServiceLayer._getToken(),_56d,obj,_56e,url;if(this._legendSymbols[idx]){return;}_56d=null;dojo.some(_569.layers,function(_56f){if(_56f.layerId==_56a){_56d=_56f;}return !!_56d;});if(_56d){obj=(this._legendSymbols[idx]={});dojo.forEach(_56d.legend,function(_570){_56e=_570.values;if(_56e&&_56e.length){for(i=0;i<_56e.length;i++){obj[_56e[i]]=_570;}}else{obj.defaultSymbol=_570;}url=_570.url;if(url&&!_570._fixed){_570._fixed=1;if((url.search(/https?\:/)===-1)){_570.url=_56b+url;}if(_56c&&_570.url.search(/https?\:/)!==-1){_570.url+=(((_570.url.indexOf("?")>-1)?"&":"?")+"token="+_56c);}}});}},this);}else{var _571;dojo.forEach(info.indices,function(idx){_571=dojo.indexOf(this._legendIndices,idx);if(_571>-1){this._legendIndices.splice(_571,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _572=grid.adaptWidth,_573,i,view;grid.adaptWidth=function(){_573=this.views.views;for(i=0;view=_573[i];i++){dojo.style(view.headerNode,"display","block");}_572.apply(this,arguments);for(i=0;view=_573[i];i++){dojo.style(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _574=dojo.connect(grid,"_onFetchComplete",this,function(){dojo.disconnect(_574);this.grid.set("autoHeight",this._rows);});}dojo.connect(grid,"_onDelete",this,this._destroyItems);dojo.connect(grid,"_clearData",this,this._destroyItems);dojo.connect(grid,"destroy",this,this._destroyItems);var _575=grid.focus;if(_575&&_575.findAndFocusGridCell){_575.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _576=function(_577){return function(_578,_579){return this._cellGet(_577,_578,_579);};};var _57a=dojo.hitch(this,this._cellFormatter),_57b=[],cols=this._columns,i;for(i=0;i<cols;i++){_57b.push({field:"cell"+i,get:dojo.hitch(this,_576(i)),formatter:_57a});}var _57c={cells:[_57b]};if(this.grouping){var _57d={field:"groupName",colSpan:cols,get:dojo.hitch(this,this._cellGetGroup),formatter:dojo.hitch(this,this._cellGroupFormatter)};_57c.cells.push([_57d]);}var grid=this.grid,_57e=_543.grid.DataGrid.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_57e)?this._rows:_57e);grid.set("structure",_57c);},_setGridData:function(){var _57f=[];if(this.grouping){this._groupRowIndices=[];var _580,_581,cols=this._columns;dojo.forEach(this._flItems,function(_582,idx){_57f.push({});var _583=(idx===0)?0:(_580+_581+1);this._groupRowIndices.push(_583);_580=_583;_581=Math.ceil(_582.length/cols);_57f=_57f.concat(this._getStoreItems(_582));},this);}else{if(this.featureLayers){dojo.forEach(this._flItems,function(_584){_57f=_57f.concat(_584);});_57f=this._getStoreItems(_57f);}else{_57f=this._getStoreItems(this._itItems);}}var _585=new dojo.data.ItemFileReadStore({data:{items:_57f}});this.grid.setStore(_585);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=dojo.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=dojo.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=dojo.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){dojo.disconnect(this._mouseOverConnect);dojo.disconnect(this._mouseOutConnect);dojo.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_586){var _587=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_587,row,col);if(!cell){return;}var _588=this.grid.store;if(_588.getValue(cell,"loadingCell")){return;}if(this._selectedCell){dojo.removeClass(this._selectedCell,"selectedItem");}if(_587!==this._selectedCell){dojo.addClass(_587,"selectedItem");this._selectedCell=_587;this._selectedItem={featureLayer:_588.getValue(cell,"layer"),type:_588.getValue(cell,"type"),template:_588.getValue(cell,"template"),symbolInfo:_588.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_588.getValue(cell,"index1"),index2:_588.getValue(cell,"index2"),index:_588.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_586){this.onSelectionChange();}},_locate:function(_589,info,_58a){var _58b=this.grid.store,cols=new Array(this._columns);var _58c,_58d=info.index1,_58e=info.index2,_58f=info.index,item=_589.item;dojo.some(_58a,function(_590,_591){return dojo.some(cols,function(_592,_593){var cell=_58b.getValue(_590,"cell"+_593);if(cell&&(item?(_58f===_58b.getValue(cell,"index")):(_58d===_58b.getValue(cell,"index1")&&_58e===_58b.getValue(cell,"index2")))){_58c=[_591,_593];return true;}else{return false;}});});return _58c;},_getCellInfo:function(_594,row,col){if(!_594){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _595=this.items;if(_595){return _595[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _596=this.tooltip;var _597=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_597,row,col);if(_596&&cell){var _598=this.grid.store;var _599=_598.getValue(cell,"template");var type=_598.getValue(cell,"type");var _59a=_598.getValue(cell,"symbolInfo");var _59b=_598.getValue(cell,"layer");var item=this._getItem(cell);var _59c=(item&&(item.label+(item.description?(": "+item.description):"")))||(_599&&(_599.name+(_599.description?(": "+_599.description):"")))||(type&&type.name)||(_59a&&(_59a.label+(_59a.description?(": "+_59a.description):"")))||((_59b&&_59b.name+": ")+"Default");_596.style.display="none";_596.innerHTML=_59c;var _59d=dojo.coords(_597.firstChild);dojo.style(_596,{left:(_59d.x)+"px",top:(_59d.y+_59d.h+5)+"px"});_596.style.display="";}},_cellMouseOut:function(){var _59e=this.tooltip;if(_59e){_59e.style.display="none";}},_destroyItems:function(){var _59f=this._itemWidgets,w;for(w in _59f){if(!_59f[w]){continue;}_59f[w].destroy();delete _59f[w];}},_repaintItems:function(){var _5a0=this._itemWidgets,w;for(w in _5a0){var _5a1=_5a0[w];if(_5a1){_5a1._repaint(_5a1._surface);}}},_getStoreItems:function(_5a2){var uid=this._uniqueId;_5a2=dojo.map(_5a2,function(item){return dojo.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_5a2.length,_5a3=0,obj={},k=0,prop,_5a4=[],flag=true,cols=this._columns;while(_5a3<len){flag=true;prop="cell"+k;obj[prop]=_5a2[_5a3];_5a3++;k++;if(k%cols===0){flag=false;_5a4.push(obj);obj={};k=0;}}if(flag&&len){_5a4.push(obj);}return _5a4;},_getItemsFromLayers:function(_5a5){var _5a6=[];dojo.forEach(_5a5,function(_5a7,_5a8){_5a6.push(this._getItemsFromLayer(_5a7,_5a8));},this);return _5a6;},_getItemsFromLayer:function(_5a9,_5aa){var _5ab=[];if(this.useLegend&&dojo.indexOf(this._loadingIndices,_5aa)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_5a9,type:null,template:null,index1:_5aa,index2:0,loadingCell:1}];}var _5ac=[];_5ac=_5ac.concat(_5a9.templates);dojo.forEach(_5a9.types,function(_5ad){var _5ae=_5ad.templates;dojo.forEach(_5ae,function(_5af){_5af._type_=_5ad;});_5ac=_5ac.concat(_5ae);});_5ac=dojo.filter(_5ac,esri._isDefined);var _5b0=_5a9.renderer;if(_5b0){var _5b1=_5b0.declaredClass.replace("esri.renderer.","");if(_5ac.length>0){dojo.forEach(_5ac,function(_5b2){var _5b3=_5b2.prototype;if(_5b3){var _5b4=_5b0.getSymbol(_5b3);if(_5b4){var _5b5=null,pms,_5b6;if(this.useLegend&&dojo.indexOf(this._legendIndices,_5aa)>-1){_5b6=this._legendSymbols&&this._legendSymbols[_5aa];if(_5b6){switch(_5b1){case "SimpleRenderer":_5b5=_5b6.defaultSymbol;break;case "UniqueValueRenderer":dojo.some(_5b0.infos,function(info){if(info.symbol===_5b4){_5b5=_5b6[info.value];}return !!_5b5;});break;case "ClassBreaksRenderer":dojo.some(_5b0.infos,function(info){if(info.symbol===_5b4){_5b5=_5b6[info.maxValue];}return !!_5b5;});break;}}if(_5b5){pms=dojo.fromJson(dojo.toJson(esri.symbol.defaultPictureMarkerSymbol));pms.url=_5b5.url;pms.imageData=_5b5.imageData;pms.contentType=_5b5.contentType;pms.width=_5b5.width;pms.height=_5b5.height;if(!esri._isDefined(pms.width)||!esri._isDefined(pms.height)){pms.width=15;pms.height=15;}_5b5=new esri.symbol.PictureMarkerSymbol(pms);}}_5ab.push({label:this._trimLabel(_5b2.name),symbol:_5b5||_5b4,legendOverride:!!_5b5,layer:_5a9,type:_5b2._type_,template:_5b2,index1:_5aa,index2:_5ab.length});}}delete _5b2._type_;},this);}else{var _5b7=[];if(_5b1==="TemporalRenderer"){_5b0=_5b0.observationRenderer;if(_5b0){_5b1=_5b0.declaredClass.replace("esri.renderer.","");}}switch(_5b1){case "SimpleRenderer":_5b7=[{symbol:_5b0.symbol,label:_5b0.label,description:_5b0.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_5b7=_5b0.infos;break;}_5ab=dojo.map(_5b7,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:dojo.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_5a9,index1:_5aa,index2:idx};},this);}}return _5ab;},_getItemsFromItems:function(_5b8){return dojo.map(_5b8,function(item,idx){item=dojo.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_5b9){var max=this.maxLabelLength;if(max&&_5b9){if(_5b9.length>max){_5b9=_5b9.substr(0,max)+"...";}}return _5b9||"";},_cellGet:function(_5ba,_5bb,_5bc){if(!_5bc){return "";}return this.grid.store.getValue(_5bc,"cell"+_5ba);},_cellFormatter:function(_5bd){if(_5bd){var _5be=this._itemWidgets,_5bf=this.grid.store;var sid=_5bf.getValue(_5bd,"surfaceId");var w=_5be[sid];if(!w){w=(_5be[sid]=new esri.dijit.editing.TemplatePickerItem({id:sid,label:_5bf.getValue(_5bd,"label"),symbol:_5bf.getValue(_5bd,"symbol"),legendOverride:_5bf.getValue(_5bd,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_5bf.getValue(_5bd,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_5c0,_5c1){if(!this._groupRowIndices){return "";}var _5c2=dojo.indexOf(this._groupRowIndices,_5c0);if(!_5c1||_5c2===-1){return "";}return (this.featureLayers[_5c2]&&this.featureLayers[_5c2].name)||"";},_cellGroupFormatter:function(_5c3){if(_5c3){return "<div class='groupLabel'>"+_5c3+"</div>";}else{return "";}}});dojo.declare("esri.dijit.editing.TemplatePickerItem",[_542._Widget,_542._Templated],{templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_5c4,_5c5,_5c6,_5c7){if(!_5c4){return;}var _5c8=_543.gfx.createSurface(node,_5c5,_5c6);if(dojo.isIE<9){var _5c9=_5c8.getEventSource();dojo.style(_5c9,"position","relative");dojo.style(_5c9.parentNode,"position","relative");}var _5ca=(!this.legendOverride&&this._getDrawingToolShape(_5c4,_5c7))||esri.symbol.getShapeDescriptors(_5c4);var _5cb;try{_5cb=_5c8.createShape(_5ca.defaultShape).setFill(_5ca.fill).setStroke(_5ca.stroke);}catch(e){_5c8.clear();_5c8.destroy();return;}var dim=_5c8.getDimensions();var _5cc={dx:dim.width/2,dy:dim.height/2};var bbox=_5cb.getBoundingBox(),_5cd=bbox.width,_5ce=bbox.height;if(_5cd>_5c5||_5ce>_5c6){var _5cf=_5cd>_5ce?_5cd:_5ce;var _5d0=_5c5<_5c6?_5c5:_5c6;var _5d1=(_5d0-5)/_5cf;dojo.mixin(_5cc,{xx:_5d1,yy:_5d1});}_5cb.applyTransform(_5cc);return _5c8;},_getDrawingToolShape:function(_5d2,_5d3){var _5d4,_5d5=_5d3?_5d3.drawingTool||null:null;switch(_5d5){case "esriFeatureEditToolArrow":_5d4={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_5d4={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_5d4={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_5d4={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_5d4={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_5d4={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_5d4={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_5d4={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_5d4={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_5d2.type==="simplelinesymbol"||_5d2.type==="cartographiclinesymbol"){_5d4={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_5d4={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_5d4,fill:_5d2.getFill(),stroke:_5d2.getStroke()};},_repaint:function(_5d6){if(!_5d6){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_5d6.getStroke&&_5d6.setStroke){_5d6.setStroke(_5d6.getStroke());}if(_5d6.getFill&&_5d6.setFill){_5d6.setFill(_5d6.getFill());}if(_5d6.children&&dojo.isArray(_5d6.children)){dojo.forEach(_5d6.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_5d7,_5d8,_5d9,has){return _5d8("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_5da){var i=_5da;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_5da);this.edit.styleRow(_5da);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _5db;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_5db=this.focus.getHeaderIndex();if(_5db>=0){this.setSortIndex(_5db);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_5d9.stop(e);}if(!e.shiftKey){var _5dc=this.edit.isEditing();this.edit.apply();if(!_5dc){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _5dd=this.focus.focusView||this.views.views[0];_5dd.content.decorateEvent(e);this.onRowClick(e);_5d9.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_5db=this.focus.getHeaderIndex();if(_5db>=0){this.setSortIndex(_5db);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_5d9.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _5de=e.keyCode;_5d9.stop(e);_5db=this.focus.getHeaderIndex();if(_5db>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_5db,(_5de==keys.LEFT_ARROW?-1:1)*5);}else{var _5df=(_5de==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_5df*=-1;}this.focus.move(0,_5df);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_5d9.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_5d9.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_5d9.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_5d9.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_5d7.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_5d7.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _5e0;if(this._click.length>1&&has("ie")){_5e0=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_5e0=this._click[0];}else{_5e0=e;}}this.focus.setFocusCell(_5e0.cell,_5e0.rowIndex);this.onRowClick(_5e0);this.edit.setEditCell(_5e0.cell,_5e0.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_5e1,_5e2){this.edit.cellFocus(_5e1,_5e2);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_5d9.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_5d7.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_5d7.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_5d9.stop(e);}},onStartEdit:function(_5e3,_5e4){},onApplyCellEdit:function(_5e5,_5e6,_5e7){},onCancelEdit:function(_5e8){},onApplyEdit:function(_5e9){},onCanSelect:function(_5ea){return true;},onCanDeselect:function(_5eb){return true;},onSelected:function(_5ec){this.updateRowStyles(_5ec);},onDeselected:function(_5ed){this.updateRowStyles(_5ed);},onSelectionChanged:function(){}});});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_5ee,_5ef,_5f0,_5f1){return _5ee("dijit.CheckedMenuItem",_5f0,{templateString:_5f1,checked:false,_setCheckedAttr:function(_5f2){_5ef.toggle(this.domNode,"dijitCheckedMenuItemChecked",_5f2);this.domNode.setAttribute("aria-checked",_5f2?"true":"false");this._set("checked",_5f2);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"dojo/io/iframe":function(){define(["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(_5f3,json,_5f4,lang,xhr,has,win,dom,_5f5,_5f6,_5f7,_5f8,_5f9){dojo.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var mid=_5f9._iframeName;mid=mid.substring(0,mid.lastIndexOf("_"));var _5fa=lang.delegate(_5f9,{create:function(){return _5fa._frame=_5f9.create.apply(_5f9,arguments);},get:null,post:null,send:function(args){var rDfd;var dfd=xhr._ioSetArgs(args,function(dfd){rDfd&&rDfd.cancel();},function(dfd){var _5fb=null,_5fc=dfd.ioArgs;try{var _5fd=_5fc.handleAs;if(_5fd==="xml"||_5fd==="html"){_5fb=rDfd.response.data;}else{_5fb=rDfd.response.text;if(_5fd==="json"){_5fb=json.fromJson(_5fb);}else{if(_5fd==="javascript"){_5fb=_5f4.eval(_5fb);}}}}catch(e){_5fb=e;}return _5fb;},function(_5fe,dfd){dfd.ioArgs._hasError=true;return _5fe;});var _5ff=dfd.ioArgs;var _600="GET",form=dojo.byId(args.form);if(args.method&&args.method.toUpperCase()==="POST"&&form){_600="POST";}var _601={method:_600,handleAs:args.handleAs==="json"||args.handleAs==="javascript"?"text":args.handleAs,form:args.form,query:form?null:args.content,data:form?args.content:null,timeout:args.timeout,ioArgs:_5ff};if(_601.method){_601.method=_601.method.toUpperCase();}if(_5f3.ioPublish&&_5f4.publish&&_5ff.args.ioPublish!==false){var _602=_5f8.after(_5f9,"_notifyStart",function(data){if(data.options.ioArgs===_5ff){_602.remove();xhr._ioNotifyStart(dfd);}},true);}rDfd=_5f9(_5ff.url,_601,true);_5ff._callNext=rDfd._callNext;rDfd.then(function(){dfd.resolve(dfd);}).otherwise(function(_603){dfd.ioArgs.error=_603;dfd.reject(_603);});return dfd;},_iframeOnload:win.global[mid+"_onload"]});lang.setObject("dojo.io.iframe",_5fa);return _5fa;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_604,on,_605,_606){return _604("dojox.gfx.Mover",null,{constructor:function(_607,e,host){this.shape=_607;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_608=on(d,_605.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_605.move,lang.hitch(this,"onMouseMove")),on(d,_605.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_606,"stop")),on(d,"selectstart",lang.hitch(_606,"stop")),_608];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_606.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(h){h.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_609,lang,dom){var dgu=lang.getObject("grid.util",true,_609);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_60a,_60b){if(_60b>=0){var s=_60a.style;var v=_60b+"px";if(_60a&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_60c,_60d,_60e,_60f){var evts=(_60f?_60f:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_60d.connect(_60c,"on"+evts[i],_60e);}};dgu.removeNode=function(_610){_610=dom.byId(_610);_610&&_610.parentNode&&_610.parentNode.removeChild(_610);return _610;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_611,_612,_613){if(_611.length<=_612){_611[_612]=_613;}else{_611.splice(_612,0,_613);}};dgu.arrayRemove=function(_614,_615){_614.splice(_615,1);};dgu.arraySwap=function(_616,inI,inJ){var _617=_616[inI];_616[inI]=_616[inJ];_616[inJ]=_617;};return dgu;});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_618,lang,_619,_61a,_61b,has,dom,_61c,_61d,_61e,util){var _61f=_618("dojox.grid._DeferredTextWidget",_61e,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _620=function(_621){try{util.fire(_621,"focus");util.fire(_621,"select");}catch(e){}};var _622=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _623=_618("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_624){this._props=_624||{};lang.mixin(this,_624);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_625,_626){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_625!=this.defaultValue&&f)?f.apply(s,_626):_625;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _61f({deferred:v},_61d.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_627,_628){var f,i=this.grid.edit.info,d=this.get?this.get(_627,_628):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_627&&i.cell==this))){return this.formatEditing(d,_627);}else{return this._defaultFormat(d,[d,_627,this]);}},formatEditing:function(_629,_62a){},getNode:function(_62b){return this.view.getCellNode(_62b,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_62c){return (this.getNode(_62c)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_62d,_62e){if(this.getNode(_62e)){this.grid.edit.applyCellEdit(_62d,this,_62e);}},cancelEdit:function(_62f){this.grid.doCancelEdit(_62f);},_onEditBlur:function(_630){if(this.grid.edit.isEditCell(_630,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_631,_632){if(this.commitOnBlur){_61a.connect(_631,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_632),250);});}},needFormatNode:function(_633,_634){this._formatPending=true;_622(this,"_formatNode",_633,_634);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_635,_636){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_636),_635,_636);}},formatNode:function(_637,_638,_639){if(has("ie")){_622(this,"focus",_639,_637);}else{this.focus(_639,_637);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_63a){return this.getEditNode(_63a)[this._valueProp];},setValue:function(_63b,_63c){var n=this.getEditNode(_63b);if(n){n[this._valueProp]=_63c;}},focus:function(_63d,_63e){_620(_63e||this.getEditNode(_63d));},save:function(_63f){this.value=this.value||this.getValue(_63f);},restore:function(_640){this.setValue(_640,this.value);},_finish:function(_641){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_642){this.applyEdit(this.getValue(_642),_642);this._finish(_642);},cancel:function(_643){this.cancelEdit(_643);this._finish(_643);}});_623.markupFactory=function(node,_644){var _645=lang.trim(_61c.get(node,"formatter")||"");if(_645){_644.formatter=lang.getObject(_645)||_645;}var get=lang.trim(_61c.get(node,"get")||"");if(get){_644.get=lang.getObject(get);}var _646=function(attr,cell,_647){var _648=lang.trim(_61c.get(node,attr)||"");if(_648){cell[_647||attr]=!(_648.toLowerCase()=="false");}};_646("sortDesc",_644);_646("editable",_644);_646("alwaysEditing",_644);_646("noresize",_644);_646("draggable",_644);var _649=lang.trim(_61c.get(node,"loadingText")||_61c.get(node,"defaultValue")||"");if(_649){_644.defaultValue=_649;}var _64a=function(attr,cell,_64b){var _64c=lang.trim(_61c.get(node,attr)||"")||undefined;if(_64c){cell[_64b||attr]=_64c;}};_64a("styles",_644);_64a("headerStyles",_644);_64a("cellStyles",_644);_64a("classes",_644);_64a("headerClasses",_644);_64a("cellClasses",_644);};var Cell=_618("dojox.grid.cells.Cell",_623,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_64d,_64e){this.needFormatNode(_64d,_64e);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_64d+"\">";},formatNode:function(_64f,_650,_651){this.inherited(arguments);this.registerOnBlur(_64f,_651);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_619.stop(e);}}},_finish:function(_652){this.inherited(arguments);var n=this.getEditNode(_652);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_653){_623.markupFactory(node,_653);var _654=lang.trim(_61c.get(node,"keyFilter")||"");if(_654){_653.keyFilter=new RegExp(_654);}};var _655=_618("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_656){return _656+1;}});_655.markupFactory=function(node,_657){Cell.markupFactory(node,_657);};var _658=_618("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_659){this.values=this.values||this.options;},formatEditing:function(_65a,_65b){this.needFormatNode(_65a,_65b);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_65a==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_65c,_65d){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_61b.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_65e){var n=this.getEditNode(_65e);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_658.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _65f=lang.trim(_61c.get(node,"options")||"");if(_65f){var o=_65f.split(",");if(o[0]!=_65f){cell.options=o;}}var _660=lang.trim(_61c.get(node,"values")||"");if(_660){var v=_660.split(",");if(v[0]!=_660){cell.values=v;}}};var _661=_618("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_662,_663){this.formatNode(this.getEditNode(_663),_662,_663);},applyStaticValue:function(_664){var e=this.grid.edit;e.applyCellEdit(this.getValue(_664),this,_664);e.start(this,_664,true);}});_661.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_618("dojox.grid.cells.Bool",_661,{_valueProp:"checked",formatEditing:function(_665,_666){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_665?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_661.markupFactory(node,cell);};return _623;});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_667,_668,lang,util,html){var _669=function(_66a){var i=0,n,p=_66a.parentNode;while((n=p.childNodes[i++])){if(n==_66a){return i-1;}}return -1;};var _66b=function(_66c){if(!_66c){return;}dojo.forEach(_667.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_66c,true)){w.destroy();}});};var _66d=function(_66e){var node=html.byId(_66e);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _66f=function(_670,_671){var _672=[];var i=0,n;while((n=_670.childNodes[i])){i++;if(_66d(n)==_671){_672.push(n);}}return _672;};var _673=function(_674){return _66f(_674,"div");};return _668("dojox.grid._Scroller",null,{constructor:function(_675){this.setContentNodes(_675);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_676,_677,_678){switch(arguments.length){case 3:this.rowsPerPage=_678;case 2:this.keepRows=_677;case 1:this.rowCount=_676;default:break;}this.defaultPageHeight=this.defaultRowHeight*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_679,_67a){return _679?(Math.ceil(_679/_67a)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_67b){this.keepRows=_67b;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_67c){this.contentNodes=_67c;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_67d){this.invalidateNodes();this.rowCount=_67d;var _67e=this.pageCount;if(_67e===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_67e){for(var i=_67e-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_67e){this.height+=this.defaultPageHeight*(this.pageCount-_67e-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_67f){return Boolean(this.getDefaultPageNode(_67f));},measurePage:function(_680){if(this.grid.rowHeight){var _681=this.grid.rowHeight+1;return ((_680+1)*this.rowsPerPage>this.rowCount?this.rowCount-_680*this.rowsPerPage:this.rowsPerPage)*_681;}var n=this.getDefaultPageNode(_680);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_682,_683){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_682].style.top=_683+"px";}},repositionPages:function(_684){var _685=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_685[_684];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_684):0);for(var p=_684+1;p<=last;p++){n=_685[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_686){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_686]);}},preparePage:function(_687,_688){var p=(_688?this.popPage():null);for(var i=0;i<this.colCount;i++){var _689=this.pageNodes[i];var _68a=(p===null?this.createPageNode():this.invalidatePageNode(p,_689));_68a.pageIndex=_687;_689[_687]=_68a;}},renderPage:function(_68b){var _68c=[];var i,j;for(i=0;i<this.colCount;i++){_68c[i]=this.pageNodes[i][_68b];}for(i=0,j=_68b*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_68c);}},removePage:function(_68d){for(var i=0,j=_68d*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_68e){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_68e,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_68f){},pacifying:false,pacifyTicks:200,setPacifying:function(_690){if(this.pacifying!=_690){this.pacifying=_690;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _691=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _691;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _692=(!this._invalidating);if(!_692){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_692=true;}}if(_692){this.needPage(this.page,this.pageTop);}var _693=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _694=this.getPageHeight(this.page);this.averageRowHeight=(_694>0&&_693>0)?(_694/_693):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _695=this.pageCount-1;var _696=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_695]=_696;return _696;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_697,_698,_699){if(this.pageExists(_697)){var oh=this.getPageHeight(_697);var h=(this.measurePage(_697));if(h===undefined){h=oh;}this.pageHeights[_697]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_698)){if(!_699){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_697);}}else{this.repositionPages(_697);}}return h;}return 0;},rowHeightChanged:function(_69a,_69b){this.updatePageHeight(Math.floor(_69a/this.rowsPerPage),false,_69b);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_69c){var ph=this.pageHeights[_69c];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_69d){return this.stack.push(_69d);},popPage:function(){return this.stack.shift();},findPage:function(_69e){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_69e){break;}}this.page=i;this.pageTop=h;},buildPage:function(_69f,_6a0,_6a1){this.preparePage(_69f,_6a0);this.positionPage(_69f,_6a1);this.installPage(_69f);this.renderPage(_69f);this.pushPage(_69f);},needPage:function(_6a2,_6a3){var h=this.getPageHeight(_6a2),oh=h;if(!this.pageExists(_6a2)){this.buildPage(_6a2,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_6a3);h=this.updatePageHeight(_6a2,true);}else{this.positionPage(_6a2,_6a3);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_6a4){this.grid.scrollTop=_6a4;if(this.colCount){this.startPacify();this.findPage(_6a4);var h=this.height;var b=this.getScrollBottom(_6a4);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_6a4);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_6a5){return (this.windowHeight>=0?_6a5+this.windowHeight:-1);},processNodeEvent:function(e,_6a6){var t=e.target;while(t&&(t!=_6a6)&&t.parentNode&&(t.parentNode.parentNode!=_6a6)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_6a6)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_669(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_6a7,_6a8){},removeRow:function(_6a9){},getDefaultPageNode:function(_6aa){return this.getDefaultNodes()[_6aa];},positionPageNode:function(_6ab,_6ac){},getPageNodePosition:function(_6ad){return _6ad.offsetTop;},invalidatePageNode:function(_6ae,_6af){var p=_6af[_6ae];if(p){delete _6af[_6ae];this.removePage(_6ae,p);_66b(p);p.innerHTML="";}return p;},getPageRow:function(_6b0){return _6b0*this.rowsPerPage;},getLastPageRow:function(_6b1){return Math.min(this.rowCount,this.getPageRow(_6b1+1))-1;},getFirstVisibleRow:function(_6b2,_6b3,_6b4){if(!this.pageExists(_6b2)){return 0;}var row=this.getPageRow(_6b2);var _6b5=this.getDefaultNodes();var rows=_673(_6b5[_6b2]);for(var i=0,l=rows.length;i<l&&_6b3<_6b4;i++,row++){_6b3+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_6b6,_6b7,_6b8){if(!this.pageExists(_6b6)){return 0;}var _6b9=this.getDefaultNodes();var row=this.getLastPageRow(_6b6);var rows=_673(_6b9[_6b6]);for(var i=rows.length-1;i>=0&&_6b7>_6b8;i--,row--){_6b7-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_6ba){var _6bb=this.getDefaultNodes();var rows=_673(_6bb[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_6ba){this.offset=h-(t-_6ba);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_6bc){var _6bd=Math.floor(_6bc/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_6bd;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_6bd;this.needPage(_6bd,this.pageTop);var _6be=this.getDefaultNodes();var rows=_673(_6be[_6bd]);var r=_6bc-this.rowsPerPage*_6bd;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_6bf,_6c0,_6c1,_6c2,lang,win,dom,_6c3,_6c4,_6c5,has,on,_6c6,_6c7,_6c8,dnd){var _6c9=_6c0("dojo.dnd.Container",_6c5,{skipForm:false,allowNested:false,constructor:function(node,_6ca){this.node=dom.byId(node);if(!_6ca){_6ca={};}this.creator=_6ca.creator||null;this.skipForm=_6ca.skipForm;this.parent=_6ca.dropParent&&dom.byId(_6ca.dropParent);this.map={};this.current=null;this.containerState="";_6c3.add(this.node,"dojoDndContainer");if(!(_6ca&&_6ca._skipStartup)){this.startup();}this.events=[on(this.node,_6c8.over,lang.hitch(this,"onMouseOver")),on(this.node,_6c8.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_6c2.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _6c6((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_6cb,_6cc){if(!this.parent.firstChild){_6cc=null;}else{if(_6cb){if(!_6cc){_6cc=this.parent.firstChild;}}else{if(_6cc){_6cc=_6cc.nextSibling;}}}var i,t;if(_6cc){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_6cc.parentNode.insertBefore(t.node,_6cc);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_6bf.forEach(this.events,function(_6cd){_6cd.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_6ce,node,Ctor){_6ce._skipStartup=true;return new Ctor(node,_6ce);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_6c1.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_6cf){var _6d0="dojoDnd"+type;var _6d1=type.toLowerCase()+"State";_6c3.replace(this.node,_6d0+_6cf,_6d0+this[_6d1]);this[_6d1]=_6cf;},_addItemClass:function(node,type){_6c3.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_6c3.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _6d2=node.parentNode;_6d2;node=_6d2,_6d2=node.parentNode){if((_6d2==this.parent||this.allowNested)&&_6c3.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_6c3.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _6c4.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_6c4.create("tr");_6c4.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _6c4.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _6d3=item&&lang.isObject(item),data,type,n;if(_6d3&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_6d3&&item.data)?item.data:item;type=(_6d3&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _6c9;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_6d4,_6d5,_6d6){return _6d4("dojox.grid.DataSelection",_6d6,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _6d5(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_6d6.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_6d7){var _6d8=this.grid.getItemIndex(_6d7);var idx=_6d6.prototype.getNextSelected.call(this,_6d8);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _6d9=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_6d9.push(this.grid.getItem(i));}}return _6d9;},addToSelection:function(_6da){if(this.mode=="none"){return;}var idx=null;if(typeof _6da=="number"||typeof _6da=="string"){idx=_6da;}else{idx=this.grid.getItemIndex(_6da);}_6d6.prototype.addToSelection.call(this,idx);},deselect:function(_6db){if(this.mode=="none"){return;}var idx=null;if(typeof _6db=="number"||typeof _6db=="string"){idx=_6db;}else{idx=this.grid.getItemIndex(_6db);}_6d6.prototype.deselect.call(this,idx);},deselectAll:function(_6dc){var idx=null;if(_6dc||typeof _6dc=="number"){if(typeof _6dc=="number"||typeof _6dc=="string"){idx=_6dc;}else{idx=this.grid.getItemIndex(_6dc);}_6d6.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_6dd,_6de,lang,_6df){return _6dd("dojox.grid._SelectionPreserver",null,{constructor:function(_6e0){this.selection=_6e0;var grid=this.grid=_6e0.grid;this.reset();this._connects=[_6de.connect(grid,"_setStore",this,"reset"),_6de.connect(grid,"_addItem",this,"_reSelectById"),_6de.connect(_6e0,"onSelected",lang.hitch(this,"_selectById",true)),_6de.connect(_6e0,"onDeselected",lang.hitch(this,"_selectById",false)),_6de.connect(_6e0,"deselectAll",this,"reset")];},destroy:function(){this.reset();_6df.forEach(this._connects,_6de.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_6e1){if(item&&this.grid._hasIdentity){this.selection.selected[_6e1]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_6e2,_6e3){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_6e3,g=this.grid;if(typeof _6e3=="number"||typeof _6e3=="string"){var _6e4=g._by_idx[_6e3];item=_6e4&&_6e4.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_6e2;}return item;}});});},"esri/layers/FeatureLayer":function(){define(["dijit","dojo","dojox","dojo/require!esri/layers/graphics,esri/tasks/query,dojo/io/iframe,esri/layers/agscommon,dojo/date/locale"],function(_6e5,dojo,_6e6){dojo.provide("esri.layers.FeatureLayer");dojo.require("esri.layers.graphics");dojo.require("esri.tasks.query");dojo.require("dojo.io.iframe");dojo.require("esri.layers.agscommon");dojo.require("dojo.date.locale");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_6e7){this._outFields=_6e7&&_6e7.outFields;this._loadCallback=_6e7&&_6e7.loadCallback;var _6e8=_6e7&&_6e7._usePatch;this._usePatch=(_6e8===null||_6e8===undefined)?true:_6e8;this._trackIdField=_6e7&&_6e7.trackIdField;this.objectIdField=_6e7&&_6e7.objectIdField;this._maxOffset=_6e7&&_6e7.maxAllowableOffset;this._optEditable=_6e7&&_6e7.editable;this._optAutoGen=_6e7&&_6e7.autoGeneralize;this.editSummaryCallback=_6e7&&_6e7.editSummaryCallback;this.userId=_6e7&&_6e7.userId;this.userIsAdmin=_6e7&&_6e7.userIsAdmin;this.useMapTime=(_6e7&&_6e7.hasOwnProperty("useMapTime"))?(!!_6e7.useMapTime):true;this.source=_6e7&&_6e7.source;this.gdbVersion=_6e7&&_6e7.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(esri._isDefined(_6e7&&_6e7.mode)?_6e7.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_6e7&&_6e7.tileWidth)||512;this._tileHeight=(_6e7&&_6e7.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);var _6e9=_6e7&&_6e7.latticeTiling;this.latticeTiling=_6e9;break;case ctor.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);this._editable=false;if(dojo.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new esri.tasks.QueryTask(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _6ea=this._url.path;this._fserver=false;if(_6ea.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _6eb=_6e7&&_6e7.resourceInfo;if(_6eb){this._initLayer(_6eb);}else{if(this.source){var _6ec={source:this.source.toJson()};this._url.query=dojo.mixin(this._url.query,{layer:dojo.toJson(_6ec)});}if(this.gdbVersion){this._url.query=dojo.mixin(this._url.query,{gdbVersion:this.gdbVersion});}esri.request({url:_6ea,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_6ed,io){if(_6ed||io){this._json=_6ed;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_6ed&&_6ed._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_6ed.featureSet;this._nextId=_6ed.nextObjectId;_6ed=_6ed.layerDefinition;}if(_6ed.hasOwnProperty("capabilities")){var _6ee=(this.capabilities=_6ed.capabilities);if(_6ee&&_6ee.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_6ed.geometryType==="esriGeometryPolyline")||(_6ed.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=esri._isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _6ef=_6ed.effectiveMinScale||_6ed.minScale,_6f0=_6ed.effectiveMaxScale||_6ed.maxScale;if(!this._hasMin&&_6ef){this.setMinScale(_6ef);}if(!this._hasMax&&_6f0){this.setMaxScale(_6f0);}this.layerId=_6ed.id;this.name=_6ed.name;this.description=_6ed.description;this.copyright=_6ed.copyrightText;this.type=_6ed.type;this.geometryType=_6ed.geometryType;this.displayField=_6ed.displayField;this.defaultDefinitionExpression=_6ed.definitionExpression;this.fullExtent=new esri.geometry.Extent(_6ed.extent);this.initialExtent=new esri.geometry.Extent(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new esri.SpatialReference(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_6ed.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_6ed.indexedFields;this.maxRecordCount=_6ed.maxRecordCount;this.canModifyLayer=_6ed.canModifyLayer;this.supportsStatistics=_6ed.supportsStatistics;this.supportsAdvancedQueries=_6ed.supportsAdvancedQueries;this.hasLabels=_6ed.hasLabels;this.canScaleSymbols=_6ed.canScaleSymbols;this.supportsRollbackOnFailure=_6ed.supportsRollbackOnFailure;this.syncCanReturnChanges=_6ed.syncCanReturnChanges;this.isDataVersioned=_6ed.isDataVersioned;this.editFieldsInfo=_6ed.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_6ed.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_6ed.relationships;this.allowGeometryUpdates=esri._isDefined(_6ed.allowGeometryUpdates)?_6ed.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _6f1=(this.fields=[]),_6f2=_6ed.fields,i;for(i=0;i<_6f2.length;i++){_6f1.push(new esri.layers.Field(_6f2[i]));}if(!this.objectIdField){this.objectIdField=_6ed.objectIdField;if(!this.objectIdField){_6f2=_6ed.fields;for(i=0;i<_6f2.length;i++){var _6f3=_6f2[i];if(_6f3.type==="esriFieldTypeOID"){this.objectIdField=_6f3.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _6f4=this.objectIdField,_6f5=-1;if(this._collection&&_6f4){var fset=this._featureSet,_6f6=fset&&fset.features,il=_6f6?_6f6.length:0,oid,attr;for(i=0;i<il;i++){attr=_6f6[i].attributes;oid=attr&&attr[_6f4];if(oid>_6f5){_6f5=oid;}}}this._nextId=(_6f5+1);}this.globalIdField=_6ed.globalIdField;var _6f7=(this.typeIdField=_6ed.typeIdField),_6f8;if(_6f7){_6f8=!this._getField(_6f7)&&this._getField(_6f7,true);if(_6f8){this.typeIdField=_6f8.name;}}this.visibilityField=_6ed.visibilityField;var _6f9=_6ed.defaultSymbol;if(_6f9){this.defaultSymbol=esri.symbol.fromJson(_6f9);}var _6fa=this.types=[],_6fb=_6ed.types,_6fc,_6fd,_6fe,_6ff=this.editFieldsInfo,_700=_6ff&&_6ff.creatorField,_701=_6ff&&_6ff.editorField,fix=(_700||_701),_702=[];if(_6fb){for(i=0;i<_6fb.length;i++){_6fc=new esri.layers.FeatureType(_6fb[i]);_6fd=_6fc.templates;if(fix&&_6fd&&_6fd.length){_702=_702.concat(_6fd);}_6fa.push(_6fc);}}var _703=_6ed.templates,_704,_705=this.templates=[];if(_703){for(i=0;i<_703.length;i++){_704=new esri.layers.FeatureTemplate(_703[i]);if(fix){_702.push(_704);}_705.push(_704);}}for(i=0;i<_702.length;i++){_6fe=dojo.getObject("prototype.attributes",false,_702[i]);if(_6fe){if(_700){delete _6fe[_700];}if(_701){delete _6fe[_701];}}}var _706=_6ed.timeInfo;if(_706){this.timeInfo=new esri.layers.TimeInfo(_706);this._startTimeField=_706.startTimeField;this._endTimeField=_706.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_706.trackIdField=this._trackIdField;}else{this._trackIdField=_706.trackIdField;}}this.hasAttachments=(!this._collection&&_6ed.hasAttachments)?true:false;this.htmlPopupType=_6ed.htmlPopupType;var _707=_6ed.drawingInfo,_708;if(!this.renderer){if(_707&&_707.renderer){_708=_707.renderer;this.setRenderer(esri.renderer.fromJson(_708));if(_708.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _709=_708.type,_70a=[];_708=this.renderer;switch(_709){case "simple":_70a.push(_708.symbol);break;case "uniqueValue":case "classBreaks":_70a.push(_708.defaultSymbol);_70a=_70a.concat(dojo.map(_708.infos,function(info){return info.symbol;}));break;}_70a=dojo.filter(_70a,esri._isDefined);var _70b=this._url.path+"/images/",_70c=this._getToken();dojo.forEach(_70a,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_70b+url;}if(_70c&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_70c);}}});}}else{if(_6f9){_6fb=this.types;if(_6fb.length>0){_708=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_6fb,function(type){_708.addValue(type.id,type.symbol);});}else{_708=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_708);}else{if(!this._isTable){var _70d;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_70d=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_70d=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_70d=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_70d?new esri.renderer.SimpleRenderer(_70d):null);}}}}var _70e=(_707&&_707.transparency)||0;if(!esri._isDefined(this.opacity)&&_70e>0){this.opacity=1-(_70e/100);}this.version=_6ed.currentVersion;if(!this.version){var ver;if("capabilities" in _6ed||"drawingInfo" in _6ed||"hasAttachments" in _6ed||"htmlPopupType" in _6ed||"relationships" in _6ed||"timeInfo" in _6ed||"typeIdField" in _6ed||"types" in _6ed){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _70f=function(){this.onLoad(this);var _710=this._loadCallback;if(_710){delete this._loadCallback;_710(this);}};if(this._collection){this._fireUpdateStart();var _711=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_711));this._fcAdded=true;_70f.call(this);}else{this._forceIdentity(_70f);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _712=this.renderer;if(_712){this._ager=(_712.declaredClass.indexOf("TemporalRenderer")!==-1&&_712.observationAger&&_712.observationRenderer);var _713=dojo.filter([_712,_712.observationRenderer,_712.latestObservationRenderer,_712.trackRenderer],esri._isDefined);var _714=[];dojo.forEach(_713,function(rnd){if(!dojo.isFunction(rnd.attributeField)){_714.push(rnd.attributeField);}_714.push(rnd.attributeField2);_714.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_714,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_unsetMap:function(map,_715){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_716){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_716;return this;}var _717=this._editable;this._editable=_716;this._updateCaps();if(_717!==_716){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_718){var _719={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _719;}var _71a=_718&&_718.feature,_71b=_718&&_718.userId,caps=dojo.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),dojo.trim),_71c=dojo.indexOf(caps,"editing")>-1,_71d=_71c&&(dojo.indexOf(caps,"create")>-1),_71e=_71c&&(dojo.indexOf(caps,"update")>-1),_71f=_71c&&(dojo.indexOf(caps,"delete")>-1),_720=this.ownershipBasedAccessControlForFeatures,_721=this.editFieldsInfo,_722=_721&&_721.creatorField,_723=_721&&_721.realm,_724=_71a&&_71a.attributes,_725=(_724&&_722)?_724[_722]:undefined,_726,_727=!!this.userIsAdmin,_728=!_720||_727||!!(_720.allowOthersToUpdate||_720.allowUpdateToOthers),_729=!_720||_727||!!(_720.allowOthersToDelete||_720.allowDeleteToOthers);if(_727||(_71c&&!(_71d||_71e||_71f))){_71d=_71e=_71f=true;}_726={"canCreate":_71d,"canUpdate":_71e,"canDelete":_71f};if(_725===null){_726.canUpdate=_71e&&_728;_726.canDelete=_71f&&_729;}else{if(_725===""){return _726;}else{if(_725){_71b=_71b||this.getUserId();if(_71b&&_723){_71b=_71b+"@"+_723;}if(_71b.toLowerCase()===_725.toLowerCase()){return _726;}else{_726.canUpdate=_71e&&_728;_726.canDelete=_71f&&_729;}}}}return _726;},getUserId:function(){var _72a;if(this.loaded){_72a=(this.credential&&this.credential.userId)||this.userId||"";}return _72a;},setUserIsAdmin:function(_72b){this.userIsAdmin=_72b;},setEditSummaryCallback:function(_72c){this.editSummaryCallback=_72c;},getEditSummary:function(_72d,_72e,_72f){_72f=esri._isDefined(_72f)?_72f:(new Date()).getTime();var _730="",info=this.getEditInfo(_72d,_72e,_72f),_731=(_72e&&_72e.callback)||this.editSummaryCallback;if(_731){info=_731(_72d,info)||"";}if(dojo.isString(info)){_730=info;}else{if(info){var _732=info.action,_733=info.userId,_734=info.timeValue,_735=0;if(_732){_735++;}if(_733){_735++;}if(esri._isDefined(_734)){_735++;}if(_735>1){_730=(_732==="edit"?"edit":"create")+(_733?"User":"")+(esri._isDefined(_734)?info.displayPattern:"");}}_730=_730&&esri.substitute(info,esri.bundle.layers.FeatureLayer[_730]);}return _730;},getEditInfo:function(_736,_737,_738){if(!this.loaded){return;}_738=esri._isDefined(_738)?_738:(new Date()).getTime();var _739=(_737&&_737.action)||"last",_73a=this.editFieldsInfo,_73b=_73a&&_73a.creatorField,_73c=_73a&&_73a.creationDateField,_73d=_73a&&_73a.editorField,_73e=_73a&&_73a.editDateField,_73f=_73a&&_73a.realm,_740=_736&&_736.attributes,_741=(_740&&_73b)?_740[_73b]:undefined,_742=(_740&&_73c)?_740[_73c]:null,_743=(_740&&_73d)?_740[_73d]:undefined,_744=(_740&&_73e)?_740[_73e]:null,_745=this._getEditData(_741,_742,_738),_746=this._getEditData(_743,_744,_738),_747;switch(_739){case "creation":_747=_745;break;case "edit":_747=_746;break;case "last":_747=_746||_745;break;}if(_747){_747.action=(_747===_746)?"edit":"creation";}return _747;},_getEditData:function(_748,_749,_74a){var data,_74b,_74c,_74d=60000,_74e=3600000,_74f=2*_74e,_750=24*_74e,_751=7*_750;if(esri._isDefined(_749)){_74b=_74a-_749;if(_74b<0){_74c="Full";}else{if(_74b<_74d){_74c="Seconds";}else{if(_74b<(2*_74d)){_74c="Minute";}else{if(_74b<_74e){_74c="Minutes";}else{if(_74b<_74f){_74c="Hour";}else{if(_74b<_750){_74c="Hours";}else{if(_74b<_751){_74c="WeekDay";}else{_74c="Full";}}}}}}}}if((_748!==undefined)||_74c){data=data||{};data.userId=_748;if(_74c){var _752=dojo.date.locale.format,_753=new Date(_749);data.minutes=Math.floor(_74b/_74d);data.hours=Math.floor(_74b/_74e);data.weekDay=_752(_753,{datePattern:"EEEE",selector:"date"});data.formattedDate=_752(_753,{selector:"date"});data.formattedTime=_752(_753,{selector:"time"});data.displayPattern=_74c;data.timeValue=_749;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_754){if(!this.isEditable()){this._maxOffset=_754;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_755){if(!this.loaded){this._optAutoGen=_755;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_755;if(_755){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_756){if(!this._collection&&(_756!==this.gdbVersion)&&(_756||this.gdbVersion)){this.gdbVersion=_756;this._task.gdbVersion=_756;this._url.query=dojo.mixin(this._url.query,{gdbVersion:_756});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_757){if(this._isSnapshot){this._timeDefn=_757;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_758,_759){this._timeOffset=_758;this._timeOffsetUnits=_759;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_75a,_75b,_75c,_75d){_75b=_75b||this.constructor.SELECTION_NEW;var _75e=this._getShallowClone(_75a),map=this._map,_75f,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_75e.outFields=this._getOutFields();_75e.returnGeometry=true;if(map){_75e.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_75e)){_75f={features:[]};this._selectHandler(_75f,_75b,_75c,_75d,dfd);return dfd;}var _760=this._canDoClientSideQuery(_75e);if(_760){_75f={features:this._doQuery(_75e,_760)};this._selectHandler(_75f,_75b,_75c,_75d,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_75d,dfd,true);return dfd;}var self=this;if(this._ts){_75e._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_75e);temp.addCallbacks(function(_761){self._selectHandler(_761,_75b,_75c,_75d,dfd);},function(err){self._resolve([err],null,_75d,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _762=this._selectedFeatures,_763=[],item;for(item in _762){if(_762.hasOwnProperty(item)){_763.push(_762[item]);}}return _763;},clearSelection:function(_764){var _765=this._selectedFeatures,mode=this._mode,item;for(item in _765){if(_765.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_764){this.onSelectionClear();}return this;},setSelectionSymbol:function(_766){this._selectionSymbol=_766;if(_766){var _767=this._selectedFeatures,item;for(item in _767){if(_767.hasOwnProperty(item)){_767[item].setSymbol(_766);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_768,_769,_76a,_76b,_76c){var _76d=_76c.assembly,dfd=_76c.dfd;this._applyNormalized(adds,_76d&&_76d[0]);this._applyNormalized(_768,_76d&&_76d[1]);this.onBeforeApplyEdits(adds,_768,_769);var i,_76e={},_76f=this.objectIdField,_770={f:"json"},_771=false;if(this._collection){var _772={};_772.addResults=adds?dojo.map(adds,function(){_771=true;return {objectId:this._nextId++,success:true};},this):null;_772.updateResults=_768?dojo.map(_768,function(_773){_771=true;var oid=_773.attributes[_76f];_76e[oid]=_773;return {objectId:oid,success:true};},this):null;_772.deleteResults=_769?dojo.map(_769,function(_774){_771=true;return {objectId:_774.attributes[_76f],success:true};},this):null;if(_771){this._editHandler(_772,adds,_76e,_76a,_76b,dfd);}return;}if(adds&&adds.length>0){_770.adds=this._convertFeaturesToJson(adds,0,1);_771=true;}if(_768&&_768.length>0){for(i=0;i<_768.length;i++){var _775=_768[i];_76e[_775.attributes[_76f]]=_775;}_770.updates=this._convertFeaturesToJson(_768,0,0,1);_771=true;}if(_769&&_769.length>0){var ids=[];for(i=0;i<_769.length;i++){ids.push(_769[i].attributes[_76f]);}_770.deletes=ids.join(",");_771=true;}if(_771){var self=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_770,this._url.query),callbackParamName:"callback",load:function(_776){self._editHandler(_776,adds,_76e,_76a,_76b,dfd);},error:function(err){self._resolve([err],null,_76b,dfd,true);}},{usePost:true});}},queryFeatures:function(_777,_778,_779){return this._query("execute","onQueryFeaturesComplete",_777,_778,_779);},queryRelatedFeatures:function(_77a,_77b,_77c){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_77a,_77b,_77c);},queryIds:function(_77d,_77e,_77f){return this._query("executeForIds","onQueryIdsComplete",_77d,_77e,_77f);},queryCount:function(_780,_781,_782){return this._query("executeForCount","onQueryCountComplete",_780,_781,_782);},queryAttachmentInfos:function(_783,_784,_785){var url=this._url.path+"/"+_783+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_786){var _787=_786.attachmentInfos,_788;dojo.forEach(_787,function(info){_788=dojo.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_788?("?"+_788):"");info.objectId=_783;});self._resolve([_787],"onQueryAttachmentInfosComplete",_784,dfd);},error:function(err){self._resolve([err],null,_785,dfd,true);}});return dfd;},addAttachment:function(_789,_78a,_78b,_78c){return this._sendAttachment("add",_789,_78a,_78b,_78c);},updateAttachment:function(_78d,_78e,_78f,_790,_791){_78f.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_78e}));return this._sendAttachment("update",_78d,_78f,_790,_791);},deleteAttachments:function(_792,_793,_794,_795){var url=this._url.path+"/"+_792+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_796={f:"json",attachmentIds:_793.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_796,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_797){var _798=_797.deleteAttachmentResults;_798=dojo.map(_798,function(_799){var res=new esri.layers.FeatureEditResult(_799);res.attachmentId=res.objectId;res.objectId=_792;return res;});self._resolve([_798],"onDeleteAttachmentsComplete",_794,dfd);}),error:function(err){self._resolve([err],null,_795,dfd,true);}},{usePost:true});return dfd;},addType:function(_79a){var _79b=this.types;if(_79b){var _79c=dojo.some(_79b,function(type){if(type.id==_79a.id){return true;}return false;});if(_79c){return false;}else{_79b.push(_79a);}}else{this.types=[_79a];}this._typesDirty=true;return true;},deleteType:function(_79d){if(!this._collection){return;}var _79e=this.types;if(_79e){var _79f=-1;dojo.some(_79e,function(type,_7a0){if(type.id==_79d){_79f=_7a0;return true;}return false;});if(_79f>-1){this._typesDirty=true;return _79e.splice(_79f,1)[0];}}},toJson:function(){var _7a1=this._json,json=dojo.isString(_7a1)?dojo.fromJson(_7a1):dojo.clone(_7a1);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _7a2=json.layerDefinition,_7a3=this._collection;if(_7a3&&this._typesDirty){_7a2.types=dojo.map(this.types||[],function(type){return type.toJson();});var _7a4=this.renderer,_7a5=_7a2.drawingInfo;if(_7a5&&_7a4&&_7a4.declaredClass.indexOf("TemporalRenderer")===-1){_7a5.renderer=_7a4.toJson();}}var _7a6=null;if(!(_7a3&&!this._fcAdded)){_7a6={geometryType:_7a2.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=dojo.mixin({},json.featureSet||{},_7a6);if(_7a3){json.nextObjectId=this._nextId;_7a2.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_7a7){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&esri.id&&esri.id._hasPortalSession()&&esri.id._doPortalSignIn(path)){esri.id.getCredential(path).then(function(){self._findCredential();_7a7.call(self);},function(){_7a7.call(self);});}else{_7a7.call(this);}},_updateCaps:function(){var _7a8=this._editable,_7a9=dojo.trim(this.capabilities||""),_7aa=dojo.map((_7a9?_7a9.split(","):[]),dojo.trim),caps=dojo.map((_7a9?_7a9.toLowerCase().split(","):[]),dojo.trim),_7ab=dojo.indexOf(caps,"editing"),cap,i,_7ac,_7ad={"Create":dojo.indexOf(caps,"create"),"Update":dojo.indexOf(caps,"update"),"Delete":dojo.indexOf(caps,"delete")};if(_7a8&&_7ab===-1){_7aa.push("Editing");}else{if(!_7a8&&_7ab>-1){_7ac=[_7ab];for(cap in _7ad){if(_7ad[cap]>-1){_7ac.push(_7ad[cap]);}}_7ac.sort();for(i=_7ac.length-1;i>=0;i--){_7aa.splice(_7ac[i],1);}}}this.capabilities=_7aa.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_7ae=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_7ae&&(_7ae.latestObservationRenderer||_7ae.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.initialize(map):mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_7af){var map=this._map;if(_7af&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_7b0){this._mapTimeExtent=_7b0;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_7b1){var _7b2=this._timeOffset,_7b3=this._timeOffsetUnits;return (_7b1&&_7b2&&_7b3)?_7b1.offset(-1*_7b2,_7b3):_7b1;},_getTimeOverlap:function(_7b4,_7b5){if(_7b4&&_7b5){return _7b4.intersection(_7b5);}else{return _7b4||_7b5;}},_getTimeFilter:function(_7b6){var _7b7=this.getTimeDefinition(),_7b8=null,_7b9;if(_7b7||_7b8){_7b9=this._getTimeOverlap(_7b7,_7b8);if(!_7b9){return [false];}}if(_7b6){_7b6=_7b9?this._getTimeOverlap(_7b6,_7b9):_7b6;if(!_7b6){return [false];}}else{_7b6=_7b9;}return [true,_7b6];},_getAttributeFilter:function(_7ba){var _7bb=this.getDefinitionExpression();if(_7ba){_7ba=_7bb?"("+_7bb+") AND ("+_7ba+")":_7ba;}else{_7ba=_7bb;}return _7ba;},_applyQueryFilters:function(_7bc){_7bc.where=this._getAttributeFilter(_7bc.where);_7bc.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _7bd=this._getTimeFilter(_7bc.timeExtent);if(!_7bd[0]){return false;}else{_7bc.timeExtent=_7bd[1];}}return true;},_add:function(_7be){var _7bf=this._selectionSymbol,attr=_7be.attributes,_7c0=this.visibilityField;if(_7bf&&this._isSelOnly){_7be.setSymbol(_7bf);}if(_7c0&&attr&&attr.hasOwnProperty(_7c0)){_7be[attr[_7c0]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_7c1){var _7c2=[],map=this._map;if(this._isTable||!map){return;}if(_7c1.text||(_7c1.where&&_7c1.where!==this.getDefinitionExpression())){return;}var _7c3=this._isSnapshot,_7c4=this._isSelOnly;var _7c5=_7c1.geometry;if(_7c5){if(!_7c4&&_7c1.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_7c5.type==="extent"&&(_7c3||map.extent.contains(_7c5)))){_7c2.push(1);}else{return;}}var ids=_7c1.objectIds;if(ids){if(_7c3){_7c2.push(2);}else{var len=ids.length,mode=this._mode,_7c6=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_7c6++;}}if(_7c6===len){_7c2.push(2);}else{return;}}}if(this.timeInfo){var _7c7=_7c1.timeExtent,_7c8=this._mapTimeExtent;if(_7c3){if(_7c7){_7c2.push(3);}}else{if(_7c4){if(_7c7){return;}}else{if(_7c8){if(dojo.indexOf(_7c2,2)!==-1){if(_7c7){_7c2.push(3);}}else{return;}}else{if(_7c2.length>0){if(_7c7){_7c2.push(3);}}else{if(_7c7){return;}}}}}}return _7c2.length>0?_7c2:null;},_doQuery:function(_7c9,_7ca,_7cb){var _7cc=[],mode=this._mode,_7cd=this.objectIdField,i,len,_7ce;if(dojo.indexOf(_7ca,2)!==-1){_7cc=[];var ids=_7c9.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_7cc.push(obj);}}if(_7cc.length===0){return [];}}if(dojo.indexOf(_7ca,1)!==-1){_7ce=_7cc.length>0?_7cc:this.graphics;len=_7ce.length;var _7cf=_7c9.geometry._normalize(null,true);_7cc=[];for(i=0;i<len;i++){var _7d0=_7ce[i],_7d1=_7d0.geometry;if(_7d1){if(this.normalization&&_7cf.length){if(_7cf[0].intersects(_7d1)||_7cf[1].intersects(_7d1)){_7cc.push(_7d0);}}else{if(_7cf.intersects(_7d1)){_7cc.push(_7d0);}}}}if(_7cc.length===0){return [];}}if(dojo.indexOf(_7ca,3)!==-1){if(this.timeInfo){_7ce=_7cc.length>0?_7cc:this.graphics;var time=_7c9.timeExtent,_7d2=this._filterByTime(_7ce,time.startTime,time.endTime);_7cc=_7d2.match;}}if(_7cb){return dojo.map(_7cc,function(obj){return obj.attributes[_7cd];},this);}else{return _7cc;}},_filterByTime:function(_7d3,_7d4,_7d5){var _7d6=this._startTimeField,_7d7=this._endTimeField,_7d8;if(!this._twoTimeFields){_7d8=_7d6||_7d7;}var _7d9=esri._isDefined,yea=[],nay=[],i,len=_7d3.length,_7da,_7db;_7d4=_7d4?_7d4.getTime():-Infinity;_7d5=_7d5?_7d5.getTime():Infinity;if(_7d8){for(i=0;i<len;i++){_7da=_7d3[i];_7db=_7da.attributes;var time=_7db[_7d8];if(time>=_7d4&&time<=_7d5){yea.push(_7da);}else{nay.push(_7da);}}}else{for(i=0;i<len;i++){_7da=_7d3[i];_7db=_7da.attributes;var _7dc=_7db[_7d6],end=_7db[_7d7];_7dc=_7d9(_7dc)?_7dc:-Infinity;end=_7d9(end)?end:Infinity;if((_7dc>=_7d4&&_7dc<=_7d5)||(end>=_7d4&&end<=_7d5)||(_7d4>=_7dc&&_7d5<=end)){yea.push(_7da);}else{nay.push(_7da);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_7dd,_7de,dfd,_7df){if(_7dd){this[_7dd].apply(this,args);}if(_7de){_7de.apply(null,args);}if(dfd){esri._resDfd(dfd,args,_7df);}},_getShallowClone:function(_7e0){var _7e1=new esri.tasks.Query(),prop;for(prop in _7e0){if(_7e0.hasOwnProperty(prop)){_7e1[prop]=_7e0[prop];}}return _7e1;},_query:function(type,_7e2,_7e3,_7e4,_7e5){var that=this,map=this._map,dfd=new dojo.Deferred(esri._dfdCanceller),_7e6=_7e3;var _7e7=function(_7e8,_7e9){if(!_7e9&&type==="execute"&&!that._isTable){var _7ea=_7e8.features,mode=that._mode,_7eb=that.objectIdField,il=_7ea.length,i;for(i=il-1;i>=0;i--){var oid=_7ea[i].attributes[_7eb];var _7ec=mode._getFeature(oid);if(_7ec){_7ea.splice(i,1,_7ec);}}}that._resolve([_7e8],_7e2,_7e4,dfd);};if(type!=="executeRelationshipQuery"){_7e6=this._getShallowClone(_7e3);_7e6.outFields=this._getOutFields();_7e6.returnGeometry=(!map&&_7e3.hasOwnProperty("returnGeometry"))?_7e3.returnGeometry:true;var _7ed;if(map){_7e6.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_7e6)){switch(type){case "execute":_7ed=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_7ed=[];break;case "executeForCount":_7ed=0;break;}_7e7(_7ed,true);return dfd;}var _7ee=this._canDoClientSideQuery(_7e6);if(_7ee){var _7ef=this._doQuery(_7e6,_7ee,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_7ed=new esri.tasks.FeatureSet();_7ed.features=_7ef;break;case "executeForIds":_7ed=_7ef;break;case "executeForCount":_7ed=_7ef.length;break;}_7e7(_7ed,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_7e5,dfd,true);return dfd;}if(this._ts){_7e6._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_7e6);temp.addCallbacks(_7e7,function(err){that._resolve([err],null,_7e5,dfd,true);});return dfd;},_convertFeaturesToJson:function(_7f0,_7f1,_7f2,_7f3){var json=[],_7f4=this._selectionSymbol,_7f5=this.visibilityField,i,_7f6,_7f7=this.objectIdField;if(this.loaded&&(_7f2||_7f3)){_7f6=dojo.filter(this.fields,function(_7f8){return (_7f8.editable===false)&&(!_7f3||(_7f8.name!==_7f7));});}for(i=0;i<_7f0.length;i++){var _7f9=_7f0[i],_7fa={},_7fb=_7f9.geometry,attr=_7f9.attributes,_7fc=_7f9.symbol;if(_7fb&&(!_7f3||!this.loaded||this.allowGeometryUpdates)){_7fa.geometry=_7fb.toJson();}if(_7f5){_7fa.attributes=attr=dojo.mixin({},attr);attr[_7f5]=_7f9.visible?1:0;}else{if(attr){_7fa.attributes=dojo.mixin({},attr);}}if(_7fa.attributes&&_7f6&&_7f6.length){dojo.forEach(_7f6,function(_7fd){delete _7fa.attributes[_7fd.name];});}if(_7fc&&(_7fc!==_7f4)){_7fa.symbol=_7fc.toJson();}json.push(_7fa);}return _7f1?json:dojo.toJson(json);},_selectHandler:function(_7fe,_7ff,_800,_801,dfd){var _802,ctor=this.constructor;switch(_7ff){case ctor.SELECTION_NEW:this.clearSelection(true);_802=true;break;case ctor.SELECTION_ADD:_802=true;break;case ctor.SELECTION_SUBTRACT:_802=false;break;}var i,_803=_7fe.features,mode=this._mode,_804=[],_805=this.objectIdField,_806,oid;if(_802){for(i=0;i<_803.length;i++){_806=_803[i];oid=_806.attributes[_805];var _807=mode._addFeatureIIf(oid,_806);_804.push(_807);this._selectFeatureIIf(oid,_807,mode);}}else{for(i=0;i<_803.length;i++){_806=_803[i];oid=_806.attributes[_805];this._unSelectFeatureIIf(oid,mode);var _808=mode._removeFeatureIIf(oid);_804.push(_808||_806);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_804,_7ff,_7fe.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_800,dfd);if(_7fe.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_809,mode){var _80a=this._selectedFeatures,_80b=_80a[oid];if(!_80b){mode._incRefCount(oid);_80a[oid]=_809;if(!this._isTable){this._setSelectSymbol(_809);}}return _80b||_809;},_unSelectFeatureIIf:function(oid,mode){var _80c=this._selectedFeatures[oid];if(_80c){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_80c);}}return _80c;},_isSelected:function(_80d){},_setSelectSymbol:function(_80e){var _80f=this._selectionSymbol;if(_80f&&!this._isSelOnly){_80e.setSymbol(_80f);}},_setUnSelectSymbol:function(_810){var _811=this._selectionSymbol;if(_811&&!this._isSelOnly){if(_811===_810.symbol){_810.setSymbol(null,true);}}},_getOutFields:function(){var _812=dojo.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_813,_814,arr){return !!_813&&(dojo.indexOf(arr,_813)===_814);});var _815=dojo.clone(this._outFields);if(_815){if(dojo.indexOf(_815,"*")!==-1){return _815;}dojo.forEach(_812,function(_816){if(dojo.indexOf(_815,_816)===-1){_815.push(_816);}});return _815;}else{return _812;}},_checkFields:function(_817){var _818=_817||this._getOutFields();dojo.forEach(_818,function(_819){if(_819==="*"){return;}if(!this._getField(_819)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_819},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_817&&!this._isTable&&!this._fserver&&!this._collection){var _81a=dojo.some(this.fields,function(_81b){return (_81b&&_81b.type==="esriFieldTypeGeometry")?true:false;});if(!_81a){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _81c=this.renderer;if(_81c&&this.fields.length>0){var _81d=dojo.filter([_81c,_81c.observationRenderer,_81c.latestObservationRenderer,_81c.trackRenderer],esri._isDefined);var _81e=[];dojo.forEach(_81d,function(rnd){var _81f,_820;_820=rnd.attributeField;if(_820&&!dojo.isFunction(_820)){_81f=!this._getField(_820)&&this._getField(_820,true);if(_81f){rnd.attributeField=_81f.name;}}_820=rnd.attributeField2;if(_820){_81f=!this._getField(_820)&&this._getField(_820,true);if(_81f){rnd.attributeField2=_81f.name;}}_820=rnd.attributeField3;if(_820){_81f=!this._getField(_820)&&this._getField(_820,true);if(_81f){rnd.attributeField3=_81f.name;}}if(!dojo.isFunction(rnd.attributeField)){_81e.push(rnd.attributeField);}_81e.push(rnd.attributeField2);_81e.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_81e,esri._isDefined);}},_getField:function(_821,_822){var _823=this.fields;if(_823.length===0){return null;}var _824;if(_822){_821=_821.toLowerCase();}dojo.some(_823,function(_825){var _826=false;if(_822){_826=(_825&&_825.name.toLowerCase()===_821)?true:false;}else{_826=(_825&&_825.name===_821)?true:false;}if(_826){_824=_825;}return _826;});return _824;},_getDateOpts:function(){if(!this._dtOpts){var _827=dojo.map(dojo.filter(this.fields,function(_828){return !!(_828&&_828.type==="esriFieldTypeDate");}),function(_829){return _829.name;});this._dtOpts={properties:_827};}return this._dtOpts;},_applyNormalized:function(_82a,_82b){if(_82a&&_82b){dojo.forEach(_82a,function(_82c,_82d){if(_82c&&_82b[_82d]){_82c.setGeometry(_82b[_82d]);}});}},_editHandler:function(_82e,adds,_82f,_830,_831,dfd){var _832=_82e.addResults,_833=_82e.updateResults,_834=_82e.deleteResults,i,_835,oid,_836,attr,_837=this.objectIdField,mode=this._mode,_838=this._isTable;var _839=this.editFieldsInfo,_83a=this._getOutFields()||[],_83b=_839&&_839.creatorField,_83c=_839&&_839.creationDateField,_83d=_839&&_839.editorField,_83e=_839&&_839.editDateField,_83f=_839&&_839.realm;if(dojo.indexOf(_83a,"*")===-1){if(_83b&&dojo.indexOf(_83a,_83b)===-1){_83b=null;}if(_83c&&dojo.indexOf(_83a,_83c)===-1){_83c=null;}if(_83d&&dojo.indexOf(_83a,_83d)===-1){_83d=null;}if(_83e&&dojo.indexOf(_83a,_83e)===-1){_83e=null;}}var _840=(_83c||_83e)?(new Date()).getTime():null,_841=(_83b||_83d)?this.getUserId():undefined;if(_841&&_83f){_841=_841+"@"+_83f;}if(_832){for(i=0;i<_832.length;i++){_832[i]=new esri.layers.FeatureEditResult(_832[i]);if(_838){continue;}_835=_832[i];if(_835.success){oid=_835.objectId;_836=adds[i];var gl=_836._graphicsLayer;if(gl&&gl!==this){gl.remove(_836);}attr=_836.attributes||{};attr[_837]=oid;if(_83b){attr[_83b]=_841;}if(_83d){attr[_83d]=_841;}if(_83c){attr[_83c]=_840;}if(_83e){attr[_83e]=_840;}_836.setAttributes(attr);if(mode._init){mode.drawFeature(_836);}}}}if(_833){for(i=0;i<_833.length;i++){_833[i]=new esri.layers.FeatureEditResult(_833[i]);if(_838){continue;}_835=_833[i];if(_835.success){oid=_835.objectId;_836=_82f[oid];var _842=mode._getFeature(oid);if(_842){if(_842.geometry!==_836.geometry){_842.setGeometry(esri.geometry.fromJson(_836.geometry.toJson()));}this._repaint(_842,oid);}_836=_842||_836;attr=_836.attributes||{};if(_83d){attr[_83d]=_841;}if(_83e){attr[_83e]=_840;}_836.setAttributes(attr);}}}if(_834){var _843=[];for(i=0;i<_834.length;i++){_834[i]=new esri.layers.FeatureEditResult(_834[i]);if(_838){continue;}_835=_834[i];if(_835.success){oid=_835.objectId;_836=mode._getFeature(oid);if(_836){if(this._unSelectFeatureIIf(oid,mode)){_843.push(_836);}_836._count=0;mode._removeFeatureIIf(oid);}}}if(_843.length>0){this.onSelectionComplete(_843,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_832,_833,_834],"onEditsComplete",_830,dfd);},_sendAttachment:function(type,_844,_845,_846,_847){var _848=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_844+"/"+_848,self=this;var dfd=esri.request({url:url,form:_845,content:dojo.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_849){var _84a=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_84b=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_84c=new esri.layers.FeatureEditResult(_849[_84a]);_84c.attachmentId=_84c.objectId;_84c.objectId=_844;self._resolve([_84c],_84b,_846);return _84c;}).addErrback(function(_84d){self._resolve([_84d],null,_847,null,true);});return dfd;},_repaint:function(_84e,oid,_84f){oid=esri._isDefined(oid)?oid:_84e.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_84e.setSymbol(_84e.symbol,_84f);}},_getKind:function(_850){var _851=this._trackManager;if(_851){return _851.isLatestObservation(_850)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _852=json.symbol;if(_852){this.symbol=esri.symbol.fromJson(_852);}var _853=json.domains,_854,i;var _855=this.domains={};for(_854 in _853){if(_853.hasOwnProperty(_854)){var _856=_853[_854];switch(_856.type){case "range":_855[_854]=new esri.layers.RangeDomain(_856);break;case "codedValue":_855[_854]=new esri.layers.CodedValueDomain(_856);break;case "inherited":_855[_854]=new esri.layers.InheritedDomain(_856);break;}}}var _857=json.templates;if(_857){var _858=this.templates=[];for(i=0;i<_857.length;i++){_858.push(new esri.layers.FeatureTemplate(_857[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _859,_85a=this.domains,_85b=this.templates,_85c=esri._sanitize;if(_85a){var _85d=json.domains={};for(_859 in _85a){if(_85a.hasOwnProperty(_859)){_85d[_859]=_85a[_859]&&_85a[_859].toJson();}}_85c(_85d);}if(_85b){json.templates=dojo.map(_85b,function(_85e){return _85e.toJson();});}return _85c(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _85f=json.prototype;this.prototype=new esri.Graphic(_85f.geometry,null,_85f.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_860){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _861=this._featureMap[oid];if(_861){_861._count++;}},_decRefCount:function(oid){var _862=this._featureMap[oid];if(_862){_862._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_863){var fmap=this._featureMap,_864=fmap[oid],_865=this.featureLayer;if(!_864){fmap[oid]=_863;_865._add(_863);_863._count=0;}return _864||_863;},_removeFeatureIIf:function(oid){var _866=this._featureMap[oid],_867=this.featureLayer;if(_866){if(_866._count){return;}delete this._featureMap[oid];_867._remove(_866);}return _866;},_clearIIf:function(){var i,_868=this.featureLayer,_869=_868.graphics,_86a=_868._selectedFeatures,_86b=_868.objectIdField;for(i=_869.length-1;i>=0;i--){var _86c=_869[i];var oid=_86c.attributes[_86b];if(oid in _86a){_86c._count=1;continue;}_86c._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _86d=this.featureLayer,_86e=_86d.graphics,_86f=show?"show":"hide",i,len=_86e.length;show=show&&_86d._ager;for(i=0;i<len;i++){var _870=_86e[i];_870[_86f]();if(show){_86d._repaint(_870);}}},_applyTimeFilter:function(_871){var _872=this.featureLayer;if(!_872.timeInfo||_872.suspended){return;}if(!_871){_872._fireUpdateStart();}var _873=_872._trackManager;if(_873){_873.clearTracks();}var defn=_872.getTimeDefinition(),_874=_872._getOffsettedTE(_872._mapTimeExtent);if(_874){_874=_872._getTimeOverlap(defn,_874);if(_874){var _875=_872._filterByTime(_872.graphics,_874.startTime,_874.endTime);if(_873){_873.addFeatures(_875.match);}dojo.forEach(_875.match,function(_876){var _877=_876._shape;if(!_876.visible){_876.show();_877=_876._shape;_877&&_877._moveToFront();}if(_872._ager&&_877){_872._repaint(_876);}});dojo.forEach(_875.noMatch,function(_878){if(_878.visible){_878.hide();}});}else{this._toggleVisibility(false);}}else{if(_873){_873.addFeatures(_872.graphics);}this._toggleVisibility(true);}if(_873){_873.moveLatestToFront();_873.drawTracks();}if(!_871){_872._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_879){this.featureLayer=_879;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_87a){this.featureLayer=_87a;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _87b=this.featureLayer;if(_87b._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_87c){var _87d=this.featureLayer,_87e=_87d.objectIdField,oid=_87c.attributes[_87e];this._addFeatureIIf(oid,_87c);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _87f=this.featureLayer;if(_87f._collection){_87f._fireUpdateStart();_87f._refresh(true);_87f._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_880){var id="_"+_880.name+_880.layerId+_880._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _881=this.featureLayer;if(_881._collection){return;}_881._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_882=this.featureLayer,_883=_882.getDefinitionExpression();var _884=new esri.tasks.Query();_884.outFields=_882._getOutFields();_884.where=_883||"1=1";_884.returnGeometry=true;_884.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_884.timeExtent=_882.getTimeDefinition();_884.maxAllowableOffset=_882._maxOffset;if(_882._ts){_884._ts=(new Date()).getTime();}var _885;if(_882._usePatch){_885=this._getRequestId(_882);this._cancelPendingRequest(null,_885);}_882._task.execute(_884,this._drawFeatures,this._queryErrorHandler,_885);},_drawFeatures:function(_886){this._purgeRequests();var _887=_886.features,_888=this.featureLayer,_889=_888.objectIdField,i,len=_887.length,_88a,oid;for(i=0;i<len;i++){_88a=_887[i];oid=_88a.attributes[_889];this._addFeatureIIf(oid,_88a);this._incRefCount(oid);}this._applyTimeFilter(true);_888._fireUpdateEnd(null,_886.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_886.exceededTransferLimit){_888.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _88b=this.featureLayer;_88b._errorHandler(err);_88b._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_88c){this.featureLayer=_88c;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_88d){var _88e=this._gridLayer,geom=_88d.geometry,_88f=[];if(!geom){return;}_88f=_88e.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _890=this._cellMap,i,cell,oid=_88d.attributes[this.featureLayer.objectIdField],_891,row,col;for(i=0;i<_88f.length;i++){cell=_88f[i];_891=cell.latticeID;row=cell.row;col=cell.col;if(_891){cell=(_890[_891]=(_890[_891]||cell));}else{_890[row]=_890[row]||{};cell=(_890[row][col]=(_890[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_88d);this._addFeatureIIf(oid,_88d);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_892=this.featureLayer;var _893=_892._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_893?_893.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_892._tileWidth,height:_892._tileHeight},{width:map.width,height:map.height},_893);this._ioQueue=[];if(!_892.suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=dojo.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);dojo.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _894=this.featureLayer,map=this.map;if(_894.suspended){return;}_894._fireUpdateStart();this._clearIIf();var _895=_894._trackManager;if(_895){_895.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_896,cell){var id="_"+_896.name+_896.layerId+_896._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_897){this._exceeds=false;var _898=this.featureLayer,map=this.map,_899=_897||map.extent,_89a=this._gridLayer.getCellsInExtent(_899,_898.latticeTiling),_89b=_89a.cells;if(!_898.isEditable()){var _89c=this._cellMap;_89b=dojo.filter(_89b,function(cell){if(cell.lattice){if(_89c[cell.latticeID]){return false;}}else{if(_89c[cell.row]&&_89c[cell.row][cell.col]){return false;}}return true;});}var _89d=_898._getOutFields(),_89e=_898.getDefinitionExpression(),time=_898._getOffsettedTE(_898._mapTimeExtent),_89f=_898._usePatch,_8a0=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_8a1,_8a2;this._pending=this._pending||0;for(i=0;i<_89b.length;i++){cell=_89b[i];_8a1=new esri.tasks.Query();_8a1.geometry=cell.extent||cell.lattice;_8a1.outFields=_89d;_8a1.where=_89e;if(_898.latticeTiling&&cell.extent){_8a1.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;}_8a1.returnGeometry=true;_8a1.timeExtent=time;_8a1.maxAllowableOffset=_898._maxOffset;if(_898._ts){_8a1._ts=(new Date()).getTime();}_8a2=null;if(_89f){_8a2=this._getRequestId(_898,cell);if(this._isPending(_8a2)){continue;}}this._pending++;_8a0.push(_898._task.execute(_8a1,function(){var _8a3=cell;return function(_8a4){func.apply(self,[_8a4,_8a3]);};}.call(this),this._queryErrorHandler,_8a2));}this._removeOldCells(_899);this._endCheck();},_drawFeatures:function(_8a5,cell){this._exceeds=this._exceeds||_8a5.exceededTransferLimit;this._finalizeIO();var _8a6=this.featureLayer,map=this.map,_8a7=map.extent,_8a8=cell.extent,row=cell.row,col=cell.col,_8a9=_8a6.objectIdField,_8aa=_8a5.features,_8ab=this._gridLayer,_8ac=this._cellMap,i,len,_8ad=cell.latticeID,_8ae=_8ad?_8ac[_8ad]:(_8ac[row]&&_8ac[row][col]);if((cell.resolution!=_8ab._resolution)||(_8ad?(_8ad!==_8ab.getLatticeID(_8a7)):(!_8ab.intersects(_8a8,_8a7)))){if(_8ae){this._removeCell(row,col,_8ad);}}else{if(_8ae){this._updateCell(_8ae,_8aa);}else{cell.features=_8aa;if(_8ad){_8ac[_8ad]=cell;}else{_8ac[row]=_8ac[row]||{};_8ac[row][col]=cell;}len=_8aa.length;for(i=0;i<len;i++){var _8af=_8aa[i];var oid=_8af.attributes[_8a9];this._addFeatureIIf(oid,_8af);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_8b0){if(this._pending===0){this._processIOQueue();var _8b1=this.featureLayer,_8b2=_8b1._trackManager;if(_8b2){_8b2.clearTracks();_8b2.addFeatures(_8b1.graphics);if(_8b1._ager){dojo.forEach(_8b1.graphics,function(_8b3){if(_8b3._shape){_8b1._repaint(_8b3);}});}_8b2.moveLatestToFront();_8b2.drawTracks();}this.featureLayer._fireUpdateEnd(_8b0&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_8b1.onQueryLimitExceeded();}}},_processIOQueue:function(_8b4){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_8b4){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_8b5){var _8b6=this._cellMap,_8b7=this._gridLayer,_8b8,_8b9;for(_8b8 in _8b6){if(_8b6[_8b8]){var row=_8b6[_8b8],_8ba=row.latticeID,_8bb=0,_8bc=0;if(_8ba){_8bb++;if(_8ba!==_8b7.getLatticeID(_8b5)){this._removeCell(null,null,_8ba);_8bc++;}}else{for(_8b9 in row){if(row[_8b9]){_8bb++;var _8bd=row[_8b9].extent;if(!_8b7.intersects(_8bd,_8b5)){this._removeCell(_8b8,_8b9);_8bc++;}}}}if(_8bc===_8bb){delete _8b6[_8b8];}}}},_updateCell:function(cell,_8be){var _8bf=this.featureLayer,_8c0=_8bf.objectIdField,_8c1=_8bf._selectedFeatures,i,len=_8be.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _8c2=_8be[i];var oid=_8c2.attributes[_8c0];var _8c3=this._addFeatureIIf(oid,_8c2);if(_8c3===_8c2){this._incRefCount(oid);cell.features.push(_8c3);}else{if(!(oid in _8c1)){_8c3.setGeometry(_8c2.geometry);_8c3.setAttributes(_8c2.attributes);}}}},_removeCell:function(row,col,_8c4){var _8c5=this._cellMap,_8c6=this.featureLayer,_8c7=_8c6.objectIdField;var cell=_8c4?_8c5[_8c4]:(_8c5[row]&&_8c5[row][col]);if(cell){if(_8c4){delete _8c5[_8c4];}else{delete _8c5[row][col];}var _8c8=cell.features,i;for(i=0;i<_8c8.length;i++){var _8c9=_8c8[i];var oid=_8c9.attributes[_8c7];this._decRefCount(oid);if(oid in _8c6._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_8ca,_8cb,_8cc,_8cd){this.origin=_8ca;this.cellWidth=_8cb.width;this.cellHeight=_8cb.height;this.mapWidth=_8cc.width;this.mapHeight=_8cc.height;this.srInfo=_8cd;},setResolution:function(_8ce){this._resolution=(_8ce.xmax-_8ce.xmin)/this.mapWidth;if(this.srInfo){var _8cf=Math.round((2*this.srInfo.valid[1])/this._resolution),_8d0=Math.round(_8cf/this.cellWidth);this._frameStats=[_8d0,0,_8d0-1];}},getCellCoordinates:function(_8d1){var res=this._resolution,_8d2=this.origin;return {row:Math.floor((_8d2.y-_8d1.y)/(this.cellHeight*res)),col:Math.floor((_8d1.x-_8d2.x)/(this.cellWidth*res))};},normalize:function(col){var _8d3=this._frameStats;if(_8d3){var _8d4=_8d3[0],m180=_8d3[1],p180=_8d3[2];if(col<m180){col=col%_8d4;col=col<m180?col+_8d4:col;}else{if(col>p180){col=col%_8d4;}}}return col;},intersects:function(_8d5,_8d6){var _8d7=this.srInfo;if(_8d7){return dojo.some(_8d6._getParts(_8d7),function(_8d8){return _8d5.intersects(_8d8.extent);});}else{return _8d5.intersects(_8d6);}},getCellExtent:function(row,col){var res=this._resolution,_8d9=this.origin,_8da=this.cellWidth,_8db=this.cellHeight;return new esri.geometry.Extent((col*_8da*res)+_8d9.x,_8d9.y-((row+1)*_8db*res),((col+1)*_8da*res)+_8d9.x,_8d9.y-(row*_8db*res),new esri.SpatialReference(_8d9.spatialReference.toJson()));},getLatticeID:function(_8dc){var _8dd=this.getCellCoordinates({x:_8dc.xmin,y:_8dc.ymax}),_8de=this.getCellCoordinates({x:_8dc.xmax,y:_8dc.ymin}),_8df=_8dd.row,_8e0=_8de.row,_8e1=this.normalize(_8dd.col),_8e2=this.normalize(_8de.col);return _8df+"_"+_8e0+"_"+_8e1+"_"+_8e2;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_8e3,_8e4){var _8e5=this.getCellCoordinates({x:_8e3.xmin,y:_8e3.ymax}),_8e6=this.getCellCoordinates({x:_8e3.xmax,y:_8e3.ymin}),_8e7=_8e5.row,_8e8=_8e6.row,_8e9=_8e5.col,_8ea=_8e6.col,_8eb=[],i,j,nj,_8ec=[],_8ed=[],len,xmin,xmax,ymin,ymax,_8ee=[],_8ef,_8f0;for(i=_8e7;i<=_8e8;i++){for(j=_8e9;j<=_8ea;j++){nj=this.normalize(j);_8e3=this.getCellExtent(i,nj);_8eb.push({row:i,col:nj,extent:_8e3,resolution:this._resolution});if(_8e4){_8ec.push(_8e3.xmin,_8e3.xmax);_8ed.push(_8e3.ymin,_8e3.ymax);}}}_8e9=this.normalize(_8e9);_8ea=this.normalize(_8ea);_8ec.sort(this.sorter);_8ed.sort(this.sorter);len=_8ec.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_8ec[i]===_8ec[i+1]){_8ec.splice(i,1);}}}len=_8ed.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_8ed[i]===_8ed[i+1]){_8ed.splice(i,1);}}}if(_8ec.length&&_8ed.length){xmin=_8ec[0];xmax=_8ec[_8ec.length-1];ymin=_8ed[0];ymax=_8ed[_8ed.length-1];len=_8ec.length;for(i=0;i<len;i++){_8ee.push([[_8ec[i],ymax],[_8ec[i],ymin]]);}len=_8ed.length;for(i=0;i<len;i++){_8ee.push([[xmin,_8ed[i]],[xmax,_8ed[i]]]);}_8ef=new esri.geometry.Polyline({paths:_8ee,spatialReference:this.origin.spatialReference.toJson()});_8f0=_8e7+"_"+_8e8+"_"+_8e9+"_"+_8ea;_8eb.push({latticeID:_8f0,lattice:_8ef,resolution:this._resolution});}return {minRow:_8e7,maxRow:_8e8,minCol:_8e9,maxCol:_8ea,cells:_8eb};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_8f1){this.layer=_8f1;this.trackMap={};},initialize:function(map){this.map=map;var _8f2=this.layer,_8f3=_8f2.renderer.trackRenderer;if(_8f3&&(_8f2.geometryType==="esriGeometryPoint")){var _8f4=(this.container=new esri.layers._GraphicsLayer({id:_8f2.id+"_tracks",_child:true}));_8f4.loaded=true;_8f4.onLoad(_8f4);_8f4._setMap(map,_8f2._div);_8f4.setRenderer(_8f3);}},addFeatures:function(_8f5){var tkid,_8f6=this.trackMap,_8f7=this.layer,_8f8=_8f7._trackIdField;dojo.forEach(_8f5,function(_8f9){var _8fa=_8f9.attributes;tkid=_8fa[_8f8];var ary=(_8f6[tkid]=(_8f6[tkid]||[]));ary.push(_8f9);});var _8fb=_8f7._startTimeField,_8fc=_8f7.objectIdField;var _8fd=function(a,b){var _8fe=a.attributes[_8fb],_8ff=b.attributes[_8fb];if(_8fe===_8ff){return (a.attributes[_8fc]<b.attributes[_8fc])?-1:1;}else{return (_8fe<_8ff)?-1:1;}};for(tkid in _8f6){_8f6[tkid].sort(_8fd);}},drawTracks:function(){var _900=this.container;if(!_900){return;}var _901=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_902,_903=this.layer._trackIdField,_904;for(tkid in _901){ary=_901[tkid];path=[];for(i=ary.length-1;i>=0;i--){_902=ary[i].geometry;if(_902){path.push([_902.x,_902.y]);}}_904={};_904[_903]=tkid;if(path.length>0){_900.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr}),null,_904));}}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_905){var _906=_905._shape;_906&&_906._moveToFront();this._repaint(_905,null,true);},this.layer);},getLatestObservations:function(){var _907=[];if(!this.layer.renderer.latestObservationRenderer){return _907;}var _908=this.trackMap,tkid;for(tkid in _908){var ary=_908[tkid];_907.push(ary[ary.length-1]);}return _907;},clearTracks:function(){var _909=this.getLatestObservations();this.trackMap={};var _90a=this.container;if(_90a){_90a.clear();}dojo.forEach(_909,function(_90b){this._repaint(_90b,null,true);},this.layer);},isLatestObservation:function(_90c){var _90d=this.layer._trackIdField;var _90e=this.trackMap[_90c.attributes[_90d]];if(_90e){return (_90e[_90e.length-1]===_90c);}return false;},destroy:function(){var _90f=this.container;if(_90f){_90f.clear();_90f._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});});},"*noref":1}});define("esri/dijit/editing/TemplatePicker-all",["dijit","dojo","dojox","dojo/require!esri/layers/FeatureLayer,esri/toolbars/draw,esri/toolbars/edit,esri/dijit/editing/TemplatePicker"],function(_910,dojo,_911){dojo.provide("esri.dijit.editing.TemplatePicker-all");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.toolbars.draw");dojo.require("esri.toolbars.edit");dojo.require("esri.dijit.editing.TemplatePicker");});