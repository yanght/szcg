//>>built
define("dgrid/extensions/Pagination",["../_StoreMixin","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/on","dojo/query","dojo/string","dojo/has","put-selector/put","dojo/i18n!./nls/pagination","dojo/_base/sniff","xstyle/css!../css/extensions/Pagination.css"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9){return _2("dgrid.extensions.Pagination",[_1],{rowsPerPage:10,pagingTextBox:false,previousNextArrows:true,firstLastArrows:false,pagingLinks:2,pageSizeOptions:[],showFooter:true,_currentPage:1,_total:0,buildRendering:function(){var _a=this;this.inherited(arguments);var _b=this.paginationNode=_8(this.footerNode,"div.dgrid-pagination"),_c=this.paginationStatusNode=_8(_b,"div.dgrid-status"),_d=this.pageSizeOptions;if(_d.length){var _e=_8(_b,"select.dgrid-page-size");for(var i=0;i<_d.length;i++){_8(_e,"option",_d[i],{value:_d[i]});}on(_e,"change",function(){_a.rowsPerPage=+_e.value;_a.gotoPage(1);});}_c.innerHTML=_6.substitute(_9.status,{start:1,end:1,total:0});var _f=this.paginationNavigationNode=_8(_b,"div.dgrid-navigation");var _f=this.paginationNavigationNode,_10=this._currentPage,_11=this.previousNextLinks,_12=this.pagingLinks,end=this._total/this.rowsPerPage,_13=this._pagingTextBoxHandle;if(this.firstLastArrows){_8(_f,"a[href=javascript:].dgrid-first","«");}if(this.previousNextArrows){_8(_f,"a[href=javascript:].dgrid-previous","‹");}var _a=this;this.paginationLinksNode=_8(_f,"span.dgrid-pagination-links");if(this.previousNextArrows){_8(_f,"a[href=javascript:].dgrid-next","›");}if(this.firstLastArrows){_8(_f,"a[href=javascript:].dgrid-last","»");}on(_f,"a:click",function(evt){var cls=this.className,_14,max;if(_a._isLoading||cls.indexOf("dgrid-page-disabled")>-1){return;}_14=_a._currentPage;max=Math.ceil(_a._total/_a.rowsPerPage);if(cls=="dgrid-page-link"){_a.gotoPage(+this.innerHTML,true);}if(cls=="dgrid-first"){_a.gotoPage(1);}else{if(cls=="dgrid-previous"){if(_14>1){_a.gotoPage(_14-1);}}else{if(cls=="dgrid-next"){if(_14<max){_a.gotoPage(_14+1);}}else{if(cls=="dgrid-last"){_a.gotoPage(max);}}}}});},_updateNavigation:function(_15){var _16=this,_17=this.paginationLinksNode,_18=this._currentPage,_19=this.pagingLinks,_1a=this.paginationNavigationNode,end=Math.ceil(this._total/this.rowsPerPage),_1b=this._pagingTextBoxHandle;function _1c(_1d){var _1e;if(_16.pagingTextBox&&_1d==_18){_1e=_8(_17,"input.dgrid-page-input[type=text][value=$]",_18);_16._pagingTextBoxHandle=on(_1e,"change",function(evt){var _1f=+this.value;if(!isNaN(_1f)&&_1f>0&&_1f<=end){_16.gotoPage(+this.value,true);}});}else{_1e=_8(_17,"a[href=javascript:]"+(_1d==_18?".dgrid-page-disabled":"")+".dgrid-page-link",_1d);}if(_1d==_18&&_15){_1e.focus();}};_1b&&_1b.remove();_17.innerHTML="";_5(".dgrid-first, .dgrid-previous",_1a).forEach(function(_20){_8(_20,(_18==1?".":"!")+"dgrid-page-disabled");});_5(".dgrid-last, .dgrid-next",_1a).forEach(function(_21){_8(_21,(_18==end?".":"!")+"dgrid-page-disabled");});if(_19){_1c(1);var _22=_18-_19;if(_22>2){_8(_17,"span.dgrid-page-skip","...");}else{_22=2;}for(var i=_22;i<Math.min(_18+_19+1,end);i++){_1c(i);}if(_18+_19+1<end){_8(_17,"span.dgrid-page-skip","...");}_1c(end);}else{if(_16.pagingTextBox){_1c(_18);}}},refresh:function(){if(!this.store){throw new Error("Pagination requires a store to operate.");}this.inherited(arguments);this.gotoPage(1);},gotoPage:function(_23,_24){var _25=this;this._trackError(function(){var _26=_25.rowsPerPage,_27=(_23-1)*_26,_28=_3.mixin(_25.get("queryOptions"),{start:_27,count:_26}),_29,_2a=_25.contentNode,_2b=_25._rowIdToObject,_2c=5+_25.id.length,r,_2d;for(r in _2b){_25.row(r.substr(_2c)).remove();}_25._rowIdToObject={};_2a.innerHTML="";_2d=_8(_2a,"div.dgrid-loading",_25.loadingMessage);_25._isLoading=true;_29=_25.store.query(_25.query,_28);return _4.when(_25.renderArray(_29,_2d,_28),function(trs){_8(_2d,"!");delete _25._isLoading;_25.bodyNode.scrollTop=0;_4.when(_29.total,function(_2e){_25.paginationStatusNode.innerHTML=_6.substitute(_9.status,{start:_27+1,end:Math.min(_2e,_27+_26),total:_2e});_25._total=_2e;_25._currentPage=_23;_25._updateNavigation(_24);});if(_7("ie")<7||(_7("ie")&&_7("quirks"))){_25.resize();}},function(_2f){delete _25._isLoading;throw _2f;});});}});});