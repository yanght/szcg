/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"dojox/charting/plot2d/Lines":function(){define("dojox/charting/plot2d/Lines",["dojo/_base/declare","./Default"],function(_1,_2){return _1("dojox.charting.plot2d.Lines",_2,{constructor:function(){this.opt.lines=true;}});});},"dojox/charting/plot2d/ClusteredBars":function(){define("dojox/charting/plot2d/ClusteredBars",["dojo/_base/declare","./Bars","./common"],function(_3,_4,dc){return _3("dojox.charting.plot2d.ClusteredBars",_4,{getBarProperties:function(){var f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt,this.series.length);return {gap:f.gap,height:f.size,thickness:f.size};}});});},"dojox/charting/plot2d/Areas":function(){define("dojox/charting/plot2d/Areas",["dojo/_base/declare","./Default"],function(_5,_6){return _5("dojox.charting.plot2d.Areas",_6,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});});},"dojox/lang/functional/array":function(){define("dojox/lang/functional/array",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","./lambda"],function(_7,_8,_9,df){var _a={};_8.mixin(df,{filter:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_7.global;f=df.lambda(f);var t=[],v,i,n;if(_8.isArray(a)){for(i=0,n=a.length;i<n;++i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){v=a.next();if(f.call(o,v,i++,a)){t.push(v);}}}else{for(i in a){if(!(i in _a)){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}}}return t;},forEach:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_7.global;f=df.lambda(f);var i,n;if(_8.isArray(a)){for(i=0,n=a.length;i<n;f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();f.call(o,a.next(),i++,a)){}}else{for(i in a){if(!(i in _a)){f.call(o,a[i],i,a);}}}}return o;},map:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_7.global;f=df.lambda(f);var t,n,i;if(_8.isArray(a)){t=new Array(n=a.length);for(i=0;i<n;t[i]=f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[];for(i=0;a.hasNext();t.push(f.call(o,a.next(),i++,a))){}}else{t=[];for(i in a){if(!(i in _a)){t.push(f.call(o,a[i],i,a));}}}}return t;},every:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_7.global;f=df.lambda(f);var i,n;if(_8.isArray(a)){for(i=0,n=a.length;i<n;++i){if(!f.call(o,a[i],i,a)){return false;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(!f.call(o,a.next(),i++,a)){return false;}}}else{for(i in a){if(!(i in _a)){if(!f.call(o,a[i],i,a)){return false;}}}}}return true;},some:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_7.global;f=df.lambda(f);var i,n;if(_8.isArray(a)){for(i=0,n=a.length;i<n;++i){if(f.call(o,a[i],i,a)){return true;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(f.call(o,a.next(),i++,a)){return true;}}}else{for(i in a){if(!(i in _a)){if(f.call(o,a[i],i,a)){return true;}}}}}return false;}});return df;});},"dojox/charting/Chart2D":function(){define("dojox/charting/Chart2D",["dojo/_base/kernel","dojo/_base/lang","..","./Chart","./axis2d/Default","./axis2d/Invisible","./plot2d/Default","./plot2d/Lines","./plot2d/Areas","./plot2d/Markers","./plot2d/MarkersOnly","./plot2d/Scatter","./plot2d/Stacked","./plot2d/StackedLines","./plot2d/StackedAreas","./plot2d/Columns","./plot2d/StackedColumns","./plot2d/ClusteredColumns","./plot2d/Bars","./plot2d/StackedBars","./plot2d/ClusteredBars","./plot2d/Grid","./plot2d/Pie","./plot2d/Bubble","./plot2d/Candlesticks","./plot2d/OHLC","./plot2d/Spider"],function(_b,_c,_d,_e){_b.deprecated("dojox.charting.Chart2D","Use dojox.charting.Chart instead and require all other components explicitly","2.0");return _c.setObject("dojox.charting.Chart2D",_e);});},"dojox/charting/Series":function(){define("dojox/charting/Series",["dojo/_base/lang","dojo/_base/declare","./Element"],function(_f,_10,_11){return _10("dojox.charting.Series",_11,{constructor:function(_12,_13,_14){_f.mixin(this,_14);if(typeof this.plot!="string"){this.plot="default";}this.update(_13);},clear:function(){this.dyn={};},update:function(_15){if(_f.isArray(_15)){this.data=_15;}else{this.source=_15;this.data=this.source.data;if(this.source.setSeriesObject){this.source.setSeriesObject(this);}}this.dirty=true;this.clear();}});});},"esri/layers/osm":function(){define(["dijit","dojo","dojox","dojo/require!esri/layers/tiled"],function(_16,_17,_18){_17.provide("esri.layers.osm");_17.require("esri.layers.tiled");_17.declare("esri.layers.OpenStreetMapLayer",esri.layers.TiledMapServiceLayer,{constructor:function(_19){this.spatialReference=new esri.SpatialReference({wkid:102100});this.tileInfo=new esri.layers.TileInfo({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-20037508.342787,y:20037508.342787},spatialReference:{wkid:102100},lods:[{level:0,scale:591657527.591555,resolution:156543.033928},{level:1,scale:295828763.795777,resolution:78271.5169639999},{level:2,scale:147914381.897889,resolution:39135.7584820001},{level:3,scale:73957190.948944,resolution:19567.8792409999},{level:4,scale:36978595.474472,resolution:9783.93962049996},{level:5,scale:18489297.737236,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:0.597164283559817}]});this.fullExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.initialExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.tileServers=(_19&&_19.tileServers)||["http://a.tile.openstreetmap.org","http://b.tile.openstreetmap.org","http://c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=_19?_19.displayLevels:null;this.copyright=(_19&&_19.copyright)||"Map data &copy; OpenStreetMap contributors, CC-BY-SA";this.loaded=true;this.onLoad(this);var _1a=_19&&_19.loadCallback;if(_1a){_1a(this);}},getTileUrl:function(_1b,row,col){return esri._getProxiedUrl(this.tileServers[row%this.serversLength]+"/"+_1b+"/"+col+"/"+row+".png");}});});},"esri/layers/KMLLayer":function(){define("esri/layers/KMLLayer",["dijit","dojo","dojox","dojo/require!esri/utils,esri/layers/layer,esri/layers/MapImageLayer,esri/layers/FeatureLayer,esri/dijit/Popup"],function(_1c,_1d,_1e){_1d.provide("esri.layers.KMLLayer");_1d.require("esri.utils");_1d.require("esri.layers.layer");_1d.require("esri.layers.MapImageLayer");_1d.require("esri.layers.FeatureLayer");_1d.require("esri.dijit.Popup");_1d.declare("esri.layers.KMLLayer",[esri.layers.Layer],{serviceUrl:"http://utility.arcgis.com/sharing/kml",constructor:function(url,_1f){if(!url){console.log("KMLLayer:constructor - please provide url for the KML file");}this._outSR=(_1f&&_1f.outSR)||new esri.SpatialReference({wkid:4326});this._options=_1f;if(esri.config.defaults.kmlService){this.serviceUrl=esri.config.defaults.kmlService;}var _20=(this.linkInfo=_1f&&_1f.linkInfo);if(_20){this.visible=!!_20.visibility;this._waitingForMap=!!_20.viewFormat;}if(!_20||(_20&&_20.visibility&&!this._waitingForMap)){this._parseKml();}this.refresh=_1d.hitch(this,this.refresh);},getFeature:function(_21){if(!_21){return;}var _22=_21.type,id=_21.id,_23,i,len;switch(_22){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":var _24=this["_"+_22];if(_24){_23=_1d.getObject("_mode._featureMap."+id,false,_24);}break;case "GroundOverlay":var _25=this._groundLyr;if(_25){var _26=_25.getImages();len=_26.length;for(i=0;i<len;i++){if(_26[i].id===id){_23=_26[i];break;}}}break;case "ScreenOverlay":break;case "NetworkLink":_1d.some(this._links,function(_27){if(_27.linkInfo&&_27.linkInfo.id===id){_23=_27;return true;}else{return false;}});break;case "Folder":var _28=this.folders;len=_28?_28.length:0;for(i=0;i<len;i++){if(_28[i].id===id){_23=_28[i];break;}}break;default:console.log("KMLLayer:getFeature - unknown feature type");break;}return _23;},getLayers:function(){var _29=[];if(this._groundLyr){_29.push(this._groundLyr);}if(this._fLayers){_29=_29.concat(this._fLayers);}if(this._links){_1d.forEach(this._links,function(_2a){if(_2a.declaredClass){_29.push(_2a);}});}return _29;},setFolderVisibility:function(_2b,_2c){if(!_2b){return;}this._fireUpdateStart();_2b.visible=_2c;if(_2c){_2c=this._areLocalAncestorsVisible(_2b);}this._setState(_2b,_2c);this._fireUpdateEnd();},onRefresh:function(){},_parseKml:function(map){var _2d=this;this._fireUpdateStart();this._io=esri.request({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(map),model:"simple",folders:"",refresh:this.loaded?true:undefined,outSR:_1d.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(_2e){_2d._io=null;_2d._initLayer(_2e);},error:function(err){_2d._io=null;err=_1d.mixin(new Error(),err);err.message="Unable to load KML: "+_2d.url+" "+(err.message||"");_2d._fireUpdateEnd(err);_2d.onError(err);}});},_initLayer:function(_2f){if(this.loaded){this._removeInternalLayers();}this.name=_2f.name;this.description=_2f.description;this.snippet=_2f.snippet;this.visibility=_2f.visibility;this.featureInfos=_2f.featureInfos;var i,len;var _30=(this.folders=_2f.folders),_31=[],_32;if(_30){len=_30.length;for(i=0;i<len;i++){_32=(_30[i]=new esri.layers.KMLFolder(_30[i]));if(_32.parentFolderId===-1){_31.push(_32);}}}var _33=(this._links=_2f.networkLinks),_34;len=_33?_33.length:0;for(i=0;i<len;i++){if(_33[i].viewRefreshMode&&_33[i].viewRefreshMode.toLowerCase().indexOf("onregion")!==-1){continue;}_34=_1d.mixin({},this._options);_34.linkInfo=_33[i];if(_34.id){_34.id=_34.id+"_"+i;}_33[i]=new esri.layers.KMLLayer(_33[i].href,_34);_33[i]._parentLayer=this;_33[i]._parentFolderId=this._getLinkParentId(_33[i].linkInfo.id);}var _35=_2f.groundOverlays;if(_35&&_35.length>0){_34=_1d.mixin({},this._options);if(_34.id){_34.id=_34.id+"_"+"mapImage";}var _36=(this._groundLyr=new esri.layers.MapImageLayer(_34));len=_35.length;for(i=0;i<len;i++){_36.addImage(new esri.layers.KMLGroundOverlay(_35[i]));}}var _37=_1d.getObject("featureCollection.layers",false,_2f);if(_37&&_37.length>0){this._fLayers=[];_1d.forEach(_37,function(_38,i){var _39=_1d.getObject("featureSet.features",false,_38),_3a;if(_39&&_39.length>0){_34=_1d.mixin({outFields:["*"],infoTemplate:_38.popupInfo?new esri.dijit.PopupTemplate(_38.popupInfo):null,editable:false},this._options);if(_34.id){_34.id=_34.id+"_"+i;}_38.layerDefinition.capabilities="Query,Data";_3a=new esri.layers.FeatureLayer(_38,_34);if(_3a.geometryType){this["_"+_3a.geometryType]=_3a;}this._fLayers.push(_3a);}},this);if(this._fLayers.length===0){delete this._fLayers;}}len=_31.length;for(i=0;i<len;i++){_32=_31[i];this._setState(_32,_32.visible);}this._fireUpdateEnd();if(this.loaded){this._addInternalLayers();this.onRefresh();}else{this.loaded=true;this.onLoad(this);}},_addInternalLayers:function(){var map=this._map;this._fireUpdateStart();if(this._links){_1d.forEach(this._links,function(_3b){if(_3b.declaredClass){map.addLayer(_3b);if(_3b._waitingForMap){_3b._waitingForMap=null;if(_3b.visible){_3b._parseKml(map);}else{_3b._wMap=map;}}}});}var _3c=map.spatialReference,_3d=this._outSR,_3e;if(!_3c.equals(_3d)){if(_3c.isWebMercator()&&_3d.wkid===4326){_3e=esri.geometry.geographicToWebMercator;}else{if(_3d.isWebMercator()&&_3c.wkid===4326){_3e=esri.geometry.webMercatorToGeographic;}else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return;}}}if(this._groundLyr){if(_3e){_1d.forEach(this._groundLyr.getImages(),function(_3f){_3f.extent=_3e(_3f.extent);});}map.addLayer(this._groundLyr);}var _40=this._fLayers;if(_40&&_40.length>0){_1d.forEach(_40,function(_41){if(_3e){var _42=_41.graphics,i,_43,len=_42?_42.length:0;for(i=0;i<len;i++){_43=_42[i].geometry;if(_43){_42[i].setGeometry(_3e(_43));}}}map.addLayer(_41);});}this.onVisibilityChange(this.visible);},_removeInternalLayers:function(){var map=this._map;if(this._links){_1d.forEach(this._links,function(_44){if(_44.declaredClass&&_44._io){_44._io.cancel();}});}if(map){_1d.forEach(this.getLayers(),map.removeLayer,map);}},_setState:function(_45,_46){var _47=_45.featureInfos,_48,_49,i,len=_47?_47.length:0,_4a=_46?"show":"hide";for(i=0;i<len;i++){_48=_47[i];_49=this.getFeature(_48);if(!_49){continue;}if(_48.type==="Folder"){this._setState(_49,_46&&_49.visible);}else{if(_48.type==="NetworkLink"){this._setInternalVisibility(_49,_46);}else{_49[_4a]();}}}},_areLocalAncestorsVisible:function(_4b){var _4c=_4b.parentFolderId,_4d=_4b.visible;while(_4d&&_4c!==-1){var _4e=this.getFeature({type:"Folder",id:_4c});_4d=_4d&&_4e.visible;_4c=_4e.parentFolderId;}return _4d;},_setInternalVisibility:function(_4f,_50){var _51=_4f._parentLayer,_52=_4f._parentFolderId;_50=_50&&_4f.visible;while(_50&&_51){_50=_50&&_51.visible;if(_52>-1){_50=_50&&_51._areLocalAncestorsVisible(_51.getFeature({type:"Folder",id:_52}));}_52=_51._parentFolderId;_51=_51._parentLayer;}this._setIntState(_4f,_50);},_setIntState:function(_53,_54){if(!_53){return;}_1d.forEach(_53.getLayers(),function(_55){if(_55.linkInfo){_53._setIntState(_55,_54&&_55.visible&&_53._areLocalAncestorsVisible(_53.getFeature({type:"Folder",id:_55._parentFolderId})));}else{_55.setVisibility(_54);}});},_getLinkParentId:function(id){var _56=-1;if(this.folders){_1d.some(this.folders,function(_57){if(_57.networkLinkIds&&_1d.indexOf(_57.networkLinkIds,id)!==-1){_56=_57.id;return true;}return false;});}return _56;},_checkAutoRefresh:function(){var _58=this.linkInfo;if(_58){if(this.visible){if(this.loaded&&this._map){var _59=_58.refreshMode,_5a=_58.refreshInterval,_5b=_58.viewRefreshMode,_5c=_58.viewRefreshTime;if(_59&&_59.toLowerCase().indexOf("oninterval")!==-1&&_5a>0){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,_5a*1000);}if(_5b&&_5b.toLowerCase().indexOf("onstop")!==-1&&_5c>0){if(!this._extChgHandle){this._extChgHandle=_1d.connect(this._map,"onExtentChange",this,this._extentChanged);}}}}else{this._stopAutoRefresh();_1d.disconnect(this._extChgHandle);delete this._extChgHandle;}}},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null;},_getQueryParameters:function(map){map=map||this._map;var _5d={},_5e=this.linkInfo,_5f=map&&map.extent,_60;if(this._url.query){_1d.mixin(_5d,this._url.query);_60=!!this._url.query.token;}if(esri.id&&!_60){var _61=esri.id.findCredential(this._url.path);if(_61){_5d.token=_61.token;}}if(_5e){var _62=_5e.viewFormat,_63=_5e.httpQuery,_64=_5e.viewBoundScale;if(_5f&&_62){var _65=_5f,_66=_5f,sr=_5f.spatialReference;if(sr){if(sr.isWebMercator()){_65=esri.geometry.webMercatorToGeographic(_5f);}else{if(sr.wkid===4326){_66=esri.geometry.geographicToWebMercator(_5f);}}}var _67=_65.getCenter(),_68=Math.max(_66.getWidth(),_66.getHeight());if(_64){_65=_65.expand(_64);}_62=_62.replace(/\[bboxWest\]/ig,_65.xmin).replace(/\[bboxEast\]/ig,_65.xmax).replace(/\[bboxSouth\]/ig,_65.ymin).replace(/\[bboxNorth\]/ig,_65.ymax).replace(/\[lookatLon\]/ig,_67.x).replace(/\[lookatLat\]/ig,_67.y).replace(/\[lookatRange\]/ig,_68).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,_67.x).replace(/\[lookatTerrainLat\]/ig,_67.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,_67.x).replace(/\[cameraLat\]/ig,_67.y).replace(/\[cameraAlt\]/ig,_68).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,map.width).replace(/\[vertPixels\]/ig,map.height).replace(/\[terrainEnabled\]/ig,0);_1d.mixin(_5d,_1d.queryToObject(_62));}if(_63){_63=_63.replace(/\[clientVersion\]/ig,esri.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,_1d.locale);_1d.mixin(_5d,_1d.queryToObject(_63));}}var _69=[],_6a;for(_6a in _5d){if(esri._isDefined(_5d[_6a])){_69.push(_6a+"="+_5d[_6a]);}}_69=_69.join("&");return _69?("?"+_69):"";},_setMap:function(map,_6b){this._map=map;var div=this._div=_1d.create("div",null,_6b);_1d.style(div,"position","absolute");this._addInternalLayers();return div;},_unsetMap:function(map,_6c){if(this._io){this._io.cancel();}this._stopAutoRefresh();_1d.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var div=this._div;if(div){_6c.removeChild(div);_1d.destroy(div);}this._map=this._wMap=this._div=null;},onVisibilityChange:function(_6d){if(!this.loaded){if(this.linkInfo&&_6d){if(!this._waitingForMap){this._parseKml(this._wMap);}}return;}this._fireUpdateStart();this._setInternalVisibility(this,_6d);this._checkAutoRefresh();this._fireUpdateEnd();},refresh:function(){if(!this.loaded||!this._map||this._io){return;}this._parseKml();},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,this.linkInfo.viewRefreshTime*1000);}});_1d.declare("esri.layers.KMLGroundOverlay",[esri.layers.MapImage],{constructor:function(_6e){if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});_1d.declare("esri.layers.KMLFolder",null,{constructor:function(_6f){_1d.mixin(this,_6f);if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});});},"dojox/charting/plot2d/Spider":function(){define("dojox/charting/plot2d/Spider",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/array","dojo/dom-geometry","dojo/_base/fx","dojo/fx","dojo/_base/sniff","./Base","./_PlotEvents","dojo/_base/Color","dojox/color/_base","./common","../axis2d/common","../scaler/primitive","dojox/gfx","dojox/gfx/matrix","dojox/gfx/fx","dojox/lang/functional","dojox/lang/utils","dojo/fx/easing"],function(_70,_71,hub,arr,_72,_73,_74,has,_75,_76,_77,_78,dc,da,_79,g,m,_7a,df,du,_7b){var _7c=0.2;var _7d=_71("dojox.charting.plot2d.Spider",[_75,_76],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:true,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:0.2,spiderOrigin:0.16,markerSize:3,spiderType:"polygon",animationType:_7b.backOut,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",fontColor:""},constructor:function(_7e,_7f){this.opt=_70.clone(this.defaultParams);du.updateWithObject(this.opt,_7f);du.updateWithPattern(this.opt,_7f,this.optionalParams);this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};},clear:function(){this.inherited(arguments);this.dyn=[];this.axes=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this;},setAxis:function(_80){if(_80){if(_80.opt.min!=undefined){this.datas[_80.name].min=_80.opt.min;}if(_80.opt.max!=undefined){this.datas[_80.name].max=_80.opt.max;}}return this;},addSeries:function(run){var _81=false;this.series.push(run);for(var key in run.data){var val=run.data[key],_82=this.datas[key];if(_82){_82.vlist.push(val);_82.min=Math.min(_82.min,val);_82.max=Math.max(_82.max,val);}else{var _83="__"+key;this.axes.push(_83);this[_83]=key;this.datas[key]={min:val,max:val,vlist:[val]};}}if(this.labelKey.length<=0){for(var key in run.data){this.labelKey.push(key);}}return this;},getSeriesStats:function(){return dc.collectSimpleStats(this.series);},render:function(dim,_84){if(!this.dirty){return this;}this.dirty=false;this.cleanGroup();var s=this.group,t=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length){return this;}var o=this.opt,ta=t.axis,rx=(dim.width-_84.l-_84.r)/2,ry=(dim.height-_84.t-_84.b)/2,r=Math.min(rx,ry),_85=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font)||"normal normal normal 7pt Tahoma",_86=o.axisFont||(ta.tick&&ta.tick.titleFont)||"normal normal normal 11pt Tahoma",_87=o.axisTickFontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"silver",_88=o.axisFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_89=o.axisColor||(ta.tick&&ta.tick.axisColor)||"silver",_8a=o.spiderColor||(ta.tick&&ta.tick.spiderColor)||"silver",_8b=o.axisWidth||(ta.stroke&&ta.stroke.width)||2,_8c=o.spiderWidth||(ta.stroke&&ta.stroke.width)||2,_8d=o.seriesWidth||(ta.stroke&&ta.stroke.width)||2,_8e=g.normalizedLength(g.splitFontString(_86).size),_8f=m._degToRad(o.startAngle),_90=_8f,_91,_92,_93,_94,_95,_96,_97,_98,_99,_9a,_9b,ro=o.spiderOrigin,dv=o.divisions>=3?o.divisions:3,ms=o.markerSize,spt=o.spiderType,at=o.animationType,_9c=o.labelOffset<-10?o.labelOffset:-10,_9d=0.2;if(o.labels){_94=arr.map(this.series,function(s){return s.name;},this);_95=df.foldl1(df.map(_94,function(_9e,i){var _9f=t.series.font;return g._base._getTextBox(_9e,{font:_9f}).w;},this),"Math.max(a, b)")/2;r=Math.min(rx-2*_95,ry-_8e)+_9c;_96=r-_9c;}if("radius" in o){r=o.radius;_96=r-_9c;}r/=(1+_9d);var _a0={cx:_84.l+rx,cy:_84.t+ry,r:r};for(var i=this.series.length-1;i>=0;i--){var _a1=this.series[i];if(!this.dirty&&!_a1.dirty){t.skip();continue;}_a1.cleanGroup();var run=_a1.data;if(run!==null){var len=this._getObjectLength(run);if(!_97||_97.length<=0){_97=[],_98=[],_9b=[];this._buildPoints(_97,len,_a0,r,_90,true);this._buildPoints(_98,len,_a0,r*ro,_90,true);this._buildPoints(_9b,len,_a0,_96,_90);if(dv>2){_99=[],_9a=[];for(var j=0;j<dv-2;j++){_99[j]=[];this._buildPoints(_99[j],len,_a0,r*(ro+(1-ro)*(j+1)/(dv-1)),_90,true);_9a[j]=r*(ro+(1-ro)*(j+1)/(dv-1));}}}}}var _a2=s.createGroup(),_a3={color:_89,width:_8b},_a4={color:_8a,width:_8c};for(var j=_97.length-1;j>=0;--j){var _a5=_97[j],st={x:_a5.x+(_a5.x-_a0.cx)*_9d,y:_a5.y+(_a5.y-_a0.cy)*_9d},nd={x:_a5.x+(_a5.x-_a0.cx)*_9d/2,y:_a5.y+(_a5.y-_a0.cy)*_9d/2};_a2.createLine({x1:_a0.cx,y1:_a0.cy,x2:st.x,y2:st.y}).setStroke(_a3);this._drawArrow(_a2,st,nd,_a3);}var _a6=s.createGroup();for(var j=_9b.length-1;j>=0;--j){var _a5=_9b[j],_a7=g._base._getTextBox(this.labelKey[j],{font:_86}).w||0,_a8=this.opt.htmlLabels&&g.renderer!="vml"?"html":"gfx",_a9=da.createText[_a8](this.chart,_a6,(!_72.isBodyLtr()&&_a8=="html")?(_a5.x+_a7-dim.width):_a5.x,_a5.y,"middle",this.labelKey[j],_86,_88);if(this.opt.htmlLabels){this.htmlElements.push(_a9);}}var _aa=s.createGroup();if(spt=="polygon"){_aa.createPolyline(_97).setStroke(_a4);_aa.createPolyline(_98).setStroke(_a4);if(_99.length>0){for(var j=_99.length-1;j>=0;--j){_aa.createPolyline(_99[j]).setStroke(_a4);}}}else{var _ab=this._getObjectLength(this.datas);_aa.createCircle({cx:_a0.cx,cy:_a0.cy,r:r}).setStroke(_a4);_aa.createCircle({cx:_a0.cx,cy:_a0.cy,r:r*ro}).setStroke(_a4);if(_9a.length>0){for(var j=_9a.length-1;j>=0;--j){_aa.createCircle({cx:_a0.cx,cy:_a0.cy,r:_9a[j]}).setStroke(_a4);}}}var _ac=s.createGroup(),len=this._getObjectLength(this.datas),k=0;for(var key in this.datas){var _ad=this.datas[key],min=_ad.min,max=_ad.max,_ae=max-min,end=_90+2*Math.PI*k/len;for(var i=0;i<dv;i++){var _af=min+_ae*i/(dv-1),_a5=this._getCoordinate(_a0,r*(ro+(1-ro)*i/(dv-1)),end);_af=this._getLabel(_af);var _a7=g._base._getTextBox(_af,{font:_85}).w||0,_a8=this.opt.htmlLabels&&g.renderer!="vml"?"html":"gfx";if(this.opt.htmlLabels){this.htmlElements.push(da.createText[_a8](this.chart,_ac,(!_72.isBodyLtr()&&_a8=="html")?(_a5.x+_a7-dim.width):_a5.x,_a5.y,"start",_af,_85,_87));}}k++;}this.chart.seriesShapes={};var _b0=[];for(var i=this.series.length-1;i>=0;i--){var _a1=this.series[i],run=_a1.data;if(run!==null){var _b1=[],k=0,_b2=[];for(var key in run){var _ad=this.datas[key],min=_ad.min,max=_ad.max,_ae=max-min,_b3=run[key],end=_90+2*Math.PI*k/len,_a5=this._getCoordinate(_a0,r*(ro+(1-ro)*(_b3-min)/_ae),end);_b1.push(_a5);_b2.push({sname:_a1.name,key:key,data:_b3});k++;}_b1[_b1.length]=_b1[0];_b2[_b2.length]=_b2[0];var _b4=this._getBoundary(_b1),_b5=t.next("spider",[o,_a1]),ts=_a1.group,f=g.normalizeColor(_b5.series.fill),sk={color:_b5.series.fill,width:_8d};f.a=o.seriesFillAlpha;_a1.dyn={fill:f,stroke:sk};var _b6=this.oldSeriePoints[_a1.name];var cs=this._createSeriesEntry(ts,(_b6||_98),_b1,f,sk,r,ro,ms,at);this.chart.seriesShapes[_a1.name]=cs;this.oldSeriePoints[_a1.name]=_b1;var po={element:"spider_poly",index:i,id:"spider_poly_"+_a1.name,run:_a1,plot:this,shape:cs.poly,parent:ts,brect:_b4,cx:_a0.cx,cy:_a0.cy,cr:r,f:f,s:s};this._connectEvents(po);var so={element:"spider_plot",index:i,id:"spider_plot_"+_a1.name,run:_a1,plot:this,shape:_a1.group};this._connectEvents(so);arr.forEach(cs.circles,function(c,i){var _b7=c.getShape(),co={element:"spider_circle",index:i,id:"spider_circle_"+_a1.name+i,run:_a1,plot:this,shape:c,parent:ts,tdata:_b2[i],cx:_b1[i].x,cy:_b1[i].y,f:f,s:s};this._connectEvents(co);},this);}}return this;},_createSeriesEntry:function(ts,_b8,sps,f,sk,r,ro,ms,at){var _b9=ts.createPolyline(_b8).setFill(f).setStroke(sk),_ba=[];for(var j=0;j<_b8.length;j++){var _bb=_b8[j],cr=ms;var _bc=ts.createCircle({cx:_bb.x,cy:_bb.y,r:cr}).setFill(f).setStroke(sk);_ba.push(_bc);}var _bd=arr.map(sps,function(np,j){var sp=_b8[j],_be=new _73.Animation({duration:1000,easing:at,curve:[sp.y,np.y]});var spl=_b9,sc=_ba[j];hub.connect(_be,"onAnimate",function(y){var _bf=spl.getShape();_bf.points[j].y=y;spl.setShape(_bf);var _c0=sc.getShape();_c0.cy=y;sc.setShape(_c0);});return _be;});var _c1=arr.map(sps,function(np,j){var sp=_b8[j],_c2=new _73.Animation({duration:1000,easing:at,curve:[sp.x,np.x]});var spl=_b9,sc=_ba[j];hub.connect(_c2,"onAnimate",function(x){var _c3=spl.getShape();_c3.points[j].x=x;spl.setShape(_c3);var _c4=sc.getShape();_c4.cx=x;sc.setShape(_c4);});return _c2;});var _c5=_74.combine(_bd.concat(_c1));_c5.play();return {group:ts,poly:_b9,circles:_ba};},plotEvent:function(o){var _c6=o.id?o.id:"default",a;if(_c6 in this.animations){a=this.animations[_c6];a.anim&&a.anim.stop(true);}else{a=this.animations[_c6]={};}if(o.element=="spider_poly"){if(!a.color){var _c7=o.shape.getFill();if(!_c7||!(_c7 instanceof _77)){return;}a.color={start:_c7,end:_c8(_c7)};}var _c9=a.color.start,end=a.color.end;if(o.type=="onmouseout"){var t=_c9;_c9=end;end=t;}a.anim=_7a.animateFill({shape:o.shape,duration:800,easing:_7b.backOut,color:{start:_c9,end:end}});a.anim.play();}else{if(o.element=="spider_circle"){var _ca,_cb,_cc=1.5;if(o.type=="onmouseover"){_ca=m.identity;_cb=_cc;var _cd={type:"rect"};_cd.x=o.cx;_cd.y=o.cy;_cd.w=_cd.h=1;var lt=this.chart.getCoords();_cd.x+=lt.x;_cd.y+=lt.y;_cd.x=Math.round(_cd.x);_cd.y=Math.round(_cd.y);this.aroundRect=_cd;var _ce=["after-centered","before-centered"];dc.doIfLoaded("dijit/Tooltip",_70.hitch(this,function(_cf){_cf.show(o.tdata.sname+"<br/>"+o.tdata.key+"<br/>"+o.tdata.data,this.aroundRect,_ce);}));}else{_ca=m.scaleAt(_cc,o.cx,o.cy);_cb=1/_cc;dc.doIfLoaded("dijit/Tooltip",_70.hitch(this,function(_d0){this.aroundRect&&_d0.hide(this.aroundRect);}));}var cs=o.shape.getShape(),_ca=m.scaleAt(_cc,cs.cx,cs.cy),_d1={shape:o.shape,duration:200,easing:_7b.backOut,transform:[{name:"scaleAt",start:[1,cs.cx,cs.cy],end:[_cb,cs.cx,cs.cy]},_ca]};a.anim=_7a.animateTransform(_d1);a.anim.play();}else{if(o.element=="spider_plot"){if(o.type=="onmouseover"&&!has("ie")){o.shape.moveToFront();}}}}},_getBoundary:function(_d2){var _d3=_d2[0].x,_d4=_d2[0].x,_d5=_d2[0].y,_d6=_d2[0].y;for(var i=0;i<_d2.length;i++){var _d7=_d2[i];_d3=Math.max(_d7.x,_d3);_d5=Math.max(_d7.y,_d5);_d4=Math.min(_d7.x,_d4);_d6=Math.min(_d7.y,_d6);}return {x:_d4,y:_d6,width:_d3-_d4,height:_d5-_d6};},_drawArrow:function(s,_d8,end,_d9){var len=Math.sqrt(Math.pow(end.x-_d8.x,2)+Math.pow(end.y-_d8.y,2)),sin=(end.y-_d8.y)/len,cos=(end.x-_d8.x)/len,_da={x:end.x+(len/3)*(-sin),y:end.y+(len/3)*cos},_db={x:end.x+(len/3)*sin,y:end.y+(len/3)*(-cos)};s.createPolyline([_d8,_da,_db]).setFill(_d9.color).setStroke(_d9);},_buildPoints:function(_dc,_dd,_de,_df,_e0,_e1){for(var i=0;i<_dd;i++){var end=_e0+2*Math.PI*i/_dd;_dc.push(this._getCoordinate(_de,_df,end));}if(_e1){_dc.push(this._getCoordinate(_de,_df,_e0+2*Math.PI));}},_getCoordinate:function(_e2,_e3,_e4){return {x:_e2.cx+_e3*Math.cos(_e4),y:_e2.cy+_e3*Math.sin(_e4)};},_getObjectLength:function(obj){var _e5=0;if(_70.isObject(obj)){for(var key in obj){_e5++;}}return _e5;},_getLabel:function(_e6){return dc.getLabel(_e6,this.opt.fixed,this.opt.precision);}});function _c8(_e7){var a=new _78.Color(_e7),x=a.toHsl();if(x.s==0){x.l=x.l<50?100:0;}else{x.s=100;if(x.l<50){x.l=75;}else{if(x.l>75){x.l=50;}else{x.l=x.l-50>75-x.l?50:75;}}}var _e7=_78.fromHsl(x);_e7.a=0.7;return _e7;};return _7d;});},"dojox/charting/Theme":function(){define("dojox/charting/Theme",["dojo/_base/lang","dojo/_base/declare","dojo/_base/Color","./SimpleTheme","dojox/color/_base","dojox/color/Palette","dojox/gfx/gradutils"],function(_e8,_e9,_ea,_eb,_ec,_ed){var _ee=_e9("dojox.charting.Theme",_eb,{});_e8.mixin(_ee,{defineColors:function(_ef){_ef=_ef||{};var l,c=[],n=_ef.num||5;if(_ef.colors){l=_ef.colors.length;for(var i=0;i<n;i++){c.push(_ef.colors[i%l]);}return c;}if(_ef.hue){var s=_ef.saturation||100,st=_ef.low||30,end=_ef.high||90;l=(end+st)/2;return _ed.generate(_ec.fromHsv(_ef.hue,s,l),"monochromatic").colors;}if(_ef.generator){return _ec.Palette.generate(_ef.base,_ef.generator).colors;}return c;},generateGradient:function(_f0,_f1,_f2){var _f3=_e8.delegate(_f0);_f3.colors=[{offset:0,color:_f1},{offset:1,color:_f2}];return _f3;},generateHslColor:function(_f4,_f5){_f4=new _ea(_f4);var hsl=_f4.toHsl(),_f6=_ec.fromHsl(hsl.h,hsl.s,_f5);_f6.a=_f4.a;return _f6;},generateHslGradient:function(_f7,_f8,_f9,_fa){_f7=new _ea(_f7);var hsl=_f7.toHsl(),_fb=_ec.fromHsl(hsl.h,hsl.s,_f9),_fc=_ec.fromHsl(hsl.h,hsl.s,_fa);_fb.a=_fc.a=_f7.a;return _ee.generateGradient(_f8,_fb,_fc);}});_ee.defaultMarkers=_eb.defaultMarkers;_ee.defaultColors=_eb.defaultColors;_ee.defaultTheme=_eb.defaultTheme;return _ee;});},"dojox/charting/axis2d/Invisible":function(){define("dojox/charting/axis2d/Invisible",["dojo/_base/lang","dojo/_base/declare","./Base","../scaler/linear","dojox/gfx","dojox/lang/utils"],function(_fd,_fe,_ff,lin,g,du){return _fe("dojox.charting.axis2d.Invisible",_ff,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1},constructor:function(_100,_101){this.opt=_fd.clone(this.defaultParams);du.updateWithObject(this.opt,_101);du.updateWithPattern(this.opt,_101,this.optionalParams);},dependOnData:function(){return !("min" in this.opt)||!("max" in this.opt);},clear:function(){delete this.scaler;delete this.ticks;this.dirty=true;return this;},initialized:function(){return "scaler" in this&&!(this.dirty&&this.dependOnData());},setWindow:function(_102,_103){this.scale=_102;this.offset=_103;return this.clear();},getWindowScale:function(){return "scale" in this?this.scale:1;},getWindowOffset:function(){return "offset" in this?this.offset:0;},calculate:function(min,max,span){if(this.initialized()){return this;}var o=this.opt;this.labels=o.labels;this.scaler=lin.buildScaler(min,max,span,o);var tsb=this.scaler.bounds;if("scale" in this){o.from=tsb.lower+this.offset;o.to=(tsb.upper-tsb.lower)/this.scale+o.from;if(!isFinite(o.from)||isNaN(o.from)||!isFinite(o.to)||isNaN(o.to)||o.to-o.from>=tsb.upper-tsb.lower){delete o.from;delete o.to;delete this.scale;delete this.offset;}else{if(o.from<tsb.lower){o.to+=tsb.lower-o.from;o.from=tsb.lower;}else{if(o.to>tsb.upper){o.from+=tsb.upper-o.to;o.to=tsb.upper;}}this.offset=o.from-tsb.lower;}this.scaler=lin.buildScaler(min,max,span,o);tsb=this.scaler.bounds;if(this.scale==1&&this.offset==0){delete this.scale;delete this.offset;}}return this;},getScaler:function(){return this.scaler;},getTicks:function(){return this.ticks;}});});},"esri/layers/MapImageLayer":function(){define("esri/layers/MapImageLayer",["dijit","dojo","dojox","dojo/require!esri/utils,esri/layers/layer,esri/geometry"],function(_104,dojo,_105){dojo.provide("esri.layers.MapImageLayer");dojo.require("esri.utils");dojo.require("esri.layers.layer");dojo.require("esri.geometry");dojo.declare("esri.layers.MapImageLayer",[esri.layers.Layer],{"-chains-":{constructor:"manual"},constructor:function(_106){this.inherited(arguments,[null,_106]);this._mapImages=[];var _107=dojo.hitch;this._panStart=_107(this,this._panStart);this._pan=_107(this,this._pan);this._extentChange=_107(this,this._extentChange);this._zoom=_107(this,this._zoom);this._zoomStart=_107(this,this._zoomStart);this._scale=_107(this,this._scale);this._resize=_107(this,this._resize);this.loaded=true;this.onLoad(this);},opacity:1,_transform:esri._getDOMAccessor("transform"),addImage:function(_108){var _109=this._mapImages.push(_108);_109=_109-1;_108._idx=_109;_108._layer=this;if(this._div){this._createImage(_108,_109);}},removeImage:function(_10a){if(_10a){var idx=_10a._idx,_10b=this._mapImages;if(_10b[idx]===_10a){delete _10b[idx];var node=_10a._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;if(node.parentNode){node.parentNode.removeChild(node);dojo.destroy(node);}}_10a._node=_10a._idx=_10a._layer=null;}}},removeAllImages:function(){var _10c=this._mapImages,i,len=_10c.length;for(i=0;i<len;i++){var _10d=_10c[i];if(_10d){this.removeImage(_10d);}}this._mapImages=[];},getImages:function(){var _10e=this._mapImages,_10f=[],i,len=_10e.length;for(i=0;i<len;i++){if(_10e[i]){_10f.push(_10e[i]);}}return _10f;},setOpacity:function(_110){if(this.opacity!=_110){this.onOpacityChange(this.opacity=_110);}},onOpacityChange:function(_111){var div=this._div,i,len,_112;if(div){if(!dojo.isIE||dojo.isIE>8){dojo.style(div,"opacity",_111);}else{_112=div.childNodes;len=_112.length;for(i=0;i<len;i++){dojo.style(_112[i],"opacity",_111);}}}},_createImage:function(_113,idx){var node=dojo.create("img");dojo.style(node,{position:"absolute"});if(dojo.isIE<=8){dojo.style(node,"opacity",this.opacity);}if(_113.rotation){var _114="rotate("+(360-_113.rotation)+"deg)";if(dojo.isIE<9){}else{dojo.style(node,this._transform,_114);dojo.style(node,"transform",_114);}}_113._node=node;node.e_idx=idx;node.e_layer=this;node.e_load=dojo.connect(node,"onload",esri.layers.MapImageLayer.prototype._imageLoaded);node.e_error=dojo.connect(node,"onerror",esri.layers.MapImageLayer.prototype._imageError);node.e_abort=dojo.connect(node,"onabort",esri.layers.MapImageLayer.prototype._imageError);node.src=_113.href;},_imageLoaded:function(evt,img){var node=img||evt.target||evt.currentTarget,self=node.e_layer,_115=self._mapImages[node.e_idx];if(self._map&&(self._map.__zooming||self._map.__panning)){self._standby.push(node);return;}self._clearEvents(node);if(!_115||_115._node!==node){return;}if(self._map){self._attach(_115);}},_imageError:function(evt){var node=evt.target||evt.currentTarget,self=node.e_layer,_116=self._mapImages[node.e_idx];self._clearEvents(node);if(_116){_116._node=null;}},_clearEvents:function(node){var _117=dojo.disconnect;_117(node.e_load);_117(node.e_error);_117(node.e_abort);node.e_load=node.e_error=node.e_abort=node.e_layer=null;},_attach:function(_118){var _119=_118.extent,_11a=_119.spatialReference,_11b=this._sr,div=this._div,node=_118._node,_11c=new esri.geometry.Point({x:_119.xmin,y:_119.ymin,spatialReference:_11a}),_11d=new esri.geometry.Point({x:_119.xmax,y:_119.ymax,spatialReference:_11a});if(!_11b.equals(_11a)){if(_11b.isWebMercator()&&_11a.wkid===4326){_11c=esri.geometry.geographicToWebMercator(_11c);_11d=esri.geometry.geographicToWebMercator(_11d);}else{if(_11a.isWebMercator()&&_11b.wkid===4326){_11c=esri.geometry.webMercatorToGeographic(_11c);_11d=esri.geometry.webMercatorToGeographic(_11d);}}}node.e_bl=_11c;node.e_tr=_11d;if(_118.visible){this._setPos(node,div._left,div._top);(this._active||div).appendChild(node);}},_setPos:function(node,_11e,_11f){var _120=node.e_bl,_121=node.e_tr,map=this._map;_120=map.toScreen(_120);_121=map.toScreen(_121);var left=_120.x-_11e,top=_121.y-_11f,_122=Math.abs(_121.x-_120.x),_123=Math.abs(_120.y-_121.y),css={width:_122+"px",height:_123+"px"},_124=this._mapImages[node.e_idx];if(map.navigationMode==="css-transforms"){css[esri._css.names.transform]=esri._css.translate(left,top)+(_124.rotation?(" "+esri._css.rotate(360-_124.rotation)):"");}else{css.left=left+"px";css.top=top+"px";}dojo.style(node,css);node.e_l=left;node.e_t=top;node.e_w=_122;node.e_h=_123;},_setMap:function(map,_125){this._map=map;this._sr=map.spatialReference;var div=this._div=dojo.create("div",null,_125),_126=esri._css.names,css={position:"absolute"},vd=map.__visibleDelta;if(!dojo.isIE||dojo.isIE>8){css.opacity=this.opacity;}if(map.navigationMode==="css-transforms"){css[_126.transform]=esri._css.translate(vd.x,vd.y);dojo.style(div,css);div._left=vd.x;div._top=vd.y;css={position:"absolute",width:map.width+"px",height:map.height+"px",overflow:"visible"};this._active=dojo.create("div",null,div);dojo.style(this._active,css);this._passive=dojo.create("div",null,div);dojo.style(this._passive,css);}else{div._left=0;div._top=0;dojo.style(div,css);}this._standby=[];var _127=this._mapImages,i,len=_127.length;for(i=0;i<len;i++){var _128=_127[i],node=_128._node;if(!node){this._createImage(_128,_128._idx);}}this.onVisibilityChange(this.visible);return div;},_unsetMap:function(map,_129){this._disconnect();var div=this._div;if(div){var _12a=this._mapImages,i,len=_12a.length;for(i=0;i<len;i++){var _12b=_12a[i];if(_12b){var node=_12b._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;}_12b._node=null;}}_129.removeChild(div);dojo.destroy(div);}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;},onVisibilityChange:function(_12c){var div=this._div;if(div){if(_12c){this._redraw();this._connect(this._map);esri.show(div);}else{this._disconnect();esri.hide(div);}}},_connect:function(map){if(!this._connections){var _12d=dojo.connect,_12e=(map.navigationMode==="css-transforms");this._connections=[_12d(map,"onPanStart",this._panStart),_12d(map,"onPan",this._pan),_12d(map,"onExtentChange",this._extentChange),_12e&&_12d(map,"onZoomStart",this._zoomStart),_12e?_12d(map,"onScale",this._scale):_12d(map,"onZoom",this._zoom),_12e&&_12d(map,"onResize",this._resize)];}},_disconnect:function(){if(this._connections){dojo.forEach(this._connections,dojo.disconnect);this._connections=null;}},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top;},_pan:function(_12f,_130){var div=this._div;div._left=this._panL+_130.x;div._top=this._panT+_130.y;if(this._map.navigationMode==="css-transforms"){dojo.style(div,esri._css.names.transform,esri._css.translate(div._left,div._top));}else{dojo.style(div,{left:div._left+"px",top:div._top+"px"});}},_extentChange:function(_131,_132,_133){if(_133){this._redraw(this._map.navigationMode==="css-transforms");}else{if(_132){this._pan(_131,_132);}}var i,_134=this._standby;if(_134&&_134.length){for(i=_134.length-1;i>=0;i--){this._imageLoaded(null,_134[i]);_134.splice(i,1);}}},_redraw:function(_135){if(_135){var _136=this._passive,_137=esri._css.names;dojo.style(_136,_137.transition,"none");this._moveImages(_136,this._active);dojo.style(_136,_137.transform,"none");}var div=this._active||this._div,_138=this._div._left,_139=this._div._top,i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];this._setPos(node,_138,_139);}},_zoom:function(_13a,_13b,_13c){var div=this._div,_13d=div._left,_13e=div._top,i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];var _13f=node.e_w*_13b,_140=node.e_h*_13b,_141=(_13c.x-_13d-node.e_l)*(_13f-node.e_w)/node.e_w,_142=(_13c.y-_13e-node.e_t)*(_140-node.e_h)/node.e_h;_141=isNaN(_141)?0:_141;_142=isNaN(_142)?0:_142;dojo.style(node,{left:(node.e_l-_141)+"px",top:(node.e_t-_142)+"px",width:_13f+"px",height:_140+"px"});}},_zoomStart:function(){this._moveImages(this._active,this._passive);},_moveImages:function(_143,dest){var _144=_143.childNodes,i,len=_144.length;if(len>0){for(i=len-1;i>=0;i--){dest.appendChild(_144[i]);}}},_scale:function(mtx,_145){var css={},_146=esri._css.names,_147=this._passive;dojo.style(_147,_146.transition,_145?"none":(_146.transformName+" "+esri.config.defaults.map.zoomDuration+"ms ease"));css[_146.transform]=esri._css.matrix(mtx);dojo.style(_147,_146.transform,esri._css.matrix(mtx));},_resize:function(_148,_149,_14a){dojo.style(this._active,{width:_149+"px",height:_14a+"px"});dojo.style(this._passive,{width:_149+"px",height:_14a+"px"});}});dojo.extend(esri.layers.MapImage,{visible:true,getLayer:function(){return this._layer;},getNode:function(){return this._node;},show:function(){if(!this.visible){this.visible=true;var node=this._node,_14b=this._layer,div;if(node){div=_14b&&_14b._div;if(div){_14b._setPos(node,div._left,div._top);(_14b._active||div).appendChild(node);}esri.show(node);}}},hide:function(){if(this.visible){this.visible=false;var node=this._node;if(node){esri.hide(node);if(node.parentNode){node.parentNode.removeChild(node);}}}}});});},"dojox/charting/plot2d/common":function(){define("dojox/charting/plot2d/common",["dojo/_base/lang","dojo/_base/array","dojo/_base/Color","dojox/gfx","dojox/lang/functional","../scaler/common"],function(lang,arr,_14c,g,df,sc){var _14d=lang.getObject("dojox.charting.plot2d.common",true);return lang.mixin(_14d,{doIfLoaded:sc.doIfLoaded,makeStroke:function(_14e){if(!_14e){return _14e;}if(typeof _14e=="string"||_14e instanceof _14c){_14e={color:_14e};}return g.makeParameters(g.defaultStroke,_14e);},augmentColor:function(_14f,_150){var t=new _14c(_14f),c=new _14c(_150);c.a=t.a;return c;},augmentStroke:function(_151,_152){var s=_14d.makeStroke(_151);if(s){s.color=_14d.augmentColor(s.color,_152);}return s;},augmentFill:function(fill,_153){var fc,c=new _14c(_153);if(typeof fill=="string"||fill instanceof _14c){return _14d.augmentColor(fill,_153);}return fill;},defaultStats:{vmin:Number.POSITIVE_INFINITY,vmax:Number.NEGATIVE_INFINITY,hmin:Number.POSITIVE_INFINITY,hmax:Number.NEGATIVE_INFINITY},collectSimpleStats:function(_154){var _155=lang.delegate(_14d.defaultStats);for(var i=0;i<_154.length;++i){var run=_154[i];for(var j=0;j<run.data.length;j++){if(run.data[j]!==null){if(typeof run.data[j]=="number"){var _156=_155.vmin,_157=_155.vmax;if(!("ymin" in run)||!("ymax" in run)){arr.forEach(run.data,function(val,i){if(val!==null){var x=i+1,y=val;if(isNaN(y)){y=0;}_155.hmin=Math.min(_155.hmin,x);_155.hmax=Math.max(_155.hmax,x);_155.vmin=Math.min(_155.vmin,y);_155.vmax=Math.max(_155.vmax,y);}});}if("ymin" in run){_155.vmin=Math.min(_156,run.ymin);}if("ymax" in run){_155.vmax=Math.max(_157,run.ymax);}}else{var _158=_155.hmin,_159=_155.hmax,_156=_155.vmin,_157=_155.vmax;if(!("xmin" in run)||!("xmax" in run)||!("ymin" in run)||!("ymax" in run)){arr.forEach(run.data,function(val,i){if(val!==null){var x="x" in val?val.x:i+1,y=val.y;if(isNaN(x)){x=0;}if(isNaN(y)){y=0;}_155.hmin=Math.min(_155.hmin,x);_155.hmax=Math.max(_155.hmax,x);_155.vmin=Math.min(_155.vmin,y);_155.vmax=Math.max(_155.vmax,y);}});}if("xmin" in run){_155.hmin=Math.min(_158,run.xmin);}if("xmax" in run){_155.hmax=Math.max(_159,run.xmax);}if("ymin" in run){_155.vmin=Math.min(_156,run.ymin);}if("ymax" in run){_155.vmax=Math.max(_157,run.ymax);}}break;}}}return _155;},calculateBarSize:function(_15a,opt,_15b){if(!_15b){_15b=1;}var gap=opt.gap,size=(_15a-2*gap)/_15b;if("minBarSize" in opt){size=Math.max(size,opt.minBarSize);}if("maxBarSize" in opt){size=Math.min(size,opt.maxBarSize);}size=Math.max(size,1);gap=(_15a-size*_15b)/2;return {size:size,gap:gap};},collectStackedStats:function(_15c){var _15d=lang.clone(_14d.defaultStats);if(_15c.length){_15d.hmin=Math.min(_15d.hmin,1);_15d.hmax=df.foldl(_15c,"seed, run -> Math.max(seed, run.data.length)",_15d.hmax);for(var i=0;i<_15d.hmax;++i){var v=_15c[0].data[i];v=v&&(typeof v=="number"?v:v.y);if(isNaN(v)){v=0;}_15d.vmin=Math.min(_15d.vmin,v);for(var j=1;j<_15c.length;++j){var t=_15c[j].data[i];t=t&&(typeof t=="number"?t:t.y);if(isNaN(t)){t=0;}v+=t;}_15d.vmax=Math.max(_15d.vmax,v);}}return _15d;},curve:function(a,_15e){var _15f=a.slice(0);if(_15e=="x"){_15f[_15f.length]=_15f[0];}var p=arr.map(_15f,function(item,i){if(i==0){return "M"+item.x+","+item.y;}if(!isNaN(_15e)){var dx=item.x-_15f[i-1].x,dy=_15f[i-1].y;return "C"+(item.x-(_15e-1)*(dx/_15e))+","+dy+" "+(item.x-(dx/_15e))+","+item.y+" "+item.x+","+item.y;}else{if(_15e=="X"||_15e=="x"||_15e=="S"){var p0,p1=_15f[i-1],p2=_15f[i],p3;var bz1x,bz1y,bz2x,bz2y;var f=1/6;if(i==1){if(_15e=="x"){p0=_15f[_15f.length-2];}else{p0=p1;}f=1/3;}else{p0=_15f[i-2];}if(i==(_15f.length-1)){if(_15e=="x"){p3=_15f[1];}else{p3=p2;}f=1/3;}else{p3=_15f[i+1];}var p1p2=Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y));var p0p2=Math.sqrt((p2.x-p0.x)*(p2.x-p0.x)+(p2.y-p0.y)*(p2.y-p0.y));var p1p3=Math.sqrt((p3.x-p1.x)*(p3.x-p1.x)+(p3.y-p1.y)*(p3.y-p1.y));var _160=p0p2*f;var _161=p1p3*f;if(_160>p1p2/2&&_161>p1p2/2){_160=p1p2/2;_161=p1p2/2;}else{if(_160>p1p2/2){_160=p1p2/2;_161=p1p2/2*p1p3/p0p2;}else{if(_161>p1p2/2){_161=p1p2/2;_160=p1p2/2*p0p2/p1p3;}}}if(_15e=="S"){if(p0==p1){_160=0;}if(p2==p3){_161=0;}}bz1x=p1.x+_160*(p2.x-p0.x)/p0p2;bz1y=p1.y+_160*(p2.y-p0.y)/p0p2;bz2x=p2.x-_161*(p3.x-p1.x)/p1p3;bz2y=p2.y-_161*(p3.y-p1.y)/p1p3;}}return "C"+(bz1x+","+bz1y+" "+bz2x+","+bz2y+" "+p2.x+","+p2.y);});return p.join(" ");},getLabel:function(_162,_163,_164){return sc.doIfLoaded("dojo/number",function(_165){return (_163?_165.format(_162,{places:_164}):_165.format(_162))||"";},function(){return _163?_162.toFixed(_164):_162.toString();});}});});},"dojox/gfx/shape":function(){define("dojox/gfx/shape",["./_base","dojo/_base/lang","dojo/_base/declare","dojo/_base/kernel","dojo/_base/sniff","dojo/_base/connect","dojo/_base/array","dojo/dom-construct","dojo/_base/Color","./matrix"],function(g,lang,_166,_167,has,_168,arr,_169,_16a,_16b){var _16c=g.shape={};var _16d={};var _16e={};_16c.register=function(s){var t=s.declaredClass.split(".").pop();var i=t in _16d?++_16d[t]:((_16d[t]=0));var uid=t+i;_16e[uid]=s;return uid;};_16c.byId=function(id){return _16e[id];};_16c.dispose=function(s){delete _16e[s.getUID()];};_16c.Shape=_166("dojox.gfx.shape.Shape",null,{constructor:function(){this.rawNode=null;this.shape=null;this.matrix=null;this.fillStyle=null;this.strokeStyle=null;this.bbox=null;this.parent=null;this.parentMatrix=null;var uid=_16c.register(this);this.getUID=function(){return uid;};},destroy:function(){_16c.dispose(this);},getNode:function(){return this.rawNode;},getShape:function(){return this.shape;},getTransform:function(){return this.matrix;},getFill:function(){return this.fillStyle;},getStroke:function(){return this.strokeStyle;},getParent:function(){return this.parent;},getBoundingBox:function(){return this.bbox;},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b){return null;}var m=this._getRealMatrix(),gm=_16b;return [gm.multiplyPoint(m,b.x,b.y),gm.multiplyPoint(m,b.x+b.width,b.y),gm.multiplyPoint(m,b.x+b.width,b.y+b.height),gm.multiplyPoint(m,b.x,b.y+b.height)];},getEventSource:function(){return this.rawNode;},setClip:function(clip){this.clip=clip;},getClip:function(){return this.clip;},setShape:function(_16f){this.shape=g.makeParameters(this.shape,_16f);this.bbox=null;return this;},setFill:function(fill){if(!fill){this.fillStyle=null;return this;}var f=null;if(typeof (fill)=="object"&&"type" in fill){switch(fill.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,fill);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,fill);break;case "pattern":f=g.makeParameters(g.defaultPattern,fill);break;}}else{f=g.normalizeColor(fill);}this.fillStyle=f;return this;},setStroke:function(_170){if(!_170){this.strokeStyle=null;return this;}if(typeof _170=="string"||lang.isArray(_170)||_170 instanceof _16a){_170={color:_170};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_170);s.color=g.normalizeColor(s.color);return this;},setTransform:function(_171){this.matrix=_16b.clone(_171?_16b.normalize(_171):_16b.identity);return this._applyTransform();},_applyTransform:function(){return this;},moveToFront:function(){var p=this.getParent();if(p){p._moveChildToFront(this);this._moveToFront();}return this;},moveToBack:function(){var p=this.getParent();if(p){p._moveChildToBack(this);this._moveToBack();}return this;},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(_172){return _172?this.setTransform([this.matrix,_172]):this;},applyLeftTransform:function(_173){return _173?this.setTransform([_173,this.matrix]):this;},applyTransform:function(_174){return _174?this.setTransform([this.matrix,_174]):this;},removeShape:function(_175){if(this.parent){this.parent.remove(this,_175);}return this;},_setParent:function(_176,_177){this.parent=_176;return this._updateParentMatrix(_177);},_updateParentMatrix:function(_178){this.parentMatrix=_178?_16b.clone(_178):null;return this._applyTransform();},_getRealMatrix:function(){var m=this.matrix;var p=this.parent;while(p){if(p.matrix){m=_16b.multiply(p.matrix,m);}p=p.parent;}return m;}});_16c._eventsProcessing={connect:function(name,_179,_17a){return _168.connect(this.getEventSource(),name,_16c.fixCallback(this,g.fixTarget,_179,_17a));},disconnect:function(_17b){_168.disconnect(_17b);}};_16c.fixCallback=function(_17c,_17d,_17e,_17f){if(!_17f){_17f=_17e;_17e=null;}if(lang.isString(_17f)){_17e=_17e||_167.global;if(!_17e[_17f]){throw (["dojox.gfx.shape.fixCallback: scope[\"",_17f,"\"] is null (scope=\"",_17e,"\")"].join(""));}return function(e){return _17d(e,_17c)?_17e[_17f].apply(_17e,arguments||[]):undefined;};}return !_17e?function(e){return _17d(e,_17c)?_17f.apply(_17e,arguments):undefined;}:function(e){return _17d(e,_17c)?_17f.apply(_17e,arguments||[]):undefined;};};lang.extend(_16c.Shape,_16c._eventsProcessing);_16c.Container={_init:function(){this.children=[];},openBatch:function(){},closeBatch:function(){},add:function(_180){var _181=_180.getParent();if(_181){_181.remove(_180,true);}this.children.push(_180);return _180._setParent(this,this._getRealMatrix());},remove:function(_182,_183){for(var i=0;i<this.children.length;++i){if(this.children[i]==_182){if(_183){}else{_182.parent=null;_182.parentMatrix=null;}this.children.splice(i,1);break;}}return this;},clear:function(_184){var _185;for(var i=0;i<this.children.length;++i){_185=this.children[i];_185.parent=null;_185.parentMatrix=null;if(_184){_185.destroy();}}this.children=[];return this;},getBoundingBox:function(){if(this.children){var _186=null;arr.forEach(this.children,function(_187){var bb=_187.getBoundingBox();if(bb){var ct=_187.getTransform();if(ct){bb=_16b.multiplyRectangle(ct,bb);}if(_186){_186.x=Math.min(_186.x,bb.x);_186.y=Math.min(_186.y,bb.y);_186.endX=Math.max(_186.endX,bb.x+bb.width);_186.endY=Math.max(_186.endY,bb.y+bb.height);}else{_186={x:bb.x,y:bb.y,endX:bb.x+bb.width,endY:bb.y+bb.height};}}});if(_186){_186.width=_186.endX-_186.x;_186.height=_186.endY-_186.y;}return _186;}return null;},_moveChildToFront:function(_188){for(var i=0;i<this.children.length;++i){if(this.children[i]==_188){this.children.splice(i,1);this.children.push(_188);break;}}return this;},_moveChildToBack:function(_189){for(var i=0;i<this.children.length;++i){if(this.children[i]==_189){this.children.splice(i,1);this.children.unshift(_189);break;}}return this;}};_16c.Surface=_166("dojox.gfx.shape.Surface",null,{constructor:function(){this.rawNode=null;this._parent=null;this._nodes=[];this._events=[];},destroy:function(){arr.forEach(this._nodes,_169.destroy);this._nodes=[];arr.forEach(this._events,_168.disconnect);this._events=[];this.rawNode=null;if(has("ie")){while(this._parent.lastChild){_169.destroy(this._parent.lastChild);}}else{this._parent.innerHTML="";}this._parent=null;},getEventSource:function(){return this.rawNode;},_getRealMatrix:function(){return null;},isLoaded:true,onLoad:function(_18a){},whenLoaded:function(_18b,_18c){var f=lang.hitch(_18b,_18c);if(this.isLoaded){f(this);}else{var h=_168.connect(this,"onLoad",function(_18d){_168.disconnect(h);f(_18d);});}}});lang.extend(_16c.Surface,_16c._eventsProcessing);_16c.Rect=_166("dojox.gfx.shape.Rect",_16c.Shape,{constructor:function(_18e){this.shape=g.getDefault("Rect");this.rawNode=_18e;},getBoundingBox:function(){return this.shape;}});_16c.Ellipse=_166("dojox.gfx.shape.Ellipse",_16c.Shape,{constructor:function(_18f){this.shape=g.getDefault("Ellipse");this.rawNode=_18f;},getBoundingBox:function(){if(!this.bbox){var _190=this.shape;this.bbox={x:_190.cx-_190.rx,y:_190.cy-_190.ry,width:2*_190.rx,height:2*_190.ry};}return this.bbox;}});_16c.Circle=_166("dojox.gfx.shape.Circle",_16c.Shape,{constructor:function(_191){this.shape=g.getDefault("Circle");this.rawNode=_191;},getBoundingBox:function(){if(!this.bbox){var _192=this.shape;this.bbox={x:_192.cx-_192.r,y:_192.cy-_192.r,width:2*_192.r,height:2*_192.r};}return this.bbox;}});_16c.Line=_166("dojox.gfx.shape.Line",_16c.Shape,{constructor:function(_193){this.shape=g.getDefault("Line");this.rawNode=_193;},getBoundingBox:function(){if(!this.bbox){var _194=this.shape;this.bbox={x:Math.min(_194.x1,_194.x2),y:Math.min(_194.y1,_194.y2),width:Math.abs(_194.x2-_194.x1),height:Math.abs(_194.y2-_194.y1)};}return this.bbox;}});_16c.Polyline=_166("dojox.gfx.shape.Polyline",_16c.Shape,{constructor:function(_195){this.shape=g.getDefault("Polyline");this.rawNode=_195;},setShape:function(_196,_197){if(_196&&_196 instanceof Array){this.inherited(arguments,[{points:_196}]);if(_197&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.inherited(arguments,[_196]);}return this;},_normalizePoints:function(){var p=this.shape.points,l=p&&p.length;if(l&&typeof p[0]=="number"){var _198=[];for(var i=0;i<l;i+=2){_198.push({x:p[i],y:p[i+1]});}this.shape.points=_198;}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){var p=this.shape.points;var l=p.length;var t=p[0];var bbox={l:t.x,t:t.y,r:t.x,b:t.y};for(var i=1;i<l;++i){t=p[i];if(bbox.l>t.x){bbox.l=t.x;}if(bbox.r<t.x){bbox.r=t.x;}if(bbox.t>t.y){bbox.t=t.y;}if(bbox.b<t.y){bbox.b=t.y;}}this.bbox={x:bbox.l,y:bbox.t,width:bbox.r-bbox.l,height:bbox.b-bbox.t};}return this.bbox;}});_16c.Image=_166("dojox.gfx.shape.Image",_16c.Shape,{constructor:function(_199){this.shape=g.getDefault("Image");this.rawNode=_199;},getBoundingBox:function(){return this.shape;},setStroke:function(){return this;},setFill:function(){return this;}});_16c.Text=_166(_16c.Shape,{constructor:function(_19a){this.fontStyle=null;this.shape=g.getDefault("Text");this.rawNode=_19a;},getFont:function(){return this.fontStyle;},setFont:function(_19b){this.fontStyle=typeof _19b=="string"?g.splitFontString(_19b):g.makeParameters(g.defaultFont,_19b);this._setFont();return this;}});_16c.Creator={createShape:function(_19c){switch(_19c.type){case g.defaultPath.type:return this.createPath(_19c);case g.defaultRect.type:return this.createRect(_19c);case g.defaultCircle.type:return this.createCircle(_19c);case g.defaultEllipse.type:return this.createEllipse(_19c);case g.defaultLine.type:return this.createLine(_19c);case g.defaultPolyline.type:return this.createPolyline(_19c);case g.defaultImage.type:return this.createImage(_19c);case g.defaultText.type:return this.createText(_19c);case g.defaultTextPath.type:return this.createTextPath(_19c);}return null;},createGroup:function(){return this.createObject(g.Group);},createRect:function(rect){return this.createObject(g.Rect,rect);},createEllipse:function(_19d){return this.createObject(g.Ellipse,_19d);},createCircle:function(_19e){return this.createObject(g.Circle,_19e);},createLine:function(line){return this.createObject(g.Line,line);},createPolyline:function(_19f){return this.createObject(g.Polyline,_19f);},createImage:function(_1a0){return this.createObject(g.Image,_1a0);},createText:function(text){return this.createObject(g.Text,text);},createPath:function(path){return this.createObject(g.Path,path);},createTextPath:function(text){return this.createObject(g.TextPath,{}).setText(text);},createObject:function(_1a1,_1a2){return null;}};return _16c;});},"dojox/charting/action2d/Tooltip":function(){define("dojox/charting/action2d/Tooltip",["dojo/_base/kernel","dijit/Tooltip","dojo/_base/lang","dojo/_base/declare","dojo/dom-style","./PlotAction","dojox/gfx/matrix","dojox/lang/functional","dojox/lang/functional/scan","dojox/lang/functional/fold"],function(dojo,_1a3,lang,_1a4,_1a5,_1a6,m,df,dfs,dff){var _1a7=function(o){var t=o.run&&o.run.data&&o.run.data[o.index];if(t&&typeof t!="number"&&(t.tooltip||t.text)){return t.tooltip||t.text;}if(o.element=="candlestick"){return "<table cellpadding=\"1\" cellspacing=\"0\" border=\"0\" style=\"font-size:0.9em;\">"+"<tr><td>Open:</td><td align=\"right\"><strong>"+o.data.open+"</strong></td></tr>"+"<tr><td>High:</td><td align=\"right\"><strong>"+o.data.high+"</strong></td></tr>"+"<tr><td>Low:</td><td align=\"right\"><strong>"+o.data.low+"</strong></td></tr>"+"<tr><td>Close:</td><td align=\"right\"><strong>"+o.data.close+"</strong></td></tr>"+(o.data.mid!==undefined?"<tr><td>Mid:</td><td align=\"right\"><strong>"+o.data.mid+"</strong></td></tr>":"")+"</table>";}return o.element=="bar"?o.x:o.y;};var pi4=Math.PI/4,pi2=Math.PI/2;return _1a4("dojox.charting.action2d.Tooltip",_1a6,{defaultParams:{text:_1a7},optionalParams:{},constructor:function(_1a8,plot,_1a9){this.text=_1a9&&_1a9.text?_1a9.text:_1a7;this.connect();},process:function(o){if(o.type==="onplotreset"||o.type==="onmouseout"){_1a3.hide(this.aroundRect);this.aroundRect=null;if(o.type==="onplotreset"){delete this.angles;}return;}if(!o.shape||o.type!=="onmouseover"){return;}var _1aa={type:"rect"},_1ab=["after-centered","before-centered"];switch(o.element){case "marker":_1aa.x=o.cx;_1aa.y=o.cy;_1aa.w=_1aa.h=1;break;case "circle":_1aa.x=o.cx-o.cr;_1aa.y=o.cy-o.cr;_1aa.w=_1aa.h=2*o.cr;break;case "spider_circle":_1aa.x=o.cx;_1aa.y=o.cy;_1aa.w=_1aa.h=1;break;case "spider_plot":return;case "column":_1ab=["above-centered","below-centered"];case "bar":_1aa=lang.clone(o.shape.getShape());_1aa.w=_1aa.width;_1aa.h=_1aa.height;break;case "candlestick":_1aa.x=o.x;_1aa.y=o.y;_1aa.w=o.width;_1aa.h=o.height;break;default:if(!this.angles){if(typeof o.run.data[0]=="number"){this.angles=df.map(df.scanl(o.run.data,"+",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"+",0));}else{this.angles=df.map(df.scanl(o.run.data,"a + b.y",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"a + b.y",0));}}var _1ac=m._degToRad(o.plot.opt.startAngle),_1ad=(this.angles[o.index]+this.angles[o.index+1])/2+_1ac;_1aa.x=o.cx+o.cr*Math.cos(_1ad);_1aa.y=o.cy+o.cr*Math.sin(_1ad);_1aa.w=_1aa.h=1;if(_1ad<pi4){}else{if(_1ad<pi2+pi4){_1ab=["below-centered","above-centered"];}else{if(_1ad<Math.PI+pi4){_1ab=["before-centered","after-centered"];}else{if(_1ad<2*Math.PI-pi4){_1ab=["above-centered","below-centered"];}}}}break;}var lt=this.chart.getCoords();_1aa.x+=lt.x;_1aa.y+=lt.y;_1aa.x=Math.round(_1aa.x);_1aa.y=Math.round(_1aa.y);_1aa.w=Math.ceil(_1aa.w);_1aa.h=Math.ceil(_1aa.h);this.aroundRect=_1aa;var _1ae=this.text(o);if(this.chart.getTextDir){var _1af=(_1a5.get(this.chart.node,"direction")=="rtl");var _1b0=(this.chart.getTextDir(_1ae)=="rtl");}if(_1ae){if(_1b0&&!_1af){_1a3.show("<span dir = 'rtl'>"+_1ae+"</span>",this.aroundRect,_1ab);}else{if(!_1b0&&_1af){_1a3.show("<span dir = 'ltr'>"+_1ae+"</span>",this.aroundRect,_1ab);}else{_1a3.show(_1ae,this.aroundRect,_1ab);}}}}});});},"dojox/charting/plot2d/Grid":function(){define("dojox/charting/plot2d/Grid",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/array","./CartesianBase","./common","dojox/lang/utils","dojox/gfx/fx"],function(lang,_1b1,hub,arr,_1b2,dc,du,fx){return _1b1("dojox.charting.plot2d.Grid",_1b2,{defaultParams:{hAxis:"x",vAxis:"y",hMajorLines:true,hMinorLines:false,vMajorLines:true,vMinorLines:false,hStripes:false,vStripes:false,animate:null,enableCache:false,renderOnAxis:true},optionalParams:{majorHLine:{},minorHLine:{},majorVLine:{},minorVLine:{}},constructor:function(_1b3,_1b4){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_1b4);du.updateWithPattern(this.opt,_1b4,this.optionalParams);this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;if(this.opt.enableCache){this._lineFreePool=[];this._lineUsePool=[];}},addSeries:function(run){return this;},getSeriesStats:function(){return lang.delegate(dc.defaultStats);},cleanGroup:function(){this.inherited(arguments);if(this.opt.enableCache){this._lineFreePool=this._lineFreePool.concat(this._lineUsePool);this._lineUsePool=[];}},createLine:function(_1b5,_1b6){var line;if(this.opt.enableCache&&this._lineFreePool.length>0){line=this._lineFreePool.pop();line.setShape(_1b6);_1b5.add(line);}else{line=_1b5.createLine(_1b6);}if(this.opt.enableCache){this._lineUsePool.push(line);}return line;},render:function(dim,_1b7){if(this.zoom){return this.performZoom(dim,_1b7);}this.dirty=this.isDirty();if(!this.dirty){return this;}this.cleanGroup();var s=this.group,ta=this.chart.theme,_1b8;var _1b9=this.opt.renderOnAxis;if(this._vAxis){var _1ba=this._vAxis.getScaler();if(_1ba){var vt=_1ba.scaler.getTransformerFromModel(_1ba);var _1bb;_1bb=this._vAxis.getTicks();if(_1bb!=null){if(this.opt.hMinorLines){_1b8=this.opt.minorHLine||(ta.grid&&ta.grid.minorLine)||ta.axis.minorTick;arr.forEach(_1bb.minor,function(tick){if(!_1b9&&tick.value==(this._vAxis.opt.leftBottom?_1ba.bounds.from:_1ba.bounds.to)){return;}var y=dim.height-_1b7.b-vt(tick.value);var _1bc=this.createLine(s,{x1:_1b7.l,y1:y,x2:dim.width-_1b7.r,y2:y}).setStroke(_1b8);if(this.animate){this._animateGrid(_1bc,"h",_1b7.l,_1b7.r+_1b7.l-dim.width);}},this);}if(this.opt.hMajorLines){_1b8=this.opt.majorHLine||(ta.grid&&ta.grid.majorLine)||ta.axis.majorTick;arr.forEach(_1bb.major,function(tick){if(!_1b9&&tick.value==(this._vAxis.opt.leftBottom?_1ba.bounds.from:_1ba.bounds.to)){return;}var y=dim.height-_1b7.b-vt(tick.value);var _1bd=this.createLine(s,{x1:_1b7.l,y1:y,x2:dim.width-_1b7.r,y2:y}).setStroke(_1b8);if(this.animate){this._animateGrid(_1bd,"h",_1b7.l,_1b7.r+_1b7.l-dim.width);}},this);}}}}if(this._hAxis){var _1be=this._hAxis.getScaler();if(_1be){var ht=_1be.scaler.getTransformerFromModel(_1be);_1bb=this._hAxis.getTicks();if(this!=null){if(_1bb&&this.opt.vMinorLines){_1b8=this.opt.minorVLine||(ta.grid&&ta.grid.minorLine)||ta.axis.minorTick;arr.forEach(_1bb.minor,function(tick){if(!_1b9&&tick.value==(this._hAxis.opt.leftBottom?_1be.bounds.from:_1be.bounds.to)){return;}var x=_1b7.l+ht(tick.value);var _1bf=this.createLine(s,{x1:x,y1:_1b7.t,x2:x,y2:dim.height-_1b7.b}).setStroke(_1b8);if(this.animate){this._animateGrid(_1bf,"v",dim.height-_1b7.b,dim.height-_1b7.b-_1b7.t);}},this);}if(_1bb&&this.opt.vMajorLines){_1b8=this.opt.majorVLine||(ta.grid&&ta.grid.majorLine)||ta.axis.majorTick;arr.forEach(_1bb.major,function(tick){if(!_1b9&&tick.value==(this._hAxis.opt.leftBottom?_1be.bounds.from:_1be.bounds.to)){return;}var x=_1b7.l+ht(tick.value);var _1c0=this.createLine(s,{x1:x,y1:_1b7.t,x2:x,y2:dim.height-_1b7.b}).setStroke(_1b8);if(this.animate){this._animateGrid(_1c0,"v",dim.height-_1b7.b,dim.height-_1b7.b-_1b7.t);}},this);}}}}this.dirty=false;return this;},_animateGrid:function(_1c1,type,_1c2,size){var _1c3=type=="h"?[_1c2,0]:[0,_1c2];var _1c4=type=="h"?[1/size,1]:[1,1/size];fx.animateTransform(lang.delegate({shape:_1c1,duration:1200,transform:[{name:"translate",start:_1c3,end:[0,0]},{name:"scale",start:_1c4,end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojox/charting/plot2d/Markers":function(){define("dojox/charting/plot2d/Markers",["dojo/_base/declare","./Default"],function(_1c5,_1c6){return _1c5("dojox.charting.plot2d.Markers",_1c6,{constructor:function(){this.opt.markers=true;}});});},"dojox/lang/utils":function(){define("dojox/lang/utils",["..","dojo/_base/lang"],function(_1c7,lang){var du=lang.getObject("lang.utils",true,_1c7);var _1c8={},opts=Object.prototype.toString;var _1c9=function(o){if(o){switch(opts.call(o)){case "[object Array]":return o.slice(0);case "[object Object]":return lang.delegate(o);}}return o;};lang.mixin(du,{coerceType:function(_1ca,_1cb){switch(typeof _1ca){case "number":return Number(eval("("+_1cb+")"));case "string":return String(_1cb);case "boolean":return Boolean(eval("("+_1cb+")"));}return eval("("+_1cb+")");},updateWithObject:function(_1cc,_1cd,conv){if(!_1cd){return _1cc;}for(var x in _1cc){if(x in _1cd&&!(x in _1c8)){var t=_1cc[x];if(t&&typeof t=="object"){du.updateWithObject(t,_1cd[x],conv);}else{_1cc[x]=conv?du.coerceType(t,_1cd[x]):_1c9(_1cd[x]);}}}return _1cc;},updateWithPattern:function(_1ce,_1cf,_1d0,conv){if(!_1cf||!_1d0){return _1ce;}for(var x in _1d0){if(x in _1cf&&!(x in _1c8)){_1ce[x]=conv?du.coerceType(_1d0[x],_1cf[x]):_1c9(_1cf[x]);}}return _1ce;},merge:function(_1d1,_1d2){if(_1d2){var _1d3=opts.call(_1d1),_1d4=opts.call(_1d2),t,i,l,m;switch(_1d4){case "[object Array]":if(_1d4==_1d3){t=new Array(Math.max(_1d1.length,_1d2.length));for(i=0,l=t.length;i<l;++i){t[i]=du.merge(_1d1[i],_1d2[i]);}return t;}return _1d2.slice(0);case "[object Object]":if(_1d4==_1d3&&_1d1){t=lang.delegate(_1d1);for(i in _1d2){if(i in _1d1){l=_1d1[i];m=_1d2[i];if(m!==l){t[i]=du.merge(l,m);}}else{t[i]=lang.clone(_1d2[i]);}}return t;}return lang.clone(_1d2);}}return _1d2;}});return du;});},"dojox/charting/plot2d/Columns":function(){define("dojox/charting/plot2d/Columns",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(lang,arr,_1d5,_1d6,_1d7,dc,df,dfr,du,fx){var _1d8=dfr.lambda("item.purgeGroup()");return _1d5("dojox.charting.plot2d.Columns",[_1d6,_1d7],{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null,enableCache:false},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:""},constructor:function(_1d9,_1da){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_1da);du.updateWithPattern(this.opt,_1da,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _1db=dc.collectSimpleStats(this.series);_1db.hmin-=0.5;_1db.hmax+=0.5;return _1db;},createRect:function(run,_1dc,_1dd){var rect;if(this.opt.enableCache&&run._rectFreePool.length>0){rect=run._rectFreePool.pop();rect.setShape(_1dd);_1dc.add(rect);}else{rect=_1dc.createRect(_1dd);}if(this.opt.enableCache){run._rectUsePool.push(rect);}return rect;},render:function(dim,_1de){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_1de);}this.getSeriesStats();this.resetEvents();this.dirty=this.isDirty();var s;if(this.dirty){arr.forEach(this.series,_1d8);this._eventSeries={};this.cleanGroup();s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_1df=Math.max(0,this._vScaler.bounds.lower),_1e0=vt(_1df),min=Math.max(0,Math.floor(this._hScaler.bounds.from-1)),_1e1=this.events();var bar=this.getBarProperties();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(this.opt.enableCache){run._rectFreePool=(run._rectFreePool?run._rectFreePool:[]).concat(run._rectUsePool?run._rectUsePool:[]);run._rectUsePool=[];}var _1e2=t.next("column",[this.opt,run]),_1e3=new Array(run.data.length);s=run.group;var l=this.getDataLength(run);var _1e4=arr.some(run.data,function(item){return typeof item=="number"||(item&&!item.hasOwnProperty("x"));});for(var j=min;j<l;++j){var _1e5=run.data[j];if(_1e5!=null){var val=this.getValue(_1e5,j,i,_1e4),vv=vt(val.y),h=Math.abs(vv-_1e0),_1e6,_1e7;if(this.opt.styleFunc||typeof _1e5!="number"){var _1e8=typeof _1e5!="number"?[_1e5]:[];if(this.opt.styleFunc){_1e8.push(this.opt.styleFunc(_1e5));}_1e6=t.addMixin(_1e2,"column",_1e8,true);}else{_1e6=t.post(_1e2,"column");}if(bar.width>=1&&h>=0){var rect={x:_1de.l+ht(val.x+0.5)+bar.gap+bar.thickness*i,y:dim.height-_1de.b-(val.y>_1df?vv:_1e0),width:bar.width,height:h};if(_1e6.series.shadow){var _1e9=lang.clone(rect);_1e9.x+=_1e6.series.shadow.dx;_1e9.y+=_1e6.series.shadow.dy;_1e7=this.createRect(run,s,_1e9).setFill(_1e6.series.shadow.color).setStroke(_1e6.series.shadow);if(this.animate){this._animateColumn(_1e7,dim.height-_1de.b+_1e0,h);}}var _1ea=this._plotFill(_1e6.series.fill,dim,_1de);_1ea=this._shapeFill(_1ea,rect);var _1eb=this.createRect(run,s,rect).setFill(_1ea).setStroke(_1e6.series.stroke);run.dyn.fill=_1eb.getFill();run.dyn.stroke=_1eb.getStroke();if(_1e1){var o={element:"column",index:j,run:run,shape:_1eb,shadow:_1e7,x:val.x+0.5,y:val.y};this._connectEvents(o);_1e3[j]=o;}if(this.animate){this._animateColumn(_1eb,dim.height-_1de.b-_1e0,h);}}}}this._eventSeries[run.name]=_1e3;run.dirty=false;}this.dirty=false;return this;},getDataLength:function(run){return Math.min(run.data.length,Math.ceil(this._hScaler.bounds.to));},getValue:function(_1ec,j,_1ed,_1ee){var y,x;if(_1ee){if(typeof _1ec=="number"){y=_1ec;}else{y=_1ec.y;}x=j;}else{y=_1ec.y;x=_1ec.x-1;}return {y:y,x:x};},getBarProperties:function(){var f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);return {gap:f.gap,width:f.size,thickness:0};},_animateColumn:function(_1ef,_1f0,_1f1){if(_1f1==0){_1f1=1;}fx.animateTransform(lang.delegate({shape:_1ef,duration:1200,transform:[{name:"translate",start:[0,_1f0-(_1f0/_1f1)],end:[0,0]},{name:"scale",start:[1,1/_1f1],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojox/lang/functional":function(){define("dojox/lang/functional",["./functional/lambda","./functional/array","./functional/object"],function(df){return df;});},"dojox/charting/plot2d/StackedBars":function(){define("dojox/charting/plot2d/StackedBars",["dojo/_base/declare","./Bars","./commonStacked"],function(_1f2,Bars,_1f3){return _1f2("dojox.charting.plot2d.StackedBars",Bars,{getSeriesStats:function(){var _1f4=_1f3.collectStats(this.series),t;this._maxRunLength=_1f4.hmax;_1f4.hmin-=0.5;_1f4.hmax+=0.5;t=_1f4.hmin,_1f4.hmin=_1f4.vmin,_1f4.vmin=t;t=_1f4.hmax,_1f4.hmax=_1f4.vmax,_1f4.vmax=t;return _1f4;},getDataLength:function(run){return this._maxRunLength;},getValue:function(_1f5,_1f6,_1f7,_1f8){var y,x;if(_1f8){x=_1f6;y=_1f3.getIndexValue(this.series,_1f7,x);}else{x=_1f5.x-1;y=_1f3.getValue(this.series,_1f7,_1f5.x);y=y?y.y:null;}return {y:y,x:x};}});});},"dojox/charting/action2d/Base":function(){define("dojox/charting/action2d/Base",["dojo/_base/lang","dojo/_base/declare"],function(lang,_1f9){return _1f9("dojox.charting.action2d.Base",null,{constructor:function(_1fa,plot){this.chart=_1fa;this.plot=plot?(lang.isString(plot)?this.chart.getPlot(plot):plot):this.chart.getPlot("default");},connect:function(){},disconnect:function(){},destroy:function(){this.disconnect();}});});},"dojox/charting/plot2d/Stacked":function(){define("dojox/charting/plot2d/Stacked",["dojo/_base/declare","./Default","./commonStacked"],function(_1fb,_1fc,_1fd){return _1fb("dojox.charting.plot2d.Stacked",_1fc,{getSeriesStats:function(){var _1fe=_1fd.collectStats(this.series);this._maxRunLength=_1fe.hmax;return _1fe;},buildSegments:function(i,_1ff){var run=this.series[i],max=_1ff?Math.min(run.data.length-1,Math.ceil(this._hScaler.bounds.to-this._hScaler.bounds.from)):run.data.length-1,rseg=null,_200=[];for(var j=0;j<=max;j++){var _201=_1ff?_1fd.getIndexValue(this.series,i,j):_1fd.getValue(this.series,i,run.data[j]?run.data[j].x:null);if(_201!=null&&(_1ff||_201.y!=null)){if(!rseg){rseg=[];_200.push({index:j,rseg:rseg});}rseg.push(_201);}else{if(!this.opt.interpolate||_1ff){rseg=null;}}}return _200;}});});},"dojox/charting/plot2d/Pie":function(){define("dojox/charting/plot2d/Pie",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./Base","./_PlotEvents","./common","../axis2d/common","dojox/gfx","dojox/gfx/matrix","dojox/lang/functional","dojox/lang/utils"],function(lang,arr,_202,Base,_203,dc,da,g,m,df,du){var _204=0.2;return _202("dojox.charting.plot2d.Pie",[Base,_203],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:20,labelStyle:"default",htmlLabels:true,radGrad:"native",fanSize:5,startAngle:0},optionalParams:{radius:0,omitLabels:false,stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:"",labelWiring:{}},constructor:function(_205,_206){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_206);du.updateWithPattern(this.opt,_206,this.optionalParams);this.axes=[];this.run=null;this.dyn=[];},clear:function(){this.inherited(arguments);this.dyn=[];this.run=null;return this;},setAxis:function(axis){return this;},addSeries:function(run){this.run=run;return this;},getSeriesStats:function(){return lang.delegate(dc.defaultStats);},getRequiredColors:function(){return this.run?this.run.data.length:0;},render:function(dim,_207){if(!this.dirty){return this;}this.resetEvents();this.dirty=false;this._eventSeries={};this.cleanGroup();var s=this.group,t=this.chart.theme;if(!this.run||!this.run.data.length){return this;}var rx=(dim.width-_207.l-_207.r)/2,ry=(dim.height-_207.t-_207.b)/2,r=Math.min(rx,ry),_208="font" in this.opt?this.opt.font:t.series.font,size,_209=m._degToRad(this.opt.startAngle),_20a=_209,step,_20b,_20c,_20d,_20e,_20f,run=this.run.data,_210=this.events();this.dyn=[];if("radius" in this.opt){r=this.opt.radius;_20f=r-this.opt.labelOffset;}var _211={cx:_207.l+rx,cy:_207.t+ry,r:r};if(this.opt.shadow||t.shadow){var _212=this.opt.shadow||t.shadow;var _213=lang.clone(_211);_213.cx+=_212.dx;_213.cy+=_212.dy;s.createCircle(_213).setFill(_212.color).setStroke(_212);}if(typeof run[0]=="number"){_20b=df.map(run,"x ? Math.max(x, 0) : 0");if(df.every(_20b,"<= 0")){s.createCircle(_211).setStroke(t.series.stroke);this.dyn=arr.map(_20b,function(){return {};});return this;}else{_20c=df.map(_20b,"/this",df.foldl(_20b,"+",0));if(this.opt.labels){_20d=arr.map(_20c,function(x){return x>0?this._getLabel(x*100)+"%":"";},this);}}}else{_20b=df.map(run,"x ? Math.max(x.y, 0) : 0");if(df.every(_20b,"<= 0")){s.createCircle(_211).setStroke(t.series.stroke);this.dyn=arr.map(_20b,function(){return {};});return this;}else{_20c=df.map(_20b,"/this",df.foldl(_20b,"+",0));if(this.opt.labels){_20d=arr.map(_20c,function(x,i){if(x<=0){return "";}var v=run[i];return "text" in v?v.text:this._getLabel(x*100)+"%";},this);}}}var _214=df.map(run,function(v,i){var _215=[this.opt,this.run];if(v!==null&&typeof v!="number"){_215.push(v);}if(this.opt.styleFunc){_215.push(this.opt.styleFunc(v));}return t.next("slice",_215,true);},this);if(this.opt.labels){size=_208?g.normalizedLength(g.splitFontString(_208).size):0;_20e=df.foldl1(df.map(_20d,function(_216,i){var font=_214[i].series.font;return g._base._getTextBox(_216,{font:font}).w;},this),"Math.max(a, b)")/2;if(this.opt.labelOffset<0){r=Math.min(rx-2*_20e,ry-size)+this.opt.labelOffset;}_20f=r-this.opt.labelOffset;}var _217=new Array(_20c.length);arr.some(_20c,function(_218,i){if(_218<0){return false;}if(_218==0){this.dyn.push({fill:null,stroke:null});return false;}var v=run[i],_219=_214[i],_21a,o;if(_218>=1){_21a=this._plotFill(_219.series.fill,dim,_207);_21a=this._shapeFill(_21a,{x:_211.cx-_211.r,y:_211.cy-_211.r,width:2*_211.r,height:2*_211.r});_21a=this._pseudoRadialFill(_21a,{x:_211.cx,y:_211.cy},_211.r);var _21b=s.createCircle(_211).setFill(_21a).setStroke(_219.series.stroke);this.dyn.push({fill:_21a,stroke:_219.series.stroke});if(_210){o={element:"slice",index:i,run:this.run,shape:_21b,x:i,y:typeof v=="number"?v:v.y,cx:_211.cx,cy:_211.cy,cr:r};this._connectEvents(o);_217[i]=o;}return true;}var end=_20a+_218*2*Math.PI;if(i+1==_20c.length){end=_209+2*Math.PI;}var step=end-_20a,x1=_211.cx+r*Math.cos(_20a),y1=_211.cy+r*Math.sin(_20a),x2=_211.cx+r*Math.cos(end),y2=_211.cy+r*Math.sin(end);var _21c=m._degToRad(this.opt.fanSize);if(_219.series.fill&&_219.series.fill.type==="radial"&&this.opt.radGrad==="fan"&&step>_21c){var _21d=s.createGroup(),_21e=Math.ceil(step/_21c),_21f=step/_21e;_21a=this._shapeFill(_219.series.fill,{x:_211.cx-_211.r,y:_211.cy-_211.r,width:2*_211.r,height:2*_211.r});for(var j=0;j<_21e;++j){var _220=j==0?x1:_211.cx+r*Math.cos(_20a+(j-_204)*_21f),_221=j==0?y1:_211.cy+r*Math.sin(_20a+(j-_204)*_21f),_222=j==_21e-1?x2:_211.cx+r*Math.cos(_20a+(j+1+_204)*_21f),_223=j==_21e-1?y2:_211.cy+r*Math.sin(_20a+(j+1+_204)*_21f),fan=_21d.createPath().moveTo(_211.cx,_211.cy).lineTo(_220,_221).arcTo(r,r,0,_21f>Math.PI,true,_222,_223).lineTo(_211.cx,_211.cy).closePath().setFill(this._pseudoRadialFill(_21a,{x:_211.cx,y:_211.cy},r,_20a+(j+0.5)*_21f,_20a+(j+0.5)*_21f));}_21d.createPath().moveTo(_211.cx,_211.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_211.cx,_211.cy).closePath().setStroke(_219.series.stroke);_21b=_21d;}else{_21b=s.createPath().moveTo(_211.cx,_211.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_211.cx,_211.cy).closePath().setStroke(_219.series.stroke);_21a=_219.series.fill;if(_21a&&_21a.type==="radial"){_21a=this._shapeFill(_21a,{x:_211.cx-_211.r,y:_211.cy-_211.r,width:2*_211.r,height:2*_211.r});if(this.opt.radGrad==="linear"){_21a=this._pseudoRadialFill(_21a,{x:_211.cx,y:_211.cy},r,_20a,end);}}else{if(_21a&&_21a.type==="linear"){_21a=this._plotFill(_21a,dim,_207);_21a=this._shapeFill(_21a,_21b.getBoundingBox());}}_21b.setFill(_21a);}this.dyn.push({fill:_21a,stroke:_219.series.stroke});if(_210){o={element:"slice",index:i,run:this.run,shape:_21b,x:i,y:typeof v=="number"?v:v.y,cx:_211.cx,cy:_211.cy,cr:r};this._connectEvents(o);_217[i]=o;}_20a=end;return false;},this);if(this.opt.labels){if(this.opt.labelStyle=="default"){_20a=_209;arr.some(_20c,function(_224,i){if(_224<=0){return false;}var _225=_214[i],elem;if(_224>=1){elem=da.createText[this.opt.htmlLabels&&g.renderer!="vml"?"html":"gfx"](this.chart,s,_211.cx,_211.cy+size/2,"middle",_20d[i],_225.series.font,_225.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}return true;}var end=_20a+_224*2*Math.PI;if(i+1==_20c.length){end=_209+2*Math.PI;}if(this.opt.omitLabels&&end-_20a<0.001){return false;}var _226=(_20a+end)/2,x=_211.cx+_20f*Math.cos(_226),y=_211.cy+_20f*Math.sin(_226)+size/2;elem=da.createText[this.opt.htmlLabels&&g.renderer!="vml"?"html":"gfx"](this.chart,s,x,y,"middle",_20d[i],_225.series.font,_225.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}_20a=end;return false;},this);}else{if(this.opt.labelStyle=="columns"){_20a=_209;var _227=this.opt.omitLabels;var _228=[];arr.forEach(_20c,function(_229,i){var end=_20a+_229*2*Math.PI;if(i+1==_20c.length){end=_209+2*Math.PI;}var _22a=(_20a+end)/2;_228.push({angle:_22a,left:Math.cos(_22a)<0,theme:_214[i],index:i,omit:_227?end-_20a<0.001:false});_20a=end;});var _22b=g._base._getTextBox("a",{font:_208}).h;this._getProperLabelRadius(_228,_22b,_211.r*1.1);arr.forEach(_228,function(_22c,i){if(!_22c.omit){var _22d=_211.cx-_211.r*2,_22e=_211.cx+_211.r*2,_22f=g._base._getTextBox(_20d[i],{font:_22c.theme.series.font}).w,x=_211.cx+_22c.labelR*Math.cos(_22c.angle),y=_211.cy+_22c.labelR*Math.sin(_22c.angle),_230=(_22c.left)?(_22d+_22f):(_22e-_22f),_231=(_22c.left)?_22d:_230;var _232=s.createPath().moveTo(_211.cx+_211.r*Math.cos(_22c.angle),_211.cy+_211.r*Math.sin(_22c.angle));if(Math.abs(_22c.labelR*Math.cos(_22c.angle))<_211.r*2-_22f){_232.lineTo(x,y);}_232.lineTo(_230,y).setStroke(_22c.theme.series.labelWiring);var elem=da.createText[this.opt.htmlLabels&&g.renderer!="vml"?"html":"gfx"](this.chart,s,_231,y,"left",_20d[i],_22c.theme.series.font,_22c.theme.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}},this);}}}var esi=0;this._eventSeries[this.run.name]=df.map(run,function(v){return v<=0?null:_217[esi++];});return this;},_getProperLabelRadius:function(_233,_234,_235){var _236,_237,_238=1,_239=1;if(_233.length==1){_233[0].labelR=_235;return;}for(var i=0;i<_233.length;i++){var _23a=Math.abs(Math.sin(_233[i].angle));if(_233[i].left){if(_238>=_23a){_238=_23a;_236=_233[i];}}else{if(_239>=_23a){_239=_23a;_237=_233[i];}}}_236.labelR=_237.labelR=_235;this._calculateLabelR(_236,_233,_234);this._calculateLabelR(_237,_233,_234);},_calculateLabelR:function(_23b,_23c,_23d){var i=_23b.index,_23e=_23c.length,_23f=_23b.labelR,_240;while(!(_23c[i%_23e].left^_23c[(i+1)%_23e].left)){if(!_23c[(i+1)%_23e].omit){_240=(Math.sin(_23c[i%_23e].angle)*_23f+((_23c[i%_23e].left)?(-_23d):_23d))/Math.sin(_23c[(i+1)%_23e].angle);_23f=(_240<_23b.labelR)?_23b.labelR:_240;_23c[(i+1)%_23e].labelR=_23f;}i++;}i=_23b.index;var j=(i==0)?_23e-1:i-1;while(!(_23c[i].left^_23c[j].left)){if(!_23c[j].omit){_240=(Math.sin(_23c[i].angle)*_23f+((_23c[i].left)?_23d:(-_23d)))/Math.sin(_23c[j].angle);_23f=(_240<_23b.labelR)?_23b.labelR:_240;_23c[j].labelR=_23f;}i--;j--;i=(i<0)?i+_23c.length:i;j=(j<0)?j+_23c.length:j;}},_getLabel:function(_241){return dc.getLabel(_241,this.opt.fixed,this.opt.precision);}});});},"dojox/color/_base":function(){define("dojox/color/_base",["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(_242,lang,_243,_244){var cx=lang.getObject("color",true,_242);cx.Color=_243;cx.blend=_243.blendColors;cx.fromRgb=_243.fromRgb;cx.fromHex=_243.fromHex;cx.fromArray=_243.fromArray;cx.fromString=_243.fromString;cx.greyscale=_244.makeGrey;lang.mixin(cx,{fromCmy:function(cyan,_245,_246){if(lang.isArray(cyan)){_245=cyan[1],_246=cyan[2],cyan=cyan[0];}else{if(lang.isObject(cyan)){_245=cyan.m,_246=cyan.y,cyan=cyan.c;}}cyan/=100,_245/=100,_246/=100;var r=1-cyan,g=1-_245,b=1-_246;return new _243({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromCmyk:function(cyan,_247,_248,_249){if(lang.isArray(cyan)){_247=cyan[1],_248=cyan[2],_249=cyan[3],cyan=cyan[0];}else{if(lang.isObject(cyan)){_247=cyan.m,_248=cyan.y,_249=cyan.b,cyan=cyan.c;}}cyan/=100,_247/=100,_248/=100,_249/=100;var r,g,b;r=1-Math.min(1,cyan*(1-_249)+_249);g=1-Math.min(1,_247*(1-_249)+_249);b=1-Math.min(1,_248*(1-_249)+_249);return new _243({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromHsl:function(hue,_24a,_24b){if(lang.isArray(hue)){_24a=hue[1],_24b=hue[2],hue=hue[0];}else{if(lang.isObject(hue)){_24a=hue.s,_24b=hue.l,hue=hue.h;}}_24a/=100;_24b/=100;while(hue<0){hue+=360;}while(hue>=360){hue-=360;}var r,g,b;if(hue<120){r=(120-hue)/60,g=hue/60,b=0;}else{if(hue<240){r=0,g=(240-hue)/60,b=(hue-120)/60;}else{r=(hue-240)/60,g=0,b=(360-hue)/60;}}r=2*_24a*Math.min(r,1)+(1-_24a);g=2*_24a*Math.min(g,1)+(1-_24a);b=2*_24a*Math.min(b,1)+(1-_24a);if(_24b<0.5){r*=_24b,g*=_24b,b*=_24b;}else{r=(1-_24b)*r+2*_24b-1;g=(1-_24b)*g+2*_24b-1;b=(1-_24b)*b+2*_24b-1;}return new _243({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});}});cx.fromHsv=function(hue,_24c,_24d){if(lang.isArray(hue)){_24c=hue[1],_24d=hue[2],hue=hue[0];}else{if(lang.isObject(hue)){_24c=hue.s,_24d=hue.v,hue=hue.h;}}if(hue==360){hue=0;}_24c/=100;_24d/=100;var r,g,b;if(_24c==0){r=_24d,b=_24d,g=_24d;}else{var _24e=hue/60,i=Math.floor(_24e),f=_24e-i;var p=_24d*(1-_24c);var q=_24d*(1-(_24c*f));var t=_24d*(1-(_24c*(1-f)));switch(i){case 0:r=_24d,g=t,b=p;break;case 1:r=q,g=_24d,b=p;break;case 2:r=p,g=_24d,b=t;break;case 3:r=p,g=q,b=_24d;break;case 4:r=t,g=p,b=_24d;break;case 5:r=_24d,g=p,b=q;break;}}return new _243({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});};lang.extend(_243,{toCmy:function(){var cyan=1-(this.r/255),_24f=1-(this.g/255),_250=1-(this.b/255);return {c:Math.round(cyan*100),m:Math.round(_24f*100),y:Math.round(_250*100)};},toCmyk:function(){var cyan,_251,_252,_253;var r=this.r/255,g=this.g/255,b=this.b/255;_253=Math.min(1-r,1-g,1-b);cyan=(1-r-_253)/(1-_253);_251=(1-g-_253)/(1-_253);_252=(1-b-_253)/(1-_253);return {c:Math.round(cyan*100),m:Math.round(_251*100),y:Math.round(_252*100),b:Math.round(_253*100)};},toHsl:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _254=max-min;var h=0,s=0,l=(min+max)/2;if(l>0&&l<1){s=_254/((l<0.5)?(2*l):(2-2*l));}if(_254>0){if(max==r&&max!=g){h+=(g-b)/_254;}if(max==g&&max!=b){h+=(2+(b-r)/_254);}if(max==b&&max!=r){h+=(4+(r-g)/_254);}h*=60;}return {h:h,s:Math.round(s*100),l:Math.round(l*100)};},toHsv:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _255=max-min;var h=null,s=(max==0)?0:(_255/max);if(s==0){h=0;}else{if(r==max){h=60*(g-b)/_255;}else{if(g==max){h=120+60*(b-r)/_255;}else{h=240+60*(r-g)/_255;}}if(h<0){h+=360;}}return {h:h,s:Math.round(s*100),v:Math.round(max*100)};}});return cx;});},"dojox/charting/action2d/PlotAction":function(){define("dojox/charting/action2d/PlotAction",["dojo/_base/connect","dojo/_base/declare","./Base","dojo/fx/easing","dojox/lang/functional","dojox/lang/functional/object"],function(hub,_256,Base,dfe,df,dlfo){var _257=400,_258=dfe.backOut;return _256("dojox.charting.action2d.PlotAction",Base,{overOutEvents:{onmouseover:1,onmouseout:1},constructor:function(_259,plot,_25a){this.anim={};if(!_25a){_25a={};}this.duration=_25a.duration?_25a.duration:_257;this.easing=_25a.easing?_25a.easing:_258;},connect:function(){this.handle=this.chart.connectToPlot(this.plot.name,this,"process");},disconnect:function(){if(this.handle){hub.disconnect(this.handle);this.handle=null;}},reset:function(){},destroy:function(){this.inherited(arguments);df.forIn(this.anim,function(o){df.forIn(o,function(anim){anim.action.stop(true);});});this.anim={};}});});},"dojox/lang/functional/fold":function(){define("dojox/lang/functional/fold",["dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","./lambda"],function(lang,arr,_25b,df){var _25c={};lang.mixin(df,{foldl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||_25b.global;f=df.lambda(f);var i,n;if(lang.isArray(a)){for(i=0,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}else{for(i in a){if(!(i in _25c)){z=f.call(o,z,a[i],i,a);}}}}return z;},foldl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_25b.global;f=df.lambda(f);var z,i,n;if(lang.isArray(a)){z=a[0];for(i=1,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){z=a.next();for(i=1;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}}else{var _25d=true;for(i in a){if(!(i in _25c)){if(_25d){z=a[i];_25d=false;}else{z=f.call(o,z,a[i],i,a);}}}}}return z;},foldr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||_25b.global;f=df.lambda(f);for(var i=a.length;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},foldr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_25b.global;f=df.lambda(f);var n=a.length,z=a[n-1],i=n-1;for(;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},reduce:function(a,f,z){return arguments.length<3?df.foldl1(a,f):df.foldl(a,f,z);},reduceRight:function(a,f,z){return arguments.length<3?df.foldr1(a,f):df.foldr(a,f,z);},unfold:function(pr,f,g,z,o){o=o||_25b.global;f=df.lambda(f);g=df.lambda(g);pr=df.lambda(pr);var t=[];for(;!pr.call(o,z);t.push(f.call(o,z)),z=g.call(o,z)){}return t;}});});},"dojox/charting/plot2d/Bars":function(){define("dojox/charting/plot2d/Bars",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./CartesianBase","./_PlotEvents","./common","dojox/gfx/fx","dojox/lang/utils","dojox/lang/functional","dojox/lang/functional/reversed"],function(dojo,lang,arr,_25e,_25f,_260,dc,fx,du,df,dfr){var _261=dfr.lambda("item.purgeGroup()");return _25e("dojox.charting.plot2d.Bars",[_25f,_260],{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null,enableCache:false},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:""},constructor:function(_262,_263){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_263);du.updateWithPattern(this.opt,_263,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _264=dc.collectSimpleStats(this.series),t;_264.hmin-=0.5;_264.hmax+=0.5;t=_264.hmin,_264.hmin=_264.vmin,_264.vmin=t;t=_264.hmax,_264.hmax=_264.vmax,_264.vmax=t;return _264;},createRect:function(run,_265,_266){var rect;if(this.opt.enableCache&&run._rectFreePool.length>0){rect=run._rectFreePool.pop();rect.setShape(_266);_265.add(rect);}else{rect=_265.createRect(_266);}if(this.opt.enableCache){run._rectUsePool.push(rect);}return rect;},render:function(dim,_267){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_267);}this.dirty=this.isDirty();this.resetEvents();var s;if(this.dirty){arr.forEach(this.series,_261);this._eventSeries={};this.cleanGroup();s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_268=Math.max(0,this._hScaler.bounds.lower),_269=ht(_268),_26a=this.events();var bar=this.getBarProperties();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(this.opt.enableCache){run._rectFreePool=(run._rectFreePool?run._rectFreePool:[]).concat(run._rectUsePool?run._rectUsePool:[]);run._rectUsePool=[];}var _26b=t.next("bar",[this.opt,run]),_26c=new Array(run.data.length);s=run.group;var l=this.getDataLength(run);var _26d=arr.some(run.data,function(item){return typeof item=="number"||(item&&!item.hasOwnProperty("x"));});for(var j=0;j<l;++j){var _26e=run.data[j];if(_26e!=null){var val=this.getValue(_26e,j,i,_26d),hv=ht(val.y),w=Math.abs(hv-_269),_26f,_270;if(this.opt.styleFunc||typeof _26e!="number"){var _271=typeof _26e!="number"?[_26e]:[];if(this.opt.styleFunc){_271.push(this.opt.styleFunc(_26e));}_26f=t.addMixin(_26b,"bar",_271,true);}else{_26f=t.post(_26b,"bar");}if(w>=0&&bar.height>=1){var rect={x:_267.l+(val.y<_268?hv:_269),y:dim.height-_267.b-vt(val.x+1.5)+bar.gap+bar.thickness*(this.series.length-i-1),width:w,height:bar.height};if(_26f.series.shadow){var _272=lang.clone(rect);_272.x+=_26f.series.shadow.dx;_272.y+=_26f.series.shadow.dy;_270=this.createRect(run,s,_272).setFill(_26f.series.shadow.color).setStroke(_26f.series.shadow);if(this.animate){this._animateBar(_270,_267.l+_269,-w);}}var _273=this._plotFill(_26f.series.fill,dim,_267);_273=this._shapeFill(_273,rect);var _274=this.createRect(run,s,rect).setFill(_273).setStroke(_26f.series.stroke);run.dyn.fill=_274.getFill();run.dyn.stroke=_274.getStroke();if(_26a){var o={element:"bar",index:j,run:run,shape:_274,shadow:_270,x:val.y,y:val.x+1.5};this._connectEvents(o);_26c[j]=o;}if(this.animate){this._animateBar(_274,_267.l+_269,-w);}}}}this._eventSeries[run.name]=_26c;run.dirty=false;}this.dirty=false;return this;},getDataLength:function(run){return Math.min(run.data.length,Math.ceil(this._vScaler.bounds.to));},getValue:function(_275,j,_276,_277){var y,x;if(_277){if(typeof _275=="number"){y=_275;}else{y=_275.y;}x=j;}else{y=_275.y;x=_275.x-1;}return {y:y,x:x};},getBarProperties:function(){var f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt);return {gap:f.gap,height:f.size,thickness:0};},_animateBar:function(_278,_279,_27a){if(_27a==0){_27a=1;}fx.animateTransform(lang.delegate({shape:_278,duration:1200,transform:[{name:"translate",start:[_279-(_279/_27a),0],end:[0,0]},{name:"scale",start:[1/_27a,1],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojox/lang/functional/object":function(){define("dojox/lang/functional/object",["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(_27b,lang,df){var _27c={};lang.mixin(df,{keys:function(obj){var t=[];for(var i in obj){if(!(i in _27c)){t.push(i);}}return t;},values:function(obj){var t=[];for(var i in obj){if(!(i in _27c)){t.push(obj[i]);}}return t;},filterIn:function(obj,f,o){o=o||_27b.global;f=df.lambda(f);var t={},v,i;for(i in obj){if(!(i in _27c)){v=obj[i];if(f.call(o,v,i,obj)){t[i]=v;}}}return t;},forIn:function(obj,f,o){o=o||_27b.global;f=df.lambda(f);for(var i in obj){if(!(i in _27c)){f.call(o,obj[i],i,obj);}}return o;},mapIn:function(obj,f,o){o=o||_27b.global;f=df.lambda(f);var t={},i;for(i in obj){if(!(i in _27c)){t[i]=f.call(o,obj[i],i,obj);}}return t;}});return df;});},"esri/arcgis/csv":function(){define("esri/arcgis/csv",["dijit","dojo","dojox","dojo/require!dojox/data/CsvStore"],function(_27d,dojo,_27e){dojo.provide("esri.arcgis.csv");dojo.require("dojox.data.CsvStore");(function(){var EAC=esri.arcgis.csv;EAC.latFieldStrings=["lat","latitude","y","ycenter","latitude83","latdecdeg","POINT-Y"];EAC.longFieldStrings=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","POINT-X"];EAC.buildCSVFeatureCollection=function(_27f){var _280=new dojo.Deferred();var _281=function(_282){_280.callback(_282);};var _283=esri.request({url:_27f.url,handleAs:"text",load:function(_284){EAC._processCsvData(_284,_27f,dojo.hitch(this,_281));},error:function(_285){console.error("error: "+_285);}},{usePost:false});return _280;};EAC.projectFeatureCollection=function(_286,_287){var _288=new dojo.Deferred();var _289=function(_28a){_288.callback(_28a);};EAC._projectFeatureSet(_286,new esri.SpatialReference({wkid:4326}),_287,dojo.hitch(this,_289));return _288;};EAC.generateDefaultPopupInfo=function(_28b){var _28c=_28b.layerDefinition.fields;var _28d={"esriFieldTypeDouble":1,"esriFieldTypeSingle":1};var _28e={"esriFieldTypeInteger":1,"esriFieldTypeSmallInteger":1};var dt={"esriFieldTypeDate":1};var _28f=null;var _290=dojo.map(_28c,dojo.hitch(this,function(item){if(item.name.toUpperCase()==="NAME"){_28f=item.name;}var _291=(item.type!=="esriFieldTypeOID"&&item.type!=="esriFieldTypeGlobalID"&&item.type!=="esriFieldTypeGeometry");var _292=null;if(_291){var f=item.name.toLowerCase();var _293=",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,";if(_293.indexOf(","+f+",")>-1||f.indexOf("area")>-1||f.indexOf("length")>-1||f.indexOf("shape")>-1||f.indexOf("perimeter")>-1||f.indexOf("objectid")>-1||f.indexOf("_")===f.length-1||(f.indexOf("_i")===f.length-2&&f.length>1)){_291=false;}if(item.type in _28e){_292={places:0,digitSeparator:true};}else{if(item.type in _28d){_292={places:2,digitSeparator:true};}else{if(item.type in dt){_292={dateFormat:"shortDateShortTime"};}}}}return dojo.mixin({},{fieldName:item.name,label:item.alias,isEditable:true,tooltip:"",visible:_291,format:_292,stringFieldOption:"textbox"});}));var _294={title:_28f?"{"+_28f+"}":"",fieldInfos:_290,description:null,showAttachments:false,mediaInfos:[]};return _294;};EAC._processCsvData=function(data,_295,_296){var _297=data.indexOf("\n");var _298=dojo.trim(data.substr(0,_297));var _299=_295.columnDelimiter;if(!_299){_299=EAC._getSeparator(_298);}var _29a=new _27e.data.CsvStore({data:data,separator:_299});var _29b=(dojo.isIE<9)?750:1001;_29a.fetch({start:0,count:_29b,onComplete:function(_29c,_29d){var _29e=0;var _29f={"layerDefinition":_295.layerDefinition,"featureSet":{"features":[],"geometryType":"esriGeometryPoint"}};var _2a0=_29f.layerDefinition.objectIdField;if(!_2a0){if(!dojo.some(_29f.layerDefinition.fields,function(_2a1){if(_2a1.type=="esriFieldTypeOID"){_2a0=_2a1.name;return true;}return false;})){_29f.layerDefinition.fields.push({"name":"__OBJECTID","alias":"__OBJECTID","type":"esriFieldTypeOID","editable":false,"domain":null});_2a0="__OBJECTID";}}var _2a2,_2a3;var _2a4=_29a._attributes;var _2a5=[];var _2a6=[];dojo.forEach(_29f.layerDefinition.fields,function(_2a7,_2a8){if(_2a7.type==="esriFieldTypeDate"){_2a5.push(_2a7.name);}else{if(_2a7.type==="esriFieldTypeDouble"||_2a7.type==="esriFieldTypeInteger"){_2a6.push(_2a7.name);}}});if(_295.locationInfo&&_295.locationInfo.locationType==="coordinates"){_2a2=_295.locationInfo.latitudeFieldName;_2a3=_295.locationInfo.longitudeFieldName;}else{dojo.forEach(_2a4,function(_2a9){var _2aa;_2aa=dojo.indexOf(EAC.latFieldStrings,_2a9.toLowerCase());if(_2aa!==-1){_2a2=_2a9;}_2aa=dojo.indexOf(EAC.longFieldStrings,_2a9.toLowerCase());if(_2aa!==-1){_2a3=_2a9;}},this);}if(!_2a2||!_2a3){setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.");},1);return;}var i=0,il=_29c.length;for(i;i<il;i++){if(_29f.featureSet.features.length>=1000){setTimeout(function(){console.error("1000 feature limit reached. Unable to load any more data.");},1);break;}var item=_29c[i];var _2ab=_29a.getAttributes(item),_2ac={};dojo.forEach(_2ab,function(attr,_2ad){if(attr){var _2ae=attr;if(attr.length===0){dojo.forEach(_29f.layerDefinition.fields,function(_2af,idx){if(_2af.name==="attribute_"+(idx-1)){attr="attribute_"+(idx-1);}});}if(dojo.some(_2a5,function(a){return a===attr;})){var val=_29a.getValue(item,_2ae),date=new Date(val);_2ac[attr]=EAC._isValidDate(date,val)?date.getTime():null;}else{if(dojo.some(_2a6,function(a){return a===attr;})){var _2b0=dojo.number.parse(_29a.getValue(item,_2ae));if((attr==_2a2||attr==_2a3)&&(isNaN(_2b0)||Math.abs(_2b0)>181)){_2b0=parseFloat(_29a.getValue(item,_2ae));if(isNaN(_2b0)){_2ac[attr]=null;}else{_2ac[attr]=_2b0;}}else{if(isNaN(_2b0)){_2ac[attr]=null;}else{_2ac[attr]=_2b0;}}}else{_2ac[attr]=_29a.getValue(item,_2ae);}}}});_2ac[_2a0]=_29e;_29e++;var _2b1=_2ac[_2a2];var _2b2=_2ac[_2a3];if(_2b2==null||_2b1==null||isNaN(_2b1)||isNaN(_2b2)){continue;}var _2b3=new esri.geometry.Point(_2b2,_2b1,new esri.SpatialReference({wkid:4326}));var _2b4={"geometry":_2b3.toJson(),"attributes":_2ac};_29f.featureSet.features.push(_2b4);}_29f.layerDefinition.name="csv";if(_296){_296(_29f);}},onError:function(_2b5){console.error("Error fetching items from CSV store: ",_2b5);}});return true;};EAC._getSeparator=function(_2b6){var _2b7=[","," ",";","|","\t"];var _2b8=0;var _2b9="";dojo.forEach(_2b7,function(_2ba){var _2bb=_2b6.split(_2ba).length;if(_2bb>_2b8){_2b8=_2bb;_2b9=_2ba;}});return _2b9;};EAC._isValidDate=function(d,_2bc){if(!d||Object.prototype.toString.call(d)!=="[object Date]"||isNaN(d.getTime())){return false;}var _2bd=true;if(dojo.isChrome&&/\d+\W*$/.test(_2bc)){var _2be=_2bc.match(/[a-zA-Z]{2,}/);if(_2be){var _2bf=false,i=0,len=_2be.length,_2c0=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;while(!_2bf&&(i<=len)&&!(_2bf=!_2c0.test(_2be[i]))){i++;}_2bd=!_2bf;}}return _2bd;};EAC._projectFeatureSet=function(_2c1,_2c2,_2c3,_2c4){if(!_2c1.featureSet||_2c1.featureSet.length===0){return;}if(EAC._sameSpatialReference(_2c3,_2c2)){_2c4(_2c1);return;}var _2c5=function(_2c6){var _2c7=[];dojo.forEach(_2c1.featureSet.features,function(_2c8,i){if(_2c6[i]){_2c8.geometry=_2c6[i];_2c7.push(_2c8);}},this);_2c4(_2c1);};var _2c9=function(_2ca,args){console.error("error projecting featureSet ("+_2c1.layerDefinition.name+"). Try one more time.");EAC._projectGeometries(_2cb,_2c1.featureSet.geometryType,_2c2,_2c3,dojo.hitch(this,_2c5),dojo.hitch(this,_2cc));};var _2cc=function(_2cd,args){console.error("error projecting featureSet ("+_2c1.layerDefinition.name+"). Final try.");_2c4(_2c1);};if(_2c1.featureSet.features&&_2c1.featureSet.features.length>0){var _2cb=[];dojo.forEach(_2c1.featureSet.features,function(_2ce){_2cb.push(_2ce.geometry);});EAC._projectGeometries(_2cb,_2c1.featureSet.geometryType,_2c2,_2c3,dojo.hitch(this,_2c5),dojo.hitch(this,_2c9));}else{_2c4(_2c1);}};EAC._projectGeometries=function(_2cf,_2d0,inSR,_2d1,_2d2,_2d3){if(_2cf.length===0){_2d2(null);}var _2d4=esri.geometry.getGeometryType(_2d0);var _2d5=[];dojo.forEach(_2cf,function(_2d6){var _2d7=new _2d4(_2d6);_2d7.spatialReference=inSR;_2d5.push(_2d7);},this);var _2d8=[102113,102100,3857];if(inSR.wkid&&inSR.wkid===4326&&_2d1.wkid&&dojo.indexOf(_2d8,_2d1.wkid)>-1){dojo.forEach(_2d5,function(_2d9){if(_2d9.xmin){_2d9.xmin=Math.max(_2d9.xmin,-180);_2d9.xmax=Math.min(_2d9.xmax,180);_2d9.ymin=Math.max(_2d9.ymin,-89.99);_2d9.ymax=Math.min(_2d9.ymax,89.99);}else{if(_2d9.rings){dojo.forEach(_2d9.rings,function(ring){dojo.forEach(ring,function(_2da){_2da[0]=Math.min(Math.max(_2da[0],-180),180);_2da[1]=Math.min(Math.max(_2da[1],-89.99),89.99);},this);},this);}else{if(_2d9.paths){dojo.forEach(_2d9.paths,function(path){dojo.forEach(path,function(_2db){_2db[0]=Math.min(Math.max(_2db[0],-180),180);_2db[1]=Math.min(Math.max(_2db[1],-89.99),89.99);},this);},this);}else{if(_2d9.x){_2d9.x=Math.min(Math.max(_2d9.x,-180),180);_2d9.y=Math.min(Math.max(_2d9.y,-89.99),89.99);}}}}},this);_2cf=[];dojo.forEach(_2d5,function(_2dc){var _2dd=esri.geometry.geographicToWebMercator(_2dc);if(_2d1.wkid!==102100){_2dd.spatialReference=_2d1;}_2cf.push(_2dd.toJson());},this);_2d2(_2cf);}else{if(inSR.wkid!==null&&dojo.indexOf(_2d8,inSR.wkid)>-1&&_2d1.wkid!==null&&_2d1.wkid===4326){_2cf=[];dojo.forEach(_2d5,function(_2de){_2cf.push(esri.geometry.webMercatorToGeographic(_2de).toJson());},this);_2d2(_2cf);}else{var _2df=function(_2e0,args){if(_2e0&&_2e0.length===_2cf.length){_2cf=[];dojo.forEach(_2e0,function(_2e1){if(_2e1&&((_2e1.rings&&_2e1.rings.length>0&&_2e1.rings[0].length>0&&_2e1.rings[0][0].length>0&&!isNaN(_2e1.rings[0][0][0])&&!isNaN(_2e1.rings[0][0][1]))||(_2e1.paths&&_2e1.paths.length>0&&_2e1.paths[0].length>0&&_2e1.paths[0][0].length>0&&!isNaN(_2e1.paths[0][0][0])&&!isNaN(_2e1.paths[0][0][1]))||(_2e1.xmin&&!isNaN(_2e1.xmin)&&_2e1.ymin&&!isNaN(_2e1.ymin))||(_2e1.x&&!isNaN(_2e1.x)&&_2e1.y&&!isNaN(_2e1.y)))){_2cf.push(_2e1.toJson());}else{_2cf.push(null);}},this);_2d2(_2cf);}else{_2d3(_2e0,args);}};if(esri.config.defaults.geometryService){esri.config.defaults.geometryService.project(_2d5,_2d1,dojo.hitch(this,_2df),_2d3);}else{_2d2(null);}}}};EAC._sameSpatialReference=function(sp1,sp2){var _2e2=[102113,102100,3857];if(sp1&&sp2&&sp1.wkid===sp2.wkid&&sp1.wkt===sp2.wkt){return true;}else{if(sp1&&sp2&&sp1.wkid&&sp2.wkid&&dojo.indexOf(_2e2,sp1.wkid)>-1&&dojo.indexOf(_2e2,sp2.wkid)>-1){return true;}}return false;};}());});},"dojox/charting/scaler/linear":function(){define("dojox/charting/scaler/linear",["dojo/_base/lang","./common"],function(lang,_2e3){var _2e4=lang.getObject("dojox.charting.scaler.linear",true);var _2e5=3,_2e6=_2e3.getNumericLabel;function _2e7(val,text){val=val.toLowerCase();for(var i=text.length-1;i>=0;--i){if(val===text[i]){return true;}}return false;};var _2e8=function(min,max,_2e9,_2ea,_2eb,_2ec,span){_2e9=lang.delegate(_2e9);if(!_2ea){if(_2e9.fixUpper=="major"){_2e9.fixUpper="minor";}if(_2e9.fixLower=="major"){_2e9.fixLower="minor";}}if(!_2eb){if(_2e9.fixUpper=="minor"){_2e9.fixUpper="micro";}if(_2e9.fixLower=="minor"){_2e9.fixLower="micro";}}if(!_2ec){if(_2e9.fixUpper=="micro"){_2e9.fixUpper="none";}if(_2e9.fixLower=="micro"){_2e9.fixLower="none";}}var _2ed=_2e7(_2e9.fixLower,["major"])?Math.floor(_2e9.min/_2ea)*_2ea:_2e7(_2e9.fixLower,["minor"])?Math.floor(_2e9.min/_2eb)*_2eb:_2e7(_2e9.fixLower,["micro"])?Math.floor(_2e9.min/_2ec)*_2ec:_2e9.min,_2ee=_2e7(_2e9.fixUpper,["major"])?Math.ceil(_2e9.max/_2ea)*_2ea:_2e7(_2e9.fixUpper,["minor"])?Math.ceil(_2e9.max/_2eb)*_2eb:_2e7(_2e9.fixUpper,["micro"])?Math.ceil(_2e9.max/_2ec)*_2ec:_2e9.max;if(_2e9.useMin){min=_2ed;}if(_2e9.useMax){max=_2ee;}var _2ef=(!_2ea||_2e9.useMin&&_2e7(_2e9.fixLower,["major"]))?min:Math.ceil(min/_2ea)*_2ea,_2f0=(!_2eb||_2e9.useMin&&_2e7(_2e9.fixLower,["major","minor"]))?min:Math.ceil(min/_2eb)*_2eb,_2f1=(!_2ec||_2e9.useMin&&_2e7(_2e9.fixLower,["major","minor","micro"]))?min:Math.ceil(min/_2ec)*_2ec,_2f2=!_2ea?0:(_2e9.useMax&&_2e7(_2e9.fixUpper,["major"])?Math.round((max-_2ef)/_2ea):Math.floor((max-_2ef)/_2ea))+1,_2f3=!_2eb?0:(_2e9.useMax&&_2e7(_2e9.fixUpper,["major","minor"])?Math.round((max-_2f0)/_2eb):Math.floor((max-_2f0)/_2eb))+1,_2f4=!_2ec?0:(_2e9.useMax&&_2e7(_2e9.fixUpper,["major","minor","micro"])?Math.round((max-_2f1)/_2ec):Math.floor((max-_2f1)/_2ec))+1,_2f5=_2eb?Math.round(_2ea/_2eb):0,_2f6=_2ec?Math.round(_2eb/_2ec):0,_2f7=_2ea?Math.floor(Math.log(_2ea)/Math.LN10):0,_2f8=_2eb?Math.floor(Math.log(_2eb)/Math.LN10):0,_2f9=span/(max-min);if(!isFinite(_2f9)){_2f9=1;}return {bounds:{lower:_2ed,upper:_2ee,from:min,to:max,scale:_2f9,span:span},major:{tick:_2ea,start:_2ef,count:_2f2,prec:_2f7},minor:{tick:_2eb,start:_2f0,count:_2f3,prec:_2f8},micro:{tick:_2ec,start:_2f1,count:_2f4,prec:0},minorPerMajor:_2f5,microPerMinor:_2f6,scaler:_2e4};};return lang.mixin(_2e4,{buildScaler:function(min,max,span,_2fa,_2fb,_2fc){var h={fixUpper:"none",fixLower:"none",natural:false};if(_2fa){if("fixUpper" in _2fa){h.fixUpper=String(_2fa.fixUpper);}if("fixLower" in _2fa){h.fixLower=String(_2fa.fixLower);}if("natural" in _2fa){h.natural=Boolean(_2fa.natural);}}_2fc=!_2fc||_2fc<_2e5?_2e5:_2fc;if("min" in _2fa){min=_2fa.min;}if("max" in _2fa){max=_2fa.max;}if(_2fa.includeZero){if(min>0){min=0;}if(max<0){max=0;}}h.min=min;h.useMin=true;h.max=max;h.useMax=true;if("from" in _2fa){min=_2fa.from;h.useMin=false;}if("to" in _2fa){max=_2fa.to;h.useMax=false;}if(max<=min){return _2e8(min,max,h,0,0,0,span);}if(!_2fb){_2fb=max-min;}var mag=Math.floor(Math.log(_2fb)/Math.LN10),_2fd=_2fa&&("majorTickStep" in _2fa)?_2fa.majorTickStep:Math.pow(10,mag),_2fe=0,_2ff=0,_300;if(_2fa&&("minorTickStep" in _2fa)){_2fe=_2fa.minorTickStep;}else{do{_2fe=_2fd/10;if(!h.natural||_2fe>0.9){_300=_2e8(min,max,h,_2fd,_2fe,0,span);if(_300.bounds.scale*_300.minor.tick>_2fc){break;}}_2fe=_2fd/5;if(!h.natural||_2fe>0.9){_300=_2e8(min,max,h,_2fd,_2fe,0,span);if(_300.bounds.scale*_300.minor.tick>_2fc){break;}}_2fe=_2fd/2;if(!h.natural||_2fe>0.9){_300=_2e8(min,max,h,_2fd,_2fe,0,span);if(_300.bounds.scale*_300.minor.tick>_2fc){break;}}return _2e8(min,max,h,_2fd,0,0,span);}while(false);}if(_2fa&&("microTickStep" in _2fa)){_2ff=_2fa.microTickStep;_300=_2e8(min,max,h,_2fd,_2fe,_2ff,span);}else{do{_2ff=_2fe/10;if(!h.natural||_2ff>0.9){_300=_2e8(min,max,h,_2fd,_2fe,_2ff,span);if(_300.bounds.scale*_300.micro.tick>_2e5){break;}}_2ff=_2fe/5;if(!h.natural||_2ff>0.9){_300=_2e8(min,max,h,_2fd,_2fe,_2ff,span);if(_300.bounds.scale*_300.micro.tick>_2e5){break;}}_2ff=_2fe/2;if(!h.natural||_2ff>0.9){_300=_2e8(min,max,h,_2fd,_2fe,_2ff,span);if(_300.bounds.scale*_300.micro.tick>_2e5){break;}}_2ff=0;}while(false);}return _2ff?_300:_2e8(min,max,h,_2fd,_2fe,0,span);},buildTicks:function(_301,_302){var step,next,tick,_303=_301.major.start,_304=_301.minor.start,_305=_301.micro.start;if(_302.microTicks&&_301.micro.tick){step=_301.micro.tick,next=_305;}else{if(_302.minorTicks&&_301.minor.tick){step=_301.minor.tick,next=_304;}else{if(_301.major.tick){step=_301.major.tick,next=_303;}else{return null;}}}var _306=1/_301.bounds.scale;if(_301.bounds.to<=_301.bounds.from||isNaN(_306)||!isFinite(_306)||step<=0||isNaN(step)||!isFinite(step)){return null;}var _307=[],_308=[],_309=[];while(next<=_301.bounds.to+_306){if(Math.abs(_303-next)<step/2){tick={value:_303};if(_302.majorLabels){tick.label=_2e6(_303,_301.major.prec,_302);}_307.push(tick);_303+=_301.major.tick;_304+=_301.minor.tick;_305+=_301.micro.tick;}else{if(Math.abs(_304-next)<step/2){if(_302.minorTicks){tick={value:_304};if(_302.minorLabels&&(_301.minMinorStep<=_301.minor.tick*_301.bounds.scale)){tick.label=_2e6(_304,_301.minor.prec,_302);}_308.push(tick);}_304+=_301.minor.tick;_305+=_301.micro.tick;}else{if(_302.microTicks){_309.push({value:_305});}_305+=_301.micro.tick;}}next+=step;}return {major:_307,minor:_308,micro:_309};},getTransformerFromModel:function(_30a){var _30b=_30a.bounds.from,_30c=_30a.bounds.scale;return function(x){return (x-_30b)*_30c;};},getTransformerFromPlot:function(_30d){var _30e=_30d.bounds.from,_30f=_30d.bounds.scale;return function(x){return x/_30f+_30e;};}});});},"dojox/gfx/gradutils":function(){define("dojox/gfx/gradutils",["./_base","dojo/_base/lang","./matrix","dojo/_base/Color"],function(g,lang,m,_310){var _311=g.gradutils={};function _312(o,c){if(o<=0){return c[0].color;}var len=c.length;if(o>=1){return c[len-1].color;}for(var i=0;i<len;++i){var stop=c[i];if(stop.offset>=o){if(i){var prev=c[i-1];return _310.blendColors(new _310(prev.color),new _310(stop.color),(o-prev.offset)/(stop.offset-prev.offset));}return stop.color;}}return c[len-1].color;};_311.getColor=function(fill,pt){var o;if(fill){switch(fill.type){case "linear":var _313=Math.atan2(fill.y2-fill.y1,fill.x2-fill.x1),_314=m.rotate(-_313),_315=m.project(fill.x2-fill.x1,fill.y2-fill.y1),p=m.multiplyPoint(_315,pt),pf1=m.multiplyPoint(_315,fill.x1,fill.y1),pf2=m.multiplyPoint(_315,fill.x2,fill.y2),_316=m.multiplyPoint(_314,pf2.x-pf1.x,pf2.y-pf1.y).x;o=m.multiplyPoint(_314,p.x-pf1.x,p.y-pf1.y).x/_316;break;case "radial":var dx=pt.x-fill.cx,dy=pt.y-fill.cy;o=Math.sqrt(dx*dx+dy*dy)/fill.r;break;}return _312(o,fill.colors);}return new _310(fill||[0,0,0,0]);};_311.reverse=function(fill){if(fill){switch(fill.type){case "linear":case "radial":fill=lang.delegate(fill);if(fill.colors){var c=fill.colors,l=c.length,i=0,stop,n=fill.colors=new Array(c.length);for(;i<l;++i){stop=c[i];n[i]={offset:1-stop.offset,color:stop.color};}n.sort(function(a,b){return a.offset-b.offset;});}break;}}return fill;};return _311;});},"dojox/charting/plot2d/Base":function(){define("dojox/charting/plot2d/Base",["dojo/_base/declare","../Element","dojo/_base/array","./common"],function(_317,_318,arr,_319){return _317("dojox.charting.plot2d.Base",_318,{constructor:function(_31a,_31b){},clear:function(){this.series=[];this.dirty=true;return this;},setAxis:function(axis){return this;},assignAxes:function(axes){arr.forEach(this.axes,function(axis){if(this[axis]){this.setAxis(axes[this[axis]]);}},this);},addSeries:function(run){this.series.push(run);return this;},getSeriesStats:function(){return _319.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},initializeScalers:function(){return this;},isDataDirty:function(){return arr.some(this.series,function(item){return item.dirty;});},render:function(dim,_31c){return this;},getRequiredColors:function(){return this.series.length;}});});},"dojox/charting/plot2d/Default":function(){define("dojox/charting/plot2d/Default",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(lang,_31d,arr,_31e,_31f,dc,df,dfr,du,fx){var _320=dfr.lambda("item.purgeGroup()");var _321=1200;return _31d("dojox.charting.plot2d.Default",[_31e,_31f],{defaultParams:{hAxis:"x",vAxis:"y",lines:true,areas:false,markers:false,tension:"",animate:false,enableCache:false,interpolate:false},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:"",marker:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(_322,_323){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_323);du.updateWithPattern(this.opt,_323,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},createPath:function(run,_324,_325){var path;if(this.opt.enableCache&&run._pathFreePool.length>0){path=run._pathFreePool.pop();path.setShape(_325);_324.add(path);}else{path=_324.createPath(_325);}if(this.opt.enableCache){run._pathUsePool.push(path);}return path;},buildSegments:function(i,_326){var run=this.series[i],min=_326?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0,max=_326?Math.min(run.data.length,Math.ceil(this._hScaler.bounds.to)):run.data.length,rseg=null,_327=[];for(var j=min;j<max;j++){if(run.data[j]!=null&&(_326||run.data[j].y!=null)){if(!rseg){rseg=[];_327.push({index:j,rseg:rseg});}rseg.push((_326&&run.data[j].hasOwnProperty("y"))?run.data[j].y:run.data[j]);}else{if(!this.opt.interpolate||_326){rseg=null;}}}return _327;},render:function(dim,_328){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_328);}this.resetEvents();this.dirty=this.isDirty();var s;if(this.dirty){arr.forEach(this.series,_320);this._eventSeries={};this.cleanGroup();this.group.setTransform(null);s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_329,_32a,_32b,_32c=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(this.opt.enableCache){run._pathFreePool=(run._pathFreePool?run._pathFreePool:[]).concat(run._pathUsePool?run._pathUsePool:[]);run._pathUsePool=[];}if(!run.data.length){run.dirty=false;t.skip();continue;}var _32d=t.next(this.opt.areas?"area":"line",[this.opt,run],true),_32e,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_32f=this._eventSeries[run.name]=new Array(run.data.length);s=run.group;var _330=arr.some(run.data,function(item){return typeof item=="number"||(item&&!item.hasOwnProperty("x"));});var _331=this.buildSegments(i,_330);for(var seg=0;seg<_331.length;seg++){var _332=_331[seg];if(_330){_32e=arr.map(_332.rseg,function(v,i){return {x:ht(i+_332.index+1)+_328.l,y:dim.height-_328.b-vt(v),data:v};},this);}else{_32e=arr.map(_332.rseg,function(v){return {x:ht(v.x)+_328.l,y:dim.height-_328.b-vt(v.y),data:v};},this);}if(_330&&this.opt.interpolate){while(seg<_331.length){seg++;_332=_331[seg];if(_332){_32e=_32e.concat(arr.map(_332.rseg,function(v,i){return {x:ht(i+_332.index+1)+_328.l,y:dim.height-_328.b-vt(v),data:v};},this));}}}var _333=this.opt.tension?dc.curve(_32e,this.opt.tension):"";if(this.opt.areas&&_32e.length>1){var fill=this._plotFill(_32d.series.fill,dim,_328),_334=lang.clone(_32e);if(this.opt.tension){var _335="L"+_334[_334.length-1].x+","+(dim.height-_328.b)+" L"+_334[0].x+","+(dim.height-_328.b)+" L"+_334[0].x+","+_334[0].y;run.dyn.fill=s.createPath(_333+" "+_335).setFill(fill).getFill();}else{_334.push({x:_32e[_32e.length-1].x,y:dim.height-_328.b});_334.push({x:_32e[0].x,y:dim.height-_328.b});_334.push(_32e[0]);run.dyn.fill=s.createPolyline(_334).setFill(fill).getFill();}}if(this.opt.lines||this.opt.markers){_329=_32d.series.stroke;if(_32d.series.outline){_32a=run.dyn.outline=dc.makeStroke(_32d.series.outline);_32a.width=2*_32a.width+_329.width;}}if(this.opt.markers){run.dyn.marker=_32d.symbol;}var _336=null,_337=null,_338=null;if(_329&&_32d.series.shadow&&_32e.length>1){var _339=_32d.series.shadow,_33a=arr.map(_32e,function(c){return {x:c.x+_339.dx,y:c.y+_339.dy};});if(this.opt.lines){if(this.opt.tension){run.dyn.shadow=s.createPath(dc.curve(_33a,this.opt.tension)).setStroke(_339).getStroke();}else{run.dyn.shadow=s.createPolyline(_33a).setStroke(_339).getStroke();}}if(this.opt.markers&&_32d.marker.shadow){_339=_32d.marker.shadow;_338=arr.map(_33a,function(c){return this.createPath(run,s,"M"+c.x+" "+c.y+" "+_32d.symbol).setStroke(_339).setFill(_339.color);},this);}}if(this.opt.lines&&_32e.length>1){if(_32a){if(this.opt.tension){run.dyn.outline=s.createPath(_333).setStroke(_32a).getStroke();}else{run.dyn.outline=s.createPolyline(_32e).setStroke(_32a).getStroke();}}if(this.opt.tension){run.dyn.stroke=s.createPath(_333).setStroke(_329).getStroke();}else{run.dyn.stroke=s.createPolyline(_32e).setStroke(_329).getStroke();}}if(this.opt.markers){var _33b=_32d;_336=new Array(_32e.length);_337=new Array(_32e.length);_32a=null;if(_33b.marker.outline){_32a=dc.makeStroke(_33b.marker.outline);_32a.width=2*_32a.width+(_33b.marker.stroke?_33b.marker.stroke.width:0);}arr.forEach(_32e,function(c,i){if(this.opt.styleFunc||typeof c.data!="number"){var _33c=typeof c.data!="number"?[c.data]:[];if(this.opt.styleFunc){_33c.push(this.opt.styleFunc(c.data));}_33b=t.addMixin(_32d,"marker",_33c,true);}else{_33b=t.post(_32d,"marker");}var path="M"+c.x+" "+c.y+" "+_33b.symbol;if(_32a){_337[i]=this.createPath(run,s,path).setStroke(_32a);}_336[i]=this.createPath(run,s,path).setStroke(_33b.marker.stroke).setFill(_33b.marker.fill);},this);run.dyn.markerFill=_33b.marker.fill;run.dyn.markerStroke=_33b.marker.stroke;if(_32c){arr.forEach(_336,function(s,i){var o={element:"marker",index:i+_332.index,run:run,shape:s,outline:_337[i]||null,shadow:_338&&_338[i]||null,cx:_32e[i].x,cy:_32e[i].y};if(_330){o.x=i+_332.index+1;o.y=_332.rseg[i];}else{o.x=_332.rseg[i].x;o.y=_332.rseg[i].y;}this._connectEvents(o);_32f[i+_332.index]=o;},this);}else{delete this._eventSeries[run.name];}}}run.dirty=false;}if(this.animate){var _33d=this.group;fx.animateTransform(lang.delegate({shape:_33d,duration:_321,transform:[{name:"translate",start:[0,dim.height-_328.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},this.animate)).play();}this.dirty=false;return this;}});});},"dojox/charting/plot2d/StackedLines":function(){define("dojox/charting/plot2d/StackedLines",["dojo/_base/declare","./Stacked"],function(_33e,_33f){return _33e("dojox.charting.plot2d.StackedLines",_33f,{constructor:function(){this.opt.lines=true;}});});},"dojox/color/Palette":function(){define("dojox/color/Palette",["dojo/_base/lang","dojo/_base/array","./_base"],function(lang,arr,dxc){dxc.Palette=function(base){this.colors=[];if(base instanceof dxc.Palette){this.colors=base.colors.slice(0);}else{if(base instanceof dxc.Color){this.colors=[null,null,base,null,null];}else{if(lang.isArray(base)){this.colors=arr.map(base.slice(0),function(item){if(lang.isString(item)){return new dxc.Color(item);}return item;});}else{if(lang.isString(base)){this.colors=[null,null,new dxc.Color(base),null,null];}}}}};function _340(p,_341,val){var ret=new dxc.Palette();ret.colors=[];arr.forEach(p.colors,function(item){var r=(_341=="dr")?item.r+val:item.r,g=(_341=="dg")?item.g+val:item.g,b=(_341=="db")?item.b+val:item.b,a=(_341=="da")?item.a+val:item.a;ret.colors.push(new dxc.Color({r:Math.min(255,Math.max(0,r)),g:Math.min(255,Math.max(0,g)),b:Math.min(255,Math.max(0,b)),a:Math.min(1,Math.max(0,a))}));});return ret;};function tCMY(p,_342,val){var ret=new dxc.Palette();ret.colors=[];arr.forEach(p.colors,function(item){var o=item.toCmy(),c=(_342=="dc")?o.c+val:o.c,m=(_342=="dm")?o.m+val:o.m,y=(_342=="dy")?o.y+val:o.y;ret.colors.push(dxc.fromCmy(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y))));});return ret;};function _343(p,_344,val){var ret=new dxc.Palette();ret.colors=[];arr.forEach(p.colors,function(item){var o=item.toCmyk(),c=(_344=="dc")?o.c+val:o.c,m=(_344=="dm")?o.m+val:o.m,y=(_344=="dy")?o.y+val:o.y,k=(_344=="dk")?o.b+val:o.b;ret.colors.push(dxc.fromCmyk(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y)),Math.min(100,Math.max(0,k))));});return ret;};function tHSL(p,_345,val){var ret=new dxc.Palette();ret.colors=[];arr.forEach(p.colors,function(item){var o=item.toHsl(),h=(_345=="dh")?o.h+val:o.h,s=(_345=="ds")?o.s+val:o.s,l=(_345=="dl")?o.l+val:o.l;ret.colors.push(dxc.fromHsl(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,l))));});return ret;};function tHSV(p,_346,val){var ret=new dxc.Palette();ret.colors=[];arr.forEach(p.colors,function(item){var o=item.toHsv(),h=(_346=="dh")?o.h+val:o.h,s=(_346=="ds")?o.s+val:o.s,v=(_346=="dv")?o.v+val:o.v;ret.colors.push(dxc.fromHsv(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,v))));});return ret;};function _347(val,low,high){return high-((high-val)*((high-low)/high));};lang.extend(dxc.Palette,{transform:function(_348){var fn=_340;if(_348.use){var use=_348.use.toLowerCase();if(use.indexOf("hs")==0){if(use.charAt(2)=="l"){fn=tHSL;}else{fn=tHSV;}}else{if(use.indexOf("cmy")==0){if(use.charAt(3)=="k"){fn=_343;}else{fn=tCMY;}}}}else{if("dc" in _348||"dm" in _348||"dy" in _348){if("dk" in _348){fn=_343;}else{fn=tCMY;}}else{if("dh" in _348||"ds" in _348){if("dv" in _348){fn=tHSV;}else{fn=tHSL;}}}}var _349=this;for(var p in _348){if(p=="use"){continue;}_349=fn(_349,p,_348[p]);}return _349;},clone:function(){return new dxc.Palette(this);}});lang.mixin(dxc.Palette,{generators:{analogous:function(args){var high=args.high||60,low=args.low||18,base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var h=[(hsv.h+low+360)%360,(hsv.h+Math.round(low/2)+360)%360,hsv.h,(hsv.h-Math.round(high/2)+360)%360,(hsv.h-high+360)%360];var s1=Math.max(10,(hsv.s<=95)?hsv.s+5:(100-(hsv.s-95))),s2=(hsv.s>1)?hsv.s-1:21-hsv.s,v1=(hsv.v>=92)?hsv.v-9:Math.max(hsv.v+9,20),v2=(hsv.v<=90)?Math.max(hsv.v+5,20):(95+Math.ceil((hsv.v-90)/2)),s=[s1,s2,hsv.s,s1,s1],v=[v1,v2,hsv.v,v1,v2];return new dxc.Palette(arr.map(h,function(hue,i){return dxc.fromHsv(hue,s[i],v[i]);}));},monochromatic:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var s1=(hsv.s-30>9)?hsv.s-30:hsv.s+30,s2=hsv.s,v1=_347(hsv.v,20,100),v2=(hsv.v-20>20)?hsv.v-20:hsv.v+60,v3=(hsv.v-50>20)?hsv.v-50:hsv.v+30;return new dxc.Palette([dxc.fromHsv(hsv.h,s1,v1),dxc.fromHsv(hsv.h,s2,v3),base,dxc.fromHsv(hsv.h,s1,v3),dxc.fromHsv(hsv.h,s2,v2)]);},triadic:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var h1=(hsv.h+57+360)%360,h2=(hsv.h-157+360)%360,s1=(hsv.s>20)?hsv.s-10:hsv.s+10,s2=(hsv.s>90)?hsv.s-10:hsv.s+10,s3=(hsv.s>95)?hsv.s-5:hsv.s+5,v1=(hsv.v-20>20)?hsv.v-20:hsv.v+20,v2=(hsv.v-30>20)?hsv.v-30:hsv.v+30,v3=(hsv.v-30>70)?hsv.v-30:hsv.v+30;return new dxc.Palette([dxc.fromHsv(h1,s1,hsv.v),dxc.fromHsv(hsv.h,s2,v2),base,dxc.fromHsv(h2,s2,v1),dxc.fromHsv(h2,s3,v3)]);},complementary:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,s1=Math.max(hsv.s-10,0),s2=_347(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([dxc.fromHsv(hsv.h,s1,v1),dxc.fromHsv(hsv.h,s2,v2),base,dxc.fromHsv(h1,s3,v2),dxc.fromHsv(h1,hsv.s,hsv.v)]);},splitComplementary:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,_34a=args.da||30,hsv=base.toHsv();var _34b=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,h1=(_34b-_34a+360)%360,h2=(_34b+_34a)%360,s1=Math.max(hsv.s-10,0),s2=_347(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([dxc.fromHsv(h1,s1,v1),dxc.fromHsv(h1,s2,v2),base,dxc.fromHsv(h2,s3,v2),dxc.fromHsv(h2,hsv.s,hsv.v)]);},compound:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+18<360)?(hsv.h*2)+18:Math.floor(hsv.h/2)-18,h2=((hsv.h*2)+120<360)?(hsv.h*2)+120:Math.floor(hsv.h/2)-120,h3=((hsv.h*2)+99<360)?(hsv.h*2)+99:Math.floor(hsv.h/2)-99,s1=(hsv.s-40>10)?hsv.s-40:hsv.s+40,s2=(hsv.s-10>80)?hsv.s-10:hsv.s+10,s3=(hsv.s-25>10)?hsv.s-25:hsv.s+25,v1=(hsv.v-40>10)?hsv.v-40:hsv.v+40,v2=(hsv.v-20>80)?hsv.v-20:hsv.v+20,v3=Math.max(hsv.v,20);return new dxc.Palette([dxc.fromHsv(h1,s1,v1),dxc.fromHsv(h1,s2,v2),base,dxc.fromHsv(h2,s3,v3),dxc.fromHsv(h3,s2,v2)]);},shades:function(args){var base=lang.isString(args.base)?new dxc.Color(args.base):args.base,hsv=base.toHsv();var s=(hsv.s==100&&hsv.v==0)?0:hsv.s,v1=(hsv.v-50>20)?hsv.v-50:hsv.v+30,v2=(hsv.v-25>=20)?hsv.v-25:hsv.v+55,v3=(hsv.v-75>=20)?hsv.v-75:hsv.v+5,v4=Math.max(hsv.v-10,20);return new dxc.Palette([new dxc.fromHsv(hsv.h,s,v1),new dxc.fromHsv(hsv.h,s,v2),base,new dxc.fromHsv(hsv.h,s,v3),new dxc.fromHsv(hsv.h,s,v4)]);}},generate:function(base,type){if(lang.isFunction(type)){return type({base:base});}else{if(dxc.Palette.generators[type]){return dxc.Palette.generators[type]({base:base});}}throw new Error("dojox.color.Palette.generate: the specified generator ('"+type+"') does not exist.");}});return dxc.Palette;});},"dojo/request/iframe":function(){define(["module","require","./watch","./util","./handlers","../_base/lang","../io-query","../query","../has","../dom","../dom-construct","../_base/window"],function(_34c,_34d,_34e,util,_34f,lang,_350,_351,has,dom,_352,win){var mid=_34c.id.replace(/[\/\.\-]/g,"_"),_353=mid+"_onload";if(!win.global[_353]){win.global[_353]=function(){var dfd=_354._currentDfd;if(!dfd){_354._fireNextRequest();return;}var _355=dfd.response,_356=_355.options,_357=dom.byId(_356.form)||dfd._tmpForm;if(_357){var _358=dfd._contentToClean;for(var i=0;i<_358.length;i++){var key=_358[i];for(var j=0;j<_357.childNodes.length;j++){var _359=_357.childNodes[j];if(_359.name===key){_352.destroy(_359);break;}}}dfd._originalAction&&_357.setAttribute("action",dfd._originalAction);if(dfd._originalMethod){_357.setAttribute("method",dfd._originalMethod);_357.method=dfd._originalMethod;}if(dfd._originalTarget){_357.setAttribute("target",dfd._originalTarget);_357.target=dfd._originalTarget;}}if(dfd._tmpForm){_352.destroy(dfd._tmpForm);delete dfd._tmpForm;}dfd._finished=true;};}function _35a(name,_35b,uri){if(win.global[name]){return win.global[name];}if(win.global.frames[name]){return win.global.frames[name];}if(!uri){if(has("config-useXDomain")&&!has("config-dojoBlankHtmlUrl")){console.warn("dojo/request/iframe: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}uri=(has("config-dojoBlankHtmlUrl")||_34d.toUrl("dojo/resources/blank.html"));}var _35c=_352.place("<iframe id=\""+name+"\" name=\""+name+"\" src=\""+uri+"\" onload=\""+_35b+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",win.body());win.global[name]=_35c;return _35c;};function _35d(_35e,src,_35f){var _360=win.global.frames[_35e.name];if(_360.contentWindow){_360=_360.contentWindow;}try{if(!_35f){_360.location=src;}else{_360.location.replace(src);}}catch(e){console.log("dojo/request/iframe.setSrc: ",e);}};function doc(_361){if(_361.contentDocument){return _361.contentDocument;}var name=_361.name;if(name){var _362=win.doc.getElementsByTagName("iframe");if(_361.document&&_362[name].contentWindow&&_362[name].contentWindow.document){return _362[name].contentWindow.document;}else{if(win.doc.frames[name]&&win.doc.frames[name].document){return win.doc.frames[name].document;}}}return null;};function _363(){return _352.create("form",{name:mid+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},win.body());};function _364(){var dfd;try{if(_354._currentDfd||!_354._dfdQueue.length){return;}do{dfd=_354._currentDfd=_354._dfdQueue.shift();}while(dfd&&(dfd.canceled||(dfd.isCanceled&&dfd.isCanceled()))&&_354._dfdQueue.length);if(!dfd||dfd.canceled||(dfd.isCanceled&&dfd.isCanceled())){_354._currentDfd=null;return;}var _365=dfd.response,_366=_365.options,c2c=dfd._contentToClean=[],_367=dom.byId(_366.form),_368=util.notify,data=_366.data||null,_369;if(!dfd._legacy&&_366.method==="POST"&&!_367){_367=dfd._tmpForm=_363();}else{if(_366.method==="GET"&&_367&&_365.url.indexOf("?")>-1){_369=_365.url.slice(_365.url.indexOf("?")+1);data=lang.mixin(_350.queryToObject(_369),data);}}if(_367){if(!dfd._legacy){var _36a=_367;while(_36a=_36a.parentNode&&_36a!==win.doc.documentElement){}if(!_36a){_367.style.position="absolute";_367.style.left="-1000px";_367.style.top="-1000px";win.body().appendChild(_367);}if(!_367.name){_367.name=mid+"_form";}}if(data){var _36b=function(name,_36c){_352.create("input",{type:"hidden",name:name,value:_36c},_367);c2c.push(name);};for(var x in data){var val=data[x];if(lang.isArray(val)&&val.length>1){for(var i=0;i<val.length;i++){_36b(x,val[i]);}}else{if(!_367[x]){_36b(x,val);}else{_367[x].value=val;}}}}var _36d=_367.getAttributeNode("action"),_36e=_367.getAttributeNode("method"),_36f=_367.getAttributeNode("target");if(_365.url){dfd._originalAction=_36d?_36d.value:null;if(_36d){_36d.value=_365.url;}else{_367.setAttribute("action",_365.url);}}if(!dfd._legacy){dfd._originalMethod=_36e?_36e.value:null;if(_36e){_36e.value=_366.method;}else{_367.setAttribute("method",_366.method);}}else{if(!_36e||!_36e.value){if(mthdNode){mthdNode.value=_366.method;}else{fn.setAttribute("method",_366.method);}}}dfd._originalTarget=_36f?_36f.value:null;if(_36f){_36f.value=_354._iframeName;}else{_367.setAttribute("target",_354._iframeName);}_367.target=_354._iframeName;_368&&_368.emit("send",_365,dfd.promise.cancel);_354._notifyStart(_365);_367.submit();}else{var _370="";if(_365.options.data){_370=_365.options.data;if(typeof _370!=="string"){_370=_350.objectToQuery(_370);}}var _371=_365.url+(_365.url.indexOf("?")>-1?"&":"?")+_370;_368&&_368.emit("send",_365,dfd.promise.cancel);_354._notifyStart(_365);_354.setSrc(_354._frame,_371,true);}}catch(e){dfd.reject(e);}};function _372(_373){return !this.isFulfilled();};function _374(_375){return !!this._finished;};function _376(_377,_378){if(!_378){try{var _379=_377.options,doc=_354.doc(_354._frame),_37a=_379.handleAs;if(_37a!=="html"){if(_37a==="xml"){if(doc.documentElement.tagName.toLowerCase()==="html"){_351("a",doc.documentElement).orphan();var _37b=doc.documentElement.innerText;_37b=_37b.replace(/>\s+</g,"><");_377.text=lang.trim(_37b);}else{_377.data=doc;}}else{_377.text=doc.getElementsByTagName("textarea")[0].value;}_34f(_377);}else{_377.data=doc;}}catch(e){_378=e;}}if(_378){this.reject(_378);}else{if(this._finished){this.resolve(_377);}else{this.reject(new Error("Invalid dojo/request/iframe request state"));}}};function last(_37c){this._callNext();};var _37d={method:"POST"};function _354(url,_37e,_37f){var _380=util.parseArgs(url,util.deepCreate(_37d,_37e),true);url=_380.url;_37e=_380.options;if(_37e.method!=="GET"&&_37e.method!=="POST"){throw new Error(_37e.method+" not supported by dojo/request/iframe");}if(!_354._frame){_354._frame=_354.create(_354._iframeName,_353+"();");}var dfd=util.deferred(_380,null,_372,_374,_376,last);dfd._callNext=function(){if(!this._calledNext){this._calledNext=true;_354._currentDfd=null;_354._fireNextRequest();}};dfd._legacy=_37f;_354._dfdQueue.push(dfd);_354._fireNextRequest();_34e(dfd);return _37f?dfd:dfd.promise;};_354.create=_35a;_354.doc=doc;_354.setSrc=_35d;_354._iframeName=mid+"_IoIframe";_354._notifyStart=function(){};_354._dfdQueue=[];_354._currentDfd=null;_354._fireNextRequest=_364;util.addCommonMethods(_354,["GET","POST"]);return _354;});},"dojox/charting/axis2d/common":function(){define("dojox/charting/axis2d/common",["dojo/_base/lang","dojo/_base/window","dojo/dom-geometry","dojox/gfx"],function(lang,win,_381,g){var _382=lang.getObject("dojox.charting.axis2d.common",true);var _383=function(s){s.marginLeft="0px";s.marginTop="0px";s.marginRight="0px";s.marginBottom="0px";s.paddingLeft="0px";s.paddingTop="0px";s.paddingRight="0px";s.paddingBottom="0px";s.borderLeftWidth="0px";s.borderTopWidth="0px";s.borderRightWidth="0px";s.borderBottomWidth="0px";};var _384=function(n){if(n["getBoundingClientRect"]){var bcr=n.getBoundingClientRect();return bcr.width||(bcr.right-bcr.left);}else{return _381.getMarginBox(n).w;}};return lang.mixin(_382,{createText:{gfx:function(_385,_386,x,y,_387,text,font,_388){return _386.createText({x:x,y:y,text:text,align:_387}).setFont(font).setFill(_388);},html:function(_389,_38a,x,y,_38b,text,font,_38c,_38d){var p=win.doc.createElement("div"),s=p.style,_38e;if(_389.getTextDir){p.dir=_389.getTextDir(text);}_383(s);s.font=font;p.innerHTML=String(text).replace(/\s/g,"&nbsp;");s.color=_38c;s.position="absolute";s.left="-10000px";win.body().appendChild(p);var size=g.normalizedLength(g.splitFontString(font).size);if(!_38d){_38e=_384(p);}if(p.dir=="rtl"){x+=_38d?_38d:_38e;}win.body().removeChild(p);s.position="relative";if(_38d){s.width=_38d+"px";switch(_38b){case "middle":s.textAlign="center";s.left=(x-_38d/2)+"px";break;case "end":s.textAlign="right";s.left=(x-_38d)+"px";break;default:s.left=x+"px";s.textAlign="left";break;}}else{switch(_38b){case "middle":s.left=Math.floor(x-_38e/2)+"px";break;case "end":s.left=Math.floor(x-_38e)+"px";break;default:s.left=Math.floor(x)+"px";break;}}s.top=Math.floor(y-size)+"px";s.whiteSpace="nowrap";var wrap=win.doc.createElement("div"),w=wrap.style;_383(w);w.width="0px";w.height="0px";wrap.appendChild(p);_389.node.insertBefore(wrap,_389.node.firstChild);return wrap;}}});});},"dojo/fx/easing":function(){define(["../_base/lang"],function(lang){var _38f={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-_38f.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return _38f.bounceIn(n*2)/2;}return (_38f.bounceOut(n*2-1)/2)+0.5;}};lang.setObject("dojo.fx.easing",_38f);return _38f;});},"dojox/charting/plot2d/StackedAreas":function(){define("dojox/charting/plot2d/StackedAreas",["dojo/_base/declare","./Stacked"],function(_390,_391){return _390("dojox.charting.plot2d.StackedAreas",_391,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});});},"dojox/charting/themes/PlotKit/base":function(){define("dojox/charting/themes/PlotKit/base",["dojo/_base/lang","dojo/_base/Color","../../Theme","../common"],function(lang,_392,_393,_394){var pk=lang.getObject("PlotKit",true,_394);pk.base=new _393({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:0.5},majorTick:{color:"#fff",width:0.5,length:6},minorTick:{color:"#fff",width:0.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});pk.base.next=function(_395,_396,_397){var _398=_393.prototype.next.apply(this,arguments);if(_395=="line"){_398.marker.outline={width:2,color:"#fff"};_398.series.stroke.width=3.5;_398.marker.stroke.width=2;}else{if(_395=="candlestick"){_398.series.stroke.width=1;}else{if(_398.series.stroke.color&&(_398.series.stroke.color.toString()==new _392(this.colors[(this._current-1)%this.colors.length]).toString())){_398.series.stroke.color="#fff";}}}return _398;};return pk;});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_399,_39a){var _39b={};lang.setObject("dojo.data.util.simpleFetch",_39b);_39b.errorHandler=function(_39c,_39d){if(_39d.onError){var _39e=_39d.scope||_399.global;_39d.onError.call(_39e,_39c,_39d);}};_39b.fetchHandler=function(_39f,_3a0){var _3a1=_3a0.abort||null,_3a2=false,_3a3=_3a0.start?_3a0.start:0,_3a4=(_3a0.count&&(_3a0.count!==Infinity))?(_3a3+_3a0.count):_39f.length;_3a0.abort=function(){_3a2=true;if(_3a1){_3a1.call(_3a0);}};var _3a5=_3a0.scope||_399.global;if(!_3a0.store){_3a0.store=this;}if(_3a0.onBegin){_3a0.onBegin.call(_3a5,_39f.length,_3a0);}if(_3a0.sort){_39f.sort(_39a.createSortFunction(_3a0.sort,this));}if(_3a0.onItem){for(var i=_3a3;(i<_39f.length)&&(i<_3a4);++i){var item=_39f[i];if(!_3a2){_3a0.onItem.call(_3a5,item,_3a0);}}}if(_3a0.onComplete&&!_3a2){var _3a6=null;if(!_3a0.onItem){_3a6=_39f.slice(_3a3,_3a4);}_3a0.onComplete.call(_3a5,_3a6,_3a0);}};_39b.fetch=function(_3a7){_3a7=_3a7||{};if(!_3a7.store){_3a7.store=this;}this._fetchItems(_3a7,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _3a7;};return _39b;});},"dojox/charting/plot2d/_PlotEvents":function(){define("dojox/charting/plot2d/_PlotEvents",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect"],function(lang,arr,_3a8,hub){return _3a8("dojox.charting.plot2d._PlotEvents",null,{constructor:function(){this._shapeEvents=[];this._eventSeries={};},destroy:function(){this.resetEvents();this.inherited(arguments);},plotEvent:function(o){},raiseEvent:function(o){this.plotEvent(o);var t=lang.delegate(o);t.originalEvent=o.type;t.originalPlot=o.plot;t.type="onindirect";arr.forEach(this.chart.stack,function(plot){if(plot!==this&&plot.plotEvent){t.plot=plot;plot.plotEvent(t);}},this);},connect:function(_3a9,_3aa){this.dirty=true;return hub.connect(this,"plotEvent",_3a9,_3aa);},events:function(){return !!this.plotEvent.after;},resetEvents:function(){if(this._shapeEvents.length){arr.forEach(this._shapeEvents,function(item){item.shape.disconnect(item.handle);});this._shapeEvents=[];}this.raiseEvent({type:"onplotreset",plot:this});},_connectSingleEvent:function(o,_3ab){this._shapeEvents.push({shape:o.eventMask,handle:o.eventMask.connect(_3ab,this,function(e){o.type=_3ab;o.event=e;this.raiseEvent(o);o.event=null;})});},_connectEvents:function(o){if(o){o.chart=this.chart;o.plot=this;o.hAxis=this.hAxis||null;o.vAxis=this.vAxis||null;o.eventMask=o.eventMask||o.shape;this._connectSingleEvent(o,"onmouseover");this._connectSingleEvent(o,"onmouseout");this._connectSingleEvent(o,"onclick");}},_reconnectEvents:function(_3ac){var a=this._eventSeries[_3ac];if(a){arr.forEach(a,this._connectEvents,this);}},fireEvent:function(_3ad,_3ae,_3af,_3b0){var s=this._eventSeries[_3ad];if(s&&s.length&&_3af<s.length){var o=s[_3af];o.type=_3ae;o.event=_3b0||null;this.raiseEvent(o);o.event=null;}}});});},"dojox/charting/plot2d/commonStacked":function(){define("dojox/charting/plot2d/commonStacked",["dojo/_base/lang","./common"],function(lang,_3b1){var _3b2=lang.getObject("dojox.charting.plot2d.commonStacked",true);return lang.mixin(_3b2,{collectStats:function(_3b3){var _3b4=lang.delegate(_3b1.defaultStats);for(var i=0;i<_3b3.length;++i){var run=_3b3[i];for(var j=0;j<run.data.length;j++){var x,y;if(run.data[j]!==null){if(typeof run.data[j]=="number"||!run.data[j].x){y=_3b2.getIndexValue(_3b3,i,j);x=j+1;}else{x=run.data[j].x;if(x){y=_3b2.getValue(_3b3,i,x);y=y!=null&&y.y?y.y:null;}}_3b4.hmin=Math.min(_3b4.hmin,x);_3b4.hmax=Math.max(_3b4.hmax,x);_3b4.vmin=Math.min(_3b4.vmin,y);_3b4.vmax=Math.max(_3b4.vmax,y);}}}return _3b4;},getIndexValue:function(_3b5,i,_3b6){var _3b7=0,v,j;for(j=0;j<=i;++j){v=_3b5[j].data[_3b6];if(v!=null){if(isNaN(v)){v=v.y||0;}_3b7+=v;}}return _3b7;},getValue:function(_3b8,i,x){var _3b9=null,j,z;for(j=0;j<=i;++j){for(z=0;z<_3b8[j].data.length;z++){v=_3b8[j].data[z];if(v!==null){if(v.x==x){if(!_3b9){_3b9={x:x};}if(v.y!=null){if(_3b9.y==null){_3b9.y=0;}_3b9.y+=v.y;}break;}else{if(v.x>x){break;}}}}}return _3b9;}});});},"esri/PopupBase":function(){define("esri/PopupBase",["dijit","dojo","dojox"],function(_3ba,dojo,_3bb){dojo.provide("esri.PopupBase");dojo.declare("esri.PopupBase",null,{onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){var _3bc=this._marked;if(_3bc){this._marked=null;this.showClosestFirst(_3bc);}},initialize:function(){this.count=0;this.selectedIndex=-1;},cleanup:function(){this.features=this.deferreds=null;},setFeatures:function(arg){if(!arg||!arg.length){return;}this.clearFeatures();var _3bd,_3be;if(arg[0] instanceof dojo.Deferred){_3be=arg;}else{_3bd=arg;}if(_3bd){this._updateFeatures(null,_3bd);}else{this.deferreds=_3be;_3be=_3be.slice(0);dojo.forEach(_3be,function(dfd){dfd.addBoth(dojo.hitch(this,this._updateFeatures,dfd));},this);}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=0;var _3bf=this.selectedIndex;this.selectedIndex=-1;if(_3bf>-1){this.onSelectionChange();}this.onClearFeatures();},getSelectedFeature:function(){var _3c0=this.features;if(_3c0){return _3c0[this.selectedIndex];}},select:function(_3c1){if(_3c1<0||_3c1>=this.count){return;}this.selectedIndex=_3c1;this.onSelectionChange();},enableHighlight:function(map){this._highlighted=map.graphics.add(new esri.Graphic(new esri.geometry.Point(0,0,map.spatialReference)));this._highlighted.hide();var ESYM=esri.symbol;if(!this.markerSymbol){var _3c2=(this.markerSymbol=new ESYM.SimpleMarkerSymbol());_3c2.setStyle(ESYM.SimpleMarkerSymbol.STYLE_TARGET);_3c2._setDim(16,16,7);_3c2.setOutline(new ESYM.CartographicLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2,ESYM.CartographicLineSymbol.CAP_ROUND,ESYM.CartographicLineSymbol.JOIN_ROUND));_3c2.setColor(new dojo.Color([0,0,0,0]));}if(!this.lineSymbol){this.lineSymbol=new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2);}if(!this.fillSymbol){this.fillSymbol=new ESYM.SimpleFillSymbol(ESYM.SimpleFillSymbol.STYLE_NULL,new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2),new dojo.Color([0,0,0,0]));}},disableHighlight:function(map){var _3c3=this._highlighted;if(_3c3){_3c3.hide();map.graphics.remove(_3c3);delete this._highlighted;}this.markerSymbol=this.lineSymbol=this.fillSymbol=null;},showHighlight:function(){var _3c4=this.features&&this.features[this.selectedIndex];if(this._highlighted&&_3c4&&_3c4.geometry){this._highlighted.show();}},hideHighlight:function(){if(this._highlighted){this._highlighted.hide();}},updateHighlight:function(map,_3c5){var _3c6=_3c5.geometry,_3c7=this._highlighted;if(!_3c6||!_3c7){if(_3c7){_3c7.hide();}return;}_3c7.hide();if(!_3c7.getLayer()&&map){map.graphics.add(_3c7);}_3c7.setGeometry(esri.geometry.fromJson(_3c6.toJson()));var _3c8;switch(_3c6.type){case "point":case "multipoint":_3c8=this.markerSymbol;_3c8.setOffset(0,0);_3c8.setAngle(0);var lyr=_3c5.getLayer();if(lyr){var _3c9=lyr._getSymbol(_3c5),_3ca,_3cb,xoff=0,yoff=0,_3cc=0;if(_3c9){switch(_3c9.type){case "simplemarkersymbol":_3ca=_3cb=(_3c9.size||0);break;case "picturemarkersymbol":_3ca=(_3c9.width||0);_3cb=(_3c9.height||0);break;}xoff=_3c9.xoffset||0;yoff=_3c9.yoffset||0;_3cc=_3c9.angle||0;}if(_3ca&&_3cb){_3c8._setDim(_3ca+1,_3cb+1,7);}_3c8.setOffset(xoff,yoff);_3c8.setAngle(_3cc);}break;case "polyline":_3c8=this.lineSymbol;break;case "polygon":_3c8=this.fillSymbol;break;}_3c7.setSymbol(_3c8);},showClosestFirst:function(_3cd){var _3ce=this.features;if(_3ce&&_3ce.length){if(_3ce.length>1){var i,_3cf=Infinity,_3d0=-1,geom,_3d1=esri.geometry.getLength,_3d2,_3d3=_3cd.spatialReference,_3d4,_3d5;_3cd=_3cd.normalize();for(i=_3ce.length-1;i>=0;i--){geom=_3ce[i].geometry;if(!geom){continue;}_3d4=geom.spatialReference;_3d2=0;try{_3d5=(geom.type==="point")?geom:geom.getExtent().getCenter();_3d5=_3d5.normalize();if(_3d3&&_3d4&&!_3d3.equals(_3d4)&&_3d3._canProject(_3d4)){_3d5=_3d3.isWebMercator()?esri.geometry.geographicToWebMercator(_3d5):esri.geometry.webMercatorToGeographic(_3d5);}_3d2=_3d1(_3cd,_3d5);}catch(e){}if(_3d2>0&&_3d2<_3cf){_3cf=_3d2;_3d0=i;}}if(_3d0>0){_3ce.splice(0,0,_3ce.splice(_3d0,1)[0]);this.select(0);}}}else{if(this.deferreds){this._marked=_3cd;}}},_unbind:function(dfd){var _3d6=dojo.indexOf(this.deferreds,dfd);if(_3d6===-1){return;}this.deferreds.splice(_3d6,1);if(!this.deferreds.length){this.deferreds=null;return 2;}return 1;},_updateFeatures:function(dfd,_3d7){if(dfd){if(this.deferreds){var res=this._unbind(dfd);if(!res){return;}if(_3d7&&_3d7 instanceof Error){this.onDfdComplete(_3d7);if(res===2){this.onSetFeatures();}return;}if(_3d7&&_3d7.length){if(!this.features){this.features=_3d7;this.count=_3d7.length;this.selectedIndex=0;this.onDfdComplete();if(res===2){this.onSetFeatures();}this.select(0);}else{var _3d8=dojo.filter(_3d7,function(_3d9){return dojo.indexOf(this.features,_3d9)===-1;},this);this.features=this.features.concat(_3d8);this.count=this.features.length;this.onDfdComplete();if(res===2){this.onSetFeatures();}}}else{this.onDfdComplete();if(res===2){this.onSetFeatures();}}}}else{this.features=_3d7;this.count=_3d7.length;this.selectedIndex=0;this.onSetFeatures();this.select(0);}}});dojo.declare("esri.PopupInfoTemplate",[esri.InfoTemplate],{"-chains-":{constructor:"manual"},initialize:function(json){if(!json){return;}this.info=json;this.title=this.getTitle;this.content=this.getContent;var _3da=(this._fieldLabels={}),_3db=(this._fieldsMap={});if(json.fieldInfos){dojo.forEach(json.fieldInfos,function(_3dc){_3da[_3dc.fieldName]=_3dc.label;_3db[_3dc.fieldName]=_3dc;});}},toJson:function(){return dojo.fromJson(dojo.toJson(this.info));},getTitle:function(){},getContent:function(){},getComponents:function(_3dd){var _3de=this.info,_3df=_3dd.getLayer(),_3e0=dojo.clone(_3dd.attributes)||{},_3e1=dojo.clone(_3e0),_3e2=_3de.fieldInfos,_3e3="",_3e4="",_3e5,_3e6,_3e7,_3e8=_3df&&_3df._getDateOpts&&_3df._getDateOpts().properties,_3e9={dateFormat:{properties:_3e8,formatter:"DateFormat"+this._dateFormats["shortDateShortTime"]}};if(_3e2){dojo.forEach(_3e2,function(_3ea){var _3eb=_3ea.fieldName,val=_3e1[_3eb];_3e1[_3eb]=this._formatValue(val,_3eb,_3e9);if(_3e8&&_3ea.format&&_3ea.format.dateFormat){var pos=dojo.indexOf(_3e8,_3eb);if(pos>-1){_3e8.splice(pos,1);}}},this);}if(_3df){var _3ec=_3df.types,_3ed=_3df.typeIdField,_3ee=_3ed&&_3e0[_3ed];for(_3e6 in _3e0){_3e7=_3e0[_3e6];if(esri._isDefined(_3e7)){var _3ef=this._getDomainName(_3df,_3ec,_3ee,_3e6,_3e7);if(esri._isDefined(_3ef)){_3e1[_3e6]=_3ef;}else{if(_3e6===_3ed){var _3f0=this._getTypeName(_3df,_3e7);if(esri._isDefined(_3f0)){_3e1[_3e6]=_3f0;}}}}}}if(_3de.title){_3e3=dojo.trim(esri.substitute(_3e1,this._fixTokens(_3de.title),_3e9)||"");}if(_3de.description){_3e4=dojo.trim(esri.substitute(_3e1,this._fixTokens(_3de.description),_3e9)||"");}if(_3e2){_3e5=[];dojo.forEach(_3e2,function(_3f1){_3e6=_3f1.fieldName;if(_3e6&&_3f1.visible){_3e5.push([_3f1.label||_3e6,esri.substitute(_3e1,"${"+_3e6+"}",_3e9)||""]);}});}var _3f2,_3f3;if(_3de.mediaInfos){_3f2=[];dojo.forEach(_3de.mediaInfos,function(_3f4){_3f3=0;_3e7=_3f4.value;switch(_3f4.type){case "image":var url=_3e7.sourceURL;url=url&&dojo.trim(esri.substitute(_3e0,this._fixTokens(url)));_3f3=!!url;break;case "piechart":case "linechart":case "columnchart":case "barchart":_3f3=dojo.some(_3e7.fields,function(_3f5){return esri._isDefined(_3e0[_3f5]);});break;default:return;}if(_3f3){_3f4=dojo.clone(_3f4);_3e7=_3f4.value;_3f4.title=_3f4.title?dojo.trim(esri.substitute(_3e1,this._fixTokens(_3f4.title),_3e9)||""):"";_3f4.caption=_3f4.caption?dojo.trim(esri.substitute(_3e1,this._fixTokens(_3f4.caption),_3e9)||""):"";if(_3f4.type==="image"){_3e7.sourceURL=esri.substitute(_3e0,this._fixTokens(_3e7.sourceURL));if(_3e7.linkURL){_3e7.linkURL=dojo.trim(esri.substitute(_3e0,this._fixTokens(_3e7.linkURL))||"");}}else{var _3f6=_3e0[_3e7.normalizeField]||0;_3e7.fields=dojo.map(_3e7.fields,function(_3f7){var data=_3e0[_3f7];data=(data===undefined)?null:data;if(data&&_3f6){data=data/_3f6;}return {y:data,tooltip:(this._fieldLabels[_3f7]||_3f7)+":<br/>"+this._formatValue(data,_3f7,_3e9,!!_3f6)};},this);}_3f2.push(_3f4);}},this);}return {title:_3e3,description:_3e4,fields:(_3e5&&_3e5.length)?_3e5:null,mediaInfos:(_3f2&&_3f2.length)?_3f2:null,formatted:_3e1,editSummary:(_3df&&_3df.getEditSummary)?_3df.getEditSummary(_3dd):""};},getAttachments:function(_3f8){var _3f9=_3f8.getLayer(),_3fa=_3f8.attributes;if(this.info.showAttachments&&_3f9&&_3f9.hasAttachments&&_3f9.objectIdField){var oid=_3fa&&_3fa[_3f9.objectIdField];if(oid){return _3f9.queryAttachmentInfos(oid);}}},_dateFormats:{"shortDate":"(datePattern: 'M/d/y', selector: 'date')","longMonthDayYear":"(datePattern: 'MMMM d, y', selector: 'date')","dayShortMonthYear":"(datePattern: 'd MMM y', selector: 'date')","longDate":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","shortDateShortTime":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","shortDateShortTime24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","shortDateLongTime":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')","shortDateLongTime24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","longMonthYear":"(datePattern: 'MMMM y', selector: 'date')","shortMonthYear":"(datePattern: 'MMM y', selector: 'date')","year":"(datePattern: 'y', selector: 'date')"},_fixTokens:function(_3fb){return _3fb.replace(/(\{[^\{\r\n]+\})/g,"$$$1");},_formatValue:function(val,_3fc,_3fd,_3fe){var _3ff=this._fieldsMap[_3fc],fmt=_3ff&&_3ff.format;if(!esri._isDefined(val)||!_3ff||!esri._isDefined(fmt)){return val;}var _400="",_401=[],_402=fmt.hasOwnProperty("places")||fmt.hasOwnProperty("digitSeparator"),_403=fmt.hasOwnProperty("digitSeparator")?fmt.digitSeparator:true;if(_402){_400="NumberFormat";_401.push("places: "+((esri._isDefined(fmt.places)&&(!_3fe||fmt.places>0))?Number(fmt.places):"Infinity"));if(_401.length){_400+=("("+_401.join(",")+")");}}else{if(fmt.dateFormat){_400="DateFormat"+(this._dateFormats[fmt.dateFormat]||this._dateFormats["shortDateShortTime"]);}else{return val;}}var _404=esri.substitute({"myKey":val},"${myKey:"+_400+"}",_3fd)||"";if(_402&&!_403){var _405=dojo.i18n.getLocalization("dojo.cldr","number");if(_405.group){_404=_404.replace(new RegExp("\\"+_405.group,"g"),"");}}return _404;},_getDomainName:function(_406,_407,_408,_409,_40a){var _40b,stop;if(_407&&esri._isDefined(_408)){dojo.some(_407,function(_40c){if(_40c.id==_408){_40b=_40c.domains&&_40c.domains[_409];if(_40b&&_40b.type==="inherited"){_40b=this._getLayerDomain(_406,_409);stop=true;}return true;}return false;},this);}if(!stop&&!_40b){_40b=this._getLayerDomain(_406,_409);}if(_40b&&_40b.codedValues){var _40d;dojo.some(_40b.codedValues,function(_40e){if(_40e.code==_40a){_40d=_40e.name;return true;}return false;});return _40d;}},_getLayerDomain:function(_40f,_410){var _411=_40f.fields;if(_411){var _412;dojo.some(_411,function(_413){if(_413.name===_410){_412=_413.domain;return true;}return false;});return _412;}},_getTypeName:function(_414,id){var _415=_414.types;if(_415){var _416;dojo.some(_415,function(_417){if(_417.id==id){_416=_417.name;return true;}return false;});return _416;}}});});},"dojox/charting/Element":function(){define("dojox/charting/Element",["dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/_base/declare","dojox/gfx","dojox/gfx/shape"],function(lang,arr,_418,_419,gfx,_41a){return _419("dojox.charting.Element",null,{chart:null,group:null,htmlElements:null,dirty:true,constructor:function(_41b){this.chart=_41b;this.group=null;this.htmlElements=[];this.dirty=true;this.trailingSymbol="...";this._events=[];},purgeGroup:function(){this.destroyHtmlElements();if(this.group){this.group.removeShape();var _41c=this.group.children;for(var i=0;i<_41c.length;++i){_41a.dispose(_41c[i]);}this.group.clear();this.group=null;}this.dirty=true;if(this._events.length){arr.forEach(this._events,function(item){item.shape.disconnect(item.handle);});this._events=[];}return this;},cleanGroup:function(_41d){this.destroyHtmlElements();if(!_41d){_41d=this.chart.surface;}if(this.group){var _41e=this.group.children;for(var i=0;i<_41e.length;++i){_41a.dispose(_41e[i]);}this.group.clear();}else{this.group=_41d.createGroup();}this.dirty=true;return this;},destroyHtmlElements:function(){if(this.htmlElements.length){arr.forEach(this.htmlElements,_418.destroy);this.htmlElements=[];}},destroy:function(){this.purgeGroup();},getTextWidth:function(s,font){return gfx._base._getTextBox(s,{font:font}).w||0;},getTextWithLimitLength:function(s,font,_41f,_420){if(!s||s.length<=0){return {text:"",truncated:_420||false};}if(!_41f||_41f<=0){return {text:s,truncated:_420||false};}var _421=2,_422=0.618,_423=s.substring(0,1)+this.trailingSymbol,_424=this.getTextWidth(_423,font);if(_41f<=_424){return {text:_423,truncated:true};}var _425=this.getTextWidth(s,font);if(_425<=_41f){return {text:s,truncated:_420||false};}else{var _426=0,end=s.length;while(_426<end){if(end-_426<=_421){while(this.getTextWidth(s.substring(0,_426)+this.trailingSymbol,font)>_41f){_426-=1;}return {text:(s.substring(0,_426)+this.trailingSymbol),truncated:true};}var _427=_426+Math.round((end-_426)*_422),_428=this.getTextWidth(s.substring(0,_427),font);if(_428<_41f){_426=_427;end=end;}else{_426=_426;end=_427;}}}},getTextWithLimitCharCount:function(s,font,_429,_42a){if(!s||s.length<=0){return {text:"",truncated:_42a||false};}if(!_429||_429<=0||s.length<=_429){return {text:s,truncated:_42a||false};}return {text:s.substring(0,_429)+this.trailingSymbol,truncated:true};},_plotFill:function(fill,dim,_42b){if(!fill||!fill.type||!fill.space){return fill;}var _42c=fill.space,span;switch(fill.type){case "linear":if(_42c==="plot"||_42c==="shapeX"||_42c==="shapeY"){fill=gfx.makeParameters(gfx.defaultLinearGradient,fill);fill.space=_42c;if(_42c==="plot"||_42c==="shapeX"){span=dim.height-_42b.t-_42b.b;fill.y1=_42b.t+span*fill.y1/100;fill.y2=_42b.t+span*fill.y2/100;}if(_42c==="plot"||_42c==="shapeY"){span=dim.width-_42b.l-_42b.r;fill.x1=_42b.l+span*fill.x1/100;fill.x2=_42b.l+span*fill.x2/100;}}break;case "radial":if(_42c==="plot"){fill=gfx.makeParameters(gfx.defaultRadialGradient,fill);fill.space=_42c;var _42d=dim.width-_42b.l-_42b.r,_42e=dim.height-_42b.t-_42b.b;fill.cx=_42b.l+_42d*fill.cx/100;fill.cy=_42b.t+_42e*fill.cy/100;fill.r=fill.r*Math.sqrt(_42d*_42d+_42e*_42e)/200;}break;case "pattern":if(_42c==="plot"||_42c==="shapeX"||_42c==="shapeY"){fill=gfx.makeParameters(gfx.defaultPattern,fill);fill.space=_42c;if(_42c==="plot"||_42c==="shapeX"){span=dim.height-_42b.t-_42b.b;fill.y=_42b.t+span*fill.y/100;fill.height=span*fill.height/100;}if(_42c==="plot"||_42c==="shapeY"){span=dim.width-_42b.l-_42b.r;fill.x=_42b.l+span*fill.x/100;fill.width=span*fill.width/100;}}break;}return fill;},_shapeFill:function(fill,bbox){if(!fill||!fill.space){return fill;}var _42f=fill.space,span;switch(fill.type){case "linear":if(_42f==="shape"||_42f==="shapeX"||_42f==="shapeY"){fill=gfx.makeParameters(gfx.defaultLinearGradient,fill);fill.space=_42f;if(_42f==="shape"||_42f==="shapeX"){span=bbox.width;fill.x1=bbox.x+span*fill.x1/100;fill.x2=bbox.x+span*fill.x2/100;}if(_42f==="shape"||_42f==="shapeY"){span=bbox.height;fill.y1=bbox.y+span*fill.y1/100;fill.y2=bbox.y+span*fill.y2/100;}}break;case "radial":if(_42f==="shape"){fill=gfx.makeParameters(gfx.defaultRadialGradient,fill);fill.space=_42f;fill.cx=bbox.x+bbox.width/2;fill.cy=bbox.y+bbox.height/2;fill.r=fill.r*bbox.width/200;}break;case "pattern":if(_42f==="shape"||_42f==="shapeX"||_42f==="shapeY"){fill=gfx.makeParameters(gfx.defaultPattern,fill);fill.space=_42f;if(_42f==="shape"||_42f==="shapeX"){span=bbox.width;fill.x=bbox.x+span*fill.x/100;fill.width=span*fill.width/100;}if(_42f==="shape"||_42f==="shapeY"){span=bbox.height;fill.y=bbox.y+span*fill.y/100;fill.height=span*fill.height/100;}}break;}return fill;},_pseudoRadialFill:function(fill,_430,_431,_432,end){if(!fill||fill.type!=="radial"||fill.space!=="shape"){return fill;}var _433=fill.space;fill=gfx.makeParameters(gfx.defaultRadialGradient,fill);fill.space=_433;if(arguments.length<4){fill.cx=_430.x;fill.cy=_430.y;fill.r=fill.r*_431/100;return fill;}var _434=arguments.length<5?_432:(end+_432)/2;return {type:"linear",x1:_430.x,y1:_430.y,x2:_430.x+fill.r*_431*Math.cos(_434)/100,y2:_430.y+fill.r*_431*Math.sin(_434)/100,colors:fill.colors};return fill;}});});},"dojox/charting/axis2d/Base":function(){define("dojox/charting/axis2d/Base",["dojo/_base/declare","../Element"],function(_435,_436){return _435("dojox.charting.axis2d.Base",_436,{constructor:function(_437,_438){this.vertical=_438&&_438.vertical;this.opt={};this.opt.min=_438&&_438.min;this.opt.max=_438&&_438.max;},clear:function(){return this;},initialized:function(){return false;},calculate:function(min,max,span){return this;},getScaler:function(){return null;},getTicks:function(){return null;},getOffsets:function(){return {l:0,r:0,t:0,b:0};},render:function(dim,_439){this.dirty=false;return this;}});});},"dojox/lang/functional/scan":function(){define("dojox/lang/functional/scan",["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(_43a,lang,df){var _43b={};lang.mixin(df,{scanl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||_43a.global;f=df.lambda(f);var t,n,i;if(lang.isArray(a)){t=new Array((n=a.length)+1);t[0]=z;for(i=0;i<n;z=f.call(o,z,a[i],i,a),t[++i]=z){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[z];for(i=0;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}else{t=[z];for(i in a){if(!(i in _43b)){t.push(z=f.call(o,z,a[i],i,a));}}}}return t;},scanl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_43a.global;f=df.lambda(f);var t,n,z,_43c=true;if(lang.isArray(a)){t=new Array(n=a.length);t[0]=z=a[0];for(var i=1;i<n;t[i]=z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){t=[z=a.next()];for(i=1;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}}else{for(i in a){if(!(i in _43b)){if(_43c){t=[z=a[i]];_43c=false;}else{t.push(z=f.call(o,z,a[i],i,a));}}}}}return t;},scanr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||_43a.global;f=df.lambda(f);var n=a.length,t=new Array(n+1),i=n;t[n]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;},scanr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_43a.global;f=df.lambda(f);var n=a.length,t=new Array(n),z=a[n-1],i=n-1;t[i]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;}});});},"esri/layers/wms":function(){define("esri/layers/wms",["dijit","dojo","dojox","dojo/require!esri/layers/dynamic,esri/layers/agscommon"],function(_43d,dojo,_43e){dojo.provide("esri.layers.wms");dojo.require("esri.layers.dynamic");dojo.require("esri.layers.agscommon");dojo.declare("esri.layers.WMSLayer",[esri.layers.DynamicMapServiceLayer],{_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],constructor:function(url,_43f){url=this._stripParameters(url,["version","service","request","bbox","format","height","width","layers","srs","crs","styles","transparent","bgcolor","exceptions","time","elevation","sld","wfs"]);this.url=url;this._url=esri.urlToObject(url);this._getCapabilitiesURL=url;this._initLayer=dojo.hitch(this,this._initLayer);this._parseCapabilities=dojo.hitch(this,this._parseCapabilities);this._getCapabilitiesError=dojo.hitch(this,this._getCapabilitiesError);if(_43f){this.imageFormat=this._getImageFormat(_43f.format);this.imageTransparency=(_43f.transparent===false)?false:true;this.visibleLayers=_43f.visibleLayers?_43f.visibleLayers:[];if(_43f.resourceInfo){this._readResourceInfo(_43f.resourceInfo);}else{this._getCapabilities();}}else{this.imageFormat="image/png";this.imageTransparency=true;this.visibleLayers=[];this._getCapabilities();}this._blankImageURL=require.toUrl("esri/layers")+"/../images/pixel.png";},setVisibleLayers:function(_440){_440=this._checkVisibleLayersList(_440);this.visibleLayers=(_440)?_440:[];this.refresh(true);},setImageFormat:function(_441){this.imageFormat=this._getImageFormat(_441);this.refresh(true);},setImageTransparency:function(_442){this.imageTransparency=_442;this.refresh(true);},getImageUrl:function(_443,_444,_445,_446){if(!this.visibleLayers||this.visibleLayers.length===0){_446(this._blankImageURL);return;}var wkid=_443.spatialReference.wkid;if(dojo.some(this._WEB_MERCATOR,function(el){return el==wkid;})){var _447=dojo.filter(this.spatialReferences,function(el){return (dojo.some(this._WEB_MERCATOR,function(el2){return el2==el;}));},this);if(_447.length==0){_447=dojo.filter(this.spatialReferences,function(el){return (dojo.some(this._WORLD_MERCATOR,function(el2){return el2==el;}));},this);}if(_447.length>0){wkid=_447[0];}else{wkid=this._WEB_MERCATOR[0];}}var list=dojo.filter(this.spatialReferences,function(el){return el!==wkid;});this.spatialReferences=list;this.spatialReferences.unshift(wkid);var xmin=_443.xmin;var xmax=_443.xmax;var ymin=_443.ymin;var ymax=_443.ymax;var _448={};_448.SERVICE="WMS";_448.REQUEST="GetMap";_448.FORMAT=this.imageFormat;_448.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";_448.STYLES="";_448.VERSION=this.version;_448.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;_448.WIDTH=_444;_448.HEIGHT=_445;if(this.maxWidth<_444){_448.WIDTH=this.maxWidth;}if(this.maxHeight<_445){_448.HEIGHT=this.maxHeight;}var _449=wkid?wkid:NaN;if(!isNaN(_449)){if(this.version=="1.3.0"){_448.CRS="EPSG:"+_449;}else{_448.SRS="EPSG:"+_449;}}if(this.version=="1.3.0"&&this._useLatLong(_449)){_448.BBOX=ymin+","+xmin+","+ymax+","+xmax;}else{_448.BBOX=xmin+","+ymin+","+xmax+","+ymax;}var _44a=this.getMapURL;_44a+=(_44a.indexOf("?")==-1)?"?":"";for(var key in _448){_44a+=(_44a.substring(_44a.length-1,_44a.length)=="?")?"":"&";_44a+=key+"="+_448[key];}_446(_44a);},_initLayer:function(_44b,io){this.spatialReference=new esri.SpatialReference(this.extent.spatialReference);this.initialExtent=new esri.geometry.Extent(this.extent);this.fullExtent=new esri.geometry.Extent(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);this.loaded=true;this.onLoad(this);var _44c=this._loadCallback;if(_44c){delete this._loadCallback;_44c(this);}},_readResourceInfo:function(_44d){if(!_44d.extent){console.error("esri.layers.WMSLayer: unable to find the 'extent' property in resourceInfo");return;}if(!_44d.layerInfos){console.error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo");return;}this.extent=_44d.extent;this.allExtents[0]=_44d.extent;this.layerInfos=_44d.layerInfos;this.description=_44d.description?_44d.description:"";this.copyright=_44d.copyright?_44d.copyright:"";this.title=_44d.title?_44d.title:"";this.getMapURL=_44d.getMapURL?_44d.getMapURL:this._getCapabilitiesURL;this.version=_44d.version?_44d.version:"1.3.0";this.maxWidth=_44d.maxWidth?_44d.maxWidth:5000;this.maxHeight=_44d.maxHeight?_44d.maxHeight:5000;this.spatialReferences=_44d.spatialReferences?_44d.spatialReferences:[];this.imageFormat=this._getImageFormat(_44d.format);this.setScaleRange(_44d.minScale,_44d.maxScale);this._initLayer();},_getCapabilities:function(){var _44e=this._url.query?this._url.query:{};_44e.SERVICE="WMS";_44e.REQUEST="GetCapabilities";var uri=this._url.path+"?";for(var key in _44e){uri+=(uri.substring(uri.length-1,uri.length)=="?")?"":"&";uri+=key+"="+_44e[key];}var _44f=esri.request({url:uri,handleAs:"xml",load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:false});},_parseCapabilities:function(xml){if(!xml){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)");return;}this.version=this._getAttributeValue("WMS_Capabilities","version",xml,null);if(!this.version){this.version=this._getAttributeValue("WMT_MS_Capabilities","version",xml,"1.3.0");}var _450=this._getTag("Service",xml);this.title=this._getTagValue("Title",_450,"");if(!this.title||this.title.length==0){this.title=this._getTagValue("Name",_450,"");}this.copyright=this._getTagValue("AccessConstraints",_450,"");this.description=this._getTagValue("Abstract",_450,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",_450,5000));this.maxHeight=parseInt(this._getTagValue("MaxHeight",_450,5000));var _451=this._getTag("Layer",xml);if(!_451){this._getCapabilitiesError({"error":{"message":"Response does not contain any layers."}});return;}var _452=this._getLayerInfo(_451);if(_452){this.layerInfos=_452.subLayers;if(!this.layerInfos||this.layerInfos.length==0){this.layerInfos=[_452];}this.extent=_452.extent;this.allExtents=_452.allExtents;this.spatialReferences=_452.spatialReferences;if(this.spatialReferences.length==0&&this.layerInfos.length>0){this.spatialReferences=this.layerInfos[0].spatialReferences;}}this.getMapURL=this._getCapabilitiesURL;var _453=dojo.query("DCPType",this._getTag("GetMap",xml));if(_453&&_453.length>0){var _454=dojo.query("HTTP",_453[0]);if(_454&&_454.length>0){var _455=dojo.query("Get",_454[0]);if(_455&&_455.length>0){var _456=this._getAttributeValue("OnlineResource","xlink:href",_455[0],null);if(_456){if(_456.indexOf("&")==(_456.length-1)){_456=_456.substring(0,_456.length-1);}this.getMapURL=_456;}}}}this.getMapFormats=[];if(dojo.query("Operation",xml).length==0){dojo.forEach(dojo.query("Format",this._getTag("GetMap",xml)),function(_457){this.getMapFormats.push(_457.text?_457.text:_457.textContent);},this);}else{dojo.forEach(dojo.query("Operation",xml),function(_458){if(_458.getAttribute("name")=="GetMap"){dojo.forEach(dojo.query("Format",_458),function(_459){this.getMapFormats.push(_459.text?_459.text:_459.textContent);},this);}},this);}if(!dojo.some(this.getMapFormats,function(el){return el.indexOf(this.imageFormat)>-1;},this)){this.imageFormat=this.getMapFormats[0];}this._initLayer();},_getCapabilitiesError:function(_45a,io){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+dojo.toJson(_45a)+")");},_getLayerInfo:function(_45b){if(!_45b){return null;}var _45c=new esri.layers.WMSLayerInfo();_45c.name="";_45c.title="";_45c.description="";_45c.allExtents=[];_45c.spatialReferences=[];_45c.subLayers=[];var _45d=this._getTag("LatLonBoundingBox",_45b);if(_45d){_45c.allExtents[0]=this._getExtent(_45d,4326);}var _45e=this._getTag("EX_GeographicBoundingBox",_45b);if(_45e){var _45f=new esri.geometry.Extent(0,0,0,0,new esri.SpatialReference({wkid:4326}));_45f.xmin=parseFloat(this._getTagValue("westBoundLongitude",_45e,0));_45f.ymin=parseFloat(this._getTagValue("southBoundLatitude",_45e,0));_45f.xmax=parseFloat(this._getTagValue("eastBoundLongitude",_45e,0));_45f.ymax=parseFloat(this._getTagValue("northBoundLatitude",_45e,0));_45c.allExtents[0]=_45f;}_45c.extent=_45c.allExtents[0];var _460=(dojo.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)>-1)?"SRS":"CRS";dojo.forEach(_45b.childNodes,function(_461){if(_461.nodeName=="Name"){_45c.name=(_461.text?_461.text:_461.textContent)||"";}else{if(_461.nodeName=="Title"){_45c.title=(_461.text?_461.text:_461.textContent)||"";}else{if(_461.nodeName=="Abstract"){_45c.description=(_461.text?_461.text:_461.textContent)||"";}else{if(_461.nodeName=="BoundingBox"){srAttr=_461.getAttribute(_460);if(srAttr&&srAttr.indexOf("EPSG:")===0){wkid=parseInt(srAttr.substring(5));if(wkid!==0&&!isNaN(wkid)){var _462;if(this.version=="1.3.0"){_462=this._getExtent(_461,wkid,this._useLatLong(wkid));}else{_462=this._getExtent(_461,wkid);}_45c.allExtents[wkid]=_462;if(!_45c.extent){_45c.extent=_462;}}}else{if(srAttr&&srAttr.indexOf("CRS:")===0){wkid=parseInt(srAttr.substring(4));if(wkid!==0&&!isNaN(wkid)){if(this._CRS_TO_EPSG[wkid]){wkid=this._CRS_TO_EPSG[wkid];}_45c.allExtents[wkid]=this._getExtent(_461,wkid);}}else{wkid=parseInt(srAttr);if(wkid!==0&&!isNaN(wkid)){_45c.allExtents[wkid]=this._getExtent(_461,wkid);}}}}else{if(_461.nodeName==_460){var _463=_461.text?_461.text:_461.textContent;var arr=_463.split(" ");dojo.forEach(arr,function(val){if(val.indexOf(":")>-1){val=parseInt(val.split(":")[1]);}else{val=parseInt(val);}if(val!==0&&!isNaN(val)){if(this._CRS_TO_EPSG[val]){val=this._CRS_TO_EPSG[val];}if(dojo.indexOf(_45c.spatialReferences,val)==-1){_45c.spatialReferences.push(val);}}},this);}else{if(_461.nodeName=="Style"){var _464=this._getTag("LegendURL",_461);if(_464){var _465=this._getTag("OnlineResource",_464);if(_465){_45c.legendURL=_465.getAttribute("xlink:href");}}}else{if(_461.nodeName==="Layer"){_45c.subLayers.push(this._getLayerInfo(_461));}}}}}}}},this);return _45c;},_getImageFormat:function(_466){var _467=_466?_466.toLowerCase():"";switch(_467){case "jpg":return "image/jpeg";case "bmp":return "image/bmp";case "gif":return "image/gif";case "svg":return "image/svg+xml";default:return "image/png";}},getImageFormat:function(){var _468=this.imageFormat?this.imageFormat.toLowerCase():"";switch(_468){case "image/jpeg":return "jpg";case "image/bmp":return "bmp";case "image/gif":return "gif";case "image/svg+xml":return "svg";default:return "png";}},_getExtent:function(_469,wkid,_46a){var _46b;if(_469){_46b=new esri.geometry.Extent();var minx=parseFloat(_469.getAttribute("minx"));var miny=parseFloat(_469.getAttribute("miny"));var maxx=parseFloat(_469.getAttribute("maxx"));var maxy=parseFloat(_469.getAttribute("maxy"));if(_46a){_46b.xmin=isNaN(miny)?((-1)*Number.MAX_VALUE):miny;_46b.ymin=isNaN(minx)?((-1)*Number.MAX_VALUE):minx;_46b.xmax=isNaN(maxy)?Number.MAX_VALUE:maxy;_46b.ymax=isNaN(maxx)?Number.MAX_VALUE:maxx;}else{_46b.xmin=isNaN(minx)?((-1)*Number.MAX_VALUE):minx;_46b.ymin=isNaN(miny)?((-1)*Number.MAX_VALUE):miny;_46b.xmax=isNaN(maxx)?Number.MAX_VALUE:maxx;_46b.ymax=isNaN(maxy)?Number.MAX_VALUE:maxy;}_46b.spatialReference=new esri.SpatialReference({wkid:wkid});}return _46b;},_useLatLong:function(wkid){var _46c;for(var i=0;i<this._REVERSED_LAT_LONG_RANGES.length;i++){var _46d=this._REVERSED_LAT_LONG_RANGES[i];if(wkid>=_46d[0]&&wkid<=_46d[1]){_46c=true;break;}}return _46c;},_getTag:function(_46e,xml){var tags=dojo.query(_46e,xml);if(tags&&tags.length>0){return tags[0];}else{return null;}},_getTagValue:function(_46f,xml,_470){var _471=dojo.query(_46f,xml);if(_471&&_471.length>0){if(_471[0].text){return _471[0].text;}else{return _471[0].textContent;}}else{return _470;}},_getAttributeValue:function(_472,_473,xml,_474){var _475=dojo.query(_472,xml);if(_475&&_475.length>0){return _475[0].getAttribute(_473);}else{return _474;}},_checkVisibleLayersList:function(_476){if(_476&&_476.length>0&&this.layerInfos&&this.layerInfos.length>0){if((typeof _476[0])=="number"){var list=[];dojo.forEach(_476,function(pos){if(pos<this.layerInfos.length){list.push(this.layerInfos[pos].name);}},this);_476=list;}}return _476;},_stripParameters:function(url,_477){var obj=esri.urlToObject(url);qs=[];for(var prop in obj.query){if(dojo.indexOf(_477,prop.toLowerCase())===-1){qs.push(prop+"="+obj.query[prop]);}}return obj.path+(qs.length?("?"+qs.join("&")):"");}});dojo.declare("esri.layers.WMSLayerInfo",null,{name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],constructor:function(_478){if(_478){this.name=_478.name;this.title=_478.title;this.description=_478.description;this.extent=_478.extent;this.legendURL=_478.legendURL;this.subLayers=_478.subLayers?_478.subLayers:[];this.allExtents=_478.allExtents?_478.allExtents:[];this.spatialReferences=_478.spatialReferences?_478.spatialReferences:[];}},clone:function(){var info={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL};if(this.extent){info.extent=this.extent.getExtent();}info.subLayers=[];dojo.forEach(this.subLayers,function(_479){info.subLayers.push(_479.clone());});info.allExtents=[];for(var wkid in this.allExtents){wkid=parseInt(wkid);if(!isNaN(wkid)){info.allExtents[wkid]=this.allExtents[wkid].getExtent();}}info.spatialReferences=[];dojo.forEach(this.spatialReferences,function(wkid){info.spatialReferences.push(wkid);});return info;}});});},"dojox/charting/scaler/primitive":function(){define("dojox/charting/scaler/primitive",["dojo/_base/lang"],function(lang){var _47a=lang.getObject("dojox.charting.scaler.primitive",true);return lang.mixin(_47a,{buildScaler:function(min,max,span,_47b){if(min==max){min-=0.5;max+=0.5;}return {bounds:{lower:min,upper:max,from:min,to:max,scale:span/(max-min),span:span},scaler:_47a};},buildTicks:function(_47c,_47d){return {major:[],minor:[],micro:[]};},getTransformerFromModel:function(_47e){var _47f=_47e.bounds.from,_480=_47e.bounds.scale;return function(x){return (x-_47f)*_480;};},getTransformerFromPlot:function(_481){var _482=_481.bounds.from,_483=_481.bounds.scale;return function(x){return x/_483+_482;};}});});},"dojox/gfx/fx":function(){define("dojox/gfx/fx",["dojo/_base/lang","./_base","./matrix","dojo/_base/Color","dojo/_base/array","dojo/_base/fx","dojo/_base/connect"],function(lang,g,m,_484,arr,fx,Hub){var fxg=g.fx={};function _485(_486,end){this.start=_486,this.end=end;};_485.prototype.getValue=function(r){return (this.end-this.start)*r+this.start;};function _487(_488,end,_489){this.start=_488,this.end=end;this.units=_489;};_487.prototype.getValue=function(r){return (this.end-this.start)*r+this.start+this.units;};function _48a(_48b,end){this.start=_48b,this.end=end;this.temp=new _484();};_48a.prototype.getValue=function(r){return _484.blendColors(this.start,this.end,r,this.temp);};function _48c(_48d){this.values=_48d;this.length=_48d.length;};_48c.prototype.getValue=function(r){return this.values[Math.min(Math.floor(r*this.length),this.length-1)];};function _48e(_48f,def){this.values=_48f;this.def=def?def:{};};_48e.prototype.getValue=function(r){var ret=lang.clone(this.def);for(var i in this.values){ret[i]=this.values[i].getValue(r);}return ret;};function _490(_491,_492){this.stack=_491;this.original=_492;};_490.prototype.getValue=function(r){var ret=[];arr.forEach(this.stack,function(t){if(t instanceof m.Matrix2D){ret.push(t);return;}if(t.name=="original"&&this.original){ret.push(this.original);return;}if(t.name=="matrix"){if((t.start instanceof m.Matrix2D)&&(t.end instanceof m.Matrix2D)){var _493=new m.Matrix2D();for(var p in t.start){_493[p]=(t.end[p]-t.start[p])*r+t.start[p];}ret.push(_493);}return;}if(!(t.name in m)){return;}var f=m[t.name];if(typeof f!="function"){ret.push(f);return;}var val=arr.map(t.start,function(v,i){return (t.end[i]-v)*r+v;}),_494=f.apply(m,val);if(_494 instanceof m.Matrix2D){ret.push(_494);}},this);return ret;};var _495=new _484(0,0,0,0);function _496(prop,obj,name,def){if(prop.values){return new _48c(prop.values);}var _497,_498,end;if(prop.start){_498=g.normalizeColor(prop.start);}else{_498=_497=obj?(name?obj[name]:obj):def;}if(prop.end){end=g.normalizeColor(prop.end);}else{if(!_497){_497=obj?(name?obj[name]:obj):def;}end=_497;}return new _48a(_498,end);};function _499(prop,obj,name,def){if(prop.values){return new _48c(prop.values);}var _49a,_49b,end;if(prop.start){_49b=prop.start;}else{_49b=_49a=obj?obj[name]:def;}if(prop.end){end=prop.end;}else{if(typeof _49a!="number"){_49a=obj?obj[name]:def;}end=_49a;}return new _485(_49b,end);};fxg.animateStroke=function(args){if(!args.easing){args.easing=fx._defaultEasing;}var anim=new fx.Animation(args),_49c=args.shape,_49d;Hub.connect(anim,"beforeBegin",anim,function(){_49d=_49c.getStroke();var prop=args.color,_49e={},_49f,_4a0,end;if(prop){_49e.color=_496(prop,_49d,"color",_495);}prop=args.style;if(prop&&prop.values){_49e.style=new _48c(prop.values);}prop=args.width;if(prop){_49e.width=_499(prop,_49d,"width",1);}prop=args.cap;if(prop&&prop.values){_49e.cap=new _48c(prop.values);}prop=args.join;if(prop){if(prop.values){_49e.join=new _48c(prop.values);}else{_4a0=prop.start?prop.start:(_49d&&_49d.join||0);end=prop.end?prop.end:(_49d&&_49d.join||0);if(typeof _4a0=="number"&&typeof end=="number"){_49e.join=new _485(_4a0,end);}}}this.curve=new _48e(_49e,_49d);});Hub.connect(anim,"onAnimate",_49c,"setStroke");return anim;};fxg.animateFill=function(args){if(!args.easing){args.easing=fx._defaultEasing;}var anim=new fx.Animation(args),_4a1=args.shape,fill;Hub.connect(anim,"beforeBegin",anim,function(){fill=_4a1.getFill();var prop=args.color,_4a2={};if(prop){this.curve=_496(prop,fill,"",_495);}});Hub.connect(anim,"onAnimate",_4a1,"setFill");return anim;};fxg.animateFont=function(args){if(!args.easing){args.easing=fx._defaultEasing;}var anim=new fx.Animation(args),_4a3=args.shape,font;Hub.connect(anim,"beforeBegin",anim,function(){font=_4a3.getFont();var prop=args.style,_4a4={},_4a5,_4a6,end;if(prop&&prop.values){_4a4.style=new _48c(prop.values);}prop=args.variant;if(prop&&prop.values){_4a4.variant=new _48c(prop.values);}prop=args.weight;if(prop&&prop.values){_4a4.weight=new _48c(prop.values);}prop=args.family;if(prop&&prop.values){_4a4.family=new _48c(prop.values);}prop=args.size;if(prop&&prop.units){_4a6=parseFloat(prop.start?prop.start:(_4a3.font&&_4a3.font.size||"0"));end=parseFloat(prop.end?prop.end:(_4a3.font&&_4a3.font.size||"0"));_4a4.size=new _487(_4a6,end,prop.units);}this.curve=new _48e(_4a4,font);});Hub.connect(anim,"onAnimate",_4a3,"setFont");return anim;};fxg.animateTransform=function(args){if(!args.easing){args.easing=fx._defaultEasing;}var anim=new fx.Animation(args),_4a7=args.shape,_4a8;Hub.connect(anim,"beforeBegin",anim,function(){_4a8=_4a7.getTransform();this.curve=new _490(args.transform,_4a8);});Hub.connect(anim,"onAnimate",_4a7,"setTransform");return anim;};return fxg;});},"dojox/charting/plot2d/StackedColumns":function(){define("dojox/charting/plot2d/StackedColumns",["dojo/_base/declare","./Columns","./commonStacked"],function(_4a9,_4aa,_4ab){return _4a9("dojox.charting.plot2d.StackedColumns",_4aa,{getSeriesStats:function(){var _4ac=_4ab.collectStats(this.series);this._maxRunLength=_4ac.hmax;_4ac.hmin-=0.5;_4ac.hmax+=0.5;return _4ac;},getDataLength:function(run){return this._maxRunLength;},getValue:function(_4ad,_4ae,_4af,_4b0){var y,x;if(_4b0){x=_4ae;y=_4ab.getIndexValue(this.series,_4af,x);}else{x=_4ad.x-1;y=_4ab.getValue(this.series,_4af,_4ad.x);y=y?y.y:null;}return {y:y,x:x};}});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _4b1={};lang.setObject("dojo.data.util.filter",_4b1);_4b1.patternToRegExp=function(_4b2,_4b3){var rxp="^";var c=null;for(var i=0;i<_4b2.length;i++){c=_4b2.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_4b2.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_4b3){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _4b1;});},"dojox/charting/SimpleTheme":function(){define("dojox/charting/SimpleTheme",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/Color","dojox/lang/utils","dojox/gfx/gradutils"],function(lang,arr,_4b4,_4b5,dlu,dgg){var _4b6=_4b4("dojox.charting.SimpleTheme",null,{shapeSpaces:{shape:1,shapeX:1,shapeY:1},constructor:function(_4b7){_4b7=_4b7||{};var def=_4b6.defaultTheme;arr.forEach(["chart","plotarea","axis","grid","series","marker","indicator"],function(name){this[name]=lang.delegate(def[name],_4b7[name]);},this);if(_4b7.seriesThemes&&_4b7.seriesThemes.length){this.colors=null;this.seriesThemes=_4b7.seriesThemes.slice(0);}else{this.seriesThemes=null;this.colors=(_4b7.colors||_4b6.defaultColors).slice(0);}this.markerThemes=null;if(_4b7.markerThemes&&_4b7.markerThemes.length){this.markerThemes=_4b7.markerThemes.slice(0);}this.markers=_4b7.markers?lang.clone(_4b7.markers):lang.delegate(_4b6.defaultMarkers);this.noGradConv=_4b7.noGradConv;this.noRadialConv=_4b7.noRadialConv;if(_4b7.reverseFills){this.reverseFills();}this._current=0;this._buildMarkerArray();},clone:function(){var _4b8=new this.constructor({chart:this.chart,plotarea:this.plotarea,axis:this.axis,grid:this.grid,series:this.series,marker:this.marker,colors:this.colors,markers:this.markers,indicator:this.indicator,seriesThemes:this.seriesThemes,markerThemes:this.markerThemes,noGradConv:this.noGradConv,noRadialConv:this.noRadialConv});arr.forEach(["clone","clear","next","skip","addMixin","post","getTick"],function(name){if(this.hasOwnProperty(name)){_4b8[name]=this[name];}},this);return _4b8;},clear:function(){this._current=0;},next:function(_4b9,_4ba,_4bb){var _4bc=dlu.merge,_4bd,_4be;if(this.colors){_4bd=lang.delegate(this.series);_4be=lang.delegate(this.marker);var _4bf=new _4b5(this.colors[this._current%this.colors.length]),old;if(_4bd.stroke&&_4bd.stroke.color){_4bd.stroke=lang.delegate(_4bd.stroke);old=new _4b5(_4bd.stroke.color);_4bd.stroke.color=new _4b5(_4bf);_4bd.stroke.color.a=old.a;}else{_4bd.stroke={color:_4bf};}if(_4be.stroke&&_4be.stroke.color){_4be.stroke=lang.delegate(_4be.stroke);old=new _4b5(_4be.stroke.color);_4be.stroke.color=new _4b5(_4bf);_4be.stroke.color.a=old.a;}else{_4be.stroke={color:_4bf};}if(!_4bd.fill||_4bd.fill.type){_4bd.fill=_4bf;}else{old=new _4b5(_4bd.fill);_4bd.fill=new _4b5(_4bf);_4bd.fill.a=old.a;}if(!_4be.fill||_4be.fill.type){_4be.fill=_4bf;}else{old=new _4b5(_4be.fill);_4be.fill=new _4b5(_4bf);_4be.fill.a=old.a;}}else{_4bd=this.seriesThemes?_4bc(this.series,this.seriesThemes[this._current%this.seriesThemes.length]):this.series;_4be=this.markerThemes?_4bc(this.marker,this.markerThemes[this._current%this.markerThemes.length]):_4bd;}var _4c0=_4be&&_4be.symbol||this._markers[this._current%this._markers.length];var _4c1={series:_4bd,marker:_4be,symbol:_4c0};++this._current;if(_4ba){_4c1=this.addMixin(_4c1,_4b9,_4ba);}if(_4bb){_4c1=this.post(_4c1,_4b9);}return _4c1;},skip:function(){++this._current;},addMixin:function(_4c2,_4c3,_4c4,_4c5){if(lang.isArray(_4c4)){arr.forEach(_4c4,function(m){_4c2=this.addMixin(_4c2,_4c3,m);},this);}else{var t={};if("color" in _4c4){if(_4c3=="line"||_4c3=="area"){lang.setObject("series.stroke.color",_4c4.color,t);lang.setObject("marker.stroke.color",_4c4.color,t);}else{lang.setObject("series.fill",_4c4.color,t);}}arr.forEach(["stroke","outline","shadow","fill","font","fontColor","labelWiring"],function(name){var _4c6="marker"+name.charAt(0).toUpperCase()+name.substr(1),b=_4c6 in _4c4;if(name in _4c4){lang.setObject("series."+name,_4c4[name],t);if(!b){lang.setObject("marker."+name,_4c4[name],t);}}if(b){lang.setObject("marker."+name,_4c4[_4c6],t);}});if("marker" in _4c4){t.symbol=_4c4.marker;t.symbol=_4c4.marker;}_4c2=dlu.merge(_4c2,t);}if(_4c5){_4c2=this.post(_4c2,_4c3);}return _4c2;},post:function(_4c7,_4c8){var fill=_4c7.series.fill,t;if(!this.noGradConv&&this.shapeSpaces[fill.space]&&fill.type=="linear"){if(_4c8=="bar"){t={x1:fill.y1,y1:fill.x1,x2:fill.y2,y2:fill.x2};}else{if(!this.noRadialConv&&fill.space=="shape"&&(_4c8=="slice"||_4c8=="circle")){t={type:"radial",cx:0,cy:0,r:100};}}if(t){return dlu.merge(_4c7,{series:{fill:t}});}}return _4c7;},getTick:function(name,_4c9){var tick=this.axis.tick,_4ca=name+"Tick",_4cb=dlu.merge;if(tick){if(this.axis[_4ca]){tick=_4cb(tick,this.axis[_4ca]);}}else{tick=this.axis[_4ca];}if(_4c9){if(tick){if(_4c9[_4ca]){tick=_4cb(tick,_4c9[_4ca]);}}else{tick=_4c9[_4ca];}}return tick;},inspectObjects:function(f){arr.forEach(["chart","plotarea","axis","grid","series","marker","indicator"],function(name){f(this[name]);},this);if(this.seriesThemes){arr.forEach(this.seriesThemes,f);}if(this.markerThemes){arr.forEach(this.markerThemes,f);}},reverseFills:function(){this.inspectObjects(function(o){if(o&&o.fill){o.fill=dgg.reverse(o.fill);}});},addMarker:function(name,_4cc){this.markers[name]=_4cc;this._buildMarkerArray();},setMarkers:function(obj){this.markers=obj;this._buildMarkerArray();},_buildMarkerArray:function(){this._markers=[];for(var p in this.markers){this._markers.push(this.markers[p]);}}});lang.mixin(_4b6,{defaultMarkers:{CIRCLE:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",SQUARE:"m-3,-3 l0,6 6,0 0,-6 z",DIAMOND:"m0,-3 l3,3 -3,3 -3,-3 z",CROSS:"m0,-3 l0,6 m-3,-3 l6,0",X:"m-3,-3 l6,6 m0,-6 l-6,6",TRIANGLE:"m-3,3 l3,-6 3,6 z",TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"},defaultColors:["#54544c","#858e94","#6e767a","#948585","#474747"],defaultTheme:{chart:{stroke:null,fill:"white",pageStyle:null,titleGap:20,titlePos:"top",titleFont:"normal normal bold 14pt Tahoma",titleFontColor:"#333"},plotarea:{stroke:null,fill:"white"},axis:{stroke:{color:"#333",width:1},tick:{color:"#666",position:"center",font:"normal normal normal 7pt Tahoma",fontColor:"#333",labelGap:4},majorTick:{width:1,length:6},minorTick:{width:0.8,length:3},microTick:{width:0.5,length:1},title:{gap:15,font:"normal normal normal 11pt Tahoma",fontColor:"#333",orientation:"axis"}},series:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000",labelWiring:{width:1,color:"#ccc"}},marker:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000"},indicator:{lineStroke:{width:1.5,color:"#333"},lineOutline:{width:0.1,color:"#ccc"},lineShadow:null,stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",radius:3,font:"normal normal normal 10pt Tahoma",fontColor:"#000",markerFill:"#ccc",markerSymbol:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",markerStroke:{width:1.5,color:"#333"},markerOutline:{width:0.1,color:"#ccc"},markerShadow:null}}});return _4b6;});},"dojox/charting/plot2d/OHLC":function(){define("dojox/charting/plot2d/OHLC",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(lang,arr,_4cd,_4ce,_4cf,dc,df,dfr,du,fx){var _4d0=dfr.lambda("item.purgeGroup()");return _4cd("dojox.charting.plot2d.OHLC",[_4ce,_4cf],{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_4d1,_4d2){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_4d2);du.updateWithPattern(this.opt,_4d2,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_4d3){var _4d4=lang.delegate(dc.defaultStats);for(var i=0;i<_4d3.length;i++){var run=_4d3[i];if(!run.data.length){continue;}var _4d5=_4d4.vmin,_4d6=_4d4.vmax;if(!("ymin" in run)||!("ymax" in run)){arr.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_4d4.hmin=Math.min(_4d4.hmin,x);_4d4.hmax=Math.max(_4d4.hmax,x);_4d4.vmin=Math.min(_4d4.vmin,val.open,val.close,val.high,val.low);_4d4.vmax=Math.max(_4d4.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_4d4.vmin=Math.min(_4d5,run.ymin);}if("ymax" in run){_4d4.vmax=Math.max(_4d6,run.ymax);}}return _4d4;},getSeriesStats:function(){var _4d7=this.collectStats(this.series);_4d7.hmin-=0.5;_4d7.hmax+=0.5;return _4d7;},render:function(dim,_4d8){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_4d8);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){arr.forEach(this.series,_4d0);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_4d9,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_4da=Math.max(0,this._vScaler.bounds.lower),_4db=vt(_4da),_4dc=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_4d9=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _4dd=t.next("candlestick",[this.opt,run]),s=run.group,_4de=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _4df=t.addMixin(_4dd,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_4d8.l+gap,y=dim.height-_4d8.b,open=vt(v.open),_4e0=vt(v.close),high=vt(v.high),low=vt(v.low);if(low>high){var tmp=high;high=low;low=tmp;}if(_4d9>=1){var hl={x1:_4d9/2,x2:_4d9/2,y1:y-high,y2:y-low},op={x1:0,x2:((_4d9/2)+((_4df.series.stroke.width||1)/2)),y1:y-open,y2:y-open},cl={x1:((_4d9/2)-((_4df.series.stroke.width||1)/2)),x2:_4d9,y1:y-_4e0,y2:y-_4e0};var _4e1=s.createGroup();_4e1.setTransform({dx:x,dy:0});var _4e2=_4e1.createGroup();_4e2.createLine(hl).setStroke(_4df.series.stroke);_4e2.createLine(op).setStroke(_4df.series.stroke);_4e2.createLine(cl).setStroke(_4df.series.stroke);run.dyn.stroke=_4df.series.stroke;if(_4dc){var o={element:"candlestick",index:j,run:run,shape:_4e2,x:x,y:y-Math.max(open,_4e0),cx:_4d9/2,cy:(y-Math.max(open,_4e0))+(Math.max(open>_4e0?open-_4e0:_4e0-open,1)/2),width:_4d9,height:Math.max(open>_4e0?open-_4e0:_4e0-open,1),data:v};this._connectEvents(o);_4de[j]=o;}}if(this.animate){this._animateOHLC(_4e1,y-low,high-low);}}}this._eventSeries[run.name]=_4de;run.dirty=false;}this.dirty=false;return this;},_animateOHLC:function(_4e3,_4e4,_4e5){fx.animateTransform(lang.delegate({shape:_4e3,duration:1200,transform:[{name:"translate",start:[0,_4e4-(_4e4/_4e5)],end:[0,0]},{name:"scale",start:[1,1/_4e5],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _4e6={};lang.setObject("dojo.data.util.sorter",_4e6);_4e6.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_4e6.createSortFunction=function(_4e7,_4e8){var _4e9=[];function _4ea(attr,dir,comp,s){return function(_4eb,_4ec){var a=s.getValue(_4eb,attr);var b=s.getValue(_4ec,attr);return dir*comp(a,b);};};var _4ed;var map=_4e8.comparatorMap;var bc=_4e6.basicComparator;for(var i=0;i<_4e7.length;i++){_4ed=_4e7[i];var attr=_4ed.attribute;if(attr){var dir=(_4ed.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_4e9.push(_4ea(attr,dir,comp,_4e8));}}return function(rowA,rowB){var i=0;while(i<_4e9.length){var ret=_4e9[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _4e6;});},"dojox/lang/functional/reversed":function(){define("dojox/lang/functional/reversed",["dojo/_base/lang","dojo/_base/kernel","./lambda"],function(lang,_4ee,df){lang.mixin(df,{filterRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_4ee.global;f=df.lambda(f);var t=[],v,i=a.length-1;for(;i>=0;--i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}return t;},forEachRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_4ee.global;f=df.lambda(f);for(var i=a.length-1;i>=0;f.call(o,a[i],i,a),--i){}},mapRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_4ee.global;f=df.lambda(f);var n=a.length,t=new Array(n),i=n-1,j=0;for(;i>=0;t[j++]=f.call(o,a[i],i,a),--i){}return t;},everyRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_4ee.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(!f.call(o,a[i],i,a)){return false;}}return true;},someRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||_4ee.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(f.call(o,a[i],i,a)){return true;}}return false;}});return df;});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_4ef,_4f0){var _4f1={};lang.setObject("dojo.colors",_4f1);var _4f2=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_4ef.fromRgb=function(_4f3,obj){var m=_4f3.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_4f0.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _4ef.fromArray(a,obj);}return _4ef.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_4f2(m1,m2,H+1/3)*256,_4f2(m1,m2,H)*256,_4f2(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _4ef.fromArray(a,obj);}}return null;};var _4f4=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_4ef.prototype.sanitize=function(){var t=this;t.r=Math.round(_4f4(t.r,0,255));t.g=Math.round(_4f4(t.g,0,255));t.b=Math.round(_4f4(t.b,0,255));t.a=_4f4(t.a,0,1);return this;};_4f1.makeGrey=_4ef.makeGrey=function(g,a){return _4ef.fromArray([g,g,g,a]);};lang.mixin(_4ef.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _4ef;});},"dojox/charting/Chart":function(){define("dojox/charting/Chart",["../main","dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/dom-style","dojo/dom","dojo/dom-geometry","dojo/dom-construct","dojo/_base/Color","dojo/_base/sniff","./Element","./SimpleTheme","./Series","./axis2d/common","dojox/gfx/shape","dojox/gfx","dojox/lang/functional","dojox/lang/functional/fold","dojox/lang/functional/reversed"],function(_4f5,lang,arr,_4f6,_4f7,dom,_4f8,_4f9,_4fa,has,_4fb,_4fc,_4fd,_4fe,_4ff,g,func,_500,_501){var dc=lang.getObject("charting",true,_4f5),_502=func.lambda("item.clear()"),_503=func.lambda("item.purgeGroup()"),_504=func.lambda("item.destroy()"),_505=func.lambda("item.dirty = false"),_506=func.lambda("item.dirty = true"),_507=func.lambda("item.name");var _508=_4f6("dojox.charting.Chart",null,{constructor:function(node,_509){if(!_509){_509={};}this.margins=_509.margins?_509.margins:{l:10,t:10,r:10,b:10};this.stroke=_509.stroke;this.fill=_509.fill;this.delayInMs=_509.delayInMs||200;this.title=_509.title;this.titleGap=_509.titleGap;this.titlePos=_509.titlePos;this.titleFont=_509.titleFont;this.titleFontColor=_509.titleFontColor;this.chartTitle=null;this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=true;this.node=dom.byId(node);var box=_4f8.getMarginBox(node);this.surface=g.createSurface(this.node,box.w||400,box.h||300);if(this.surface.declaredClass.indexOf("vml")==-1){this.plotGroup=this.surface.createGroup();}},destroy:function(){arr.forEach(this.series,_504);arr.forEach(this.stack,_504);func.forIn(this.axes,_504);if(this.chartTitle&&this.chartTitle.tagName){_4f9.destroy(this.chartTitle);}if(this.plotGroup){this.plotGroup.destroy();}this.surface.destroy();},getCoords:function(){var node=this.node;var s=_4f7.getComputedStyle(node),_50a=_4f8.getMarginBox(node,s);var abs=_4f8.position(node,true);_50a.x=abs.x;_50a.y=abs.y;return _50a;},setTheme:function(_50b){this.theme=_50b.clone();this.dirty=true;return this;},addAxis:function(name,_50c){var axis,_50d=_50c&&_50c.type||"Default";if(typeof _50d=="string"){if(!dc.axis2d||!dc.axis2d[_50d]){throw Error("Can't find axis: "+_50d+" - Check "+"require() dependencies.");}axis=new dc.axis2d[_50d](this,_50c);}else{axis=new _50d(this,_50c);}axis.name=name;axis.dirty=true;if(name in this.axes){this.axes[name].destroy();}this.axes[name]=axis;this.dirty=true;return this;},getAxis:function(name){return this.axes[name];},removeAxis:function(name){if(name in this.axes){this.axes[name].destroy();delete this.axes[name];this.dirty=true;}return this;},addPlot:function(name,_50e){var plot,_50f=_50e&&_50e.type||"Default";if(typeof _50f=="string"){if(!dc.plot2d||!dc.plot2d[_50f]){throw Error("Can't find plot: "+_50f+" - didn't you forget to dojo"+".require() it?");}plot=new dc.plot2d[_50f](this,_50e);}else{plot=new _50f(this,_50e);}plot.name=name;plot.dirty=true;if(name in this.plots){this.stack[this.plots[name]].destroy();this.stack[this.plots[name]]=plot;}else{this.plots[name]=this.stack.length;this.stack.push(plot);}this.dirty=true;return this;},getPlot:function(name){return this.stack[this.plots[name]];},removePlot:function(name){if(name in this.plots){var _510=this.plots[name];delete this.plots[name];this.stack[_510].destroy();this.stack.splice(_510,1);func.forIn(this.plots,function(idx,name,_511){if(idx>_510){_511[name]=idx-1;}});var ns=arr.filter(this.series,function(run){return run.plot!=name;});if(ns.length<this.series.length){arr.forEach(this.series,function(run){if(run.plot==name){run.destroy();}});this.runs={};arr.forEach(ns,function(run,_512){this.runs[run.plot]=_512;},this);this.series=ns;}this.dirty=true;}return this;},getPlotOrder:function(){return func.map(this.stack,_507);},setPlotOrder:function(_513){var _514={},_515=func.filter(_513,function(name){if(!(name in this.plots)||(name in _514)){return false;}_514[name]=1;return true;},this);if(_515.length<this.stack.length){func.forEach(this.stack,function(plot){var name=plot.name;if(!(name in _514)){_515.push(name);}});}var _516=func.map(_515,function(name){return this.stack[this.plots[name]];},this);func.forEach(_516,function(plot,i){this.plots[plot.name]=i;},this);this.stack=_516;this.dirty=true;return this;},movePlotToFront:function(name){if(name in this.plots){var _517=this.plots[name];if(_517){var _518=this.getPlotOrder();_518.splice(_517,1);_518.unshift(name);return this.setPlotOrder(_518);}}return this;},movePlotToBack:function(name){if(name in this.plots){var _519=this.plots[name];if(_519<this.stack.length-1){var _51a=this.getPlotOrder();_51a.splice(_519,1);_51a.push(name);return this.setPlotOrder(_51a);}}return this;},addSeries:function(name,data,_51b){var run=new _4fd(this,data,_51b);run.name=name;if(name in this.runs){this.series[this.runs[name]].destroy();this.series[this.runs[name]]=run;}else{this.runs[name]=this.series.length;this.series.push(run);}this.dirty=true;if(!("ymin" in run)&&"min" in run){run.ymin=run.min;}if(!("ymax" in run)&&"max" in run){run.ymax=run.max;}return this;},getSeries:function(name){return this.series[this.runs[name]];},removeSeries:function(name){if(name in this.runs){var _51c=this.runs[name];delete this.runs[name];this.series[_51c].destroy();this.series.splice(_51c,1);func.forIn(this.runs,function(idx,name,runs){if(idx>_51c){runs[name]=idx-1;}});this.dirty=true;}return this;},updateSeries:function(name,data,_51d){if(name in this.runs){var run=this.series[this.runs[name]];run.update(data);if(_51d){this.dirty=true;}else{this._invalidateDependentPlots(run.plot,false);this._invalidateDependentPlots(run.plot,true);}}return this;},getSeriesOrder:function(_51e){return func.map(func.filter(this.series,function(run){return run.plot==_51e;}),_507);},setSeriesOrder:function(_51f){var _520,_521={},_522=func.filter(_51f,function(name){if(!(name in this.runs)||(name in _521)){return false;}var run=this.series[this.runs[name]];if(_520){if(run.plot!=_520){return false;}}else{_520=run.plot;}_521[name]=1;return true;},this);func.forEach(this.series,function(run){var name=run.name;if(!(name in _521)&&run.plot==_520){_522.push(name);}});var _523=func.map(_522,function(name){return this.series[this.runs[name]];},this);this.series=_523.concat(func.filter(this.series,function(run){return run.plot!=_520;}));func.forEach(this.series,function(run,i){this.runs[run.name]=i;},this);this.dirty=true;return this;},moveSeriesToFront:function(name){if(name in this.runs){var _524=this.runs[name],_525=this.getSeriesOrder(this.series[_524].plot);if(name!=_525[0]){_525.splice(_524,1);_525.unshift(name);return this.setSeriesOrder(_525);}}return this;},moveSeriesToBack:function(name){if(name in this.runs){var _526=this.runs[name],_527=this.getSeriesOrder(this.series[_526].plot);if(name!=_527[_527.length-1]){_527.splice(_526,1);_527.push(name);return this.setSeriesOrder(_527);}}return this;},resize:function(_528,_529){var box;switch(arguments.length){case 1:box=lang.mixin({},_528);_4f8.setMarginBox(this.node,box);break;case 2:box={w:_528,h:_529};_4f8.setMarginBox(this.node,box);break;}box=_4f8.getMarginBox(this.node);var d=this.surface.getDimensions();if(d.width!=box.w||d.height!=box.h){this.surface.setDimensions(box.w,box.h);this.dirty=true;return this.render();}else{return this;}},getGeometry:function(){var ret={};func.forIn(this.axes,function(axis){if(axis.initialized()){ret[axis.name]={name:axis.name,vertical:axis.vertical,scaler:axis.scaler,ticks:axis.ticks};}});return ret;},setAxisWindow:function(name,_52a,_52b,zoom){var axis=this.axes[name];if(axis){axis.setWindow(_52a,_52b);arr.forEach(this.stack,function(plot){if(plot.hAxis==name||plot.vAxis==name){plot.zoom=zoom;}});}return this;},setWindow:function(sx,sy,dx,dy,zoom){if(!("plotArea" in this)){this.calculateGeometry();}func.forIn(this.axes,function(axis){var _52c,_52d,_52e=axis.getScaler().bounds,s=_52e.span/(_52e.upper-_52e.lower);if(axis.vertical){_52c=sy;_52d=dy/s/_52c;}else{_52c=sx;_52d=dx/s/_52c;}axis.setWindow(_52c,_52d);});arr.forEach(this.stack,function(plot){plot.zoom=zoom;});return this;},zoomIn:function(name,_52f,_530){var axis=this.axes[name];if(axis){var _531,_532,_533=axis.getScaler().bounds;var _534=Math.min(_52f[0],_52f[1]);var _535=Math.max(_52f[0],_52f[1]);_534=_52f[0]<_533.lower?_533.lower:_534;_535=_52f[1]>_533.upper?_533.upper:_535;_531=(_533.upper-_533.lower)/(_535-_534);_532=_534-_533.lower;this.setAxisWindow(name,_531,_532);if(_530){this.delayedRender();}else{this.render();}}},calculateGeometry:function(){if(this.dirty){return this.fullGeometry();}var _536=arr.filter(this.stack,function(plot){return plot.dirty||(plot.hAxis&&this.axes[plot.hAxis].dirty)||(plot.vAxis&&this.axes[plot.vAxis].dirty);},this);_537(_536,this.plotArea);return this;},fullGeometry:function(){this._makeDirty();arr.forEach(this.stack,_502);if(!this.theme){this.setTheme(new _4fc());}arr.forEach(this.series,function(run){if(!(run.plot in this.plots)){if(!dc.plot2d||!dc.plot2d.Default){throw Error("Can't find plot: Default - didn't you forget to dojo"+".require() it?");}var plot=new dc.plot2d.Default(this,{});plot.name=run.plot;this.plots[run.plot]=this.stack.length;this.stack.push(plot);}this.stack[this.plots[run.plot]].addSeries(run);},this);arr.forEach(this.stack,function(plot){if(plot.assignAxes){plot.assignAxes(this.axes);}},this);var dim=this.dim=this.surface.getDimensions();dim.width=g.normalizedLength(dim.width);dim.height=g.normalizedLength(dim.height);func.forIn(this.axes,_502);_537(this.stack,dim);var _538=this.offsets={l:0,r:0,t:0,b:0};func.forIn(this.axes,function(axis){func.forIn(axis.getOffsets(),function(o,i){_538[i]=Math.max(o,_538[i]);});});if(this.title){this.titleGap=(this.titleGap==0)?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||"top";this.titleFont=this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";var _539=g.normalizedLength(g.splitFontString(this.titleFont).size);_538[this.titlePos=="top"?"t":"b"]+=(_539+this.titleGap);}func.forIn(this.margins,function(o,i){_538[i]+=o;});this.plotArea={width:dim.width-_538.l-_538.r,height:dim.height-_538.t-_538.b};func.forIn(this.axes,_502);_537(this.stack,this.plotArea);return this;},render:function(){if(this._delayedRenderHandle){clearTimeout(this._delayedRenderHandle);this._delayedRenderHandle=null;}if(this.theme){this.theme.clear();}if(this.dirty){return this.fullRender();}this.calculateGeometry();func.forEachRev(this.stack,function(plot){plot.render(this.dim,this.offsets);},this);func.forIn(this.axes,function(axis){axis.render(this.dim,this.offsets);},this);this._makeClean();return this;},fullRender:function(){this.fullGeometry();var _53a=this.offsets,dim=this.dim;var w=Math.max(0,dim.width-_53a.l-_53a.r),h=Math.max(0,dim.height-_53a.t-_53a.b);arr.forEach(this.series,_503);func.forIn(this.axes,_503);arr.forEach(this.stack,_503);var _53b=this.surface.children;for(var i=0;i<_53b.length;++i){_4ff.dispose(_53b[i]);}if(this.chartTitle&&this.chartTitle.tagName){_4f9.destroy(this.chartTitle);}if(this.plotGroup){this.plotGroup.clear();}this.surface.clear();this.chartTitle=null;if(this.plotGroup){this._renderChartBackground(dim,_53a);this._renderPlotBackground(dim,_53a,w,h);this.surface.add(this.plotGroup);this.plotGroup.setClip({x:_53a.l,y:_53a.t,width:w,height:h});}else{this._renderPlotBackground(dim,_53a,w,h);}func.foldr(this.stack,function(z,plot){return plot.render(dim,_53a),0;},0);if(!this.plotGroup){this._renderChartBackground(dim,_53a);}if(this.title){var _53c=(g.renderer=="canvas"),_53d=_53c||!has("ie")&&!has("opera")?"html":"gfx",_53e=g.normalizedLength(g.splitFontString(this.titleFont).size);this.chartTitle=_4fe.createText[_53d](this,this.surface,dim.width/2,this.titlePos=="top"?_53e+this.margins.t:dim.height-this.margins.b,"middle",this.title,this.titleFont,this.titleFontColor);}func.forIn(this.axes,function(axis){axis.render(dim,_53a);});this._makeClean();return this;},_renderChartBackground:function(dim,_53f){var t=this.theme,rect;var fill=this.fill!==undefined?this.fill:(t.chart&&t.chart.fill);var _540=this.stroke!==undefined?this.stroke:(t.chart&&t.chart.stroke);if(fill=="inherit"){var node=this.node;fill=new _4fa(_4f7.get(node,"backgroundColor"));while(fill.a==0&&node!=document.documentElement){fill=new _4fa(_4f7.get(node,"backgroundColor"));node=node.parentNode;}}if(fill){if(this.plotGroup){fill=_4fb.prototype._shapeFill(_4fb.prototype._plotFill(fill,dim),{x:0,y:0,width:dim.width+1,height:dim.height+1});this.surface.createRect({width:dim.width+1,height:dim.height+1}).setFill(fill);}else{fill=_4fb.prototype._plotFill(fill,dim,_53f);if(_53f.l){rect={x:0,y:0,width:_53f.l,height:dim.height+1};this.surface.createRect(rect).setFill(_4fb.prototype._shapeFill(fill,rect));}if(_53f.r){rect={x:dim.width-_53f.r,y:0,width:_53f.r+1,height:dim.height+2};this.surface.createRect(rect).setFill(_4fb.prototype._shapeFill(fill,rect));}if(_53f.t){rect={x:0,y:0,width:dim.width+1,height:_53f.t};this.surface.createRect(rect).setFill(_4fb.prototype._shapeFill(fill,rect));}if(_53f.b){rect={x:0,y:dim.height-_53f.b,width:dim.width+1,height:_53f.b+2};this.surface.createRect(rect).setFill(_4fb.prototype._shapeFill(fill,rect));}}}if(_540){this.surface.createRect({width:dim.width-1,height:dim.height-1}).setStroke(_540);}},_renderPlotBackground:function(dim,_541,w,h){var t=this.theme;var fill=t.plotarea&&t.plotarea.fill;var _542=t.plotarea&&t.plotarea.stroke;var rect={x:_541.l-1,y:_541.t-1,width:w+2,height:h+2};if(fill){fill=_4fb.prototype._shapeFill(_4fb.prototype._plotFill(fill,dim,_541),rect);this.surface.createRect(rect).setFill(fill);}if(_542){this.surface.createRect({x:_541.l,y:_541.t,width:w+1,height:h+1}).setStroke(_542);}},delayedRender:function(){if(!this._delayedRenderHandle){this._delayedRenderHandle=setTimeout(lang.hitch(this,function(){this.render();}),this.delayInMs);}return this;},connectToPlot:function(name,_543,_544){return name in this.plots?this.stack[this.plots[name]].connect(_543,_544):null;},fireEvent:function(_545,_546,_547){if(_545 in this.runs){var _548=this.series[this.runs[_545]].plot;if(_548 in this.plots){var plot=this.stack[this.plots[_548]];if(plot){plot.fireEvent(_545,_546,_547);}}}return this;},_makeClean:function(){arr.forEach(this.axes,_505);arr.forEach(this.stack,_505);arr.forEach(this.series,_505);this.dirty=false;},_makeDirty:function(){arr.forEach(this.axes,_506);arr.forEach(this.stack,_506);arr.forEach(this.series,_506);this.dirty=true;},_invalidateDependentPlots:function(_549,_54a){if(_549 in this.plots){var plot=this.stack[this.plots[_549]],axis,_54b=_54a?"vAxis":"hAxis";if(plot[_54b]){axis=this.axes[plot[_54b]];if(axis&&axis.dependOnData()){axis.dirty=true;arr.forEach(this.stack,function(p){if(p[_54b]&&p[_54b]==plot[_54b]){p.dirty=true;}});}}else{plot.dirty=true;}}}});function _54c(_54d){return {min:_54d.hmin,max:_54d.hmax};};function _54e(_54f){return {min:_54f.vmin,max:_54f.vmax};};function _550(_551,h){_551.hmin=h.min;_551.hmax=h.max;};function _552(_553,v){_553.vmin=v.min;_553.vmax=v.max;};function _554(_555,_556){if(_555&&_556){_555.min=Math.min(_555.min,_556.min);_555.max=Math.max(_555.max,_556.max);}return _555||_556;};function _537(_557,_558){var _559={},axes={};arr.forEach(_557,function(plot){var _55a=_559[plot.name]=plot.getSeriesStats();if(plot.hAxis){axes[plot.hAxis]=_554(axes[plot.hAxis],_54c(_55a));}if(plot.vAxis){axes[plot.vAxis]=_554(axes[plot.vAxis],_54e(_55a));}});arr.forEach(_557,function(plot){var _55b=_559[plot.name];if(plot.hAxis){_550(_55b,axes[plot.hAxis]);}if(plot.vAxis){_552(_55b,axes[plot.vAxis]);}plot.initializeScalers(_558,_55b);});};return _508;});},"dojox/charting/plot2d/Candlesticks":function(){define("dojox/charting/plot2d/Candlesticks",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(lang,_55c,arr,_55d,_55e,dc,df,dfr,du,fx){var _55f=dfr.lambda("item.purgeGroup()");return _55c("dojox.charting.plot2d.Candlesticks",[_55d,_55e],{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_560,_561){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_561);du.updateWithPattern(this.opt,_561,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_562){var _563=lang.delegate(dc.defaultStats);for(var i=0;i<_562.length;i++){var run=_562[i];if(!run.data.length){continue;}var _564=_563.vmin,_565=_563.vmax;if(!("ymin" in run)||!("ymax" in run)){arr.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_563.hmin=Math.min(_563.hmin,x);_563.hmax=Math.max(_563.hmax,x);_563.vmin=Math.min(_563.vmin,val.open,val.close,val.high,val.low);_563.vmax=Math.max(_563.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_563.vmin=Math.min(_564,run.ymin);}if("ymax" in run){_563.vmax=Math.max(_565,run.ymax);}}return _563;},getSeriesStats:function(){var _566=this.collectStats(this.series);_566.hmin-=0.5;_566.hmax+=0.5;return _566;},render:function(dim,_567){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_567);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){arr.forEach(this.series,_55f);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_568,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_569=Math.max(0,this._vScaler.bounds.lower),_56a=vt(_569),_56b=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_568=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _56c=t.next("candlestick",[this.opt,run]),s=run.group,_56d=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _56e=t.addMixin(_56c,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_567.l+gap,y=dim.height-_567.b,open=vt(v.open),_56f=vt(v.close),high=vt(v.high),low=vt(v.low);if("mid" in v){var mid=vt(v.mid);}if(low>high){var tmp=high;high=low;low=tmp;}if(_568>=1){var _570=open>_56f;var line={x1:_568/2,x2:_568/2,y1:y-high,y2:y-low},rect={x:0,y:y-Math.max(open,_56f),width:_568,height:Math.max(_570?open-_56f:_56f-open,1)};var _571=s.createGroup();_571.setTransform({dx:x,dy:0});var _572=_571.createGroup();_572.createLine(line).setStroke(_56e.series.stroke);_572.createRect(rect).setStroke(_56e.series.stroke).setFill(_570?_56e.series.fill:"white");if("mid" in v){_572.createLine({x1:(_56e.series.stroke.width||1),x2:_568-(_56e.series.stroke.width||1),y1:y-mid,y2:y-mid}).setStroke(_570?"white":_56e.series.stroke);}run.dyn.fill=_56e.series.fill;run.dyn.stroke=_56e.series.stroke;if(_56b){var o={element:"candlestick",index:j,run:run,shape:_572,x:x,y:y-Math.max(open,_56f),cx:_568/2,cy:(y-Math.max(open,_56f))+(Math.max(_570?open-_56f:_56f-open,1)/2),width:_568,height:Math.max(_570?open-_56f:_56f-open,1),data:v};this._connectEvents(o);_56d[j]=o;}}if(this.animate){this._animateCandlesticks(_571,y-low,high-low);}}}this._eventSeries[run.name]=_56d;run.dirty=false;}this.dirty=false;return this;},_animateCandlesticks:function(_573,_574,_575){fx.animateTransform(lang.delegate({shape:_573,duration:1200,transform:[{name:"translate",start:[0,_574-(_574/_575)],end:[0,0]},{name:"scale",start:[1,1/_575],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojox/charting/axis2d/Default":function(){define("dojox/charting/axis2d/Default",["dojo/_base/lang","dojo/_base/array","dojo/_base/sniff","dojo/_base/declare","dojo/_base/connect","dojo/dom-geometry","./Invisible","../scaler/common","../scaler/linear","./common","dojox/gfx","dojox/lang/utils","dojox/lang/functional"],function(lang,arr,has,_576,_577,_578,_579,_57a,lin,_57b,g,du,df){var _57c=45;return _576("dojox.charting.axis2d.Default",_579,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,rotation:0,htmlLabels:true,enableCache:false,dropLabels:true,labelSizeChange:false},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",titleOrientation:""},constructor:function(_57d,_57e){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_57e);du.updateWithPattern(this.opt,_57e,this.optionalParams);if(this.opt.enableCache){this._textFreePool=[];this._lineFreePool=[];this._textUsePool=[];this._lineUsePool=[];}this._invalidMaxLabelSize=true;},setWindow:function(_57f,_580){if(_57f!=this.scale){this._invalidMaxLabelSize=true;}return this.inherited(arguments);},_groupLabelWidth:function(_581,font,_582){if(!_581.length){return 0;}if(_581.length>50){_581.length=50;}if(lang.isObject(_581[0])){_581=df.map(_581,function(_583){return _583.text;});}if(_582){_581=df.map(_581,function(_584){return lang.trim(_584).length==0?"":_584.substring(0,_582)+this.trailingSymbol;},this);}var s=_581.join("<br>");return g._base._getTextBox(s,{font:font}).w||0;},_getMaxLabelSize:function(min,max,span,_585,font,size){if(this._maxLabelSize==null&&arguments.length==6){var o=this.opt;this.scaler.minMinorStep=this._prevMinMinorStep=0;var ob=lang.clone(o);delete ob.to;delete ob.from;var sb=lin.buildScaler(min,max,span,ob,o.to-o.from);sb.minMinorStep=0;this._majorStart=sb.major.start;var tb=lin.buildTicks(sb,o);if(size&&tb){var _586=0,_587=0;var _588=function(tick){if(tick.label){this.push(tick.label);}};var _589=[];if(this.opt.majorLabels){arr.forEach(tb.major,_588,_589);_586=this._groupLabelWidth(_589,font,ob.maxLabelCharCount);if(ob.maxLabelSize){_586=Math.min(ob.maxLabelSize,_586);}}_589=[];if(this.opt.dropLabels&&this.opt.minorLabels){arr.forEach(tb.minor,_588,_589);_587=this._groupLabelWidth(_589,font,ob.maxLabelCharCount);if(ob.maxLabelSize){_587=Math.min(ob.maxLabelSize,_587);}}this._maxLabelSize={majLabelW:_586,minLabelW:_587,majLabelH:size,minLabelH:size};}else{this._maxLabelSize=null;}}return this._maxLabelSize;},calculate:function(min,max,span){this.inherited(arguments);this.scaler.minMinorStep=this._prevMinMinorStep;if((this._invalidMaxLabelSize||span!=this._oldSpan)&&(min!=Infinity&&max!=-Infinity)){this._invalidMaxLabelSize=false;if(this.opt.labelSizeChange){this._maxLabelSize=null;}this._oldSpan=span;var o=this.opt;var ta=this.chart.theme.axis,_58a=o.rotation%360,_58b=this.chart.theme.axis.tick.labelGap,font=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),size=font?g.normalizedLength(g.splitFontString(font).size):0,_58c=this._getMaxLabelSize(min,max,span,_58a,font,size);if(typeof _58b!="number"){_58b=4;}if(_58c&&o.dropLabels){var cosr=Math.abs(Math.cos(_58a*Math.PI/180)),sinr=Math.abs(Math.sin(_58a*Math.PI/180));var _58d,_58e;if(_58a<0){_58a+=360;}switch(_58a){case 0:case 180:if(this.vertical){_58d=_58e=size;}else{_58d=_58c.majLabelW;_58e=_58c.minLabelW;}break;case 90:case 270:if(this.vertical){_58d=_58c.majLabelW;_58e=_58c.minLabelW;}else{_58d=_58e=size;}break;default:_58d=this.vertical?Math.min(_58c.majLabelW,size/cosr):Math.min(_58c.majLabelW,size/sinr);var gap1=Math.sqrt(_58c.minLabelW*_58c.minLabelW+size*size),gap2=this.vertical?size*cosr+_58c.minLabelW*sinr:_58c.minLabelW*cosr+size*sinr;_58e=Math.min(gap1,gap2);break;}this.scaler.minMinorStep=this._prevMinMinorStep=Math.max(_58d,_58e)+_58b;var _58f=this.scaler.minMinorStep<=this.scaler.minor.tick*this.scaler.bounds.scale;if(!_58f){this._skipInterval=Math.floor((_58d+_58b)/(this.scaler.major.tick*this.scaler.bounds.scale));}else{this._skipInterval=0;}}else{this._skipInterval=0;}}this.ticks=lin.buildTicks(this.scaler,this.opt);return this;},getOffsets:function(){var s=this.scaler,_590={l:0,r:0,t:0,b:0};if(!s){return _590;}var o=this.opt,a,b,c,d,gl=_57a.getNumericLabel,_591=0,ma=s.major,mi=s.minor,ta=this.chart.theme.axis,_592=this.chart.theme.axis.tick.labelGap,_593=o.titleFont||(ta.title&&ta.title.font),_594=(o.titleGap==0)?0:o.titleGap||(ta.title&&ta.title.gap),_595=this.chart.theme.getTick("major",o),_596=this.chart.theme.getTick("minor",o),_597=_593?g.normalizedLength(g.splitFontString(_593).size):0,_598=o.rotation%360,_599=o.leftBottom,cosr=Math.abs(Math.cos(_598*Math.PI/180)),sinr=Math.abs(Math.sin(_598*Math.PI/180));this.trailingSymbol=(o.trailingSymbol===undefined||o.trailingSymbol===null)?this.trailingSymbol:o.trailingSymbol;if(typeof _592!="number"){_592=4;}if(_598<0){_598+=360;}var _59a=this._getMaxLabelSize();if(_59a){var side;var _59b=Math.ceil(Math.max(_59a.majLabelW,_59a.minLabelW))+1,size=Math.ceil(Math.max(_59a.majLabelH,_59a.minLabelH))+1;if(this.vertical){side=_599?"l":"r";switch(_598){case 0:case 180:_590[side]=_59b;_590.t=_590.b=size/2;break;case 90:case 270:_590[side]=size;_590.t=_590.b=_59b/2;break;default:if(_598<=_57c||(180<_598&&_598<=(180+_57c))){_590[side]=size*sinr/2+_59b*cosr;_590[_599?"t":"b"]=size*cosr/2+_59b*sinr;_590[_599?"b":"t"]=size*cosr/2;}else{if(_598>(360-_57c)||(180>_598&&_598>(180-_57c))){_590[side]=size*sinr/2+_59b*cosr;_590[_599?"b":"t"]=size*cosr/2+_59b*sinr;_590[_599?"t":"b"]=size*cosr/2;}else{if(_598<90||(180<_598&&_598<270)){_590[side]=size*sinr+_59b*cosr;_590[_599?"t":"b"]=size*cosr+_59b*sinr;}else{_590[side]=size*sinr+_59b*cosr;_590[_599?"b":"t"]=size*cosr+_59b*sinr;}}}break;}_590[side]+=_592+Math.max(_595.length,_596.length)+(o.title?(_597+_594):0);}else{side=_599?"b":"t";switch(_598){case 0:case 180:_590[side]=size;_590.l=_590.r=_59b/2;break;case 90:case 270:_590[side]=_59b;_590.l=_590.r=size/2;break;default:if((90-_57c)<=_598&&_598<=90||(270-_57c)<=_598&&_598<=270){_590[side]=size*cosr/2+_59b*sinr;_590[_599?"r":"l"]=size*sinr/2+_59b*cosr;_590[_599?"l":"r"]=size*sinr/2;}else{if(90<=_598&&_598<=(90+_57c)||270<=_598&&_598<=(270+_57c)){_590[side]=size*cosr/2+_59b*sinr;_590[_599?"l":"r"]=size*sinr/2+_59b*cosr;_590[_599?"r":"l"]=size*sinr/2;}else{if(_598<_57c||(180<_598&&_598<(180+_57c))){_590[side]=size*cosr+_59b*sinr;_590[_599?"r":"l"]=size*sinr+_59b*cosr;}else{_590[side]=size*cosr+_59b*sinr;_590[_599?"l":"r"]=size*sinr+_59b*cosr;}}}break;}_590[side]+=_592+Math.max(_595.length,_596.length)+(o.title?(_597+_594):0);}}return _590;},cleanGroup:function(_59c){if(this.opt.enableCache&&this.group){this._lineFreePool=this._lineFreePool.concat(this._lineUsePool);this._lineUsePool=[];this._textFreePool=this._textFreePool.concat(this._textUsePool);this._textUsePool=[];}this.inherited(arguments);},createText:function(_59d,_59e,x,y,_59f,_5a0,font,_5a1,_5a2){if(!this.opt.enableCache||_59d=="html"){return _57b.createText[_59d](this.chart,_59e,x,y,_59f,_5a0,font,_5a1,_5a2);}var text;if(this._textFreePool.length>0){text=this._textFreePool.pop();text.setShape({x:x,y:y,text:_5a0,align:_59f});_59e.add(text);}else{text=_57b.createText[_59d](this.chart,_59e,x,y,_59f,_5a0,font,_5a1);}this._textUsePool.push(text);return text;},createLine:function(_5a3,_5a4){var line;if(this.opt.enableCache&&this._lineFreePool.length>0){line=this._lineFreePool.pop();line.setShape(_5a4);_5a3.add(line);}else{line=_5a3.createLine(_5a4);}if(this.opt.enableCache){this._lineUsePool.push(line);}return line;},render:function(dim,_5a5){if(!this.dirty||!this.scaler){return this;}var o=this.opt,ta=this.chart.theme.axis,_5a6=o.leftBottom,_5a7=o.rotation%360,_5a8,stop,_5a9,_5aa=0,_5ab,_5ac,_5ad,_5ae,_5af,_5b0,_5b1=this.chart.theme.axis.tick.labelGap,_5b2=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),_5b3=o.titleFont||(ta.title&&ta.title.font),_5b4=o.fontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"black",_5b5=o.titleFontColor||(ta.title&&ta.title.fontColor)||"black",_5b6=(o.titleGap==0)?0:o.titleGap||(ta.title&&ta.title.gap)||15,_5b7=o.titleOrientation||(ta.title&&ta.title.orientation)||"axis",_5b8=this.chart.theme.getTick("major",o),_5b9=this.chart.theme.getTick("minor",o),_5ba=this.chart.theme.getTick("micro",o),_5bb=Math.max(_5b8.length,_5b9.length,_5ba.length),_5bc="stroke" in o?o.stroke:ta.stroke,size=_5b2?g.normalizedLength(g.splitFontString(_5b2).size):0,cosr=Math.abs(Math.cos(_5a7*Math.PI/180)),sinr=Math.abs(Math.sin(_5a7*Math.PI/180)),_5bd=_5b3?g.normalizedLength(g.splitFontString(_5b3).size):0;if(typeof _5b1!="number"){_5b1=4;}if(_5a7<0){_5a7+=360;}var _5be=this._getMaxLabelSize();_5be=_5be&&_5be.majLabelW;if(this.vertical){_5a8={y:dim.height-_5a5.b};stop={y:_5a5.t};_5a9={y:(dim.height-_5a5.b+_5a5.t)/2};_5ab=size*sinr+(_5be||0)*cosr+_5b1+Math.max(_5b8.length,_5b9.length)+_5bd+_5b6;_5ac={x:0,y:-1};_5af={x:0,y:0};_5ad={x:1,y:0};_5ae={x:_5b1,y:0};switch(_5a7){case 0:_5b0="end";_5af.y=size*0.4;break;case 90:_5b0="middle";_5af.x=-size;break;case 180:_5b0="start";_5af.y=-size*0.4;break;case 270:_5b0="middle";break;default:if(_5a7<_57c){_5b0="end";_5af.y=size*0.4;}else{if(_5a7<90){_5b0="end";_5af.y=size*0.4;}else{if(_5a7<(180-_57c)){_5b0="start";}else{if(_5a7<(180+_57c)){_5b0="start";_5af.y=-size*0.4;}else{if(_5a7<270){_5b0="start";_5af.x=_5a6?0:size*0.4;}else{if(_5a7<(360-_57c)){_5b0="end";_5af.x=_5a6?0:size*0.4;}else{_5b0="end";_5af.y=size*0.4;}}}}}}}if(_5a6){_5a8.x=stop.x=_5a5.l;_5aa=(_5b7&&_5b7=="away")?90:270;_5a9.x=_5a5.l-_5ab+(_5aa==270?_5bd:0);_5ad.x=-1;_5ae.x=-_5ae.x;}else{_5a8.x=stop.x=dim.width-_5a5.r;_5aa=(_5b7&&_5b7=="axis")?90:270;_5a9.x=dim.width-_5a5.r+_5ab-(_5aa==270?0:_5bd);switch(_5b0){case "start":_5b0="end";break;case "end":_5b0="start";break;case "middle":_5af.x+=size;break;}}}else{_5a8={x:_5a5.l};stop={x:dim.width-_5a5.r};_5a9={x:(dim.width-_5a5.r+_5a5.l)/2};_5ab=size*cosr+(_5be||0)*sinr+_5b1+Math.max(_5b8.length,_5b9.length)+_5bd+_5b6;_5ac={x:1,y:0};_5af={x:0,y:0};_5ad={x:0,y:1};_5ae={x:0,y:_5b1};switch(_5a7){case 0:_5b0="middle";_5af.y=size;break;case 90:_5b0="start";_5af.x=-size*0.4;break;case 180:_5b0="middle";break;case 270:_5b0="end";_5af.x=size*0.4;break;default:if(_5a7<(90-_57c)){_5b0="start";_5af.y=_5a6?size:0;}else{if(_5a7<(90+_57c)){_5b0="start";_5af.x=-size*0.4;}else{if(_5a7<180){_5b0="start";_5af.y=_5a6?0:-size;}else{if(_5a7<(270-_57c)){_5b0="end";_5af.y=_5a6?0:-size;}else{if(_5a7<(270+_57c)){_5b0="end";_5af.y=_5a6?size*0.4:0;}else{_5b0="end";_5af.y=_5a6?size:0;}}}}}}if(_5a6){_5a8.y=stop.y=dim.height-_5a5.b;_5aa=(_5b7&&_5b7=="axis")?180:0;_5a9.y=dim.height-_5a5.b+_5ab-(_5aa?_5bd:0);}else{_5a8.y=stop.y=_5a5.t;_5aa=(_5b7&&_5b7=="away")?180:0;_5a9.y=_5a5.t-_5ab+(_5aa?0:_5bd);_5ad.y=-1;_5ae.y=-_5ae.y;switch(_5b0){case "start":_5b0="end";break;case "end":_5b0="start";break;case "middle":_5af.y-=size;break;}}}this.cleanGroup();var s=this.group,c=this.scaler,t=this.ticks,f=lin.getTransformerFromModel(this.scaler),_5bf=(!o.title||!_5aa)&&!_5a7&&this.opt.htmlLabels&&!has("ie")&&!has("opera")?"html":"gfx",dx=_5ad.x*_5b8.length,dy=_5ad.y*_5b8.length,skip=this._skipInterval;s.createLine({x1:_5a8.x,y1:_5a8.y,x2:stop.x,y2:stop.y}).setStroke(_5bc);if(o.title){var _5c0=_57b.createText[_5bf](this.chart,s,_5a9.x,_5a9.y,"middle",o.title,_5b3,_5b5);if(_5bf=="html"){this.htmlElements.push(_5c0);}else{_5c0.setTransform(g.matrix.rotategAt(_5aa,_5a9.x,_5a9.y));}}if(t==null){this.dirty=false;return this;}var rel=(t.major.length>0)?(t.major[0].value-this._majorStart)/c.major.tick:0;var _5c1=this.opt.majorLabels;arr.forEach(t.major,function(tick,i){var _5c2=f(tick.value),elem,x=_5a8.x+_5ac.x*_5c2,y=_5a8.y+_5ac.y*_5c2;i+=rel;this.createLine(s,{x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_5b8);if(tick.label&&(!skip||(i-(1+skip))%(1+skip)==0)){var _5c3=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_5b2,o.maxLabelCharCount):{text:tick.label,truncated:false};_5c3=o.maxLabelSize?this.getTextWithLimitLength(_5c3.text,_5b2,o.maxLabelSize,_5c3.truncated):_5c3;elem=this.createText(_5bf,s,x+dx+_5ae.x+(_5a7?0:_5af.x),y+dy+_5ae.y+(_5a7?0:_5af.y),_5b0,_5c3.text,_5b2,_5b4);if(this.chart.truncateBidi&&_5c3.truncated){this.chart.truncateBidi(elem,tick.label,_5bf);}_5c3.truncated&&this.labelTooltip(elem,this.chart,tick.label,_5c3.text,_5b2,_5bf);if(_5bf=="html"){this.htmlElements.push(elem);}else{if(_5a7){elem.setTransform([{dx:_5af.x,dy:_5af.y},g.matrix.rotategAt(_5a7,x+dx+_5ae.x,y+dy+_5ae.y)]);}}}},this);dx=_5ad.x*_5b9.length;dy=_5ad.y*_5b9.length;_5c1=this.opt.minorLabels&&c.minMinorStep<=c.minor.tick*c.bounds.scale;arr.forEach(t.minor,function(tick){var _5c4=f(tick.value),elem,x=_5a8.x+_5ac.x*_5c4,y=_5a8.y+_5ac.y*_5c4;this.createLine(s,{x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_5b9);if(_5c1&&tick.label){var _5c5=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_5b2,o.maxLabelCharCount):{text:tick.label,truncated:false};_5c5=o.maxLabelSize?this.getTextWithLimitLength(_5c5.text,_5b2,o.maxLabelSize,_5c5.truncated):_5c5;elem=this.createText(_5bf,s,x+dx+_5ae.x+(_5a7?0:_5af.x),y+dy+_5ae.y+(_5a7?0:_5af.y),_5b0,_5c5.text,_5b2,_5b4);if(this.chart.getTextDir&&_5c5.truncated){this.chart.truncateBidi(elem,tick.label,_5bf);}_5c5.truncated&&this.labelTooltip(elem,this.chart,tick.label,_5c5.text,_5b2,_5bf);if(_5bf=="html"){this.htmlElements.push(elem);}else{if(_5a7){elem.setTransform([{dx:_5af.x,dy:_5af.y},g.matrix.rotategAt(_5a7,x+dx+_5ae.x,y+dy+_5ae.y)]);}}}},this);dx=_5ad.x*_5ba.length;dy=_5ad.y*_5ba.length;arr.forEach(t.micro,function(tick){var _5c6=f(tick.value),elem,x=_5a8.x+_5ac.x*_5c6,y=_5a8.y+_5ac.y*_5c6;this.createLine(s,{x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_5ba);},this);this.dirty=false;return this;},labelTooltip:function(elem,_5c7,_5c8,_5c9,font,_5ca){var _5cb=["dijit/Tooltip"];var _5cc={type:"rect"},_5cd=["above","below"],_5ce=g._base._getTextBox(_5c9,{font:font}).w||0,_5cf=font?g.normalizedLength(g.splitFontString(font).size):0;if(_5ca=="html"){lang.mixin(_5cc,_578.position(elem.firstChild,true));_5cc.width=Math.ceil(_5ce);_5cc.height=Math.ceil(_5cf);this._events.push({shape:dojo,handle:_577.connect(elem.firstChild,"onmouseover",this,function(e){require(_5cb,function(_5d0){_5d0.show(_5c8,_5cc,_5cd);});})});this._events.push({shape:dojo,handle:_577.connect(elem.firstChild,"onmouseout",this,function(e){require(_5cb,function(_5d1){_5d1.hide(_5cc);});})});}else{var shp=elem.getShape(),lt=_5c7.getCoords();_5cc=lang.mixin(_5cc,{x:shp.x-_5ce/2,y:shp.y});_5cc.x+=lt.x;_5cc.y+=lt.y;_5cc.x=Math.round(_5cc.x);_5cc.y=Math.round(_5cc.y);_5cc.width=Math.ceil(_5ce);_5cc.height=Math.ceil(_5cf);this._events.push({shape:elem,handle:elem.connect("onmouseenter",this,function(e){require(_5cb,function(_5d2){_5d2.show(_5c8,_5cc,_5cd);});})});this._events.push({shape:elem,handle:elem.connect("onmouseleave",this,function(e){require(_5cb,function(_5d3){_5d3.hide(_5cc);});})});}}});});},"dojox/charting/plot2d/Scatter":function(){define("dojox/charting/plot2d/Scatter",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx","dojox/gfx/gradutils"],function(lang,arr,_5d4,_5d5,_5d6,dc,df,dfr,du,fx,_5d7){var _5d8=dfr.lambda("item.purgeGroup()");return _5d4("dojox.charting.plot2d.Scatter",[_5d5,_5d6],{defaultParams:{hAxis:"x",vAxis:"y",shadows:null,animate:null},optionalParams:{markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:"",styleFunc:null},constructor:function(_5d9,_5da){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_5da);du.updateWithPattern(this.opt,_5da,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_5db){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_5db);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){arr.forEach(this.series,_5d8);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_5dc=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}var _5dd=t.next("marker",[this.opt,run]),s=run.group,_5de,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler);if(typeof run.data[0]=="number"){_5de=arr.map(run.data,function(v,i){return {x:ht(i+1)+_5db.l,y:dim.height-_5db.b-vt(v)};},this);}else{_5de=arr.map(run.data,function(v,i){return {x:ht(v.x)+_5db.l,y:dim.height-_5db.b-vt(v.y)};},this);}var _5df=new Array(_5de.length),_5e0=new Array(_5de.length),_5e1=new Array(_5de.length);arr.forEach(_5de,function(c,i){var _5e2=run.data[i],_5e3;if(this.opt.styleFunc||typeof _5e2!="number"){var _5e4=typeof _5e2!="number"?[_5e2]:[];if(this.opt.styleFunc){_5e4.push(this.opt.styleFunc(_5e2));}_5e3=t.addMixin(_5dd,"marker",_5e4,true);}else{_5e3=t.post(_5dd,"marker");}var path="M"+c.x+" "+c.y+" "+_5e3.symbol;if(_5e3.marker.shadow){_5df[i]=s.createPath("M"+(c.x+_5e3.marker.shadow.dx)+" "+(c.y+_5e3.marker.shadow.dy)+" "+_5e3.symbol).setStroke(_5e3.marker.shadow).setFill(_5e3.marker.shadow.color);if(this.animate){this._animateScatter(_5df[i],dim.height-_5db.b);}}if(_5e3.marker.outline){var _5e5=dc.makeStroke(_5e3.marker.outline);_5e5.width=2*_5e5.width+_5e3.marker.stroke.width;_5e1[i]=s.createPath(path).setStroke(_5e5);if(this.animate){this._animateScatter(_5e1[i],dim.height-_5db.b);}}var _5e6=dc.makeStroke(_5e3.marker.stroke),fill=this._plotFill(_5e3.marker.fill,dim,_5db);if(fill&&(fill.type==="linear"||fill.type=="radial")){var _5e7=_5d7.getColor(fill,{x:c.x,y:c.y});if(_5e6){_5e6.color=_5e7;}_5e0[i]=s.createPath(path).setStroke(_5e6).setFill(_5e7);}else{_5e0[i]=s.createPath(path).setStroke(_5e6).setFill(fill);}if(this.animate){this._animateScatter(_5e0[i],dim.height-_5db.b);}},this);if(_5e0.length){run.dyn.marker=_5dd.symbol;run.dyn.markerStroke=_5e0[_5e0.length-1].getStroke();run.dyn.markerFill=_5e0[_5e0.length-1].getFill();}if(_5dc){var _5e8=new Array(_5e0.length);arr.forEach(_5e0,function(s,i){var o={element:"marker",index:i,run:run,shape:s,outline:_5e1&&_5e1[i]||null,shadow:_5df&&_5df[i]||null,cx:_5de[i].x,cy:_5de[i].y};if(typeof run.data[0]=="number"){o.x=i+1;o.y=run.data[i];}else{o.x=run.data[i].x;o.y=run.data[i].y;}this._connectEvents(o);_5e8[i]=o;},this);this._eventSeries[run.name]=_5e8;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateScatter:function(_5e9,_5ea){fx.animateTransform(lang.delegate({shape:_5e9,duration:1200,transform:[{name:"translate",start:[0,_5ea],end:[0,0]},{name:"scale",start:[0,0],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"dojox/data/CsvStore":function(){define("dojox/data/CsvStore",["dojo/_base/lang","dojo/_base/declare","dojo/_base/xhr","dojo/_base/kernel","dojo/data/util/filter","dojo/data/util/simpleFetch"],function(lang,_5eb,xhr,_5ec,_5ed,_5ee){var _5ef=_5eb("dojox.data.CsvStore",null,{constructor:function(_5f0){this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=false;if(_5f0.url){this.url=_5f0.url;}this._csvData=_5f0.data;if(_5f0.label){this.label=_5f0.label;}else{if(this.label===""){this.label=undefined;}}this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._loadInProgress=false;this._queuedFetches=[];this.identifier=_5f0.identifier;if(this.identifier===""){delete this.identifier;}else{this._idMap={};}if("separator" in _5f0){this.separator=_5f0.separator;}if("urlPreventCache" in _5f0){this.urlPreventCache=_5f0.urlPreventCache?true:false;}},url:"",label:"",identifier:"",separator:",",urlPreventCache:false,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": a function was passed an item argument that was not an item");}},_getIndex:function(item){var idx=this.getIdentity(item);if(this.identifier){idx=this._idMap[idx];}return idx;},getValue:function(item,_5f1,_5f2){this._assertIsItem(item);var _5f3=_5f2;if(typeof _5f1==="string"){var ai=this._attributeIndexes[_5f1];if(ai!=null){var _5f4=this._dataArray[this._getIndex(item)];_5f3=_5f4[ai]||_5f2;}}else{throw new Error(this.declaredClass+": a function was passed an attribute argument that was not a string");}return _5f3;},getValues:function(item,_5f5){var _5f6=this.getValue(item,_5f5);return (_5f6?[_5f6]:[]);},getAttributes:function(item){this._assertIsItem(item);var _5f7=[];var _5f8=this._dataArray[this._getIndex(item)];for(var i=0;i<_5f8.length;i++){if(_5f8[i]!==""){_5f7.push(this._attributes[i]);}}return _5f7;},hasAttribute:function(item,_5f9){this._assertIsItem(item);if(typeof _5f9==="string"){var _5fa=this._attributeIndexes[_5f9];var _5fb=this._dataArray[this._getIndex(item)];return (typeof _5fa!=="undefined"&&_5fa<_5fb.length&&_5fb[_5fa]!=="");}else{throw new Error(this.declaredClass+": a function was passed an attribute argument that was not a string");}},containsValue:function(item,_5fc,_5fd){var _5fe=undefined;if(typeof _5fd==="string"){_5fe=_5ed.patternToRegExp(_5fd,false);}return this._containsValue(item,_5fc,_5fd,_5fe);},_containsValue:function(item,_5ff,_600,_601){var _602=this.getValues(item,_5ff);for(var i=0;i<_602.length;++i){var _603=_602[i];if(typeof _603==="string"&&_601){return (_603.match(_601)!==null);}else{if(_600===_603){return true;}}}return false;},isItem:function(_604){if(_604&&_604[this._storeProp]===this){var _605=_604[this._idProp];if(this.identifier){var data=this._dataArray[this._idMap[_605]];if(data){return true;}}else{if(_605>=0&&_605<this._dataArray.length){return true;}}}return false;},isItemLoaded:function(_606){return this.isItem(_606);},loadItem:function(item){},getFeatures:function(){return this._features;},getLabel:function(item){if(this.label&&this.isItem(item)){return this.getValue(item,this.label);}return undefined;},getLabelAttributes:function(item){if(this.label){return [this.label];}return null;},_fetchItems:function(_607,_608,_609){var self=this;var _60a=function(_60b,_60c){var _60d=null;if(_60b.query){var key,_60e;_60d=[];var _60f=_60b.queryOptions?_60b.queryOptions.ignoreCase:false;var _610={};for(key in _60b.query){_60e=_60b.query[key];if(typeof _60e==="string"){_610[key]=_5ed.patternToRegExp(_60e,_60f);}}for(var i=0;i<_60c.length;++i){var _611=true;var _612=_60c[i];for(key in _60b.query){_60e=_60b.query[key];if(!self._containsValue(_612,key,_60e,_610[key])){_611=false;}}if(_611){_60d.push(_612);}}}else{_60d=_60c.slice(0,_60c.length);}_608(_60d,_60b);};if(this._loadFinished){_60a(_607,this._arrayOfAllItems);}else{if(this.url!==""){if(this._loadInProgress){this._queuedFetches.push({args:_607,filter:_60a});}else{this._loadInProgress=true;var _613={url:self.url,handleAs:"text",preventCache:self.urlPreventCache};var _614=xhr.get(_613);_614.addCallback(function(data){try{self._processData(data);_60a(_607,self._arrayOfAllItems);self._handleQueuedFetches();}catch(e){_609(e,_607);}});_614.addErrback(function(_615){self._loadInProgress=false;if(_609){_609(_615,_607);}else{throw _615;}});var _616=null;if(_607.abort){_616=_607.abort;}_607.abort=function(){var df=_614;if(df&&df.fired===-1){df.cancel();df=null;}if(_616){_616.call(_607);}};}}else{if(this._csvData){try{this._processData(this._csvData);this._csvData=null;_60a(_607,this._arrayOfAllItems);}catch(e){_609(e,_607);}}else{var _617=new Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(_609){_609(_617,_607);}else{throw _617;}}}}},close:function(_618){},_getArrayOfArraysFromCsvFileContents:function(_619){if(lang.isString(_619)){var _61a=new RegExp("^\\s+","g");var _61b=new RegExp("\\s+$","g");var _61c=new RegExp("\"\"","g");var _61d=[];var i;var _61e=this._splitLines(_619);for(i=0;i<_61e.length;++i){var _61f=_61e[i];if(_61f.length>0){var _620=_61f.split(this.separator);var j=0;while(j<_620.length){var _621=_620[j];var _622=_621.replace(_61a,"");var _623=_622.replace(_61b,"");var _624=_623.charAt(0);var _625=_623.charAt(_623.length-1);var _626=_623.charAt(_623.length-2);var _627=_623.charAt(_623.length-3);if(_623.length===2&&_623=="\"\""){_620[j]="";}else{if((_624=="\"")&&((_625!="\"")||((_625=="\"")&&(_626=="\"")&&(_627!="\"")))){if(j+1===_620.length){return;}var _628=_620[j+1];_620[j]=_622+this.separator+_628;_620.splice(j+1,1);}else{if((_624=="\"")&&(_625=="\"")){_623=_623.slice(1,(_623.length-1));_623=_623.replace(_61c,"\"");}_620[j]=_623;j+=1;}}}_61d.push(_620);}}this._attributes=_61d.shift();for(i=0;i<this._attributes.length;i++){this._attributeIndexes[this._attributes[i]]=i;}this._dataArray=_61d;}},_splitLines:function(_629){var _62a=[];var i;var line="";var _62b=false;for(i=0;i<_629.length;i++){var c=_629.charAt(i);switch(c){case "\"":_62b=!_62b;line+=c;break;case "\r":if(_62b){line+=c;}else{_62a.push(line);line="";if(i<(_629.length-1)&&_629.charAt(i+1)=="\n"){i++;}}break;case "\n":if(_62b){line+=c;}else{_62a.push(line);line="";}break;default:line+=c;}}if(line!==""){_62a.push(line);}return _62a;},_processData:function(data){this._getArrayOfArraysFromCsvFileContents(data);this._arrayOfAllItems=[];if(this.identifier){if(this._attributeIndexes[this.identifier]===undefined){throw new Error(this.declaredClass+": Identity specified is not a column header in the data set.");}}for(var i=0;i<this._dataArray.length;i++){var id=i;if(this.identifier){var _62c=this._dataArray[i];id=_62c[this._attributeIndexes[this.identifier]];this._idMap[id]=i;}this._arrayOfAllItems.push(this._createItemFromIdentity(id));}this._loadFinished=true;this._loadInProgress=false;},_createItemFromIdentity:function(_62d){var item={};item[this._storeProp]=this;item[this._idProp]=_62d;return item;},getIdentity:function(item){if(this.isItem(item)){return item[this._idProp];}return null;},fetchItemByIdentity:function(_62e){var item;var _62f=_62e.scope?_62e.scope:_5ec.global;if(!this._loadFinished){var self=this;if(this.url!==""){if(this._loadInProgress){this._queuedFetches.push({args:_62e});}else{this._loadInProgress=true;var _630={url:self.url,handleAs:"text"};var _631=xhr.get(_630);_631.addCallback(function(data){try{self._processData(data);var item=self._createItemFromIdentity(_62e.identity);if(!self.isItem(item)){item=null;}if(_62e.onItem){_62e.onItem.call(_62f,item);}self._handleQueuedFetches();}catch(error){if(_62e.onError){_62e.onError.call(_62f,error);}}});_631.addErrback(function(_632){this._loadInProgress=false;if(_62e.onError){_62e.onError.call(_62f,_632);}});}}else{if(this._csvData){try{self._processData(self._csvData);self._csvData=null;item=self._createItemFromIdentity(_62e.identity);if(!self.isItem(item)){item=null;}if(_62e.onItem){_62e.onItem.call(_62f,item);}}catch(e){if(_62e.onError){_62e.onError.call(_62f,e);}}}}}else{item=this._createItemFromIdentity(_62e.identity);if(!this.isItem(item)){item=null;}if(_62e.onItem){_62e.onItem.call(_62f,item);}}},getIdentityAttributes:function(item){if(this.identifier){return [this.identifier];}else{return null;}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _633=this._queuedFetches[i];var _634=_633.filter;var _635=_633.args;if(_634){_634(_635,this._arrayOfAllItems);}else{this.fetchItemByIdentity(_633.args);}}this._queuedFetches=[];}}});lang.extend(_5ef,_5ee);return _5ef;});},"dojox/charting/plot2d/ClusteredColumns":function(){define("dojox/charting/plot2d/ClusteredColumns",["dojo/_base/declare","./Columns","./common"],function(_636,_637,dc){return _636("dojox.charting.plot2d.ClusteredColumns",_637,{getBarProperties:function(){var f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt,this.series.length);return {gap:f.gap,width:f.size,thickness:f.size};}});});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_638,_639){dojo.DeferredList=function(list,_63a,_63b,_63c,_63d){var _63e=[];_638.call(this);var self=this;if(list.length===0&&!_63a){this.resolve([0,[]]);}var _63f=0;_639.forEach(list,function(item,i){item.then(function(_640){if(_63a){self.resolve([i,_640]);}else{_641(true,_640);}},function(_642){if(_63b){self.reject(_642);}else{_641(false,_642);}if(_63c){return null;}throw _642;});function _641(_643,_644){_63e[i]=[_643,_644];_63f++;if(_63f===list.length){self.resolve(_63e);}};});};dojo.DeferredList.prototype=new _638();dojo.DeferredList.prototype.gatherResults=function(_645){var d=new dojo.DeferredList(_645,false,true,false);d.addCallback(function(_646){var ret=[];_639.forEach(_646,function(_647){ret.push(_647[1]);});return ret;});return d;};return dojo.DeferredList;});},"dojo/io/iframe":function(){define(["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(_648,json,_649,lang,xhr,has,win,dom,_64a,_64b,_64c,_64d,_64e){dojo.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var mid=_64e._iframeName;mid=mid.substring(0,mid.lastIndexOf("_"));var _64f=lang.delegate(_64e,{create:function(){return _64f._frame=_64e.create.apply(_64e,arguments);},get:null,post:null,send:function(args){var rDfd;var dfd=xhr._ioSetArgs(args,function(dfd){rDfd&&rDfd.cancel();},function(dfd){var _650=null,_651=dfd.ioArgs;try{var _652=_651.handleAs;if(_652==="xml"||_652==="html"){_650=rDfd.response.data;}else{_650=rDfd.response.text;if(_652==="json"){_650=json.fromJson(_650);}else{if(_652==="javascript"){_650=_649.eval(_650);}}}}catch(e){_650=e;}return _650;},function(_653,dfd){dfd.ioArgs._hasError=true;return _653;});var _654=dfd.ioArgs;var _655="GET",form=dojo.byId(args.form);if(args.method&&args.method.toUpperCase()==="POST"&&form){_655="POST";}var _656={method:_655,handleAs:args.handleAs==="json"||args.handleAs==="javascript"?"text":args.handleAs,form:args.form,query:form?null:args.content,data:form?args.content:null,timeout:args.timeout,ioArgs:_654};if(_656.method){_656.method=_656.method.toUpperCase();}if(_648.ioPublish&&_649.publish&&_654.args.ioPublish!==false){var _657=_64d.after(_64e,"_notifyStart",function(data){if(data.options.ioArgs===_654){_657.remove();xhr._ioNotifyStart(dfd);}},true);}rDfd=_64e(_654.url,_656,true);_654._callNext=rDfd._callNext;rDfd.then(function(){dfd.resolve(dfd);}).otherwise(function(_658){dfd.ioArgs.error=_658;dfd.reject(_658);});return dfd;},_iframeOnload:win.global[mid+"_onload"]});lang.setObject("dojo.io.iframe",_64f);return _64f;});},"dojox/lang/functional/lambda":function(){define("dojox/lang/functional/lambda",["../..","dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(_659,dojo,lang,arr){var df=lang.getObject("lang.functional",true,_659);var _65a={};var _65b="ab".split(/a*/).length>1?String.prototype.split:function(sep){var r=this.split.call(this,sep),m=sep.exec(this);if(m&&m.index==0){r.unshift("");}return r;};var _65c=function(s){var args=[],_65d=_65b.call(s,/\s*->\s*/m);if(_65d.length>1){while(_65d.length){s=_65d.pop();args=_65d.pop().split(/\s*,\s*|\s+/m);if(_65d.length){_65d.push("(function("+args+"){return ("+s+")})");}}}else{if(s.match(/\b_\b/)){args=["_"];}else{var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(l||r){if(l){args.push("$1");s="$1"+s;}if(r){args.push("$2");s=s+"$2";}}else{var vars=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};arr.forEach(vars,function(v){if(!(v in t)){args.push(v);t[v]=1;}});}}}return {args:args,body:s};};var _65e=function(a){return a.length?function(){var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);for(--i;i>=0;--i){x=df.lambda(a[i]).call(this,x);}return x;}:function(x){return x;};};lang.mixin(df,{rawLambda:function(s){return _65c(s);},buildLambda:function(s){s=_65c(s);return "function("+s.args.join(",")+"){return ("+s.body+");}";},lambda:function(s){if(typeof s=="function"){return s;}if(s instanceof Array){return _65e(s);}if(s in _65a){return _65a[s];}s=_65c(s);return _65a[s]=new Function(s.args,"return ("+s.body+");");},clearLambdaCache:function(){_65a={};}});return df;});},"dojox/charting/plot2d/CartesianBase":function(){define("dojox/charting/plot2d/CartesianBase",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","./Base","../scaler/primitive","dojox/gfx/fx"],function(lang,_65f,hub,Base,_660,fx){return _65f("dojox.charting.plot2d.CartesianBase",Base,{constructor:function(_661,_662){this.axes=["hAxis","vAxis"];this.zoom=null,this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};},clear:function(){this.inherited(arguments);this._hAxis=null;this._vAxis=null;return this;},cleanGroup:function(_663){this.inherited(arguments,[_663||this.chart.plotGroup]);},setAxis:function(axis){if(axis){this[axis.vertical?"_vAxis":"_hAxis"]=axis;}return this;},toPage:function(_664){var ah=this._hAxis,av=this._vAxis,sh=ah.getScaler(),sv=av.getScaler(),th=sh.scaler.getTransformerFromModel(sh),tv=sv.scaler.getTransformerFromModel(sv),c=this.chart.getCoords(),o=this.chart.offsets,dim=this.chart.dim;var t=function(_665){var r={};r.x=th(_665[ah.name])+c.x+o.l;r.y=c.y+dim.height-o.b-tv(_665[av.name]);return r;};return _664?t(_664):t;},toData:function(_666){var ah=this._hAxis,av=this._vAxis,sh=ah.getScaler(),sv=av.getScaler(),th=sh.scaler.getTransformerFromPlot(sh),tv=sv.scaler.getTransformerFromPlot(sv),c=this.chart.getCoords(),o=this.chart.offsets,dim=this.chart.dim;var t=function(_667){var r={};r[ah.name]=th(_667.x-c.x-o.l);r[av.name]=tv(c.y+dim.height-_667.y-o.b);return r;};return _666?t(_666):t;},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty;},performZoom:function(dim,_668){var vs=this._vAxis.scale||1,hs=this._hAxis.scale||1,_669=dim.height-_668.b,_66a=this._hScaler.bounds,_66b=(_66a.from-_66a.lower)*_66a.scale,_66c=this._vScaler.bounds,_66d=(_66c.from-_66c.lower)*_66c.scale,_66e=vs/this.lastWindow.vscale,_66f=hs/this.lastWindow.hscale,_670=(this.lastWindow.xoffset-_66b)/((this.lastWindow.hscale==1)?hs:this.lastWindow.hscale),_671=(_66d-this.lastWindow.yoffset)/((this.lastWindow.vscale==1)?vs:this.lastWindow.vscale),_672=this.group,anim=fx.animateTransform(lang.delegate({shape:_672,duration:1200,transform:[{name:"translate",start:[0,0],end:[_668.l*(1-_66f),_669*(1-_66e)]},{name:"scale",start:[1,1],end:[_66f,_66e]},{name:"original"},{name:"translate",start:[0,0],end:[_670,_671]}]},this.zoom));lang.mixin(this.lastWindow,{vscale:vs,hscale:hs,xoffset:_66b,yoffset:_66d});this.zoomQueue.push(anim);hub.connect(anim,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();if(this.zoomQueue.length>0){this.zoomQueue[0].play();}});if(this.zoomQueue.length==1){this.zoomQueue[0].play();}return this;},initializeScalers:function(dim,_673){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_673.hmin,_673.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=_660.buildScaler(_673.hmin,_673.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_673.vmin,_673.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=_660.buildScaler(_673.vmin,_673.vmax,dim.height);}return this;}});});},"dojox/charting/themes/common":function(){define("dojox/charting/themes/common",["dojo/_base/lang"],function(lang){return lang.getObject("dojox.charting.themes",true);});},"dojox/charting/plot2d/MarkersOnly":function(){define("dojox/charting/plot2d/MarkersOnly",["dojo/_base/declare","./Default"],function(_674,_675){return _674("dojox.charting.plot2d.MarkersOnly",_675,{constructor:function(){this.opt.lines=false;this.opt.markers=true;}});});},"esri/dijit/Popup":function(){define("esri/dijit/Popup",["dijit","dojo","dojox","dojo/require!esri/InfoWindowBase,esri/PopupBase,esri/utils,dijit/_Widget,dijit/_Templated,dojo/number,dojo/date/locale,dojox/charting/Chart2D,dojox/charting/themes/PlotKit/base,dojox/charting/action2d/Tooltip,dojo/i18n"],function(_676,dojo,_677){dojo.provide("esri.dijit.Popup");dojo.require("esri.InfoWindowBase");dojo.require("esri.PopupBase");dojo.require("esri.utils");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dojo.number");dojo.require("dojo.date.locale");dojo.require("dojox.charting.Chart2D");dojo.require("dojox.charting.themes.PlotKit.base");dojo.require("dojox.charting.action2d.Tooltip");dojo.require("dojo.i18n");(function(){var dc=_677.charting,pk=dc.themes.PlotKit;pk.popup=pk.base.clone();pk.popup.chart.fill=pk.popup.plotarea.fill="#e7eef6";pk.popup.colors=["#284B70","#702828","#5F7143","#F6BC0C","#382C6C","#50224F","#1D7554","#4C4C4C","#0271AE","#706E41","#446A73","#0C3E69","#757575","#B7B7B7","#A3A3A3"];pk.popup.series.stroke.width=1;pk.popup.marker.stroke.width=1;}());dojo.declare("esri.dijit.Popup",[esri.InfoWindowBase,esri.PopupBase],{offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:true,constructor:function(_678,_679){this.initialize();dojo.mixin(this,_678);this.domNode=dojo.byId(_679);var nls=this._nls=dojo.mixin({},esri.bundle.widgets.popup);var _67a=this.domNode;dojo.addClass(_67a,"esriPopup");var _67b="<div class='esriPopupWrapper' style='position: absolute;'>"+"<div class='sizer'>"+"<div class='titlePane'>"+"<div class='spinner hidden' title='"+nls.NLS_searching+"...'></div>"+"<div class='title'></div>"+"<div class='titleButton prev hidden' title='"+nls.NLS_prevFeature+"'></div>"+"<div class='titleButton next hidden' title='"+nls.NLS_nextFeature+"'></div>"+"<div class='titleButton maximize' title='"+nls.NLS_maximize+"'></div>"+"<div class='titleButton close' title='"+nls.NLS_close+"'></div>"+"</div>"+"</div>"+"<div class='sizer content'>"+"<div class='contentPane'>"+"</div>"+"</div>"+"<div class='sizer'>"+"<div class='actionsPane'>"+"<div class='actionList hidden'>"+"<a class='action zoomTo' href='javascript:void(0);'>"+nls.NLS_zoomTo+"</a>"+"</div>"+"</div>"+"</div>"+"<div class='pointer hidden'></div>"+"</div>"+"<div class='outerPointer hidden'></div>";dojo.attr(_67a,"innerHTML",_67b);this._sizers=dojo.query(".sizer",_67a);var _67c=dojo.query(".titlePane",_67a)[0];dojo.setSelectable(_67c,false);this._title=dojo.query(".title",_67c)[0];this._prevFeatureButton=dojo.query(".prev",_67c)[0];this._nextFeatureButton=dojo.query(".next",_67c)[0];this._maxButton=dojo.query(".maximize",_67c)[0];this._spinner=dojo.query(".spinner",_67c)[0];this._contentPane=dojo.query(".contentPane",_67a)[0];this._positioner=dojo.query(".esriPopupWrapper",_67a)[0];this._pointer=dojo.query(".pointer",_67a)[0];this._outerPointer=dojo.query(".outerPointer",_67a)[0];this._actionList=dojo.query(".actionsPane .actionList",_67a)[0];this._eventConnections=[dojo.connect(dojo.query(".close",_67c)[0],"onclick",this,this.hide),dojo.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),dojo.connect(this._nextFeatureButton,"onclick",this,this.selectNext),dojo.connect(this._maxButton,"onclick",this,this._toggleSize),dojo.connect(dojo.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature)];if(esri.isTouchEnabled){var _67d=esri.setScrollable(this._contentPane);this._eventConnections.push(_67d[0],_67d[1]);}this._setVisibility(false);this.isShowing=false;},setMap:function(map){this.inherited(arguments);dojo.place(this.domNode,map.root);if(this.highlight){this.enableHighlight(map);}this._maxHeight=dojo.style(this._contentPane,"maxHeight");},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments);},setTitle:function(_67e){if(!esri._isDefined(_67e)||_67e===""){_67e="&nbsp;";}this.destroyDijits(this._title);this.place(_67e,this._title);if(this.isShowing){this.startupDijits(this._title);this.reposition();}},setContent:function(_67f){if(!esri._isDefined(_67f)||_67f===""){_67f="&nbsp;";}this.destroyDijits(this._contentPane);this.place(_67f,this._contentPane);if(this.isShowing){this.startupDijits(this._contentPane);this.reposition();}},show:function(_680,_681){if(!_680){this._setVisibility(true);this.isShowing=true;return;}var map=this.map,_682;if(_680.spatialReference){this._location=_680;_682=map.toScreen(_680);}else{this._location=map.toMap(_680);_682=_680;}var _683=map._getFrameWidth();if(_683!==-1){_682.x=_682.x%_683;if(_682.x<0){_682.x+=_683;}if(map.width>_683){var _684=(map.width-_683)/2;while(_682.x<_684){_682.x+=_683;}}}if(this._maximized){this.restore();}else{this._setPosition(_682);}if(_681&&_681.closestFirst){this.showClosestFirst(this._location);}if(!this.isShowing){this._setVisibility(true);this.isShowing=true;this.onShow();}},hide:function(){if(this.isShowing){this._setVisibility(false);this.isShowing=false;this.onHide();}},resize:function(_685,_686){this._sizers.style({width:_685+"px"});dojo.style(this._contentPane,"maxHeight",_686+"px");this._maxHeight=_686;if(this.isShowing){this.reposition();}},reposition:function(){if(this.map&&this._location&&!this._maximized&&this.isShowing){this._setPosition(this.map.toScreen(this._location));}},onShow:function(){this._followMap();this.startupDijits(this._title);this.startupDijits(this._contentPane);this.reposition();this.showHighlight();},onHide:function(){this._unfollowMap();this.hideHighlight();},maximize:function(){var map=this.map;if(!map||this._maximized){return;}this._maximized=true;var max=this._maxButton;dojo.removeClass(max,"maximize");dojo.addClass(max,"restore");dojo.attr(max,"title",this._nls.NLS_restore);var _687=this.marginLeft,_688=this.marginTop,_689=map.width-(2*_687),_68a=map.height-(2*_688),_68b=this.domNode;dojo.style(_68b,{left:_687+"px",right:null,top:_688+"px",bottom:null});dojo.style(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=dojo.style(this._sizers[0],"width");this._savedHeight=dojo.style(this._contentPane,"maxHeight");this._sizers.style({width:_689+"px"});dojo.style(this._contentPane,{maxHeight:(_68a-65)+"px",height:(_68a-65)+"px"});this._showPointer("");this._unfollowMap();dojo.addClass(this.domNode,"esriPopupMaximized");this.onMaximize();},restore:function(){var map=this.map;if(!map||!this._maximized){return;}this._maximized=false;var max=this._maxButton;dojo.removeClass(max,"restore");dojo.addClass(max,"maximize");dojo.attr(max,"title",this._nls.NLS_maximize);dojo.style(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this._location);this._followMap();dojo.removeClass(this.domNode,"esriPopupMaximized");this.onRestore();},destroy:function(){if(this.map){this.unsetMap();}this.cleanup();if(this.isShowing){this.hide();}this.destroyDijits(this._title);this.destroyDijits(this._content);dojo.forEach(this._eventConnections,dojo.disconnect);dojo.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null;},selectNext:function(){this.select(this.selectedIndex+1);},selectPrevious:function(){this.select(this.selectedIndex-1);},setFeatures:function(){this.inherited(arguments);this._updateUI();},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("&nbsp;");this.setContent("&nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight();},onSelectionChange:function(){var ptr=this.selectedIndex;this._updateUI();if(ptr>=0){this.setContent(this.features[ptr].getContent());this.updateHighlight(this.map,this.features[ptr]);if(this.isShowing){this.showHighlight();}}},onDfdComplete:function(){this.inherited(arguments);this._updateUI();},onMaximize:function(){},onRestore:function(){},_setVisibility:function(_68c){dojo.style(this.domNode,"visibility",_68c?"visible":"hidden");},_followMap:function(){this._unfollowMap();var map=this.map;this._handles=[dojo.connect(map,"onPanStart",this,this._onPanStart),dojo.connect(map,"onPan",this,this._onPan),dojo.connect(map,"onZoomStart",this,this._onZoomStart),dojo.connect(map,"onExtentChange",this,this._onExtentChange)];},_unfollowMap:function(){var _68d=this._handles;if(_68d){dojo.forEach(_68d,dojo.disconnect,dojo);this._handles=null;}},_onPanStart:function(){var _68e=this.domNode.style;this._panOrigin={left:_68e.left,top:_68e.top,right:_68e.right,bottom:_68e.bottom};},_onPan:function(_68f,_690){var _691=this._panOrigin,dx=_690.x,dy=_690.y,left=_691.left,top=_691.top,_692=_691.right,_693=_691.bottom;if(left){left=(parseFloat(left)+dx)+"px";}if(top){top=(parseFloat(top)+dy)+"px";}if(_692){_692=(parseFloat(_692)-dx)+"px";}if(_693){_693=(parseFloat(_693)-dy)+"px";}dojo.style(this.domNode,{left:left,top:top,right:_692,bottom:_693});},_onZoomStart:function(){this._setVisibility(false);},_onExtentChange:function(_694,_695,_696){if(_696){this._setVisibility(true);this.show(this._targetLocation||this._location);}this._targetLocation=null;},_toggleSize:function(){if(this._maximized){this.restore();}else{this.maximize();}},_setPosition:function(_697){var posX=_697.x,posY=_697.y,offX=this.offsetX||0,offY=this.offsetY||0,_698=0,_699=0,_69a=dojo.position(this.map.container,true),_69b=_69a.w,_69c=_69a.h,_69d="Left",_69e="bottom",_69f=dojo.contentBox(this._positioner),_6a0=_69f.w/2,_6a1=_69f.h/2,maxH=dojo.style(this._sizers[0],"height")+this._maxHeight+dojo.style(this._sizers[2],"height"),_6a2=maxH/2,xmin=0,ymin=0,xmax=_69b,ymax=_69c,_6a3=posX,_6a4=posY;var _6a5=dojo.getObject("dojo.window.getBox");if(_6a5){_6a5=_6a5();xmin=Math.max(_6a5.l,_69a.x);xmax=Math.min(_6a5.l+_6a5.w,_69a.x+_69a.w);ymin=Math.max(_6a5.t,_69a.y);ymax=Math.min(_6a5.t+_6a5.h,_69a.y+_69a.h);_6a3+=_69a.x;_6a4+=_69a.y;}var _6a6=((_6a4-ymin)>_6a2),_6a7=((ymax-_6a4)>=_6a2),_6a8=((xmax-_6a3)>=_6a0),_6a9=((_6a3-xmin)>_6a0),_6aa=((_6a4-ymin)>=maxH),_6ab=((ymax-_6a4)>=maxH),_6ac=((xmax-_6a3)>=_69f.w),_6ad=((_6a3-xmin)>=_69f.w);if(_6a6&&_6a7){if(_6ac){_69e="";_69d="Left";}else{if(_6ad){_69e="";_69d="Right";}}}if(_69d&&_69e){if(_6a9&&_6a8){if(_6aa){_69d="";_69e="bottom";}else{if(_6ab){_69d="";_69e="top";}}}}if(_69d&&_69e){if(_6ac&&_6aa){_69d="Left";_69e="bottom";}else{if(_6ac&&_6ab){_69d="Left";_69e="top";}else{if(_6ad&&_6ab){_69d="Right";_69e="top";}else{if(_6ad&&_6aa){_69d="Right";_69e="bottom";}else{}}}}}var _6ae=_69e+_69d;switch(_6ae){case "top":case "bottom":_699=14;break;case "Left":case "Right":_698=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":_699=45;break;}dojo.style(this.domNode,{left:posX+"px",top:posY+"px",right:null,bottom:null});var _6af={left:null,right:null,top:null,bottom:null};if(_69d){_6af[_69d.toLowerCase()]=(_698+offX)+"px";}else{_6af.left=(-_6a0)+"px";}if(_69e){_6af[_69e]=(_699+offY)+"px";}else{_6af.top=(-_6a1)+"px";}dojo.style(this._positioner,_6af);this._showPointer(_6ae);},_showPointer:function(_6b0){dojo.removeClass(this._pointer,["top","bottom","right","left","topLeft","topRight","bottomRight","bottomLeft","hidden"]);dojo.removeClass(this._outerPointer,["right","left","hidden"]);if(_6b0==="Right"||_6b0==="Left"){_6b0=_6b0.toLowerCase();dojo.addClass(this._outerPointer,_6b0);}else{dojo.addClass(this._pointer,_6b0);}},_setPagerCallbacks:function(_6b1,_6b2,_6b3){if(_6b1===this&&(!this._pagerScope||this._pagerScope===this)){return;}if(_6b1===this._pagerScope){return;}this._pagerScope=_6b1;if(_6b1===this){_6b2=this.selectPrevious;_6b3=this.selectNext;}var _6b4=this._eventConnections;dojo.disconnect(_6b4[1]);dojo.disconnect(_6b4[2]);if(_6b2){_6b4[1]=dojo.connect(this._prevFeatureButton,"onclick",_6b1,_6b2);}if(_6b3){_6b4[2]=dojo.connect(this._nextFeatureButton,"onclick",_6b1,_6b3);}},_zoomToFeature:function(){var _6b5=this.features,ptr=this.selectedIndex,map=this.map;if(_6b5){var _6b6=_6b5[ptr].geometry,_6b7,_6b8,_6b9=0,_6ba;if(_6b6){switch(_6b6.type){case "point":_6b7=_6b6;break;case "multipoint":_6b7=_6b6.getPoint(0);_6b8=_6b6.getExtent();break;case "polyline":_6b7=_6b6.getPoint(0,0);_6b8=_6b6.getExtent();if(map._getFrameWidth()!==-1){dojo.forEach(_6b6.paths,function(path){var _6bb={"paths":[path,map.spatialReference]},_6bc=new esri.geometry.Polyline(_6bb),_6bd=_6bc.getExtent(),_6be=Math.abs(_6bd.ymax-_6bd.ymin),_6bf=Math.abs(_6bd.xmax-_6bd.xmin),_6c0=(_6bf>_6be)?_6bf:_6be;if(_6c0>_6b9){_6b9=_6c0;_6ba=_6bd;}});_6ba.spatialReference=_6b8.spatialReference;_6b8=_6ba;}break;case "polygon":_6b7=_6b6.getPoint(0,0);_6b8=_6b6.getExtent();if(map._getFrameWidth()!==-1){dojo.forEach(_6b6.rings,function(ring){var _6c1={"rings":[ring,map.spatialReference]},_6c2=new esri.geometry.Polygon(_6c1),_6c3=_6c2.getExtent(),_6c4=Math.abs(_6c3.ymax-_6c3.ymin),_6c5=Math.abs(_6c3.xmax-_6c3.xmin),_6c6=(_6c5>_6c4)?_6c5:_6c4;if(_6c6>_6b9){_6b9=_6c6;_6ba=_6c3;}});_6ba.spatialReference=_6b8.spatialReference;_6b8=_6ba;}break;}}if(!_6b7){_6b7=this._location;}if(!_6b8||!_6b8.intersects(this._location)){this._location=_6b7;}if(_6b8){map.setExtent(_6b8,true);}else{var _6c7=map.getNumLevels(),_6c8=map.getLevel(),last=map.getMaxZoom(),_6c9=this.zoomFactor||1;if(_6c7>0){if(_6c8===last){return;}var _6ca=_6c8+_6c9;if(_6ca>last){_6ca=last;}map.navigationManager._wheelZoom({value:(_6ca-_6c8),mapPoint:_6b7},true);}else{map.navigationManager._wheelZoom({value:(1/Math.pow(2,_6c9))*2,mapPoint:_6b7},true);}}}},_updateUI:function(){var _6cb="&nbsp;",ptr=this.selectedIndex,_6cc=this.features,_6cd=this.deferreds,prev=this._prevFeatureButton,next=this._nextFeatureButton,_6ce=this._spinner,_6cf=this._actionList,nls=this._nls;if(_6cc&&_6cc.length>1){if(nls.NLS_pagingInfo){_6cb=esri.substitute({index:(ptr+1),total:_6cc.length},nls.NLS_pagingInfo);}if(ptr===0){dojo.addClass(prev,"hidden");}else{dojo.removeClass(prev,"hidden");}if(ptr===_6cc.length-1){dojo.addClass(next,"hidden");}else{dojo.removeClass(next,"hidden");}}else{dojo.addClass(prev,"hidden");dojo.addClass(next,"hidden");}this.setTitle(_6cb);if(_6cd&&_6cd.length){if(_6cc){dojo.removeClass(_6ce,"hidden");}else{this.setContent("<div style='text-align: center;'>"+nls.NLS_searching+"...</div>");}}else{dojo.addClass(_6ce,"hidden");if(!_6cc||!_6cc.length){this.setContent("<div style='text-align: center;'>"+nls.NLS_noInfo+".</div>");}}if(_6cc&&_6cc.length){dojo.removeClass(_6cf,"hidden");}else{dojo.addClass(_6cf,"hidden");}}});dojo.declare("esri.dijit.PopupTemplate",[esri.PopupInfoTemplate],{chartTheme:"dojox.charting.themes.PlotKit.popup",constructor:function(json,_6d0){dojo.mixin(this,_6d0);this.initialize(json);this._nls=dojo.mixin({},esri.bundle.widgets.popup);},getTitle:function(_6d1){return this.info?this.getComponents(_6d1).title:"";},getContent:function(_6d2){return this.info?new esri.dijit._PopupRenderer({template:this,graphic:_6d2,chartTheme:this.chartTheme,_nls:this._nls},dojo.create("div")).domNode:"";}});dojo.declare("esri.dijit._PopupRenderer",[_676._Widget,_676._Templated],{templateString:"<div class='esriViewPopup'>"+"<div class='mainSection'>"+"<div class='header' dojoAttachPoint='_title'></div>"+"<div class='hzLine'></div>"+"<div dojoAttachPoint='_description'></div>"+"<div class='break'></div>"+"</div>"+"<div class='attachmentsSection hidden'>"+"<div>${_nls.NLS_attach}:</div>"+"<ul dojoAttachPoint='_attachmentsList'>"+"</ul>"+"<div class='break'></div>"+"</div>"+"<div class='mediaSection hidden'>"+"<div class='header' dojoAttachPoint='_mediaTitle'></div>"+"<div class='hzLine'></div>"+"<div class='caption' dojoAttachPoint='_mediaCaption'></div>"+"<div class='gallery' dojoAttachPoint='_gallery'>"+"<div class='mediaHandle prev' dojoAttachPoint='_prevMedia' dojoAttachEvent='onclick: _goToPrevMedia'></div>"+"<div class='mediaHandle next' dojoAttachPoint='_nextMedia' dojoAttachEvent='onclick: _goToNextMedia'></div>"+"<ul class='summary'>"+"<li class='image mediaCount hidden' dojoAttachPoint='_imageCount'>0</li>"+"<li class='image mediaIcon hidden'></li>"+"<li class='chart mediaCount hidden' dojoAttachPoint='_chartCount'>0</li>"+"<li class='chart mediaIcon hidden'></li>"+"</ul>"+"<div class='frame' dojoAttachPoint='_mediaFrame'></div>"+"</div>"+"</div>"+"<div class='editSummarySection hidden' dojoAttachPoint='_editSummarySection'>"+"<div class='break'></div>"+"<div class='break hidden' dojoAttachPoint='_mediaBreak'></div>"+"<div class='editSummary' dojoAttachPoint='_editSummary'></div>"+"</div>"+"</div>",startup:function(){this.inherited(arguments);var _6d3=this.template,_6d4=this.graphic,_6d5=_6d3.getComponents(_6d4),_6d6=_6d5.title,_6d7=_6d5.description,_6d8=_6d5.fields,_6d9=_6d5.mediaInfos,_6da=this.domNode,nls=this._nls;this._prevMedia.title=nls.NLS_prevMedia;this._nextMedia.title=nls.NLS_nextMedia;dojo.attr(this._title,"innerHTML",_6d6);if(!_6d6){dojo.addClass(this._title,"hidden");}if(!_6d7&&_6d8){_6d7="";dojo.forEach(_6d8,function(row){_6d7+=("<tr valign='top'>");_6d7+=("<td class='attrName'>"+row[0]+"</td>");_6d7+=("<td class='attrValue'>"+row[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"<a target='_blank' href='$1' title='$1'>"+nls.NLS_moreInfo+"</a>")+"</td>");_6d7+=("</tr>");});if(_6d7){_6d7="<table class='attrTable' cellpadding='0px' cellspacing='0px'>"+_6d7+"</table>";}}dojo.attr(this._description,"innerHTML",_6d7);if(!_6d7){dojo.addClass(this._description,"hidden");}dojo.query("a",this._description).forEach(function(node){dojo.attr(node,"target","_blank");});if(_6d6&&_6d7){dojo.query(".mainSection .hzLine",_6da).removeClass("hidden");}else{if(_6d6||_6d7){dojo.query(".mainSection .hzLine",_6da).addClass("hidden");}else{dojo.query(".mainSection",_6da).addClass("hidden");}}var dfd=(this._dfd=_6d3.getAttachments(_6d4));if(dfd){dfd.addBoth(dojo.hitch(this,this._attListHandler,dfd));dojo.attr(this._attachmentsList,"innerHTML","<li>"+nls.NLS_searching+"...</li>");dojo.query(".attachmentsSection",_6da).removeClass("hidden");}if(_6d9&&_6d9.length){dojo.query(".mediaSection",_6da).removeClass("hidden");dojo.setSelectable(this._mediaFrame,false);this._mediaInfos=_6d9;this._mediaPtr=0;this._updateUI();this._displayMedia();}if(_6d5.editSummary){dojo.attr(this._editSummary,"innerHTML",_6d5.editSummary);if(_6d9&&_6d9.length){dojo.removeClass(this._mediaBreak,"hidden");}dojo.removeClass(this._editSummarySection,"hidden");}},destroy:function(){if(this._dfd){this._dfd.cancel();}this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments);},_goToPrevMedia:function(){var ptr=this._mediaPtr-1;if(ptr<0){return;}this._mediaPtr--;this._updateUI();this._displayMedia();},_goToNextMedia:function(){var ptr=this._mediaPtr+1;if(ptr===this._mediaInfos.length){return;}this._mediaPtr++;this._updateUI();this._displayMedia();},_updateUI:function(){var _6db=this._mediaInfos,_6dc=_6db.length,_6dd=this.domNode,_6de=this._prevMedia,_6df=this._nextMedia;if(_6dc>1){var _6e0=0,_6e1=0;dojo.forEach(_6db,function(info){if(info.type==="image"){_6e0++;}else{if(info.type.indexOf("chart")!==-1){_6e1++;}}});if(_6e0){dojo.attr(this._imageCount,"innerHTML",_6e0);dojo.query(".summary .image",_6dd).removeClass("hidden");}if(_6e1){dojo.attr(this._chartCount,"innerHTML",_6e1);dojo.query(".summary .chart",_6dd).removeClass("hidden");}}else{dojo.query(".summary",_6dd).addClass("hidden");dojo.addClass(_6de,"hidden");dojo.addClass(_6df,"hidden");}var ptr=this._mediaPtr;if(ptr===0){dojo.addClass(_6de,"hidden");}else{dojo.removeClass(_6de,"hidden");}if(ptr===_6dc-1){dojo.addClass(_6df,"hidden");}else{dojo.removeClass(_6df,"hidden");}this._destroyFrame();},_displayMedia:function(){var info=this._mediaInfos[this._mediaPtr],_6e2=info.title,_6e3=info.caption,_6e4=dojo.query(".mediaSection .hzLine",this.domNode)[0];dojo.attr(this._mediaTitle,"innerHTML",_6e2);dojo[_6e2?"removeClass":"addClass"](this._mediaTitle,"hidden");dojo.attr(this._mediaCaption,"innerHTML",_6e3);dojo[_6e3?"removeClass":"addClass"](this._mediaCaption,"hidden");dojo[(_6e2&&_6e3)?"removeClass":"addClass"](_6e4,"hidden");if(info.type==="image"){this._showImage(info.value);}else{this._showChart(info.type,info.value);}},_showImage:function(_6e5){dojo.addClass(this._mediaFrame,"image");var _6e6=dojo.style(this._gallery,"height"),html="<img src='"+_6e5.sourceURL+"' onload='esri.dijit._PopupRenderer.prototype._imageLoaded(this,"+_6e6+");' />";if(_6e5.linkURL){html="<a target='_blank' href='"+_6e5.linkURL+"'>"+html+"</a>";}dojo.attr(this._mediaFrame,"innerHTML",html);},_showChart:function(type,_6e7){dojo.removeClass(this._mediaFrame,"image");var _6e8=this._chart=new _677.charting.Chart2D(dojo.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});var _6e9=_6e7.theme||this.chartTheme||"PlotKit.popup";_6e8.setTheme(dojo.getObject(_6e9)||dojo.getObject("dojox.charting.themes."+_6e9));switch(type){case "piechart":_6e8.addPlot("default",{type:"Pie",labels:false});_6e8.addSeries("Series A",_6e7.fields);break;case "linechart":_6e8.addPlot("default",{type:"Markers"});_6e8.addAxis("x",{min:0,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_6e8.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});dojo.forEach(_6e7.fields,function(info,idx){info.x=idx+1;});_6e8.addSeries("Series A",_6e7.fields);break;case "columnchart":_6e8.addPlot("default",{type:"Columns",gap:3});_6e8.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});_6e8.addSeries("Series A",_6e7.fields);break;case "barchart":_6e8.addPlot("default",{type:"Bars",gap:3});_6e8.addAxis("x",{includeZero:true,fixUpper:"minor",minorLabels:false});_6e8.addAxis("y",{vertical:true,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_6e8.addSeries("Series A",_6e7.fields);break;}this._action=new _677.charting.action2d.Tooltip(_6e8);_6e8.render();},_destroyFrame:function(){if(this._chart){this._chart.destroy();this._chart=null;}if(this._action){this._action.destroy();this._action=null;}dojo.attr(this._mediaFrame,"innerHTML","");},_imageLoaded:function(img,_6ea){var _6eb=img.height;if(_6eb<_6ea){var diff=Math.round((_6ea-_6eb)/2);dojo.style(img,"marginTop",diff+"px");}},_attListHandler:function(dfd,_6ec){if(dfd===this._dfd){this._dfd=null;var html="";if(!(_6ec instanceof Error)&&_6ec&&_6ec.length){dojo.forEach(_6ec,function(info){html+=("<li>");html+=("<a href='"+info.url+"' target='_blank'>"+(info.name||"[No name]")+"</a>");html+=("</li>");});}dojo.attr(this._attachmentsList,"innerHTML",html||"<li>"+this._nls.NLS_noAttach+"</li>");}}});});},"dojox/charting/scaler/common":function(){define("dojox/charting/scaler/common",["dojo/_base/lang"],function(lang){var eq=function(a,b){return Math.abs(a-b)<=0.000001*(Math.abs(a)+Math.abs(b));};var _6ed=lang.getObject("dojox.charting.scaler.common",true);var _6ee={};return lang.mixin(_6ed,{doIfLoaded:function(_6ef,_6f0,_6f1){if(_6ee[_6ef]==undefined){try{_6ee[_6ef]=require(_6ef);}catch(e){_6ee[_6ef]=null;}}if(_6ee[_6ef]){return _6f0(_6ee[_6ef]);}else{return _6f1();}},getNumericLabel:function(_6f2,_6f3,_6f4){var def="";_6ed.doIfLoaded("dojo/number",function(_6f5){def=(_6f4.fixed?_6f5.format(_6f2,{places:_6f3<0?-_6f3:0}):_6f5.format(_6f2))||"";},function(){def=_6f4.fixed?_6f2.toFixed(_6f3<0?-_6f3:0):_6f2.toString();});if(_6f4.labelFunc){var r=_6f4.labelFunc(def,_6f2,_6f3);if(r){return r;}}if(_6f4.labels){var l=_6f4.labels,lo=0,hi=l.length;while(lo<hi){var mid=Math.floor((lo+hi)/2),val=l[mid].value;if(val<_6f2){lo=mid+1;}else{hi=mid;}}if(lo<l.length&&eq(l[lo].value,_6f2)){return l[lo].text;}--lo;if(lo>=0&&lo<l.length&&eq(l[lo].value,_6f2)){return l[lo].text;}lo+=2;if(lo<l.length&&eq(l[lo].value,_6f2)){return l[lo].text;}}return def;}});});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dijit","dojo","dojox","dojo/require!esri/layers/graphics,esri/tasks/query,dojo/io/iframe,esri/layers/agscommon,dojo/date/locale"],function(_6f6,dojo,_6f7){dojo.provide("esri.layers.FeatureLayer");dojo.require("esri.layers.graphics");dojo.require("esri.tasks.query");dojo.require("dojo.io.iframe");dojo.require("esri.layers.agscommon");dojo.require("dojo.date.locale");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_6f8){this._outFields=_6f8&&_6f8.outFields;this._loadCallback=_6f8&&_6f8.loadCallback;var _6f9=_6f8&&_6f8._usePatch;this._usePatch=(_6f9===null||_6f9===undefined)?true:_6f9;this._trackIdField=_6f8&&_6f8.trackIdField;this.objectIdField=_6f8&&_6f8.objectIdField;this._maxOffset=_6f8&&_6f8.maxAllowableOffset;this._optEditable=_6f8&&_6f8.editable;this._optAutoGen=_6f8&&_6f8.autoGeneralize;this.editSummaryCallback=_6f8&&_6f8.editSummaryCallback;this.userId=_6f8&&_6f8.userId;this.userIsAdmin=_6f8&&_6f8.userIsAdmin;this.useMapTime=(_6f8&&_6f8.hasOwnProperty("useMapTime"))?(!!_6f8.useMapTime):true;this.source=_6f8&&_6f8.source;this.gdbVersion=_6f8&&_6f8.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(esri._isDefined(_6f8&&_6f8.mode)?_6f8.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_6f8&&_6f8.tileWidth)||512;this._tileHeight=(_6f8&&_6f8.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);var _6fa=_6f8&&_6f8.latticeTiling;this.latticeTiling=_6fa;break;case ctor.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);this._editable=false;if(dojo.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new esri.tasks.QueryTask(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _6fb=this._url.path;this._fserver=false;if(_6fb.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _6fc=_6f8&&_6f8.resourceInfo;if(_6fc){this._initLayer(_6fc);}else{if(this.source){var _6fd={source:this.source.toJson()};this._url.query=dojo.mixin(this._url.query,{layer:dojo.toJson(_6fd)});}if(this.gdbVersion){this._url.query=dojo.mixin(this._url.query,{gdbVersion:this.gdbVersion});}esri.request({url:_6fb,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_6fe,io){if(_6fe||io){this._json=_6fe;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_6fe&&_6fe._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_6fe.featureSet;this._nextId=_6fe.nextObjectId;_6fe=_6fe.layerDefinition;}if(_6fe.hasOwnProperty("capabilities")){var _6ff=(this.capabilities=_6fe.capabilities);if(_6ff&&_6ff.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_6fe.geometryType==="esriGeometryPolyline")||(_6fe.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=esri._isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _700=_6fe.effectiveMinScale||_6fe.minScale,_701=_6fe.effectiveMaxScale||_6fe.maxScale;if(!this._hasMin&&_700){this.setMinScale(_700);}if(!this._hasMax&&_701){this.setMaxScale(_701);}this.layerId=_6fe.id;this.name=_6fe.name;this.description=_6fe.description;this.copyright=_6fe.copyrightText;this.type=_6fe.type;this.geometryType=_6fe.geometryType;this.displayField=_6fe.displayField;this.defaultDefinitionExpression=_6fe.definitionExpression;this.fullExtent=new esri.geometry.Extent(_6fe.extent);this.initialExtent=new esri.geometry.Extent(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new esri.SpatialReference(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_6fe.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_6fe.indexedFields;this.maxRecordCount=_6fe.maxRecordCount;this.canModifyLayer=_6fe.canModifyLayer;this.supportsStatistics=_6fe.supportsStatistics;this.supportsAdvancedQueries=_6fe.supportsAdvancedQueries;this.hasLabels=_6fe.hasLabels;this.canScaleSymbols=_6fe.canScaleSymbols;this.supportsRollbackOnFailure=_6fe.supportsRollbackOnFailure;this.syncCanReturnChanges=_6fe.syncCanReturnChanges;this.isDataVersioned=_6fe.isDataVersioned;this.editFieldsInfo=_6fe.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_6fe.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_6fe.relationships;this.allowGeometryUpdates=esri._isDefined(_6fe.allowGeometryUpdates)?_6fe.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _702=(this.fields=[]),_703=_6fe.fields,i;for(i=0;i<_703.length;i++){_702.push(new esri.layers.Field(_703[i]));}if(!this.objectIdField){this.objectIdField=_6fe.objectIdField;if(!this.objectIdField){_703=_6fe.fields;for(i=0;i<_703.length;i++){var _704=_703[i];if(_704.type==="esriFieldTypeOID"){this.objectIdField=_704.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _705=this.objectIdField,_706=-1;if(this._collection&&_705){var fset=this._featureSet,_707=fset&&fset.features,il=_707?_707.length:0,oid,attr;for(i=0;i<il;i++){attr=_707[i].attributes;oid=attr&&attr[_705];if(oid>_706){_706=oid;}}}this._nextId=(_706+1);}this.globalIdField=_6fe.globalIdField;var _708=(this.typeIdField=_6fe.typeIdField),_709;if(_708){_709=!this._getField(_708)&&this._getField(_708,true);if(_709){this.typeIdField=_709.name;}}this.visibilityField=_6fe.visibilityField;var _70a=_6fe.defaultSymbol;if(_70a){this.defaultSymbol=esri.symbol.fromJson(_70a);}var _70b=this.types=[],_70c=_6fe.types,_70d,_70e,_70f,_710=this.editFieldsInfo,_711=_710&&_710.creatorField,_712=_710&&_710.editorField,fix=(_711||_712),_713=[];if(_70c){for(i=0;i<_70c.length;i++){_70d=new esri.layers.FeatureType(_70c[i]);_70e=_70d.templates;if(fix&&_70e&&_70e.length){_713=_713.concat(_70e);}_70b.push(_70d);}}var _714=_6fe.templates,_715,_716=this.templates=[];if(_714){for(i=0;i<_714.length;i++){_715=new esri.layers.FeatureTemplate(_714[i]);if(fix){_713.push(_715);}_716.push(_715);}}for(i=0;i<_713.length;i++){_70f=dojo.getObject("prototype.attributes",false,_713[i]);if(_70f){if(_711){delete _70f[_711];}if(_712){delete _70f[_712];}}}var _717=_6fe.timeInfo;if(_717){this.timeInfo=new esri.layers.TimeInfo(_717);this._startTimeField=_717.startTimeField;this._endTimeField=_717.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_717.trackIdField=this._trackIdField;}else{this._trackIdField=_717.trackIdField;}}this.hasAttachments=(!this._collection&&_6fe.hasAttachments)?true:false;this.htmlPopupType=_6fe.htmlPopupType;var _718=_6fe.drawingInfo,_719;if(!this.renderer){if(_718&&_718.renderer){_719=_718.renderer;this.setRenderer(esri.renderer.fromJson(_719));if(_719.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _71a=_719.type,_71b=[];_719=this.renderer;switch(_71a){case "simple":_71b.push(_719.symbol);break;case "uniqueValue":case "classBreaks":_71b.push(_719.defaultSymbol);_71b=_71b.concat(dojo.map(_719.infos,function(info){return info.symbol;}));break;}_71b=dojo.filter(_71b,esri._isDefined);var _71c=this._url.path+"/images/",_71d=this._getToken();dojo.forEach(_71b,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_71c+url;}if(_71d&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_71d);}}});}}else{if(_70a){_70c=this.types;if(_70c.length>0){_719=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_70c,function(type){_719.addValue(type.id,type.symbol);});}else{_719=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_719);}else{if(!this._isTable){var _71e;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_71e=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_71e=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_71e=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_71e?new esri.renderer.SimpleRenderer(_71e):null);}}}}var _71f=(_718&&_718.transparency)||0;if(!esri._isDefined(this.opacity)&&_71f>0){this.opacity=1-(_71f/100);}this.version=_6fe.currentVersion;if(!this.version){var ver;if("capabilities" in _6fe||"drawingInfo" in _6fe||"hasAttachments" in _6fe||"htmlPopupType" in _6fe||"relationships" in _6fe||"timeInfo" in _6fe||"typeIdField" in _6fe||"types" in _6fe){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _720=function(){this.onLoad(this);var _721=this._loadCallback;if(_721){delete this._loadCallback;_721(this);}};if(this._collection){this._fireUpdateStart();var _722=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_722));this._fcAdded=true;_720.call(this);}else{this._forceIdentity(_720);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _723=this.renderer;if(_723){this._ager=(_723.declaredClass.indexOf("TemporalRenderer")!==-1&&_723.observationAger&&_723.observationRenderer);var _724=dojo.filter([_723,_723.observationRenderer,_723.latestObservationRenderer,_723.trackRenderer],esri._isDefined);var _725=[];dojo.forEach(_724,function(rnd){if(!dojo.isFunction(rnd.attributeField)){_725.push(rnd.attributeField);}_725.push(rnd.attributeField2);_725.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_725,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_unsetMap:function(map,_726){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_727){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_727;return this;}var _728=this._editable;this._editable=_727;this._updateCaps();if(_728!==_727){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_729){var _72a={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _72a;}var _72b=_729&&_729.feature,_72c=_729&&_729.userId,caps=dojo.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),dojo.trim),_72d=dojo.indexOf(caps,"editing")>-1,_72e=_72d&&(dojo.indexOf(caps,"create")>-1),_72f=_72d&&(dojo.indexOf(caps,"update")>-1),_730=_72d&&(dojo.indexOf(caps,"delete")>-1),_731=this.ownershipBasedAccessControlForFeatures,_732=this.editFieldsInfo,_733=_732&&_732.creatorField,_734=_732&&_732.realm,_735=_72b&&_72b.attributes,_736=(_735&&_733)?_735[_733]:undefined,_737,_738=!!this.userIsAdmin,_739=!_731||_738||!!(_731.allowOthersToUpdate||_731.allowUpdateToOthers),_73a=!_731||_738||!!(_731.allowOthersToDelete||_731.allowDeleteToOthers);if(_738||(_72d&&!(_72e||_72f||_730))){_72e=_72f=_730=true;}_737={"canCreate":_72e,"canUpdate":_72f,"canDelete":_730};if(_736===null){_737.canUpdate=_72f&&_739;_737.canDelete=_730&&_73a;}else{if(_736===""){return _737;}else{if(_736){_72c=_72c||this.getUserId();if(_72c&&_734){_72c=_72c+"@"+_734;}if(_72c.toLowerCase()===_736.toLowerCase()){return _737;}else{_737.canUpdate=_72f&&_739;_737.canDelete=_730&&_73a;}}}}return _737;},getUserId:function(){var _73b;if(this.loaded){_73b=(this.credential&&this.credential.userId)||this.userId||"";}return _73b;},setUserIsAdmin:function(_73c){this.userIsAdmin=_73c;},setEditSummaryCallback:function(_73d){this.editSummaryCallback=_73d;},getEditSummary:function(_73e,_73f,_740){_740=esri._isDefined(_740)?_740:(new Date()).getTime();var _741="",info=this.getEditInfo(_73e,_73f,_740),_742=(_73f&&_73f.callback)||this.editSummaryCallback;if(_742){info=_742(_73e,info)||"";}if(dojo.isString(info)){_741=info;}else{if(info){var _743=info.action,_744=info.userId,_745=info.timeValue,_746=0;if(_743){_746++;}if(_744){_746++;}if(esri._isDefined(_745)){_746++;}if(_746>1){_741=(_743==="edit"?"edit":"create")+(_744?"User":"")+(esri._isDefined(_745)?info.displayPattern:"");}}_741=_741&&esri.substitute(info,esri.bundle.layers.FeatureLayer[_741]);}return _741;},getEditInfo:function(_747,_748,_749){if(!this.loaded){return;}_749=esri._isDefined(_749)?_749:(new Date()).getTime();var _74a=(_748&&_748.action)||"last",_74b=this.editFieldsInfo,_74c=_74b&&_74b.creatorField,_74d=_74b&&_74b.creationDateField,_74e=_74b&&_74b.editorField,_74f=_74b&&_74b.editDateField,_750=_74b&&_74b.realm,_751=_747&&_747.attributes,_752=(_751&&_74c)?_751[_74c]:undefined,_753=(_751&&_74d)?_751[_74d]:null,_754=(_751&&_74e)?_751[_74e]:undefined,_755=(_751&&_74f)?_751[_74f]:null,_756=this._getEditData(_752,_753,_749),_757=this._getEditData(_754,_755,_749),_758;switch(_74a){case "creation":_758=_756;break;case "edit":_758=_757;break;case "last":_758=_757||_756;break;}if(_758){_758.action=(_758===_757)?"edit":"creation";}return _758;},_getEditData:function(_759,_75a,_75b){var data,_75c,_75d,_75e=60000,_75f=3600000,_760=2*_75f,_761=24*_75f,_762=7*_761;if(esri._isDefined(_75a)){_75c=_75b-_75a;if(_75c<0){_75d="Full";}else{if(_75c<_75e){_75d="Seconds";}else{if(_75c<(2*_75e)){_75d="Minute";}else{if(_75c<_75f){_75d="Minutes";}else{if(_75c<_760){_75d="Hour";}else{if(_75c<_761){_75d="Hours";}else{if(_75c<_762){_75d="WeekDay";}else{_75d="Full";}}}}}}}}if((_759!==undefined)||_75d){data=data||{};data.userId=_759;if(_75d){var _763=dojo.date.locale.format,_764=new Date(_75a);data.minutes=Math.floor(_75c/_75e);data.hours=Math.floor(_75c/_75f);data.weekDay=_763(_764,{datePattern:"EEEE",selector:"date"});data.formattedDate=_763(_764,{selector:"date"});data.formattedTime=_763(_764,{selector:"time"});data.displayPattern=_75d;data.timeValue=_75a;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_765){if(!this.isEditable()){this._maxOffset=_765;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_766){if(!this.loaded){this._optAutoGen=_766;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_766;if(_766){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_767){if(!this._collection&&(_767!==this.gdbVersion)&&(_767||this.gdbVersion)){this.gdbVersion=_767;this._task.gdbVersion=_767;this._url.query=dojo.mixin(this._url.query,{gdbVersion:_767});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_768){if(this._isSnapshot){this._timeDefn=_768;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_769,_76a){this._timeOffset=_769;this._timeOffsetUnits=_76a;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_76b,_76c,_76d,_76e){_76c=_76c||this.constructor.SELECTION_NEW;var _76f=this._getShallowClone(_76b),map=this._map,_770,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_76f.outFields=this._getOutFields();_76f.returnGeometry=true;if(map){_76f.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_76f)){_770={features:[]};this._selectHandler(_770,_76c,_76d,_76e,dfd);return dfd;}var _771=this._canDoClientSideQuery(_76f);if(_771){_770={features:this._doQuery(_76f,_771)};this._selectHandler(_770,_76c,_76d,_76e,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_76e,dfd,true);return dfd;}var self=this;if(this._ts){_76f._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_76f);temp.addCallbacks(function(_772){self._selectHandler(_772,_76c,_76d,_76e,dfd);},function(err){self._resolve([err],null,_76e,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _773=this._selectedFeatures,_774=[],item;for(item in _773){if(_773.hasOwnProperty(item)){_774.push(_773[item]);}}return _774;},clearSelection:function(_775){var _776=this._selectedFeatures,mode=this._mode,item;for(item in _776){if(_776.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_775){this.onSelectionClear();}return this;},setSelectionSymbol:function(_777){this._selectionSymbol=_777;if(_777){var _778=this._selectedFeatures,item;for(item in _778){if(_778.hasOwnProperty(item)){_778[item].setSymbol(_777);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_779,_77a,_77b,_77c,_77d){var _77e=_77d.assembly,dfd=_77d.dfd;this._applyNormalized(adds,_77e&&_77e[0]);this._applyNormalized(_779,_77e&&_77e[1]);this.onBeforeApplyEdits(adds,_779,_77a);var i,_77f={},_780=this.objectIdField,_781={f:"json"},_782=false;if(this._collection){var _783={};_783.addResults=adds?dojo.map(adds,function(){_782=true;return {objectId:this._nextId++,success:true};},this):null;_783.updateResults=_779?dojo.map(_779,function(_784){_782=true;var oid=_784.attributes[_780];_77f[oid]=_784;return {objectId:oid,success:true};},this):null;_783.deleteResults=_77a?dojo.map(_77a,function(_785){_782=true;return {objectId:_785.attributes[_780],success:true};},this):null;if(_782){this._editHandler(_783,adds,_77f,_77b,_77c,dfd);}return;}if(adds&&adds.length>0){_781.adds=this._convertFeaturesToJson(adds,0,1);_782=true;}if(_779&&_779.length>0){for(i=0;i<_779.length;i++){var _786=_779[i];_77f[_786.attributes[_780]]=_786;}_781.updates=this._convertFeaturesToJson(_779,0,0,1);_782=true;}if(_77a&&_77a.length>0){var ids=[];for(i=0;i<_77a.length;i++){ids.push(_77a[i].attributes[_780]);}_781.deletes=ids.join(",");_782=true;}if(_782){var self=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_781,this._url.query),callbackParamName:"callback",load:function(_787){self._editHandler(_787,adds,_77f,_77b,_77c,dfd);},error:function(err){self._resolve([err],null,_77c,dfd,true);}},{usePost:true});}},queryFeatures:function(_788,_789,_78a){return this._query("execute","onQueryFeaturesComplete",_788,_789,_78a);},queryRelatedFeatures:function(_78b,_78c,_78d){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_78b,_78c,_78d);},queryIds:function(_78e,_78f,_790){return this._query("executeForIds","onQueryIdsComplete",_78e,_78f,_790);},queryCount:function(_791,_792,_793){return this._query("executeForCount","onQueryCountComplete",_791,_792,_793);},queryAttachmentInfos:function(_794,_795,_796){var url=this._url.path+"/"+_794+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_797){var _798=_797.attachmentInfos,_799;dojo.forEach(_798,function(info){_799=dojo.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_799?("?"+_799):"");info.objectId=_794;});self._resolve([_798],"onQueryAttachmentInfosComplete",_795,dfd);},error:function(err){self._resolve([err],null,_796,dfd,true);}});return dfd;},addAttachment:function(_79a,_79b,_79c,_79d){return this._sendAttachment("add",_79a,_79b,_79c,_79d);},updateAttachment:function(_79e,_79f,_7a0,_7a1,_7a2){_7a0.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_79f}));return this._sendAttachment("update",_79e,_7a0,_7a1,_7a2);},deleteAttachments:function(_7a3,_7a4,_7a5,_7a6){var url=this._url.path+"/"+_7a3+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_7a7={f:"json",attachmentIds:_7a4.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_7a7,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_7a8){var _7a9=_7a8.deleteAttachmentResults;_7a9=dojo.map(_7a9,function(_7aa){var res=new esri.layers.FeatureEditResult(_7aa);res.attachmentId=res.objectId;res.objectId=_7a3;return res;});self._resolve([_7a9],"onDeleteAttachmentsComplete",_7a5,dfd);}),error:function(err){self._resolve([err],null,_7a6,dfd,true);}},{usePost:true});return dfd;},addType:function(_7ab){var _7ac=this.types;if(_7ac){var _7ad=dojo.some(_7ac,function(type){if(type.id==_7ab.id){return true;}return false;});if(_7ad){return false;}else{_7ac.push(_7ab);}}else{this.types=[_7ab];}this._typesDirty=true;return true;},deleteType:function(_7ae){if(!this._collection){return;}var _7af=this.types;if(_7af){var _7b0=-1;dojo.some(_7af,function(type,_7b1){if(type.id==_7ae){_7b0=_7b1;return true;}return false;});if(_7b0>-1){this._typesDirty=true;return _7af.splice(_7b0,1)[0];}}},toJson:function(){var _7b2=this._json,json=dojo.isString(_7b2)?dojo.fromJson(_7b2):dojo.clone(_7b2);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _7b3=json.layerDefinition,_7b4=this._collection;if(_7b4&&this._typesDirty){_7b3.types=dojo.map(this.types||[],function(type){return type.toJson();});var _7b5=this.renderer,_7b6=_7b3.drawingInfo;if(_7b6&&_7b5&&_7b5.declaredClass.indexOf("TemporalRenderer")===-1){_7b6.renderer=_7b5.toJson();}}var _7b7=null;if(!(_7b4&&!this._fcAdded)){_7b7={geometryType:_7b3.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=dojo.mixin({},json.featureSet||{},_7b7);if(_7b4){json.nextObjectId=this._nextId;_7b3.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_7b8){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&esri.id&&esri.id._hasPortalSession()&&esri.id._doPortalSignIn(path)){esri.id.getCredential(path).then(function(){self._findCredential();_7b8.call(self);},function(){_7b8.call(self);});}else{_7b8.call(this);}},_updateCaps:function(){var _7b9=this._editable,_7ba=dojo.trim(this.capabilities||""),_7bb=dojo.map((_7ba?_7ba.split(","):[]),dojo.trim),caps=dojo.map((_7ba?_7ba.toLowerCase().split(","):[]),dojo.trim),_7bc=dojo.indexOf(caps,"editing"),cap,i,_7bd,_7be={"Create":dojo.indexOf(caps,"create"),"Update":dojo.indexOf(caps,"update"),"Delete":dojo.indexOf(caps,"delete")};if(_7b9&&_7bc===-1){_7bb.push("Editing");}else{if(!_7b9&&_7bc>-1){_7bd=[_7bc];for(cap in _7be){if(_7be[cap]>-1){_7bd.push(_7be[cap]);}}_7bd.sort();for(i=_7bd.length-1;i>=0;i--){_7bb.splice(_7bd[i],1);}}}this.capabilities=_7bb.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_7bf=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_7bf&&(_7bf.latestObservationRenderer||_7bf.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.initialize(map):mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_7c0){var map=this._map;if(_7c0&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_7c1){this._mapTimeExtent=_7c1;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_7c2){var _7c3=this._timeOffset,_7c4=this._timeOffsetUnits;return (_7c2&&_7c3&&_7c4)?_7c2.offset(-1*_7c3,_7c4):_7c2;},_getTimeOverlap:function(_7c5,_7c6){if(_7c5&&_7c6){return _7c5.intersection(_7c6);}else{return _7c5||_7c6;}},_getTimeFilter:function(_7c7){var _7c8=this.getTimeDefinition(),_7c9=null,_7ca;if(_7c8||_7c9){_7ca=this._getTimeOverlap(_7c8,_7c9);if(!_7ca){return [false];}}if(_7c7){_7c7=_7ca?this._getTimeOverlap(_7c7,_7ca):_7c7;if(!_7c7){return [false];}}else{_7c7=_7ca;}return [true,_7c7];},_getAttributeFilter:function(_7cb){var _7cc=this.getDefinitionExpression();if(_7cb){_7cb=_7cc?"("+_7cc+") AND ("+_7cb+")":_7cb;}else{_7cb=_7cc;}return _7cb;},_applyQueryFilters:function(_7cd){_7cd.where=this._getAttributeFilter(_7cd.where);_7cd.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _7ce=this._getTimeFilter(_7cd.timeExtent);if(!_7ce[0]){return false;}else{_7cd.timeExtent=_7ce[1];}}return true;},_add:function(_7cf){var _7d0=this._selectionSymbol,attr=_7cf.attributes,_7d1=this.visibilityField;if(_7d0&&this._isSelOnly){_7cf.setSymbol(_7d0);}if(_7d1&&attr&&attr.hasOwnProperty(_7d1)){_7cf[attr[_7d1]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_7d2){var _7d3=[],map=this._map;if(this._isTable||!map){return;}if(_7d2.text||(_7d2.where&&_7d2.where!==this.getDefinitionExpression())){return;}var _7d4=this._isSnapshot,_7d5=this._isSelOnly;var _7d6=_7d2.geometry;if(_7d6){if(!_7d5&&_7d2.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_7d6.type==="extent"&&(_7d4||map.extent.contains(_7d6)))){_7d3.push(1);}else{return;}}var ids=_7d2.objectIds;if(ids){if(_7d4){_7d3.push(2);}else{var len=ids.length,mode=this._mode,_7d7=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_7d7++;}}if(_7d7===len){_7d3.push(2);}else{return;}}}if(this.timeInfo){var _7d8=_7d2.timeExtent,_7d9=this._mapTimeExtent;if(_7d4){if(_7d8){_7d3.push(3);}}else{if(_7d5){if(_7d8){return;}}else{if(_7d9){if(dojo.indexOf(_7d3,2)!==-1){if(_7d8){_7d3.push(3);}}else{return;}}else{if(_7d3.length>0){if(_7d8){_7d3.push(3);}}else{if(_7d8){return;}}}}}}return _7d3.length>0?_7d3:null;},_doQuery:function(_7da,_7db,_7dc){var _7dd=[],mode=this._mode,_7de=this.objectIdField,i,len,_7df;if(dojo.indexOf(_7db,2)!==-1){_7dd=[];var ids=_7da.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_7dd.push(obj);}}if(_7dd.length===0){return [];}}if(dojo.indexOf(_7db,1)!==-1){_7df=_7dd.length>0?_7dd:this.graphics;len=_7df.length;var _7e0=_7da.geometry._normalize(null,true);_7dd=[];for(i=0;i<len;i++){var _7e1=_7df[i],_7e2=_7e1.geometry;if(_7e2){if(this.normalization&&_7e0.length){if(_7e0[0].intersects(_7e2)||_7e0[1].intersects(_7e2)){_7dd.push(_7e1);}}else{if(_7e0.intersects(_7e2)){_7dd.push(_7e1);}}}}if(_7dd.length===0){return [];}}if(dojo.indexOf(_7db,3)!==-1){if(this.timeInfo){_7df=_7dd.length>0?_7dd:this.graphics;var time=_7da.timeExtent,_7e3=this._filterByTime(_7df,time.startTime,time.endTime);_7dd=_7e3.match;}}if(_7dc){return dojo.map(_7dd,function(obj){return obj.attributes[_7de];},this);}else{return _7dd;}},_filterByTime:function(_7e4,_7e5,_7e6){var _7e7=this._startTimeField,_7e8=this._endTimeField,_7e9;if(!this._twoTimeFields){_7e9=_7e7||_7e8;}var _7ea=esri._isDefined,yea=[],nay=[],i,len=_7e4.length,_7eb,_7ec;_7e5=_7e5?_7e5.getTime():-Infinity;_7e6=_7e6?_7e6.getTime():Infinity;if(_7e9){for(i=0;i<len;i++){_7eb=_7e4[i];_7ec=_7eb.attributes;var time=_7ec[_7e9];if(time>=_7e5&&time<=_7e6){yea.push(_7eb);}else{nay.push(_7eb);}}}else{for(i=0;i<len;i++){_7eb=_7e4[i];_7ec=_7eb.attributes;var _7ed=_7ec[_7e7],end=_7ec[_7e8];_7ed=_7ea(_7ed)?_7ed:-Infinity;end=_7ea(end)?end:Infinity;if((_7ed>=_7e5&&_7ed<=_7e6)||(end>=_7e5&&end<=_7e6)||(_7e5>=_7ed&&_7e6<=end)){yea.push(_7eb);}else{nay.push(_7eb);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_7ee,_7ef,dfd,_7f0){if(_7ee){this[_7ee].apply(this,args);}if(_7ef){_7ef.apply(null,args);}if(dfd){esri._resDfd(dfd,args,_7f0);}},_getShallowClone:function(_7f1){var _7f2=new esri.tasks.Query(),prop;for(prop in _7f1){if(_7f1.hasOwnProperty(prop)){_7f2[prop]=_7f1[prop];}}return _7f2;},_query:function(type,_7f3,_7f4,_7f5,_7f6){var that=this,map=this._map,dfd=new dojo.Deferred(esri._dfdCanceller),_7f7=_7f4;var _7f8=function(_7f9,_7fa){if(!_7fa&&type==="execute"&&!that._isTable){var _7fb=_7f9.features,mode=that._mode,_7fc=that.objectIdField,il=_7fb.length,i;for(i=il-1;i>=0;i--){var oid=_7fb[i].attributes[_7fc];var _7fd=mode._getFeature(oid);if(_7fd){_7fb.splice(i,1,_7fd);}}}that._resolve([_7f9],_7f3,_7f5,dfd);};if(type!=="executeRelationshipQuery"){_7f7=this._getShallowClone(_7f4);_7f7.outFields=this._getOutFields();_7f7.returnGeometry=(!map&&_7f4.hasOwnProperty("returnGeometry"))?_7f4.returnGeometry:true;var _7fe;if(map){_7f7.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_7f7)){switch(type){case "execute":_7fe=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_7fe=[];break;case "executeForCount":_7fe=0;break;}_7f8(_7fe,true);return dfd;}var _7ff=this._canDoClientSideQuery(_7f7);if(_7ff){var _800=this._doQuery(_7f7,_7ff,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_7fe=new esri.tasks.FeatureSet();_7fe.features=_800;break;case "executeForIds":_7fe=_800;break;case "executeForCount":_7fe=_800.length;break;}_7f8(_7fe,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_7f6,dfd,true);return dfd;}if(this._ts){_7f7._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_7f7);temp.addCallbacks(_7f8,function(err){that._resolve([err],null,_7f6,dfd,true);});return dfd;},_convertFeaturesToJson:function(_801,_802,_803,_804){var json=[],_805=this._selectionSymbol,_806=this.visibilityField,i,_807,_808=this.objectIdField;if(this.loaded&&(_803||_804)){_807=dojo.filter(this.fields,function(_809){return (_809.editable===false)&&(!_804||(_809.name!==_808));});}for(i=0;i<_801.length;i++){var _80a=_801[i],_80b={},_80c=_80a.geometry,attr=_80a.attributes,_80d=_80a.symbol;if(_80c&&(!_804||!this.loaded||this.allowGeometryUpdates)){_80b.geometry=_80c.toJson();}if(_806){_80b.attributes=attr=dojo.mixin({},attr);attr[_806]=_80a.visible?1:0;}else{if(attr){_80b.attributes=dojo.mixin({},attr);}}if(_80b.attributes&&_807&&_807.length){dojo.forEach(_807,function(_80e){delete _80b.attributes[_80e.name];});}if(_80d&&(_80d!==_805)){_80b.symbol=_80d.toJson();}json.push(_80b);}return _802?json:dojo.toJson(json);},_selectHandler:function(_80f,_810,_811,_812,dfd){var _813,ctor=this.constructor;switch(_810){case ctor.SELECTION_NEW:this.clearSelection(true);_813=true;break;case ctor.SELECTION_ADD:_813=true;break;case ctor.SELECTION_SUBTRACT:_813=false;break;}var i,_814=_80f.features,mode=this._mode,_815=[],_816=this.objectIdField,_817,oid;if(_813){for(i=0;i<_814.length;i++){_817=_814[i];oid=_817.attributes[_816];var _818=mode._addFeatureIIf(oid,_817);_815.push(_818);this._selectFeatureIIf(oid,_818,mode);}}else{for(i=0;i<_814.length;i++){_817=_814[i];oid=_817.attributes[_816];this._unSelectFeatureIIf(oid,mode);var _819=mode._removeFeatureIIf(oid);_815.push(_819||_817);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_815,_810,_80f.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_811,dfd);if(_80f.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_81a,mode){var _81b=this._selectedFeatures,_81c=_81b[oid];if(!_81c){mode._incRefCount(oid);_81b[oid]=_81a;if(!this._isTable){this._setSelectSymbol(_81a);}}return _81c||_81a;},_unSelectFeatureIIf:function(oid,mode){var _81d=this._selectedFeatures[oid];if(_81d){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_81d);}}return _81d;},_isSelected:function(_81e){},_setSelectSymbol:function(_81f){var _820=this._selectionSymbol;if(_820&&!this._isSelOnly){_81f.setSymbol(_820);}},_setUnSelectSymbol:function(_821){var _822=this._selectionSymbol;if(_822&&!this._isSelOnly){if(_822===_821.symbol){_821.setSymbol(null,true);}}},_getOutFields:function(){var _823=dojo.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_824,_825,arr){return !!_824&&(dojo.indexOf(arr,_824)===_825);});var _826=dojo.clone(this._outFields);if(_826){if(dojo.indexOf(_826,"*")!==-1){return _826;}dojo.forEach(_823,function(_827){if(dojo.indexOf(_826,_827)===-1){_826.push(_827);}});return _826;}else{return _823;}},_checkFields:function(_828){var _829=_828||this._getOutFields();dojo.forEach(_829,function(_82a){if(_82a==="*"){return;}if(!this._getField(_82a)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_82a},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_828&&!this._isTable&&!this._fserver&&!this._collection){var _82b=dojo.some(this.fields,function(_82c){return (_82c&&_82c.type==="esriFieldTypeGeometry")?true:false;});if(!_82b){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _82d=this.renderer;if(_82d&&this.fields.length>0){var _82e=dojo.filter([_82d,_82d.observationRenderer,_82d.latestObservationRenderer,_82d.trackRenderer],esri._isDefined);var _82f=[];dojo.forEach(_82e,function(rnd){var _830,_831;_831=rnd.attributeField;if(_831&&!dojo.isFunction(_831)){_830=!this._getField(_831)&&this._getField(_831,true);if(_830){rnd.attributeField=_830.name;}}_831=rnd.attributeField2;if(_831){_830=!this._getField(_831)&&this._getField(_831,true);if(_830){rnd.attributeField2=_830.name;}}_831=rnd.attributeField3;if(_831){_830=!this._getField(_831)&&this._getField(_831,true);if(_830){rnd.attributeField3=_830.name;}}if(!dojo.isFunction(rnd.attributeField)){_82f.push(rnd.attributeField);}_82f.push(rnd.attributeField2);_82f.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_82f,esri._isDefined);}},_getField:function(_832,_833){var _834=this.fields;if(_834.length===0){return null;}var _835;if(_833){_832=_832.toLowerCase();}dojo.some(_834,function(_836){var _837=false;if(_833){_837=(_836&&_836.name.toLowerCase()===_832)?true:false;}else{_837=(_836&&_836.name===_832)?true:false;}if(_837){_835=_836;}return _837;});return _835;},_getDateOpts:function(){if(!this._dtOpts){var _838=dojo.map(dojo.filter(this.fields,function(_839){return !!(_839&&_839.type==="esriFieldTypeDate");}),function(_83a){return _83a.name;});this._dtOpts={properties:_838};}return this._dtOpts;},_applyNormalized:function(_83b,_83c){if(_83b&&_83c){dojo.forEach(_83b,function(_83d,_83e){if(_83d&&_83c[_83e]){_83d.setGeometry(_83c[_83e]);}});}},_editHandler:function(_83f,adds,_840,_841,_842,dfd){var _843=_83f.addResults,_844=_83f.updateResults,_845=_83f.deleteResults,i,_846,oid,_847,attr,_848=this.objectIdField,mode=this._mode,_849=this._isTable;var _84a=this.editFieldsInfo,_84b=this._getOutFields()||[],_84c=_84a&&_84a.creatorField,_84d=_84a&&_84a.creationDateField,_84e=_84a&&_84a.editorField,_84f=_84a&&_84a.editDateField,_850=_84a&&_84a.realm;if(dojo.indexOf(_84b,"*")===-1){if(_84c&&dojo.indexOf(_84b,_84c)===-1){_84c=null;}if(_84d&&dojo.indexOf(_84b,_84d)===-1){_84d=null;}if(_84e&&dojo.indexOf(_84b,_84e)===-1){_84e=null;}if(_84f&&dojo.indexOf(_84b,_84f)===-1){_84f=null;}}var _851=(_84d||_84f)?(new Date()).getTime():null,_852=(_84c||_84e)?this.getUserId():undefined;if(_852&&_850){_852=_852+"@"+_850;}if(_843){for(i=0;i<_843.length;i++){_843[i]=new esri.layers.FeatureEditResult(_843[i]);if(_849){continue;}_846=_843[i];if(_846.success){oid=_846.objectId;_847=adds[i];var gl=_847._graphicsLayer;if(gl&&gl!==this){gl.remove(_847);}attr=_847.attributes||{};attr[_848]=oid;if(_84c){attr[_84c]=_852;}if(_84e){attr[_84e]=_852;}if(_84d){attr[_84d]=_851;}if(_84f){attr[_84f]=_851;}_847.setAttributes(attr);if(mode._init){mode.drawFeature(_847);}}}}if(_844){for(i=0;i<_844.length;i++){_844[i]=new esri.layers.FeatureEditResult(_844[i]);if(_849){continue;}_846=_844[i];if(_846.success){oid=_846.objectId;_847=_840[oid];var _853=mode._getFeature(oid);if(_853){if(_853.geometry!==_847.geometry){_853.setGeometry(esri.geometry.fromJson(_847.geometry.toJson()));}this._repaint(_853,oid);}_847=_853||_847;attr=_847.attributes||{};if(_84e){attr[_84e]=_852;}if(_84f){attr[_84f]=_851;}_847.setAttributes(attr);}}}if(_845){var _854=[];for(i=0;i<_845.length;i++){_845[i]=new esri.layers.FeatureEditResult(_845[i]);if(_849){continue;}_846=_845[i];if(_846.success){oid=_846.objectId;_847=mode._getFeature(oid);if(_847){if(this._unSelectFeatureIIf(oid,mode)){_854.push(_847);}_847._count=0;mode._removeFeatureIIf(oid);}}}if(_854.length>0){this.onSelectionComplete(_854,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_843,_844,_845],"onEditsComplete",_841,dfd);},_sendAttachment:function(type,_855,_856,_857,_858){var _859=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_855+"/"+_859,self=this;var dfd=esri.request({url:url,form:_856,content:dojo.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_85a){var _85b=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_85c=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_85d=new esri.layers.FeatureEditResult(_85a[_85b]);_85d.attachmentId=_85d.objectId;_85d.objectId=_855;self._resolve([_85d],_85c,_857);return _85d;}).addErrback(function(_85e){self._resolve([_85e],null,_858,null,true);});return dfd;},_repaint:function(_85f,oid,_860){oid=esri._isDefined(oid)?oid:_85f.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_85f.setSymbol(_85f.symbol,_860);}},_getKind:function(_861){var _862=this._trackManager;if(_862){return _862.isLatestObservation(_861)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _863=json.symbol;if(_863){this.symbol=esri.symbol.fromJson(_863);}var _864=json.domains,_865,i;var _866=this.domains={};for(_865 in _864){if(_864.hasOwnProperty(_865)){var _867=_864[_865];switch(_867.type){case "range":_866[_865]=new esri.layers.RangeDomain(_867);break;case "codedValue":_866[_865]=new esri.layers.CodedValueDomain(_867);break;case "inherited":_866[_865]=new esri.layers.InheritedDomain(_867);break;}}}var _868=json.templates;if(_868){var _869=this.templates=[];for(i=0;i<_868.length;i++){_869.push(new esri.layers.FeatureTemplate(_868[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _86a,_86b=this.domains,_86c=this.templates,_86d=esri._sanitize;if(_86b){var _86e=json.domains={};for(_86a in _86b){if(_86b.hasOwnProperty(_86a)){_86e[_86a]=_86b[_86a]&&_86b[_86a].toJson();}}_86d(_86e);}if(_86c){json.templates=dojo.map(_86c,function(_86f){return _86f.toJson();});}return _86d(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _870=json.prototype;this.prototype=new esri.Graphic(_870.geometry,null,_870.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_871){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _872=this._featureMap[oid];if(_872){_872._count++;}},_decRefCount:function(oid){var _873=this._featureMap[oid];if(_873){_873._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_874){var fmap=this._featureMap,_875=fmap[oid],_876=this.featureLayer;if(!_875){fmap[oid]=_874;_876._add(_874);_874._count=0;}return _875||_874;},_removeFeatureIIf:function(oid){var _877=this._featureMap[oid],_878=this.featureLayer;if(_877){if(_877._count){return;}delete this._featureMap[oid];_878._remove(_877);}return _877;},_clearIIf:function(){var i,_879=this.featureLayer,_87a=_879.graphics,_87b=_879._selectedFeatures,_87c=_879.objectIdField;for(i=_87a.length-1;i>=0;i--){var _87d=_87a[i];var oid=_87d.attributes[_87c];if(oid in _87b){_87d._count=1;continue;}_87d._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _87e=this.featureLayer,_87f=_87e.graphics,_880=show?"show":"hide",i,len=_87f.length;show=show&&_87e._ager;for(i=0;i<len;i++){var _881=_87f[i];_881[_880]();if(show){_87e._repaint(_881);}}},_applyTimeFilter:function(_882){var _883=this.featureLayer;if(!_883.timeInfo||_883.suspended){return;}if(!_882){_883._fireUpdateStart();}var _884=_883._trackManager;if(_884){_884.clearTracks();}var defn=_883.getTimeDefinition(),_885=_883._getOffsettedTE(_883._mapTimeExtent);if(_885){_885=_883._getTimeOverlap(defn,_885);if(_885){var _886=_883._filterByTime(_883.graphics,_885.startTime,_885.endTime);if(_884){_884.addFeatures(_886.match);}dojo.forEach(_886.match,function(_887){var _888=_887._shape;if(!_887.visible){_887.show();_888=_887._shape;_888&&_888._moveToFront();}if(_883._ager&&_888){_883._repaint(_887);}});dojo.forEach(_886.noMatch,function(_889){if(_889.visible){_889.hide();}});}else{this._toggleVisibility(false);}}else{if(_884){_884.addFeatures(_883.graphics);}this._toggleVisibility(true);}if(_884){_884.moveLatestToFront();_884.drawTracks();}if(!_882){_883._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_88a){this.featureLayer=_88a;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_88b){this.featureLayer=_88b;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _88c=this.featureLayer;if(_88c._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_88d){var _88e=this.featureLayer,_88f=_88e.objectIdField,oid=_88d.attributes[_88f];this._addFeatureIIf(oid,_88d);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _890=this.featureLayer;if(_890._collection){_890._fireUpdateStart();_890._refresh(true);_890._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_891){var id="_"+_891.name+_891.layerId+_891._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _892=this.featureLayer;if(_892._collection){return;}_892._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_893=this.featureLayer,_894=_893.getDefinitionExpression();var _895=new esri.tasks.Query();_895.outFields=_893._getOutFields();_895.where=_894||"1=1";_895.returnGeometry=true;_895.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_895.timeExtent=_893.getTimeDefinition();_895.maxAllowableOffset=_893._maxOffset;if(_893._ts){_895._ts=(new Date()).getTime();}var _896;if(_893._usePatch){_896=this._getRequestId(_893);this._cancelPendingRequest(null,_896);}_893._task.execute(_895,this._drawFeatures,this._queryErrorHandler,_896);},_drawFeatures:function(_897){this._purgeRequests();var _898=_897.features,_899=this.featureLayer,_89a=_899.objectIdField,i,len=_898.length,_89b,oid;for(i=0;i<len;i++){_89b=_898[i];oid=_89b.attributes[_89a];this._addFeatureIIf(oid,_89b);this._incRefCount(oid);}this._applyTimeFilter(true);_899._fireUpdateEnd(null,_897.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_897.exceededTransferLimit){_899.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _89c=this.featureLayer;_89c._errorHandler(err);_89c._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_89d){this.featureLayer=_89d;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_89e){var _89f=this._gridLayer,geom=_89e.geometry,_8a0=[];if(!geom){return;}_8a0=_89f.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _8a1=this._cellMap,i,cell,oid=_89e.attributes[this.featureLayer.objectIdField],_8a2,row,col;for(i=0;i<_8a0.length;i++){cell=_8a0[i];_8a2=cell.latticeID;row=cell.row;col=cell.col;if(_8a2){cell=(_8a1[_8a2]=(_8a1[_8a2]||cell));}else{_8a1[row]=_8a1[row]||{};cell=(_8a1[row][col]=(_8a1[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_89e);this._addFeatureIIf(oid,_89e);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_8a3=this.featureLayer;var _8a4=_8a3._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_8a4?_8a4.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_8a3._tileWidth,height:_8a3._tileHeight},{width:map.width,height:map.height},_8a4);this._ioQueue=[];if(!_8a3.suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=dojo.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);dojo.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _8a5=this.featureLayer,map=this.map;if(_8a5.suspended){return;}_8a5._fireUpdateStart();this._clearIIf();var _8a6=_8a5._trackManager;if(_8a6){_8a6.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_8a7,cell){var id="_"+_8a7.name+_8a7.layerId+_8a7._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_8a8){this._exceeds=false;var _8a9=this.featureLayer,map=this.map,_8aa=_8a8||map.extent,_8ab=this._gridLayer.getCellsInExtent(_8aa,_8a9.latticeTiling),_8ac=_8ab.cells;if(!_8a9.isEditable()){var _8ad=this._cellMap;_8ac=dojo.filter(_8ac,function(cell){if(cell.lattice){if(_8ad[cell.latticeID]){return false;}}else{if(_8ad[cell.row]&&_8ad[cell.row][cell.col]){return false;}}return true;});}var _8ae=_8a9._getOutFields(),_8af=_8a9.getDefinitionExpression(),time=_8a9._getOffsettedTE(_8a9._mapTimeExtent),_8b0=_8a9._usePatch,_8b1=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_8b2,_8b3;this._pending=this._pending||0;for(i=0;i<_8ac.length;i++){cell=_8ac[i];_8b2=new esri.tasks.Query();_8b2.geometry=cell.extent||cell.lattice;_8b2.outFields=_8ae;_8b2.where=_8af;if(_8a9.latticeTiling&&cell.extent){_8b2.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;}_8b2.returnGeometry=true;_8b2.timeExtent=time;_8b2.maxAllowableOffset=_8a9._maxOffset;if(_8a9._ts){_8b2._ts=(new Date()).getTime();}_8b3=null;if(_8b0){_8b3=this._getRequestId(_8a9,cell);if(this._isPending(_8b3)){continue;}}this._pending++;_8b1.push(_8a9._task.execute(_8b2,function(){var _8b4=cell;return function(_8b5){func.apply(self,[_8b5,_8b4]);};}.call(this),this._queryErrorHandler,_8b3));}this._removeOldCells(_8aa);this._endCheck();},_drawFeatures:function(_8b6,cell){this._exceeds=this._exceeds||_8b6.exceededTransferLimit;this._finalizeIO();var _8b7=this.featureLayer,map=this.map,_8b8=map.extent,_8b9=cell.extent,row=cell.row,col=cell.col,_8ba=_8b7.objectIdField,_8bb=_8b6.features,_8bc=this._gridLayer,_8bd=this._cellMap,i,len,_8be=cell.latticeID,_8bf=_8be?_8bd[_8be]:(_8bd[row]&&_8bd[row][col]);if((cell.resolution!=_8bc._resolution)||(_8be?(_8be!==_8bc.getLatticeID(_8b8)):(!_8bc.intersects(_8b9,_8b8)))){if(_8bf){this._removeCell(row,col,_8be);}}else{if(_8bf){this._updateCell(_8bf,_8bb);}else{cell.features=_8bb;if(_8be){_8bd[_8be]=cell;}else{_8bd[row]=_8bd[row]||{};_8bd[row][col]=cell;}len=_8bb.length;for(i=0;i<len;i++){var _8c0=_8bb[i];var oid=_8c0.attributes[_8ba];this._addFeatureIIf(oid,_8c0);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_8c1){if(this._pending===0){this._processIOQueue();var _8c2=this.featureLayer,_8c3=_8c2._trackManager;if(_8c3){_8c3.clearTracks();_8c3.addFeatures(_8c2.graphics);if(_8c2._ager){dojo.forEach(_8c2.graphics,function(_8c4){if(_8c4._shape){_8c2._repaint(_8c4);}});}_8c3.moveLatestToFront();_8c3.drawTracks();}this.featureLayer._fireUpdateEnd(_8c1&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_8c2.onQueryLimitExceeded();}}},_processIOQueue:function(_8c5){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_8c5){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_8c6){var _8c7=this._cellMap,_8c8=this._gridLayer,_8c9,_8ca;for(_8c9 in _8c7){if(_8c7[_8c9]){var row=_8c7[_8c9],_8cb=row.latticeID,_8cc=0,_8cd=0;if(_8cb){_8cc++;if(_8cb!==_8c8.getLatticeID(_8c6)){this._removeCell(null,null,_8cb);_8cd++;}}else{for(_8ca in row){if(row[_8ca]){_8cc++;var _8ce=row[_8ca].extent;if(!_8c8.intersects(_8ce,_8c6)){this._removeCell(_8c9,_8ca);_8cd++;}}}}if(_8cd===_8cc){delete _8c7[_8c9];}}}},_updateCell:function(cell,_8cf){var _8d0=this.featureLayer,_8d1=_8d0.objectIdField,_8d2=_8d0._selectedFeatures,i,len=_8cf.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _8d3=_8cf[i];var oid=_8d3.attributes[_8d1];var _8d4=this._addFeatureIIf(oid,_8d3);if(_8d4===_8d3){this._incRefCount(oid);cell.features.push(_8d4);}else{if(!(oid in _8d2)){_8d4.setGeometry(_8d3.geometry);_8d4.setAttributes(_8d3.attributes);}}}},_removeCell:function(row,col,_8d5){var _8d6=this._cellMap,_8d7=this.featureLayer,_8d8=_8d7.objectIdField;var cell=_8d5?_8d6[_8d5]:(_8d6[row]&&_8d6[row][col]);if(cell){if(_8d5){delete _8d6[_8d5];}else{delete _8d6[row][col];}var _8d9=cell.features,i;for(i=0;i<_8d9.length;i++){var _8da=_8d9[i];var oid=_8da.attributes[_8d8];this._decRefCount(oid);if(oid in _8d7._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_8db,_8dc,_8dd,_8de){this.origin=_8db;this.cellWidth=_8dc.width;this.cellHeight=_8dc.height;this.mapWidth=_8dd.width;this.mapHeight=_8dd.height;this.srInfo=_8de;},setResolution:function(_8df){this._resolution=(_8df.xmax-_8df.xmin)/this.mapWidth;if(this.srInfo){var _8e0=Math.round((2*this.srInfo.valid[1])/this._resolution),_8e1=Math.round(_8e0/this.cellWidth);this._frameStats=[_8e1,0,_8e1-1];}},getCellCoordinates:function(_8e2){var res=this._resolution,_8e3=this.origin;return {row:Math.floor((_8e3.y-_8e2.y)/(this.cellHeight*res)),col:Math.floor((_8e2.x-_8e3.x)/(this.cellWidth*res))};},normalize:function(col){var _8e4=this._frameStats;if(_8e4){var _8e5=_8e4[0],m180=_8e4[1],p180=_8e4[2];if(col<m180){col=col%_8e5;col=col<m180?col+_8e5:col;}else{if(col>p180){col=col%_8e5;}}}return col;},intersects:function(_8e6,_8e7){var _8e8=this.srInfo;if(_8e8){return dojo.some(_8e7._getParts(_8e8),function(_8e9){return _8e6.intersects(_8e9.extent);});}else{return _8e6.intersects(_8e7);}},getCellExtent:function(row,col){var res=this._resolution,_8ea=this.origin,_8eb=this.cellWidth,_8ec=this.cellHeight;return new esri.geometry.Extent((col*_8eb*res)+_8ea.x,_8ea.y-((row+1)*_8ec*res),((col+1)*_8eb*res)+_8ea.x,_8ea.y-(row*_8ec*res),new esri.SpatialReference(_8ea.spatialReference.toJson()));},getLatticeID:function(_8ed){var _8ee=this.getCellCoordinates({x:_8ed.xmin,y:_8ed.ymax}),_8ef=this.getCellCoordinates({x:_8ed.xmax,y:_8ed.ymin}),_8f0=_8ee.row,_8f1=_8ef.row,_8f2=this.normalize(_8ee.col),_8f3=this.normalize(_8ef.col);return _8f0+"_"+_8f1+"_"+_8f2+"_"+_8f3;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_8f4,_8f5){var _8f6=this.getCellCoordinates({x:_8f4.xmin,y:_8f4.ymax}),_8f7=this.getCellCoordinates({x:_8f4.xmax,y:_8f4.ymin}),_8f8=_8f6.row,_8f9=_8f7.row,_8fa=_8f6.col,_8fb=_8f7.col,_8fc=[],i,j,nj,_8fd=[],_8fe=[],len,xmin,xmax,ymin,ymax,_8ff=[],_900,_901;for(i=_8f8;i<=_8f9;i++){for(j=_8fa;j<=_8fb;j++){nj=this.normalize(j);_8f4=this.getCellExtent(i,nj);_8fc.push({row:i,col:nj,extent:_8f4,resolution:this._resolution});if(_8f5){_8fd.push(_8f4.xmin,_8f4.xmax);_8fe.push(_8f4.ymin,_8f4.ymax);}}}_8fa=this.normalize(_8fa);_8fb=this.normalize(_8fb);_8fd.sort(this.sorter);_8fe.sort(this.sorter);len=_8fd.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_8fd[i]===_8fd[i+1]){_8fd.splice(i,1);}}}len=_8fe.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_8fe[i]===_8fe[i+1]){_8fe.splice(i,1);}}}if(_8fd.length&&_8fe.length){xmin=_8fd[0];xmax=_8fd[_8fd.length-1];ymin=_8fe[0];ymax=_8fe[_8fe.length-1];len=_8fd.length;for(i=0;i<len;i++){_8ff.push([[_8fd[i],ymax],[_8fd[i],ymin]]);}len=_8fe.length;for(i=0;i<len;i++){_8ff.push([[xmin,_8fe[i]],[xmax,_8fe[i]]]);}_900=new esri.geometry.Polyline({paths:_8ff,spatialReference:this.origin.spatialReference.toJson()});_901=_8f8+"_"+_8f9+"_"+_8fa+"_"+_8fb;_8fc.push({latticeID:_901,lattice:_900,resolution:this._resolution});}return {minRow:_8f8,maxRow:_8f9,minCol:_8fa,maxCol:_8fb,cells:_8fc};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_902){this.layer=_902;this.trackMap={};},initialize:function(map){this.map=map;var _903=this.layer,_904=_903.renderer.trackRenderer;if(_904&&(_903.geometryType==="esriGeometryPoint")){var _905=(this.container=new esri.layers._GraphicsLayer({id:_903.id+"_tracks",_child:true}));_905.loaded=true;_905.onLoad(_905);_905._setMap(map,_903._div);_905.setRenderer(_904);}},addFeatures:function(_906){var tkid,_907=this.trackMap,_908=this.layer,_909=_908._trackIdField;dojo.forEach(_906,function(_90a){var _90b=_90a.attributes;tkid=_90b[_909];var ary=(_907[tkid]=(_907[tkid]||[]));ary.push(_90a);});var _90c=_908._startTimeField,_90d=_908.objectIdField;var _90e=function(a,b){var _90f=a.attributes[_90c],_910=b.attributes[_90c];if(_90f===_910){return (a.attributes[_90d]<b.attributes[_90d])?-1:1;}else{return (_90f<_910)?-1:1;}};for(tkid in _907){_907[tkid].sort(_90e);}},drawTracks:function(){var _911=this.container;if(!_911){return;}var _912=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_913,_914=this.layer._trackIdField,_915;for(tkid in _912){ary=_912[tkid];path=[];for(i=ary.length-1;i>=0;i--){_913=ary[i].geometry;if(_913){path.push([_913.x,_913.y]);}}_915={};_915[_914]=tkid;if(path.length>0){_911.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr}),null,_915));}}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_916){var _917=_916._shape;_917&&_917._moveToFront();this._repaint(_916,null,true);},this.layer);},getLatestObservations:function(){var _918=[];if(!this.layer.renderer.latestObservationRenderer){return _918;}var _919=this.trackMap,tkid;for(tkid in _919){var ary=_919[tkid];_918.push(ary[ary.length-1]);}return _918;},clearTracks:function(){var _91a=this.getLatestObservations();this.trackMap={};var _91b=this.container;if(_91b){_91b.clear();}dojo.forEach(_91a,function(_91c){this._repaint(_91c,null,true);},this.layer);},isLatestObservation:function(_91d){var _91e=this.layer._trackIdField;var _91f=this.trackMap[_91d.attributes[_91e]];if(_91f){return (_91f[_91f.length-1]===_91d);}return false;},destroy:function(){var _920=this.container;if(_920){_920.clear();_920._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});});},"dojox/charting/plot2d/Bubble":function(){define("dojox/charting/plot2d/Bubble",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(lang,_921,arr,_922,_923,dc,df,dfr,du,fx){var _924=dfr.lambda("item.purgeGroup()");return _921("dojox.charting.plot2d.Bubble",[_922,_923],{defaultParams:{hAxis:"x",vAxis:"y",animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:""},constructor:function(_925,_926){this.opt=lang.clone(this.defaultParams);du.updateWithObject(this.opt,_926);du.updateWithPattern(this.opt,_926,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_927){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_927);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){arr.forEach(this.series,_924);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_928=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}if(typeof run.data[0]=="number"){console.warn("dojox.charting.plot2d.Bubble: the data in the following series cannot be rendered as a bubble chart; ",run);continue;}var _929=t.next("circle",[this.opt,run]),s=run.group,_92a=arr.map(run.data,function(v,i){return v?{x:ht(v.x)+_927.l,y:dim.height-_927.b-vt(v.y),radius:this._vScaler.bounds.scale*(v.size/2)}:null;},this);var _92b=null,_92c=null,_92d=null,_92e=this.opt.styleFunc;var _92f=function(item){if(_92e){return t.addMixin(_929,"circle",[item,_92e(item)],true);}return t.addMixin(_929,"circle",item,true);};if(_929.series.shadow){_92d=arr.map(_92a,function(item,i){if(item!==null){var _930=_92f(run.data[i]),_931=_930.series.shadow;var _932=s.createCircle({cx:item.x+_931.dx,cy:item.y+_931.dy,r:item.radius}).setStroke(_931).setFill(_931.color);if(this.animate){this._animateBubble(_932,dim.height-_927.b,item.radius);}return _932;}return null;},this);if(_92d.length){run.dyn.shadow=_92d[_92d.length-1].getStroke();}}if(_929.series.outline){_92c=arr.map(_92a,function(item,i){if(item!==null){var _933=_92f(run.data[i]),_934=dc.makeStroke(_933.series.outline);_934.width=2*_934.width+_929.series.stroke.width;var _935=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setStroke(_934);if(this.animate){this._animateBubble(_935,dim.height-_927.b,item.radius);}return _935;}return null;},this);if(_92c.length){run.dyn.outline=_92c[_92c.length-1].getStroke();}}_92b=arr.map(_92a,function(item,i){if(item!==null){var _936=_92f(run.data[i]),rect={x:item.x-item.radius,y:item.y-item.radius,width:2*item.radius,height:2*item.radius};var _937=this._plotFill(_936.series.fill,dim,_927);_937=this._shapeFill(_937,rect);var _938=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setFill(_937).setStroke(_936.series.stroke);if(this.animate){this._animateBubble(_938,dim.height-_927.b,item.radius);}return _938;}return null;},this);if(_92b.length){run.dyn.fill=_92b[_92b.length-1].getFill();run.dyn.stroke=_92b[_92b.length-1].getStroke();}if(_928){var _939=new Array(_92b.length);arr.forEach(_92b,function(s,i){if(s!==null){var o={element:"circle",index:i,run:run,shape:s,outline:_92c&&_92c[i]||null,shadow:_92d&&_92d[i]||null,x:run.data[i].x,y:run.data[i].y,r:run.data[i].size/2,cx:_92a[i].x,cy:_92a[i].y,cr:_92a[i].radius};this._connectEvents(o);_939[i]=o;}},this);this._eventSeries[run.name]=_939;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateBubble:function(_93a,_93b,size){fx.animateTransform(lang.delegate({shape:_93a,duration:1200,transform:[{name:"translate",start:[0,_93b],end:[0,0]},{name:"scale",start:[0,1/size],end:[1,1]},{name:"original"}]},this.animate)).play();}});});},"*noref":1}});define("esri/arcgis/utils",["dijit","dojo","dojox","dojo/require!esri/map,esri/layers/agsimageservice,esri/layers/osm,esri/layers/FeatureLayer,esri/layers/KMLLayer,esri/layers/wms,esri/virtualearth/VETiledLayer,esri/tasks/geometry,dojo/DeferredList,esri/dijit/Popup,esri/arcgis/csv"],function(_93c,dojo,_93d){dojo.provide("esri.arcgis.utils");dojo.require("esri.map");dojo.require("esri.layers.agsimageservice");dojo.require("esri.layers.osm");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.layers.KMLLayer");dojo.require("esri.layers.wms");dojo.require("esri.virtualearth.VETiledLayer");dojo.require("esri.tasks.geometry");dojo.require("dojo.DeferredList");dojo.require("esri.dijit.Popup");dojo.require("esri.arcgis.csv");(function(){var EAU=esri.arcgis.utils;EAU.arcgisUrl=location.protocol+"//www.arcgis.com/sharing/rest/content/items";String.prototype.endsWith=function(str){return (this.match(str+"$")==str);};EAU.getItem=function(_93e){if(EAU._arcgisUrl&&EAU._arcgisUrl.length>0){EAU.arcgisUrl=EAU._arcgisUrl;}var url=EAU.arcgisUrl+"/"+_93e;var _93f={},_940=new dojo.Deferred();esri.request({url:url,content:{f:"json"},callbackParamName:"callback",load:function(_941){_93f.item=_941;esri.request({url:url+"/data",content:{f:"json"},callbackParamName:"callback",load:function(_942){_93f.itemData=_942;_940.callback(_93f);},error:function(_943){_940.errback(_943);}});},error:function(_944){_940.errback(_944);}});return _940;};EAU.createMap=function(arg1,_945,_946){var _947=new dojo.Deferred();_946=_946||{};var _948=_946.infoTemplateClass;_946._clazz=(_948&&dojo.getObject(_948))||esri.dijit.PopupTemplate;if(dojo.isString(arg1)){EAU.getItem(arg1).addCallback(function(_949){EAU._getItemProps(_949,_946).addCallback(function(_94a){EAU._getLayers(_94a.itemData,_946).addCallback(dojo.hitch(null,EAU._preCreateMap,_94a,_945,_946,_947));});}).addErrback(dojo.hitch(_947,_947.errback));}else{EAU._getItemProps(arg1,_946).addCallback(function(_94b){EAU._getLayers(_94b.itemData,_946).addCallback(dojo.hitch(null,EAU._preCreateMap,_94b,_945,_946,_947));});}return _947;};EAU._arcgisUrl=null;EAU._getItemProps=function(_94c,_94d){var _94e=new dojo.Deferred();var _94f=_94c.itemData;var _950=[];var _951=[];dojo.forEach(_94f.operationalLayers,function(_952){if(_952.itemId&&!_952.type){if(_952.url.indexOf("/FeatureServer")>-1){_951.push(_952);_950.push(EAU._getItemData(_952));}else{if(_952.url.indexOf("/MapServer")>-1&&_952.url.indexOf("/MapServer/")===-1&&(!_952.layers||(!esri.isDefined(_952.minScale)&&!esri.isDefined(_952.maxScale)))){_951.push(_952);_950.push(EAU._getItemData(_952));}else{if(_952.url.indexOf("/ImageServer")>-1&&!esri.isDefined(_952.minScale)&&!esri.isDefined(_952.maxScale)){_951.push(_952);_950.push(EAU._getItemData(_952));}}}}});if(_950.length>0){var _953=new dojo.DeferredList(_950);_953.addCallback(function(_954){dojo.forEach(_951,function(_955,i){var _956=_954[i][1];if(_956){if(_955.url.indexOf("/FeatureServer")>-1&&_956.layers){dojo.forEach(_956.layers,function(_957){if(_955.url.endsWith("/FeatureServer/"+_957.id)){_955.itemProperties=_957;EAU._processFSItemProperties(_955);}});}else{if(_955.url.indexOf("/MapServer")>-1){if(_956.layers&&!_955.layers){_955.layers=_956.layers;}if(esri.isDefined(_956.minScale)&&!esri.isDefined(_955.minScale)){_955.minScale=_956.minScale;}if(esri.isDefined(_956.maxScale)&&!esri.isDefined(_955.maxScale)){_955.maxScale=_956.maxScale;}}else{if(_955.url.indexOf("/ImageServer")>-1){if(esri.isDefined(_956.minScale)&&!esri.isDefined(_955.minScale)){_955.minScale=_956.minScale;}if(esri.isDefined(_956.maxScale)&&!esri.isDefined(_955.maxScale)){_955.maxScale=_956.maxScale;}}}}}});_94e.callback(_94c);});}else{_94e.callback(_94c);}return _94e;};EAU._getItemData=function(_958){var url=EAU.arcgisUrl+"/"+_958.itemId+"/data";var _959=esri.request({url:url,content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:true,_preLookup:true});return _959;};EAU._processFSItemProperties=function(_95a){if(_95a.itemProperties.layerDefinition){if(_95a.layerDefinition){if(!_95a.layerDefinition.drawingInfo){_95a.layerDefinition.drawingInfo=_95a.itemProperties.layerDefinition.drawingInfo;}if(!esri.isDefined(_95a.layerDefinition.definitionExpression)){_95a.layerDefinition.definitionExpression=_95a.itemProperties.layerDefinition.definitionExpression;}if(!esri.isDefined(_95a.layerDefinition.minScale)){_95a.layerDefinition.minScale=_95a.itemProperties.layerDefinition.minScale;}if(!esri.isDefined(_95a.layerDefinition.maxScale)){_95a.layerDefinition.maxScale=_95a.itemProperties.layerDefinition.maxScale;}}else{_95a.layerDefinition=_95a.itemProperties.layerDefinition;}}if(_95a.itemProperties.popupInfo&&!_95a.popupInfo&&!_95a.disablePopup){_95a.popupInfo=_95a.itemProperties.popupInfo;}};EAU._getLayers=function(_95b,_95c){var _95d=[];var _95e=[];var _95f=[];var _960=new dojo.Deferred();dojo.forEach(_95b.operationalLayers,function(_961,_962){if(_961.featureCollection){dojo.forEach(_961.featureCollection.layers,function(_963,idx){var _964=true;if(_961.visibleLayers){if(dojo.indexOf(_961.visibleLayers,idx)==-1){_964=false;}}_963.visibility=(_961.visibility&&_964);_963.opacity=_961.opacity;_963.id=(_961.id||("operational"+_962))+"_"+idx;_95f.push(_963);},this);}else{_95f.push(_961);}});dojo.forEach(_95b.baseMap.baseMapLayers,function(_965,_966){_965.baseMapLayer=true;_965.id=_965.id||("base"+_966);_95d.push(_965);});dojo.forEach(_95f,function(_967,_968){_967.id=_967.id||("operational"+_968);_95d.push(_967);});dojo.forEach(_95d,function(_969){if(_969.url&&!_969.type){_969.deferredsPos=_95e.length;_969.errors=[];_95e.push(EAU._getServiceInfo(_969.url,_969.errors));}else{if(_969.url&&_969.type=="CSV"){_969.deferredsPos=_95e.length;_95e.push(esri.arcgis.csv.buildCSVFeatureCollection(_969));}}});if(_95e.length==0){var _96a=EAU._getMapSR(_95d);_95d=EAU._buildLayerObjects(_95d,_95c,_96a);_960.callback(_95d);}else{var _96b=new dojo.DeferredList(_95e);_96b.addCallback(function(_96c){EAU._preBuildLayerObjects(_96c,_95d,_95c,_95e,_960);});}return _960;};EAU._preBuildLayerObjects=function(_96d,_96e,_96f,_970,_971){dojo.forEach(_96e,function(_972,_973){if(_972.url&&!_972.type){_972.resourceInfo=_96d[_972.deferredsPos][1];delete _972.deferredsPos;}else{if(_972.url&&_972.type=="CSV"){_972.featureCollection=_970[_972.deferredsPos].results[0];delete _972.deferredsPos;}}});var _974=EAU._getMapSR(_96e);var _975=[];var _976=new dojo.Deferred();dojo.forEach(_96e,function(_977){if(_977.url&&_977.type=="CSV"){_977.deferredsPos=_975.length;_975.push(esri.arcgis.csv.projectFeatureCollection(_977.featureCollection,_974));}});if(_975.length==0){_96e=EAU._buildLayerObjects(_96e,_96f,_974);_971.callback(_96e);}else{var _978=new dojo.DeferredList(_975);_978.addCallback(function(){dojo.forEach(_96e,function(_979){if(_979.url&&_979.type=="CSV"){_979.featureCollection=_975[_979.deferredsPos].results[0];delete _979.deferredsPos;}});_96e=EAU._buildLayerObjects(_96e,_96f,_974);_971.callback(_96e);});}};EAU._buildLayerObjects=function(_97a,_97b,_97c){dojo.forEach(_97a,function(_97d,_97e){if(_97d.url&&!_97d.type){if(_97e===0||_97a[0].layerObject){_97d.layerObject=EAU._initLayer(_97d,_97a,_97b,_97c);}}else{if(_97d.url&&_97d.type=="CSV"){_97d.layerObject=EAU._initLayer(_97d,_97a,_97b,_97c);}else{_97d.layerObject=EAU._initLayer(_97d,_97a,_97b,_97c);}}});var _97f=dojo.filter(_97a,function(lyr){return !lyr.isReference;});var _980=dojo.filter(_97a,function(lyr){return !!lyr.isReference;});_97a=_97f.concat(_980);return _97a;};EAU._preCreateMap=function(_981,_982,_983,_984,_985){try{var _986=_983.mapOptions||{};_983.mapOptions=_986;var card=_981.item;var _987=[];dojo.forEach(_985,function(_988){if(dojo.isArray(_988.layerObject)){dojo.forEach(_988.layerObject,function(l){_987.push(l);});}else{_987.push(_988.layerObject);}});if(!_987[0]){_984.errback(new Error(esri.bundle.arcgis.utils.baseLayerError));return;}_987=dojo.filter(_987,esri.isDefined);if(card){if(card.extent){if(!_986.extent){var _989=new esri.geometry.Extent(card.extent[0][0],card.extent[0][1],card.extent[1][0],card.extent[1][1],new esri.SpatialReference({wkid:4326}));var _98a=_987[0].spatialReference;if(_98a.wkid===4326){_986.extent=_989;EAU._createMap(_987,_985,_981,_982,_983,_984);}else{if(_98a.wkid===102100||_98a.wkid===102113||_98a.wkid===3857){_989.xmin=Math.max(_989.xmin,-180);_989.xmax=Math.min(_989.xmax,180);_989.ymin=Math.max(_989.ymin,-89.99);_989.ymax=Math.min(_989.ymax,89.99);_986.extent=esri.geometry.geographicToWebMercator(_989);EAU._createMap(_987,_985,_981,_982,_983,_984);}else{if(_983.geometryServiceURL||esri.config.defaults.geometryService){var gs;if(_983.geometryServiceURL){gs=new esri.tasks.GeometryService(_983.geometryServiceURL);}else{gs=esri.config.defaults.geometryService;}gs.project([_989],_98a,function(_98b){var _98c=_98b[0];_986.extent=_986.extent||_98c;EAU._createMap(_987,_985,_981,_982,_983,_984);});}else{_984.errback(new Error(esri.bundle.arcgis.utils.geometryServiceError));}}}}else{EAU._createMap(_987,_985,_981,_982,_983,_984);}}else{EAU._createMap(_987,_985,_981,_982,_983,_984);}}else{EAU._createMap(_987,_985,_981,_982,_983,_984);}}catch(err){_984.errback(err);}};EAU._getMapSR=function(_98d){var _98e=null;var _98f=_98d[0];if(_98f.url&&!_98f.type){if(_98f.resourceInfo.spatialReference){_98e=new esri.SpatialReference();if(_98f.resourceInfo.spatialReference.wkid){_98e.wkid=_98f.resourceInfo.spatialReference.wkid;}if(_98f.resourceInfo.spatialReference.wkt){_98e.wkt=_98f.resourceInfo.spatialReference.wkt;}}}else{if(_98f.type.indexOf("BingMaps")>-1||_98f.type=="OpenStreetMap"){_98e=new esri.SpatialReference({wkid:102100});}else{if(_98f.type=="WMS"){_98e=new esri.SpatialReference({wkid:_98f.spatialReferences[0]});}}}return _98e;};EAU._createMap=function(_990,_991,_992,_993,_994,_995){var _996=(_994.mapOptions||{}),_997,_998;if(!_996.infoWindow){_997=new esri.dijit.Popup(null,dojo.create("div"));_996.infoWindow=_997;}if(!esri.isDefined(_996.showInfoWindowOnClick)){_996.showInfoWindowOnClick=false;}var map=new esri.Map(_993,_996);if(_994.ignorePopups){dojo.forEach(_990,function(_999){delete _999.infoTemplate;});}if(!(_994.ignorePopups||_994.disableClickBehavior)){_998=dojo.connect(map,"onClick",EAU._showPopup);}dojo.connect(map,"onLayersAddResult",EAU._onLayersAddResult);map.addLayers(_990);if(!_994.ignorePopups){EAU._addSelectionLayers(_990,map,_994._clazz);}var _99a=[];dojo.forEach(_991,function(_99b){_99a=_99a.concat(_99b.errors);},this);_995.callback({map:map,itemInfo:_992,errors:_99a,clickEventHandle:_998,clickEventListener:EAU._showPopup});};EAU._addSelectionLayers=function(_99c,map,_99d){var _99e=[];dojo.forEach(_99c,function(_99f){var _9a0=_99f.__popups;if(_9a0&&_9a0.length>1&&_99f.version>=10){_99f.__deferredsPos=_99e.length;_99e.push(EAU._getLayersInfo(_99f));}});var _9a1=[];if(_99e.length>0){var _9a2=new dojo.DeferredList(_99e);_9a2.addCallback(function(_9a3){dojo.forEach(_99c,function(_9a4){if(_9a4.__popups&&_9a4.__popups.length>0){if(_9a4.__deferredsPos||_9a4.__deferredsPos===0){var _9a5=_9a3[_9a4.__deferredsPos][1];_9a1=_9a1.concat(EAU._createSelectionFeatureLayers(_9a4,_9a5.layers,_99d,map));delete _9a4.__deferredsPos;}else{_9a1=_9a1.concat(EAU._createSelectionFeatureLayers(_9a4,null,_99d,map));}}});map.addLayers(_9a1);});}else{dojo.forEach(_99c,function(_9a6){if(_9a6.__popups&&_9a6.__popups.length>0){_9a1=_9a1.concat(EAU._createSelectionFeatureLayers(_9a6,null,_99d,map));}});map.addLayers(_9a1);}};EAU._createSelectionFeatureLayers=function(_9a7,_9a8,_9a9,map){var url=_9a7.url;var _9aa=_9a7.__popups;var ids=_9a7.__popupIds;var urls=_9a7.__popupUrls;var _9ab=_9a7.__resourceInfo;var _9ac=[];dojo.forEach(_9aa,function(_9ad,_9ae){var i,_9af=null;if(_9a8){for(i=0;i<_9a8.length;i++){if(_9a8[i].id===ids[_9ae]){_9af=_9a8[i];break;}}}var _9b0=url+"/"+ids[_9ae];if(urls[_9ae].length){_9b0=urls[_9ae];}var _9b1=new esri.layers.FeatureLayer(EAU._checkUrl(_9b0),{id:_9a7.id+"_"+ids[_9ae],outFields:["*"],mode:esri.layers.FeatureLayer.MODE_SELECTION,infoTemplate:_9ad&&new _9a9(_9ad),drawMode:false,visible:_9a7.visible,resourceInfo:_9af,autoGeneralize:true});if(_9b1.loaded){EAU._updateLayerScaleInfo(_9ab.layers,_9b1);}else{dojo.connect(_9b1,"onLoad",function(_9b2){EAU._updateLayerScaleInfo(_9ab.layers,_9b2);});}_9ac.push(_9b1);});if(_9ac.length>0){var _9b3=function(_9b4,_9b5){dojo.forEach(_9b4,function(_9b6){if(_9b5){_9b6.show();}else{_9b6.hide();}});};dojo.connect(_9a7,"onVisibilityChange",dojo.hitch(this,_9b3,_9ac));var _9b7=function(_9b8,_9b9,_9ba){if(_9b8.id===_9ba.id){dojo.forEach(_9b9,function(_9bb){map.removeLayer(_9bb);});}};dojo.connect(map,"onLayerRemove",dojo.hitch(this,_9b7,_9a7,_9ac));}delete _9a7.__popups;delete _9a7.__popupIds;delete _9a7.__popupUrls;delete _9a7.__resourceInfo;return _9ac;};EAU._getServiceInfo=function(url,_9bc){var url2=EAU._checkUrl(url);return esri.request({url:url2,content:{f:"json"},callbackParamName:"callback",error:function(_9bd,io){if(_9bd.message){_9bd.message+=" [url:"+url2+"]";}else{_9bd.message="[url:"+url2+"]";}_9bc.push(_9bd);esri.config.defaults.io.errorHandler(_9bd,io);}});};EAU._getLayersInfo=function(_9be){return esri.request({url:EAU._checkUrl(_9be.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}});};EAU._initLayer=function(_9bf,_9c0,_9c1,_9c2){var _9c3,_9c4=_9c1._clazz;if(_9bf.type==="OpenStreetMap"){_9c3=new esri.layers.OpenStreetMapLayer({id:_9bf.id,opacity:_9bf.opacity,visible:(_9bf.visibility!==null&&_9bf.visibility!==undefined)?_9bf.visibility:true});}else{if(_9bf.type==="WMS"){var _9c5=[];var _9c6=[];dojo.forEach(_9bf.layers,function(_9c7){_9c6.push(new esri.layers.WMSLayerInfo({name:_9c7.name,title:_9c7.title,legendURL:_9c7.legendURL}));_9c5.push(_9c7.name);},this);if(_9bf.visibleLayers){_9c5=_9bf.visibleLayers;}var _9c8=new esri.geometry.Extent(_9bf.extent[0][0],_9bf.extent[0][1],_9bf.extent[1][0],_9bf.extent[1][1],new esri.SpatialReference({wkid:4326}));var _9c9={extent:_9c8,layerInfos:_9c6,version:_9bf.version,maxWidth:_9bf.maxWidth,maxHeight:_9bf.maxHeight,getMapUrl:_9bf.mapUrl,spatialReferences:_9bf.spatialReferences,title:_9bf.title,copyright:_9bf.copyright};_9c3=new esri.layers.WMSLayer(_9bf.url,{id:_9bf.id,visibleLayers:_9c5,format:"png",transparent:_9bf.baseMapLayer?false:true,opacity:_9bf.opacity,visible:(_9bf.visibility!==null)?_9bf.visibility:true,resourceInfo:_9c9});_9c3.spatialReference.wkid=_9c9.spatialReferences[0];}else{if(_9bf.type==="KML"){_9c3=new esri.layers.KMLLayer(_9bf.url,{id:_9bf.id,visible:(_9bf.visibility!==null)?_9bf.visibility:true,outSR:_9c2});dojo.connect(_9c3,"onLoad",function(){var _9ca=function(_9cb){dojo.forEach(_9cb,function(_9cc){if(_9cc.declaredClass==="esri.layers.FeatureLayer"||_9cc.declaredClass==="esri.layers.MapImageLayer"){_9cc.setOpacity(_9bf.opacity);}else{if(_9cc.declaredClass==="esri.layers.KMLLayer"){if(_9cc.loaded){_9ca(_9cc.getLayers());}else{dojo.connect(_9cc,"onLoad",dojo.hitch(this,function(lyr){_9ca(lyr.getLayers());}));}}}});};if(_9bf.opacity||_9bf.opacity===0){_9ca(_9c3.getLayers());}if(_9bf.visibleFolders){dojo.forEach(_9c3.folders,function(_9cd){if(dojo.indexOf(_9bf.visibleFolders,_9cd.id)>-1){_9c3.setFolderVisibility(_9cd,true);}else{_9c3.setFolderVisibility(_9cd,false);}},this);}});}else{if(_9bf.type=="CSV"&&_9bf.url){_9c3=new esri.layers.FeatureLayer(_9bf.featureCollection,{infoTemplate:new esri.dijit.PopupTemplate(_9bf.popupInfo?_9bf.popupInfo:esri.arcgis.csv.generateDefaultPopupInfo(_9bf.featureCollection)),id:_9bf.id?_9bf.id:null,outFields:["*"],visible:(_9bf.visibility!==null)?_9bf.visibility:true,opacity:_9bf.opacity,autoGeneralize:true});}else{if(_9bf.layerDefinition&&!_9bf.url){var _9ce=dojo.fromJson(dojo.toJson(_9bf));delete _9ce.id;delete _9ce.opacity;delete _9ce.visibility;_9c3=new esri.layers.FeatureLayer(_9ce,{id:_9bf.id,opacity:_9bf.opacity,visible:_9bf.visibility,outFields:["*"],infoTemplate:_9ce.popupInfo&&new _9c4(_9ce.popupInfo),autoGeneralize:true});}else{if(_9bf.type==="BingMapsAerial"||_9bf.type==="BingMapsRoad"||_9bf.type==="BingMapsHybrid"){var _9cf=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS;if(_9bf.type==="BingMapsAerial"){_9cf=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL;}else{if(_9bf.type==="BingMapsRoad"){_9cf=esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD;}}_9c3=new esri.virtualearth.VETiledLayer({bingMapsKey:_9c1.bingMapsKey,mapStyle:_9cf,opacity:_9bf.opacity,id:_9bf.id});}else{if(_9bf.resourceInfo&&_9bf.resourceInfo.mapName){if(_9bf.resourceInfo.singleFusedMapCache===true){if(!_9bf.baseMapLayer){if(EAU._sameSpatialReferenceAsBasemap(_9bf,_9c0)){if(EAU._sameTilingSchemeAsBasemap(_9bf,_9c0)){_9c3=EAU._loadAsCached(_9bf);}else{_9c3=EAU._loadAsDynamic(_9bf);}}else{_9c3=EAU._loadAsDynamic(_9bf);}}else{_9c3=EAU._loadAsCached(_9bf);}}else{_9c3=EAU._loadAsDynamic(_9bf);}}else{if(_9bf.resourceInfo&&_9bf.resourceInfo.pixelSizeX){var _9d0=new esri.layers.ImageServiceParameters();_9d0.bandIds=_9bf.bandIds;if(!_9bf.bandIds&&_9bf.resourceInfo.bandCount&&parseInt(_9bf.resourceInfo.bandCount,10)>3){_9d0.bandIds=[0,1,2];}_9c3=new esri.layers.ArcGISImageServiceLayer(EAU._checkUrl(_9bf.url),{resourceInfo:_9bf.resourceInfo,opacity:_9bf.opacity,visible:_9bf.visibility,id:_9bf.id,imageServiceParameters:_9d0,minScale:_9bf.minScale,maxScale:_9bf.maxScale});}else{if(_9bf.resourceInfo&&_9bf.resourceInfo.type==="Feature Layer"){_9c3=new esri.layers.FeatureLayer(EAU._checkUrl(_9bf.url),{resourceInfo:_9bf.resourceInfo,opacity:_9bf.opacity,visible:_9bf.visibility,id:_9bf.id,mode:esri.isDefined(_9bf.mode)?_9bf.mode:esri.layers.FeatureLayer.MODE_ONDEMAND,outFields:["*"],infoTemplate:_9bf.popupInfo&&new _9c4(_9bf.popupInfo),autoGeneralize:true});if(_9bf.layerDefinition){if(_9bf.layerDefinition.drawingInfo&&_9bf.layerDefinition.drawingInfo.renderer){var _9d1=esri.renderer.fromJson(_9bf.layerDefinition.drawingInfo.renderer);_9d1.isMaxInclusive=true;_9c3.setRenderer(_9d1);}if(_9bf.layerDefinition.definitionExpression){_9c3.setDefinitionExpression(_9bf.layerDefinition.definitionExpression);}if(esri.isDefined(_9bf.layerDefinition.minScale)){_9c3.setMinScale(_9bf.layerDefinition.minScale);}if(esri.isDefined(_9bf.layerDefinition.maxScale)){_9c3.setMaxScale(_9bf.layerDefinition.maxScale);}}}}}}}}}}}if(_9c3){_9c3.arcgisProps={title:_9bf.title};}return _9c3;};EAU._loadAsCached=function(_9d2){var _9d3=[];if(!_9d2.displayLevels){_9d3=dojo.map(_9d2.resourceInfo.tileInfo.lods,function(lod){return lod.level;});}var _9d4=new esri.layers.ArcGISTiledMapServiceLayer(EAU._checkUrl(_9d2.url),{resourceInfo:_9d2.resourceInfo,opacity:_9d2.opacity,visible:_9d2.visibility,displayLevels:_9d2.displayLevels||_9d3,id:_9d2.id,minScale:_9d2.minScale,maxScale:_9d2.maxScale});EAU._processPopups(_9d4,_9d2);return _9d4;};EAU._loadAsDynamic=function(_9d5){var _9d6=new esri.layers.ImageParameters();_9d6.format="png24";if(_9d5.resourceInfo&&_9d5.resourceInfo.supportedImageFormatTypes&&_9d5.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")>-1){_9d6.format="png32";}var _9d7=new esri.layers.ArcGISDynamicMapServiceLayer(EAU._checkUrl(_9d5.url),{resourceInfo:_9d5.resourceInfo,opacity:_9d5.opacity,visible:_9d5.visibility,id:_9d5.id,imageParameters:_9d6,minScale:_9d5.minScale,maxScale:_9d5.maxScale});if(!_9d5.visibleLayers){var _9d8="";var _9d9=_9d7.layerInfos;dojo.forEach(_9d9,function(_9da){if(_9da.defaultVisibility){_9d8+=(_9d8.length>0?",":"")+_9da.id;}});_9d5.visibleLayers=_9d8;}var _9db=EAU._getVisibleFeatureLayers(_9d7.layerInfos,_9d5.visibleLayers);_9d7.setVisibleLayers(_9db);if(_9d5.layers&&_9d5.layers.length>0){var _9dc=[];dojo.forEach(_9d5.layers,function(_9dd){if(_9dd.layerDefinition&&_9dd.layerDefinition.definitionExpression){_9dc[_9dd.id]=_9dd.layerDefinition.definitionExpression;}},this);if(_9dc.length>0){_9d7.setLayerDefinitions(_9dc);}}EAU._processPopups(_9d7,_9d5);return _9d7;};EAU._processPopups=function(_9de,_9df){var _9e0=_9de.layerInfos;var _9e1=_9df.layers;if(_9e1&&_9e0){var _9e2=[],ids=[],urls=[];dojo.forEach(_9e0,function(_9e3){var id=_9e3.id,i;if(!_9e3.subLayerIds&&dojo.indexOf(_9de.visibleLayers,id)!==-1){for(i=0;i<_9e1.length;i++){var _9e4=_9e1[i];if(_9e4.id===id){ids.push(id);_9e2.push(_9e4.popupInfo);urls.push(_9e4.layerUrl||"");break;}}}});if(_9e2.length){_9de.__popups=_9e2;_9de.__popupIds=ids;_9de.__popupUrls=urls;_9de.__resourceInfo=_9df.resourceInfo;}}};EAU._onLayersAddResult=function(_9e5){dojo.forEach(_9e5,function(_9e6){var _9e7=_9e6.layer;if(_9e7.toJson){var json=_9e7.toJson();if(json.featureSet&&_9e7.name.indexOf("Text")>-1){dojo.forEach(json.featureSet.features,function(_9e8,idx){if(_9e8.attributes.TEXT){var _9e9=_9e7.graphics[idx];_9e9.symbol.setText(_9e8.attributes.TEXT);if(_9e8.symbol.horizontalAlignment){_9e9.symbol.align=_9e8.symbol.horizontalAlignment;}_9e9.setSymbol(_9e9.symbol);_9e9.setAttributes(_9e8.attributes);}},this);}}});};EAU._sameSpatialReferenceAsBasemap=function(_9ea,_9eb){var _9ec=[102113,102100,3857];var sp1=_9eb[0].layerObject.fullExtent.spatialReference;var sp2=new esri.SpatialReference(_9ea.resourceInfo.fullExtent.spatialReference);if(dojo.toJson(sp1.toJson())===dojo.toJson(sp2.toJson())){return true;}else{if(dojo.some(_9ec,function(wkid){return wkid===sp2.wkid;})&&dojo.some(_9ec,function(wkid){return wkid===sp1.wkid;})){return true;}}return false;};EAU._sameTilingSchemeAsBasemap=function(_9ed,_9ee){if(!_9ee[0].layerObject.tileInfo){return false;}var _9ef=[];dojo.forEach(_9ee,function(_9f0){if(_9f0.baseMapLayer){if(_9f0.layerObject.tileInfo){_9ef=_9ef.concat(dojo.map(_9f0.layerObject.tileInfo.lods,function(lod){return lod.scale;}));}}});var _9f1=dojo.some(_9ed.resourceInfo.tileInfo.lods,function(lod){return dojo.some(_9ef,function(_9f2){return _9f2===lod.scale;});});return _9f1;};EAU._showPopup=function(evt){var map=this,_9f3=map.infoWindow,_9f4=evt.graphic;if(!map.loaded){return;}_9f3.hide();_9f3.clearFeatures();var _9f5=[];dojo.forEach(map.graphicsLayerIds,function(_9f6){var _9f7=map.getLayer(_9f6);if(_9f7&&_9f7.declaredClass.indexOf("FeatureLayer")!==-1&&_9f7.loaded&&_9f7.visible){_9f7.clearSelection();if(_9f7.infoTemplate&&!_9f7.suspended){_9f5.push(_9f7);}}});_9f4=(_9f4&&_9f4._getEffInfoTemplate())?_9f4:null;if(!_9f5.length&&!_9f4){return;}var _9f8=EAU._calculateClickTolerance(_9f5);var _9f9=evt.screenPoint,_9fa=map.toMap(new esri.geometry.Point(_9f9.x-_9f8,_9f9.y+_9f8)),_9fb=map.toMap(new esri.geometry.Point(_9f9.x+_9f8,_9f9.y-_9f8)),_9fc=new esri.geometry.Extent(_9fa.x,_9fa.y,_9fb.x,_9fb.y,map.spatialReference);var _9fd=new esri.tasks.Query();_9fd.geometry=_9fc;_9fd.timeExtent=map.timeExtent;var _9fe=dojo.map(_9f5,function(_9ff){var dfd=_9ff.selectFeatures(_9fd);dfd.addCallback(function(){var _a00=_9ff.getSelectedFeatures();return _a00;});return dfd;});if(_9f4){var dfd=new dojo.Deferred();dfd.callback([_9f4]);_9fe.splice(0,0,dfd);}var _a01=dojo.some(_9fe,function(dfd){return dfd.fired===-1;});if(!_a01){var _a02=_9f4?1:0;dojo.forEach(_9f5,function(_a03){_a02=_a02+_a03.getSelectedFeatures().length;});if(!_a02){return;}}_9f3.setFeatures(_9fe);_9f3.show(evt.mapPoint,{closestFirst:true});};EAU._calculateClickTolerance=function(_a04){var _a05=6;dojo.forEach(_a04,function(_a06){var _a07=_a06.renderer;if(_a07.declaredClass==="esri.renderer.SimpleRenderer"){var _a08=_a07.symbol;if(_a08&&_a08.xoffset){_a05=Math.max(_a05,Math.abs(_a08.xoffset));}if(_a08&&_a08.yoffset){_a05=Math.max(_a05,Math.abs(_a08.yoffset));}}else{if(_a07.declaredClass==="esri.renderer.UniqueValueRenderer"||_a07.declaredClass==="esri.renderer.ClassBreaksRenderer"){dojo.forEach(_a07.infos,function(info){var _a09=info.symbol;if(_a09&&_a09.xoffset){_a05=Math.max(_a05,Math.abs(_a09.xoffset));}if(_a09&&_a09.yoffset){_a05=Math.max(_a05,Math.abs(_a09.yoffset));}});}}});return _a05;};EAU._getVisibleFeatureLayers=function(_a0a,_a0b){if(!_a0a||!_a0b||_a0b.length===0){return [];}var _a0c=","+_a0b+",";var _a0d=[];var _a0e="";var k,_a0f=",";for(k=0;k<_a0a.length;k++){if(_a0a[k].subLayerIds!==null){if(_a0c.indexOf(","+_a0a[k].id+",")===-1||_a0f.indexOf(","+_a0a[k].id+",")>-1){_a0f+=_a0a[k].subLayerIds.toString()+",";}}else{if(_a0c.indexOf(","+_a0a[k].id+",")>-1&&_a0f.indexOf(","+_a0a[k].id+",")===-1){_a0d.push(_a0a[k].id);_a0e=",";}}}return _a0d;};EAU._updateLayerScaleInfo=function(_a10,_a11){if(_a11.version<=10.1&&_a10){var i,id=parseInt(_a11.url.substring(_a11.url.lastIndexOf("/")+1,_a11.url.length));for(i=_a10.length-1;i>=0;i--){if(_a10[i].id==id){if(_a11.minScale==0&&_a10[i].minScale>0){_a11.minScale=_a10[i].minScale;}else{if(_a11.minScale>0&&_a10[i].minScale==0){_a11.minScale=_a11.minScale;}else{if(_a11.minScale>0&&_a10[i].minScale>0){_a11.minScale=Math.min(_a11.minScale,_a10[i].minScale);}}}_a11.maxScale=Math.max(_a11.maxScale||0,_a10[i].maxScale||0);if(_a10[i].parentLayerId>-1){id=_a10[i].parentLayerId;}else{break;}}}}};EAU._checkUrl=function(url){if(location.protocol==="https:"&&(EAU._isHostedService(url)||EAU._isAgolService(url))){url=url.replace("http:","https:");}return url;};EAU._isHostedService=function(url){if(!url){return false;}var _a12=".arcgis.com/";var _a13=(new dojo._Url(EAU.arcgisUrl)).authority;return (url.indexOf(_a12)!==-1||url.indexOf(_a13)!==-1);};EAU._isAgolService=function(url){if(!url){return false;}return (url.indexOf("/services.arcgisonline.com/")!==-1||url.indexOf("/server.arcgisonline.com/")!==-1);};}());});