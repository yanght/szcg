/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","esri/dijit/editing/tools/ToolBase":function(){define(["dijit","dojo","dojox","dojo/require!esri/toolbars/draw"],function(_1,_2,_3){_2.provide("esri.dijit.editing.tools.ToolBase");_2.require("esri.toolbars.draw");_2.declare("esri.dijit.editing.tools.ToolBase",null,{_enabled:true,showLabel:false,constructor:function(_4,_5){_4=_4||{};_2.mixin(this,_4);this.label=this._label?esri.bundle.widgets.editor.tools[this._label]:"";this._settings=_4.settings;this._toolbar=_4.settings.drawToolbar;this._editToolbar=_4.settings.editToolbar;this._initializeTool();},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments);},destroy:function(){},activate:function(_6){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}if(!this._enabled){return;}this._checked=true;this._layer=_6;if(this._toolbar&&this._drawType){this._toolbar.activate(this._drawType);}},deactivate:function(){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}this.setChecked(false);this._updateUI();},setEnabled:function(_7){this._enabled=_7;this._updateUI();},setChecked:function(_8){this._checked=_8;},enable:function(_9){this._updateUI();},isEnabled:function(){return _enabled;},getToolName:function(){return this._toolName;},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon);}});});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_a,_b,_c,_d,_e,_f,_10,_11,_12){var _13=_f("dojox.grid.DataGrid",_10,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _11(this);},get:function(_14,_15){if(_15&&this.field=="_item"&&!this.fields){return _15;}else{if(_15&&this.fields){var ret=[];var s=this.grid.store;_b.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_15,f));});return ret;}else{if(!_15&&typeof _14==="string"){return this.inherited(arguments);}}}return (!_15?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_15:this.grid.store.getValue(_15,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _16=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_16=true;}if(!this.updating){this.beginUpdate();_16=true;}if(_16){var _17=this;this._endUpdateDelay=setTimeout(function(){delete _17._endUpdateDelay;_17.endUpdate();},this.updateDelay);}}},_onSet:function(_18,_19,_1a,_1b){this._checkUpdateStatus();var idx=this.getItemIndex(_18);if(idx>-1){this.updateRow(idx);}},_createItem:function(_1c,_1d){var _1e=this._hasIdentity?this.store.getIdentity(_1c):_d.toJson(this.query)+":idx:"+_1d+":sort:"+_d.toJson(this.getSortProps());var o=this._by_idty[_1e]={idty:_1e,item:_1c};return o;},_addItem:function(_1f,_20,_21){this._by_idx[_20]=this._createItem(_1f,_20);if(!_21){this.updateRow(_20);}},_onNew:function(_22,_23){this._checkUpdateStatus();var _24=this.get("rowCount");this._addingItem=true;this.updateRowCount(_24+1);this._addingItem=false;this._addItem(_22,_24);this.showMessage();},_onDelete:function(_25){this._checkUpdateStatus();var idx=this._getItemIndex(_25,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_26,_27,_28){if(this._requestsPending(0)){return;}this._setQuery(_27,_28);this._setStore(_26);this._refresh(true);},setQuery:function(_29,_2a){if(this._requestsPending(0)){return;}this._setQuery(_29,_2a);this._refresh(true);},setItems:function(_2b){this.items=_2b;this._setStore(this.store);this._refresh(true);},_setQuery:function(_2c,_2d){this.query=_2c;this.queryOptions=_2d||this.queryOptions;},_setStore:function(_2e){if(this.store&&this._store_connects){_b.forEach(this._store_connects,this.disconnect,this);}this.store=_2e;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(_2f,req){if(!this.scroller){return;}if(this.rowCount!=_2f){if(req.isRender){this.scroller.init(_2f,this.keepRows,this.rowsPerPage);this.rowCount=_2f;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(_2f);}}if(!_2f){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_30,req){if(!this.scroller){return;}if(_30&&_30.length>0){_b.forEach(_30,function(_31,idx){this._addItem(_31,req.start+idx,true);},this);this.updateRows(req.start,_30.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(_e("ie")){_12.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_32,_33){_32=_32||0;if(this.store&&!this._pending_requests[_32]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_32]=true;try{if(this.items){var _34=this.items;var _35=this.store;this.rowsPerPage=_34.length;var req={start:_32,count:this.rowsPerPage,isRender:_33};this._onFetchBegin(_34.length,req);var _36=0;_b.forEach(_34,function(i){if(!_35.isItemLoaded(i)){_36++;}});if(_36===0){this._onFetchComplete(_34,req);}else{var _37=function(_38){_36--;if(_36===0){this._onFetchComplete(_34,req);}};_b.forEach(_34,function(i){if(!_35.isItemLoaded(i)){_35.loadItem({item:i,onItem:_37,scope:this});}},this);}}else{this.store.fetch({start:_32,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_33,onBegin:_c.hitch(this,"_onFetchBegin"),onComplete:_c.hitch(this,"_onFetchComplete"),onError:_c.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_32,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var _39=this._by_idx[idx];if(!_39||(_39&&!_39.item)){this._preparePage(idx);return null;}return _39.item;},getItemIndex:function(_3a){return this._getItemIndex(_3a,false);},_getItemIndex:function(_3b,_3c){if(!_3c&&!this.store.isItem(_3b)){return -1;}var _3d=this._hasIdentity?this.store.getIdentity(_3b):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((_3d&&d.idty==_3d)||(d.item===_3b))){return i;}}return -1;},filter:function(_3e,_3f){this.query=_3e;if(_3f){this._clearData();}this._fetch();},_getItemAttr:function(idx,_40){var _41=this.getItem(idx);return (!_41?this.fetchText:this.store.getValue(_41,_40));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_42){return this._pending_requests[_42];},_rowToPage:function(_43){return (this.rowsPerPage?Math.floor(_43/this.rowsPerPage):_43);},_pageToRow:function(_44){return (this.rowsPerPage?this.rowsPerPage*_44:_44);},_preparePage:function(_45){if((_45<this._bop||_45>=this._eop)&&!this._addingItem){var _46=this._rowToPage(_45);this._needPage(_46);this._bop=_46*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_47){if(!this._pages[_47]){this._pages[_47]=true;this._requestPage(_47);}},_requestPage:function(_48){var row=this._pageToRow(_48);var _49=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_49>0){this._requests++;if(!this._requestsPending(row)){setTimeout(_c.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_4a){return _4a.field;},_refresh:function(_4b){this._clearData();this._fetch(0,_4b);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var _4c=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof _4c=="undefined"){_4c=si;}else{_4c=si?!_4c:_4c;}return [{attribute:c.field,descending:_4c}];}},styleRowState:function(_4d){if(this.store&&this.store.getState){var _4e=this.store.getState(_4d.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_4e[s]){c=" dojoxGridRow-"+s;break;}}_4d.customClasses+=c;}},onStyleRow:function(_4f){this.styleRowState(_4f);this.inherited(arguments);},canEdit:function(_50,_51){return this._canEdit;},_copyAttr:function(idx,_52){var row={};var _53={};var src=this.getItem(idx);return this.store.getValue(src,_52);},doStartEdit:function(_54,_55){if(!this._cache[_55]){this._cache[_55]=this._copyAttr(_55,_54.field);}this.onStartEdit(_54,_55);},doApplyCellEdit:function(_56,_57,_58){this.store.fetchItemByIdentity({identity:this._by_idx[_57].idty,onItem:_c.hitch(this,function(_59){var _5a=this.store.getValue(_59,_58);if(typeof _5a=="number"){_56=isNaN(_56)?_56:parseFloat(_56);}else{if(typeof _5a=="boolean"){_56=_56=="true"?true:_56=="false"?false:_56;}else{if(_5a instanceof Date){var _5b=new Date(_56);_56=isNaN(_5b.getTime())?_56:_5b;}}}this.store.setValue(_59,_58,_56);this.onApplyCellEdit(_56,_57,_58);})});},doCancelEdit:function(_5c){var _5d=this._cache[_5c];if(_5d){this.updateRow(_5c);delete this._cache[_5c];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_5e,_5f){var _60=this._cache[_5e];this.onApplyEdit(_5e);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=_c.hitch(this,function(_61){if(_61.length){_b.forEach(_61,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_13.cell_markupFactory=function(_62,_63,_64){var _65=_c.trim(_12.attr(_63,"field")||"");if(_65){_64.field=_65;}_64.field=_64.field||_64.name;var _66=_c.trim(_12.attr(_63,"fields")||"");if(_66){_64.fields=_66.split(",");}if(_62){_62(_63,_64);}};_13.markupFactory=function(_67,_68,_69,_6a){return _10.markupFactory(_67,_68,_69,_c.partial(_13.cell_markupFactory,_6a));};return _13;});},"esri/dijit/editing/SelectionHelper":function(){define("esri/dijit/editing/SelectionHelper",["dijit","dojo","dojox"],function(_6b,_6c,_6d){_6c.provide("esri.dijit.editing.SelectionHelper");_6c.declare("esri.dijit.editing.SelectionHelper",null,{constructor:function(_6e){this._settings=_6e||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers);},destroy:function(){var _6f;for(_6f in this._sConnects){if(this._sConnects.hasOwnProperty(_6f)){_6c.disconnect(this._sConnects[_6f]);}}},selectFeatures:function(_70,_71,_72,_73){if(_72===esri.layers.FeatureLayer.SELECTION_NEW){this._resetMapServiceInfos();this.getSelection(_70);}var _74=[];_6c.forEach(_70,function(_75){if(_75.visible===true&&_75._isMapAtVisibleScale()===true){var _76=_72;if(_75._isSelOnly&&_76===esri.layers.FeatureLayer.SELECTION_NEW){_76=esri.layers.FeatureLayer.SELECTION_ADD;}_74.push(_75.selectFeatures(_71,_76));}});var _77=new _6c.DeferredList(_74);_77.addCallback(_6c.hitch(this,function(_78){var _79=[];_6c.forEach(_78,function(set,idx){_6c.forEach(set[1],function(_7a){var _7b=_7a.attributes[_70[idx].objectIdField];_7a=_70[idx]._mode._getFeature(_7b)||null;if(_7a){_79.push(_7a);}},this);},this);if(!this._mapServiceCount){_73(_79);return;}var _7c=_72===esri.layers.FeatureLayer.SELECTION_SUBTRACT;if(_7c){this._resetMapServiceInfos();this._createLayerDefs(this._getLayerInfosFromSelection(_70));}else{this._createLayerDefs(this._getLayerInfosFromFeatures(_79));}this._updateLayerDefs(this._mapServiceInfos,false,!((_79&&_79.length)||_7c),_6c.hitch(this,_73,_79));}));},selectFeaturesByGeometry:function(_7d,_7e,_7f,_80){var _81=_7e;if(_7e.declaredClass.indexOf("Extent")!==-1){if(_7e.xmax===_7e.xmin&&_7e.ymax===_7e.ymin){_81=new esri.geometry.Point(_7e.xmax,_7e.ymax,_7e.spatialReference);}}_81=(_81.declaredClass.indexOf("Point")!==-1)?this._extentFromPoint(_81):_81;var _82=new esri.tasks.Query();_82.geometry=_81;this.selectFeatures(_7d,_82,_7f,_80);},clearSelection:function(_83){var _84=this._nonSelOnlyLayers;_6c.forEach(_84,"if (item.clearSelection){ item.clearSelection(); }");if(!this._mapServiceCount){return;}this._resetMapServiceInfos();var _85=this._getLayerInfosFromSelection(this._settings.layers);var _86=_6c.some(_85,"return item.oids && item.oids.length");if(_86){this._createLayerDefs(_85);this._updateLayerDefs(this._mapServiceInfos,true,_83||false);}},findMapService:function(_87){var map=this._map,_88=map.layerIds,_89=(_87&&_87._url)?_87._url.path.toLowerCase():"",_8a,_8b,_8c;for(_8b in _88){if(_88.hasOwnProperty(_8b)){_8a=map.getLayer(_88[_8b]);_8c=_8a._url?_8a._url.path.toLowerCase().replace("mapserver","featureserver"):"";if(_89.substr(0,_8c.length)===_8c&&_8a.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"){return _8a;}}}},getSelection:function(_8d){var _8e=[];_6c.forEach(_8d,function(_8f){if(_8f._isSelOnly){_8e.push(this._createLayerInfo(_8f));}},this);_6c.forEach(_8e,function(_90){var _91=this._createMapServiceInfo(this.findMapService(_90.layer));if(_91){_91.layerInfos[_90.layer.layerId]=_90;}},this);},_initMapServiceInfos:function(_92){this._nonSelOnlyLayers=[];this._mapServiceInfos=[];_6c.forEach(_92,function(_93){var _94=this.findMapService(_93);if(_94){this._mapServiceCount++;this._createMapServiceInfo(_94);if(_94){_94.setDisableClientCaching(true);}}else{this._nonSelOnlyLayers.push(_93);}},this);},_createMapServiceInfo:function(_95){if(!_95){return null;}var _96=this._mapServiceInfos;var _97=_96[_95.id];if(!_97){_97=_96[_95.id]={mapService:_95,layerInfos:[],layerDefs:_6c.mixin([],_95.layerDefinitions||[]),origLayerDefs:_6c.mixin([],_95.layerDefinitions||[])};}return _97;},_resetMapServiceInfo:function(_98){_6c.forEach(_98.layerInfos,this._resetLayerInfo);_98.layerDefs=_6c.mixin([],_98.origLayerDefs||[]);},_resetMapServiceInfos:function(){var _99=this._mapServiceInfos,_9a;for(_9a in _99){if(_99.hasOwnProperty(_9a)){this._resetMapServiceInfo(_99[_9a]);}}},_createLayerInfo:function(_9b,_9c){var _9d=_9b.objectIdField;var _9e=_9c?[]:_9b.getSelectedFeatures();return {layer:_9b,selectedFeatures:_9e||[],oids:_6c.map(_9e,function(_9f){return _9f.attributes[_9d];})};},_resetLayerInfo:function(_a0){if(!_a0){return;}_a0.selectedFeatures=[];_a0.oids=[];},_updateLayerDefs:function(_a1,_a2,_a3,_a4){var _a5;for(_a5 in _a1){if(_a1.hasOwnProperty(_a5)){var _a6=_a1[_a5];var _a7=_a6.mapService;var _a8=_a6.layerDefs=(_a2?_6c.mixin([],_a6.origLayerDefs||[]):_a6.layerDefs);if(_a8){if(!_a3){this._sConnects[_a7.id]=(_6c.connect(_a7,"onUpdateEnd",_6c.hitch(this,"_onMapServiceUpdate",_a6,_a2,_a4)));}else{if(_a4){_a4();}}_a7.setLayerDefinitions(_a8,_a3||false);}else{if(_a4){_a4();}}}}},_onMapServiceUpdate:function(_a9,_aa,_ab){_6c.disconnect(this._sConnects[_a9.mapService.id]);_6c.forEach(_a9.layerInfos,function(_ac){if(_aa){if(_ac){_ac.layer.clearSelection();}}else{var _ad=new esri.tasks.Query();_ad.objectIds=_ac?_ac.oids:[];if(_ad.objectIds.length){_ac.layer.selectFeatures(_ad,esri.layers.FeatureLayer.SELECTION_SUBTRACT);}}},this);if(_aa){this._resetMapServiceInfo(_a9);}if(_ab){_ab();}},_createLayerDefs:function(_ae){_6c.forEach(_ae,function(_af){var _b0=_af.layer;var _b1=this._createMapServiceInfo(this.findMapService(_af.layer));if(!_b1){return;}var _b2=_b1.mapService;var _b3=_b1.layerDefs;var _b4=_b0.objectIdField;var _b5=_b0.layerId;var _b6="(\""+_b4+"\" NOT IN (";var _b7=_af.oids;if(_b7&&_b7.length){_6c.forEach(_af.oids,function(oid,idx){_b7=true;if(idx){_b6+=",";}_b6+="'"+oid+"'";});_b6+="))";if(_b3.length&&(_b3[_b5]&&_b3[_b5].length)){_b3[_b5]+=" AND"+_b6;}else{_b3[_b5]=_b6;}}},this);},_getLayerInfosFromFeatures:function(_b8){var _b9=[];_6c.forEach(_b8,function(_ba){var _bb=_ba.getLayer();if(_bb&&_bb._isSelOnly){if(!_b9[_bb.id]){_b9[_bb.id]=this._createLayerInfo(_bb,true);}_b9[_bb.id].selectedFeatures.push(_ba);_b9[_bb.id].oids.push(_ba.attributes[_bb.objectIdField]);}},this);var _bc=[],_bd;for(_bd in _b9){if(_b9.hasOwnProperty(_bd)){_bc.push(_b9[_bd]);}}return _bc;},_getLayerInfosFromSelection:function(_be){var _bf=[];_6c.forEach(_be,function(_c0){if(_c0._isSelOnly){_bf.push(this._createLayerInfo(_c0,false));}},this);return _bf;},_extentFromPoint:function(_c1){var _c2=this._tolerance;var map=this._map;var _c3=map.toScreen(_c1);var _c4=new esri.geometry.ScreenPoint(_c3.x-_c2,_c3.y+_c2);var _c5=new esri.geometry.ScreenPoint(_c3.x+_c2,_c3.y-_c2);var _c6=map.toMap(_c4);var _c7=map.toMap(_c5);return new esri.geometry.Extent(_c6.x,_c6.y,_c7.x,_c7.y,map.spatialReference);}});});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_c8,_c9,_ca,_cb,_cc,has,_cd,_ce,_cf){return _ca("dojox.grid._FocusManager",null,{constructor:function(_d0){this.grid=_d0;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_cb.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_cb.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_cb.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_cb.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_cb.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_cb.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_cb.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_cb.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_cb.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_c8.forEach(this._connects,_cb.disconnect);_c8.forEach(this._headerConnects,_cb.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_d1,_d2){return (this.cell==_d1)&&(this.rowIndex==_d2);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _c8.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_d3){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){_cf.toggleClass(n,this.focusClass,_d3);if(_d3){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){_ce.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){_cf.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}_ce.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_c8.forEach(this._headerConnects,_cb.disconnect);this._headerConnects=[];var _d4=this._findHeaderCells();for(var i=0;i<_d4.length;i++){this._headerConnects.push(_cb.connect(_d4[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_cb.connect(_d4[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _d5=_cd("th",this.grid.viewsHeaderNode);var _d6=[];for(var i=0;i<_d5.length;i++){var _d7=_d5[i];var _d8=_cf.hasAttr(_d7,"tabIndex");var _d9=_cf.attr(_d7,"tabIndex");if(_d8&&_d9<0){_d6.push(_d7);}}return _d6;},_setActiveColHeader:function(_da,_db,_dc){this.grid.domNode.setAttribute("aria-activedescendant",_da.id);if(_dc!=null&&_dc>=0&&_dc!=_db){_cf.toggleClass(this._findHeaderCells()[_dc],this.focusClass,false);}_cf.toggleClass(_da,this.focusClass,true);this._colHeadNode=_da;this._colHeadFocusIdx=_db;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var _dd=(this.cell?this._scrollInfo(this.cell):null);if(!_dd||!_dd.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(_dd.n&&_dd.sr){if(_dd.n.offsetLeft+_dd.n.offsetWidth>_dd.sr.l+_dd.sr.w){_dd.s.scrollLeft=_dd.n.offsetLeft+_dd.n.offsetWidth-_dd.sr.w;}else{if(_dd.n.offsetLeft<_dd.sr.l){_dd.s.scrollLeft=_dd.n.offsetLeft;}}}if(_dd.r&&_dd.sr){if(rt+_dd.r.offsetHeight>_dd.sr.t+_dd.sr.h){this.grid.setScrollTop(rt+_dd.r.offsetHeight-_dd.sr.h);}else{if(rt<_dd.sr.t){this.grid.setScrollTop(rt);}}}return _dd.s.scrollLeft;},_scrollInfo:function(_de,_df){if(_de){var cl=_de,sbn=cl.view.scrollboxNode,_e0={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:_e0,n:(_df?_df:_de.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_e1){var _e2=null;if(this._colHeadNode){var _e3=this.grid.getCell(_e1);if(!_e3){return;}_e2=this._scrollInfo(_e3,_e3.getNode(0));}if(_e2&&_e2.s&&_e2.sr&&_e2.n){var _e4=_e2.sr.l+_e2.sr.w;if(_e2.n.offsetLeft+_e2.n.offsetWidth>_e4){_e2.s.scrollLeft=_e2.n.offsetLeft+_e2.n.offsetWidth-_e2.sr.w;}else{if(_e2.n.offsetLeft<_e2.sr.l){_e2.s.scrollLeft=_e2.n.offsetLeft;}else{if(has("ie")<=7&&_e3&&_e3.view.headerNode){_e3.view.headerNode.scrollLeft=_e2.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _e5=this.focusView;if(!_e5){for(var i=0,_e6;(_e6=this.grid.views.views[i]);i++){if(_e6.headerNode){_e5=_e6;break;}}}return (_e5&&_cf.getComputedStyle(_e5.headerNode).display=="none");},colSizeAdjust:function(e,_e7,_e8){var _e9=this._findHeaderCells();var _ea=this.focusView;if(!_ea||!_ea.header.tableMap.map){for(var i=0,_eb;(_eb=this.grid.views.views[i]);i++){if(_eb.header.tableMap.map){_ea=_eb;break;}}}var _ec=_e9[_e7];if(!_ea||(_e7==_e9.length-1&&_e7===0)){return;}_ea.content.baseDecorateEvent(e);e.cellNode=_ec;e.cellIndex=_ea.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(_ea.header.canResize(e)){var _ed={l:_e8};var _ee=_ea.header.colResizeSetup(e,false);_ea.header.doResizeColumn(_ee,null,_ed);_ea.update();}},styleRow:function(_ef){return;},setFocusIndex:function(_f0,_f1){this.setFocusCell(this.grid.getCell(_f1),_f0);},setFocusCell:function(_f2,_f3){if(_f2&&!this.isFocusCell(_f2,_f3)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_f2;this.rowIndex=_f3;this._focusifyCellNode(true);}if(has("opera")){setTimeout(_c9.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _f4=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_f4.editable||this.grid.canEdit&&!this.grid.canEdit(_f4,row))){this.cell=_f4;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _f5=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_f5.editable){this.cell=_f5;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_f6,_f7){var _f8=_f7<0?-1:1;if(this.isNavHeader()){var _f9=this._findHeaderCells();var _fa=currentIdx=_c8.indexOf(_f9,this._colHeadNode);currentIdx+=_f7;while(currentIdx>=0&&currentIdx<_f9.length&&_f9[currentIdx].style.display=="none"){currentIdx+=_f8;}if((currentIdx>=0)&&(currentIdx<_f9.length)){this._setActiveColHeader(_f9[currentIdx],currentIdx,_fa);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_f6));if(_f6){if(_f6>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_f6<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_f7));var _fb=this.grid.getCell(col);while(col>=0&&col<cc&&_fb&&_fb.hidden===true){col+=_f8;_fb=this.grid.getCell(col);}if(!_fb||_fb.hidden===true){col=i;}var n=_fb.getNode(row);if(!n&&_f6){if((row+_f6)>=0&&(row+_f6)<=rc){this.move(_f6>0?++_f6:--_f6,_f7);}return;}else{if((!n||_cf.style(n,"display")==="none")&&_f7){if((col+_f7)>=0&&(col+_f7)<=cc){this.move(_f6,_f7>0?++_f7:--_f7);}return;}}this.setFocusIndex(row,col);if(_f6){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_cc.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_cc.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){_cf.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _fc=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_cc.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_cc.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_fd){this.tabbingOut=true;_fd.focus();},focusGridView:function(){_ce.fire(this.focusView,"focus");},focusGrid:function(_fe){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _ff=true;var _100=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_100){var _101=0;var cell=this.grid.getCell(_101);if(cell.hidden){_101=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_101);}else{if(this.cell&&!_100){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_ff=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _ff;},focusHeader:function(){var _102=this._findHeaderCells();var _103=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_102[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_102.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_102[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_103);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){_cf.removeClass(this._colHeadNode,this.focusClass);_cf.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _104=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_104);this._contextMenuBindNode=_104;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_cc.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_cc.stop(e);},doBlur:function(e){_cc.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_cc.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_cc.stop(e);},doLastNodeBlur:function(e){_cc.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,_cf.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_cc.stop(e);},doColHeaderBlur:function(e){_cf.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"esri/toolbars/_VertexEditor":function(){define("esri/toolbars/_VertexEditor",["dijit","dojo","dojox","dojo/require!dijit/Menu,esri/toolbars/_VertexMover"],function(_105,dojo,_106){dojo.provide("esri.toolbars._VertexEditor");dojo.require("dijit.Menu");dojo.require("esri.toolbars._VertexMover");dojo.declare("esri.toolbars._GraphicVertexEditor",null,{constructor:function(_107,map,_108){this.graphic=_107;this.map=map;this.toolbar=_108;var _109=_108._options;this._symbol1=_109.vertexSymbol;this._symbol2=_109.ghostVertexSymbol;var _10a=_109.ghostLineSymbol;this._lineStroke={style:_10a.style,width:_10a.width,color:_10a.color};this._canDel=_109.allowDeleteVertices;this._canAdd=_109.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_10b){if(_10b){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=dojo.connect(esri.toolbars.VertexMover,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=dojo.connect(esri.toolbars.VertexMover,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _10c=this._getGraphicsLayer();this._mouseOverHandle=dojo.connect(_10c,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=dojo.connect(_10c,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new _105.Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _10d=(this._ctxDelete=new _105.MenuItem({label:esri.bundle.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=dojo.connect(_10d,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_10d);this._ctxMenu.startup();}},_removeControllers:function(){dojo.disconnect(this._firstMoveHandle);dojo.disconnect(this._moveStopHandle);dojo.disconnect(this._mouseOverHandle);dojo.disconnect(this._mouseOutHandle);dojo.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_10e,_10f,_110){var i,j,_111=this.graphic,_112=[];for(i=0;i<_10e.length;i++){var _113=_10e[i],_114=[];for(j=0;j<_113.length;j++){_114.push(new esri.toolbars.VertexMover(_113[j],_10f,_111,i,j,_113.length,this,_110));}_112.push(_114);}return _112;},_remove:function(_115){if(_115){dojo.forEach(_115,function(_116){dojo.forEach(_116,function(_117){_117.destroy();});});}},_refresh:function(_118){if(_118){dojo.forEach(_118,function(_119){dojo.forEach(_119,function(_11a){_11a.refresh();});});}},_isNew:function(_11b){return (dojo.indexOf(this._vertexMovers[_11b.segIndex],_11b)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _11c=this._selectedMover,_11d=_11c.ptIndex;this._updateRelatedGraphic(_11c,_11c.relatedGraphic,_11c.graphic.geometry,_11c.segIndex,_11c.ptIndex,_11c.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_11c);}this._deleteVertex(_11c);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _11e=evt.graphic,_11f=this._findMover(_11e);if(_11f){this.toolbar.onVertexMouseOver(this.graphic,_11f._getInfo());if(!_11f._placeholder){this._selectedMover=_11f;if(this._canDel){this._bindCtxNode(_11e.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _120=evt.graphic,_121=this._findMover(_120);if(_121){this.toolbar.onVertexMouseOut(this.graphic,_121._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_122){var i,_123=[],_124=this._mpVertexMovers;dojo.forEach(this._vertexMovers,function(_125){_123=_123.concat(_125);});if(_124){dojo.forEach(_124,function(_126){_123=_123.concat(_126);});}for(i=0;i<_123.length;i++){var _127=_123[i];if(_127.graphic===_122){return _127;}}},_firstMoveHandler:function(_128){if(!this._isNew(_128)&&this._canAdd){this._hideRelatedMidpoints(_128);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_129,tx){var add=this._isNew(_129);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_129);}return;}this._updateRelatedGraphic(_129,_129.relatedGraphic,_129.graphic.geometry,_129.segIndex,_129.ptIndex,_129.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_129);}else{this._repositionRelatedMidpoints(_129);this._showRelatedMidpoints(_129);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_12a){var i,_12b=this._getAdjacentMidpoints(_12a.ptIndex,_12a.segLength),_12c=this._mpVertexMovers[_12a.segIndex];for(i=0;i<_12b.length;i++){var mvr=_12c[_12b[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_12d){var i,_12e=this._getAdjacentMidpoints(_12d.ptIndex,_12d.segLength),_12f=this._mpVertexMovers[_12d.segIndex];for(i=0;i<_12e.length;i++){_12f[_12e[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_130){var i,_131=this._getAdjacentMidpoints(_130.ptIndex,_130.segLength),_132=this._mpVertexMovers[_130.segIndex];for(i=0;i<_131.length;i++){var _133=this._getAdjacentVertices(_131[i],_130.segLength);var _134=_130.relatedGraphic.geometry.getPoint(_130.segIndex,_133[0]),_135=_130.relatedGraphic.geometry.getPoint(_130.segIndex,_133[1]);var _136=new esri.geometry.Point({x:(_134.x+_135.x)/2,y:(_134.y+_135.y)/2,spatialReference:_134.spatialReference.toJson()});_132[_131[i]].graphic.setGeometry(_136);}},_addMidpoints:function(_137){var _138=_137.segIndex,_139=_137.ptIndex,_13a=_137.segLength;var _13b=_139+1;var i,_13c=_13a+1;this._mpVertexMovers[_138].splice(_139,1);var _13d=this._vertexMovers[_138];for(i=0;i<_13b;i++){_13d[i].segLength+=1;}for(i=_13b;i<_13d.length;i++){_13d[i].ptIndex+=1;_13d[i].segLength+=1;}_137.ptIndex=_13b;_137.segLength=_13d.length+1;_13d.splice(_13b,0,_137);_137.graphic.setSymbol(this._symbol1);_13d=this._mpVertexMovers[_138];for(i=0;i<_139;i++){_13d[i].segLength+=1;}for(i=_139;i<_13a-1;i++){_13d[i].ptIndex+=1;_13d[i].segLength+=1;}var _13e=this._getAdjacentVertices(_139,_13c);var _13f=this._getAdjacentVertices(_139+1,_13c);var _140,_141;_140=_137.relatedGraphic.geometry.getPoint(_137.segIndex,_13e[0]);_141=_137.relatedGraphic.geometry.getPoint(_137.segIndex,_13e[1]);var _142=new esri.geometry.Point({x:(_140.x+_141.x)/2,y:(_140.y+_141.y)/2,spatialReference:_140.spatialReference.toJson()});_140=_137.relatedGraphic.geometry.getPoint(_137.segIndex,_13f[0]);_141=_137.relatedGraphic.geometry.getPoint(_137.segIndex,_13f[1]);var _143=new esri.geometry.Point({x:(_140.x+_141.x)/2,y:(_140.y+_141.y)/2,spatialReference:_140.spatialReference.toJson()});var mvr1=new esri.toolbars.VertexMover(_142,this._symbol2,this.graphic,_137.segIndex,_139,_13c,this,true);var mvr2=new esri.toolbars.VertexMover(_143,this._symbol2,this.graphic,_137.segIndex,_139+1,_13c,this,true);_13d.splice(_139,0,mvr1,mvr2);},_deleteVertex:function(_144){var i,_145=_144.segIndex,_146=_144.ptIndex;var _147=this._vertexMovers[_145];for(i=0;i<_146;i++){_147[i].segLength-=1;}for(i=_146+1;i<_147.length;i++){var mvr=_147[i];mvr.ptIndex-=1;mvr.segLength-=1;}_147.splice(_146,1);var info=_144._getInfo();_144.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});dojo.mixin(esri.toolbars._GraphicVertexEditor,{create:function(_148,map,_149){var type=_148.geometry.type;switch(type){case "multipoint":return new esri.toolbars._MultipointVertexEditor(_148,map,_149);break;case "polyline":return new esri.toolbars._PolylineVertexEditor(_148,map,_149);break;case "polygon":return new esri.toolbars._PolygonVertexEditor(_148,map,_149);break;}}});dojo.declare("esri.toolbars._MultipointVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:1,constructor:function(){this._moveStartHandle=dojo.connect(esri.toolbars.VertexMover,"onMoveStart",this,this._moveStartHandler);dojo.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);dojo.disconnect(this._moveStartHandle);},_getSegments:function(_14a){var i,_14b=_14a.points,_14c=[],sr=_14a.spatialReference;for(i=0;i<_14b.length;i++){var _14d=_14b[i];_14c.push(new esri.geometry.Point({x:_14d[0],y:_14d[1],spatialReference:sr.toJson()}));}return [_14c];},_getMidpointSegments:function(_14e){return [];},_getControlPoints:function(_14f,_150,_151,_152,_153){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _154=evt.graphic,_155=this._findMover(evt);if(_155){this.toolbar.onVertexMouseOver(_154,_155._getInfo());this._selectedMover=_155;if(this._canDel){this._bindCtxNode(_155.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _156=evt.graphic,_157=this._findMover(evt);if(_157){this.toolbar.onVertexMouseOut(_156,_157._getInfo());}},_findMover:function(evt){var i,_158=[].concat(this._vertexMovers[0]),_159=evt.target;for(i=0;i<_158.length;i++){var _15a=_158[i];if(_15a.graphic.getDojoShape().getNode()===_159){return _15a;}}},_moveStartHandler:function(_15b){var geom=_15b.relatedGraphic.geometry,_15c=_15b.ptIndex;var _15d=_15b.segLength-1;var _15e=geom.points;var _15f=_15e.splice(_15c,1);_15e.push(_15f[0]);var j,_160=this._vertexMovers[0];for(j=_15d;j>_15c;j--){_160[j].ptIndex-=1;}_15f=_160.splice(_15c,1);_160.push(_15f[0]);_15f[0].ptIndex=_15d;},_moveStopHandler:function(_161){this._updateRelatedGraphic(_161,_161.relatedGraphic,_161.graphic.geometry,_161.segIndex,_161.ptIndex,_161.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_162,_163,_164,_165,_166,_167,add,del){var geom=_163.geometry;if(del){geom.removePoint(_166);}else{geom.setPoint(_166,_164);}_163.setGeometry(geom);},_deleteMidpoints:function(_168){}});dojo.declare("esri.toolbars._PolylineVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:2,_getSegments:function(_169){var i,j,_16a=_169.paths,_16b=[];for(i=0;i<_16a.length;i++){var path=_16a[i],_16c=[];for(j=0;j<path.length;j++){_16c.push(_169.getPoint(i,j));}_16b.push(_16c);}return _16b;},_getMidpointSegments:function(_16d){var i,j,_16e=_16d.paths,_16f=[],sr=_16d.spatialReference;for(i=0;i<_16e.length;i++){var path=_16e[i],_170=[];for(j=0;j<path.length-1;j++){var _171=_16d.getPoint(i,j),_172=_16d.getPoint(i,j+1);var midX=(_171.x+_172.x)/2,midY=(_171.y+_172.y)/2;var _173=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_170.push(_173);}_16f.push(_170);}return _16f;},_getControlPoints:function(_174,_175,_176,_177,_178){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_174)){idx1=_177;idx2=_177+1;if(idx1>=0){pt1=map.toScreen(_175.getPoint(_176,idx1));}if(idx2<=_178){pt2=map.toScreen(_175.getPoint(_176,idx2));}}else{idx1=_177-1;idx2=_177+1;if(idx1>=0){pt1=map.toScreen(_175.getPoint(_176,idx1));}if(idx2<_178){pt2=map.toScreen(_175.getPoint(_176,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_179,_17a){var _17b=[];var idx1=_179-1;if(idx1>=0){_17b.push(idx1);}var idx2=_179;if(idx2<_17a-1){_17b.push(idx2);}return _17b;},_getAdjacentVertices:function(_17c,_17d){return [_17c,_17c+1];},_deleteMidpoints:function(_17e){var _17f=_17e.segIndex,_180=_17e.ptIndex,_181=_17e.segLength;var _182=this._mpVertexMovers[_17f],_183=_182.length-1;var _184=this._getAdjacentMidpoints(_180,_181).sort();var i,min=_184[0];for(i=0;i<min;i++){_182[i].segLength-=1;}for(i=min+1;i<_182.length;i++){var mvr=_182[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_184.length===1){_182.splice(min,1)[0].destroy();}else{var _185=this._getAdjacentVertices(min,_183);var _186=_17e.relatedGraphic.geometry.getPoint(_17e.segIndex,_185[0]);var _187=_17e.relatedGraphic.geometry.getPoint(_17e.segIndex,_185[1]);var _188=new esri.geometry.Point({x:(_186.x+_187.x)/2,y:(_186.y+_187.y)/2,spatialReference:_186.spatialReference.toJson()});var mvr1=new esri.toolbars.VertexMover(_188,this._symbol2,this.graphic,_17e.segIndex,min,_183,this,true);var _189=_182.splice(min,_184.length,mvr1);for(i=0;i<_189.length;i++){_189[i].destroy();}}},_updateRelatedGraphic:function(_18a,_18b,_18c,_18d,_18e,_18f,add,del){var geom=_18b.geometry;if(add){geom.insertPoint(_18d,_18e+1,esri.geometry.fromJson(_18c.toJson()));}else{if(del){geom.removePoint(_18d,_18e);}else{geom.setPoint(_18d,_18e,esri.geometry.fromJson(_18c.toJson()));}}_18b.setGeometry(geom);}});dojo.declare("esri.toolbars._PolygonVertexEditor",esri.toolbars._GraphicVertexEditor,{minLength:3,_getSegments:function(_190){var i,j,_191=_190.rings,_192=[];for(i=0;i<_191.length;i++){var ring=_191[i],_193=[];for(j=0;j<ring.length-1;j++){_193.push(_190.getPoint(i,j));}_192.push(_193);}return _192;},_getMidpointSegments:function(_194){var i,j,_195=_194.rings,_196=[],sr=_194.spatialReference;for(i=0;i<_195.length;i++){var ring=_195[i],_197=[];for(j=0;j<ring.length-1;j++){var _198=_194.getPoint(i,j),_199=_194.getPoint(i,j+1);var midX=(_198.x+_199.x)/2,midY=(_198.y+_199.y)/2;var _19a=new esri.geometry.Point({x:midX,y:midY,spatialReference:sr.toJson()});_197.push(_19a);}_196.push(_197);}return _196;},_getControlPoints:function(_19b,_19c,_19d,_19e,_19f){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_19b)){idx1=_19e;idx2=(_19e+1)%_19f;}else{idx1=_19e-1;idx1=idx1<0?(_19f+idx1)%_19f:idx1;idx2=(_19e+1)%_19f;}pt1=map.toScreen(_19c.getPoint(_19d,idx1));pt2=map.toScreen(_19c.getPoint(_19d,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_1a0,_1a1){var idx1=_1a0-1;idx1=idx1<0?(_1a1+idx1)%_1a1:idx1;var idx2=_1a0;return [idx1,idx2];},_getAdjacentVertices:function(_1a2,_1a3){return [_1a2,(_1a2+1)%_1a3];},_deleteMidpoints:function(_1a4){var _1a5=_1a4.segIndex,_1a6=_1a4.ptIndex,_1a7=_1a4.segLength;var _1a8=this._mpVertexMovers[_1a5],_1a9=_1a8.length-1,_1aa=this._getAdjacentMidpoints(_1a6,_1a7).sort(),_1ab,_1ac,_1ad,_1ae,i,mvr1,mvr,min=_1aa[0],max=_1aa[_1aa.length-1];if(_1a6===0){_1ab=this._getAdjacentVertices(_1a9-1,_1a9);_1ac=_1a4.relatedGraphic.geometry.getPoint(_1a4.segIndex,_1ab[0]);_1ad=_1a4.relatedGraphic.geometry.getPoint(_1a4.segIndex,_1ab[1]);_1ae=new esri.geometry.Point({x:(_1ac.x+_1ad.x)/2,y:(_1ac.y+_1ad.y)/2,spatialReference:_1ac.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_1ae,this._symbol2,this.graphic,_1a4.segIndex,_1a9-1,_1a9,this,true);_1a8.splice(max,1,mvr1)[0].destroy();_1a8.splice(min,1)[0].destroy();for(i=0;i<_1a8.length-1;i++){mvr=_1a8[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_1ab=this._getAdjacentVertices(min,_1a9);_1ac=_1a4.relatedGraphic.geometry.getPoint(_1a4.segIndex,_1ab[0]);_1ad=_1a4.relatedGraphic.geometry.getPoint(_1a4.segIndex,_1ab[1]);_1ae=new esri.geometry.Point({x:(_1ac.x+_1ad.x)/2,y:(_1ac.y+_1ad.y)/2,spatialReference:_1ac.spatialReference.toJson()});mvr1=new esri.toolbars.VertexMover(_1ae,this._symbol2,this.graphic,_1a4.segIndex,min,_1a9,this,true);var _1af=_1a8.splice(min,_1aa.length,mvr1);for(i=0;i<_1af.length;i++){_1af[i].destroy();}for(i=0;i<min;i++){_1a8[i].segLength-=1;}for(i=min+1;i<_1a8.length;i++){mvr=_1a8[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_1b0,_1b1,_1b2,_1b3,_1b4,_1b5,add,del){var geom=_1b1.geometry;if(add){geom.insertPoint(_1b3,_1b4+1,esri.geometry.fromJson(_1b2.toJson()));}else{if(del){geom.removePoint(_1b3,_1b4);if(_1b4===0){geom.setPoint(_1b3,_1b5-1,esri.geometry.fromJson(geom.getPoint(_1b3,0).toJson()));}}else{geom.setPoint(_1b3,_1b4,esri.geometry.fromJson(_1b2.toJson()));if(_1b4===0){geom.setPoint(_1b3,_1b5,esri.geometry.fromJson(_1b2.toJson()));}}}_1b1.setGeometry(geom);}});});},"dijit/_editor/html":function(){define("dijit/_editor/html",["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(_1b6,lang,has){var _1b7={};lang.setObject("dijit._editor.html",_1b7);var _1b8=_1b7.escapeXml=function(str,_1b9){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_1b9){str=str.replace(/'/gm,"&#39;");}return str;};_1b7.getNodeHtml=function(node){var _1ba=[];_1b7.getNodeHtmlHelper(node,_1ba);return _1ba.join("");};_1b7.getNodeHtmlHelper=function(node,_1bb){switch(node.nodeType){case 1:var _1bc=node.nodeName.toLowerCase();if(!_1bc||_1bc.charAt(0)=="/"){return "";}_1bb.push("<",_1bc);var _1bd=[],_1be={};var attr;if(has("dom-attributes-explicit")||has("dom-attributes-specified-flag")){var i=0;while((attr=node.attributes[i++])){var n=attr.name;if(n.substr(0,3)!=="_dj"&&(!has("dom-attributes-specified-flag")||attr.specified)&&!(n in _1be)){var v=attr.value;if(n=="src"||n=="href"){if(node.getAttribute("_djrealurl")){v=node.getAttribute("_djrealurl");}}if(has("ie")===8&&n==="style"){v=v.replace("HEIGHT:","height:").replace("WIDTH:","width:");}_1bd.push([n,v]);_1be[n]=v;}}}else{var _1bf=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false);var s=_1bf.outerHTML;var _1c0=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;var _1c1=s.match(_1c0);s=s.substr(0,s.indexOf(">"));_1b6.forEach(_1c1,function(attr){if(attr){var idx=attr.indexOf("=");if(idx>0){var key=attr.substring(0,idx);if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(node.getAttribute("_djrealurl")){_1bd.push([key,node.getAttribute("_djrealurl")]);return;}}var val,_1c2;switch(key){case "style":val=node.style.cssText.toLowerCase();break;case "class":val=node.className;break;case "width":if(_1bc==="img"){_1c2=/width=(\S+)/i.exec(s);if(_1c2){val=_1c2[1];}break;}case "height":if(_1bc==="img"){_1c2=/height=(\S+)/i.exec(s);if(_1c2){val=_1c2[1];}break;}default:val=node.getAttribute(key);}if(val!=null){_1bd.push([key,val.toString()]);}}}}},this);}_1bd.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((attr=_1bd[j++])){_1bb.push(" ",attr[0],"=\"",(typeof attr[1]==="string"?_1b8(attr[1],true):attr[1]),"\"");}switch(_1bc){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":_1bb.push(" />");break;case "script":_1bb.push(">",node.innerHTML,"</",_1bc,">");break;default:_1bb.push(">");if(node.hasChildNodes()){_1b7.getChildrenHtmlHelper(node,_1bb);}_1bb.push("</",_1bc,">");}break;case 4:case 3:_1bb.push(_1b8(node.nodeValue,true));break;case 8:_1bb.push("<!--",_1b8(node.nodeValue,true),"-->");break;default:_1bb.push("<!-- Element not recognized - Type: ",node.nodeType," Name: ",node.nodeName,"-->");}};_1b7.getChildrenHtml=function(node){var _1c3=[];_1b7.getChildrenHtmlHelper(node,_1c3);return _1c3.join("");};_1b7.getChildrenHtmlHelper=function(dom,_1c4){if(!dom){return;}var _1c5=dom["childNodes"]||dom;var _1c6=!has("ie")||_1c5!==dom;var node,i=0;while((node=_1c5[i++])){if(!_1c6||node.parentNode==dom){_1b7.getNodeHtmlHelper(node,_1c4);}}};return _1b7;});},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range","../../_base/focus"],function(_1c7,_1c8,_1c9,keys,lang,has,win,_1ca,_1cb,_1cc,_1cd,_1ce){return _1c7("dijit._editor.plugins.EnterKeyHandling",_1cb,{blockNodeForEnter:"BR",constructor:function(args){if(args){if("blockNodeForEnter" in args){args.blockNodeForEnter=args.blockNodeForEnter.toUpperCase();}lang.mixin(this,args);}},setEditor:function(_1cf){if(this.editor===_1cf){return;}this.editor=_1cf;if(this.blockNodeForEnter=="BR"){this.editor.customUndo=true;_1cf.onLoadDeferred.then(lang.hitch(this,function(d){this.connect(_1cf.document,"onkeypress",function(e){if(e.charOrCode==keys.ENTER){var ne=lang.mixin({},e);ne.shiftKey=true;if(!this.handleEnterKey(ne)){_1c9.stop(e);}}});if(has("ie")==9){this.connect(_1cf.document,"onpaste",function(e){setTimeout(dojo.hitch(this,function(){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();r.move("character",1);r.select();}),0);});}return d;}));}else{if(this.blockNodeForEnter){var h=lang.hitch(this,this.handleEnterKey);_1cf.addKeyHandler(13,0,0,h);_1cf.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},onKeyPressed:function(){if(this._checkListLater){if(win.withGlobal(this.editor.window,"isCollapsed",_1ce)){var _1d0=this.editor._sCall("getAncestorElement",["LI"]);if(!_1d0){_1cc.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _1d1=this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]);if(_1d1){_1d1.innerHTML=this.bogusHtmlContent;if(has("ie")){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{console.error("onKeyPressed: Cannot find the new block node");}}else{if(has("mozilla")){if(_1d0.parentNode.parentNode.nodeName=="LI"){_1d0=_1d0.parentNode.parentNode;}}var fc=_1d0.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_1d0.insertBefore(fc.ownerDocument.createTextNode(""),fc);var _1d2=_1cd.create(this.editor.window);_1d2.setStart(_1d0.firstChild,0);var _1d3=_1cd.getSelection(this.editor.window,true);_1d3.removeAllRanges();_1d3.addRange(_1d2);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){var _1d4,_1d5,_1d6,_1d7,_1d8,_1d9,doc=this.editor.document,br,rs,txt;if(e.shiftKey){var _1da=this.editor._sCall("getParentElement",[]);var _1db=_1cd.getAncestor(_1da,this.blockNodes);if(_1db){if(_1db.tagName=="LI"){return true;}_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);if(!_1d5.collapsed){_1d5.deleteContents();_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);}if(_1cd.atBeginningOfContainer(_1db,_1d5.startContainer,_1d5.startOffset)){br=doc.createElement("br");_1d6=_1cd.create(this.editor.window);_1db.insertBefore(br,_1db.firstChild);_1d6.setStartAfter(br);_1d4.removeAllRanges();_1d4.addRange(_1d6);}else{if(_1cd.atEndOfContainer(_1db,_1d5.startContainer,_1d5.startOffset)){_1d6=_1cd.create(this.editor.window);br=doc.createElement("br");_1db.appendChild(br);_1db.appendChild(doc.createTextNode(""));_1d6.setStart(_1db.lastChild,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);}else{rs=_1d5.startContainer;if(rs&&rs.nodeType==3){txt=rs.nodeValue;_1d7=doc.createTextNode(txt.substring(0,_1d5.startOffset));_1d8=doc.createTextNode(txt.substring(_1d5.startOffset));_1d9=doc.createElement("br");if(_1d8.nodeValue==""&&has("webkit")){_1d8=doc.createTextNode("");}_1c8.place(_1d7,rs,"after");_1c8.place(_1d9,_1d7,"after");_1c8.place(_1d8,_1d9,"after");_1c8.destroy(rs);_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1d8,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);return false;}return true;}}}else{_1d4=_1cd.getSelection(this.editor.window);if(_1d4.rangeCount){_1d5=_1d4.getRangeAt(0);if(_1d5&&_1d5.startContainer){if(!_1d5.collapsed){_1d5.deleteContents();_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);}rs=_1d5.startContainer;if(rs&&rs.nodeType==3){var _1dc=false;var _1dd=_1d5.startOffset;if(rs.length<_1dd){ret=this._adjustNodeAndOffset(rs,_1dd);rs=ret.node;_1dd=ret.offset;}txt=rs.nodeValue;_1d7=doc.createTextNode(txt.substring(0,_1dd));_1d8=doc.createTextNode(txt.substring(_1dd));_1d9=doc.createElement("br");if(!_1d8.length){_1d8=doc.createTextNode("");_1dc=true;}if(_1d7.length){_1c8.place(_1d7,rs,"after");}else{_1d7=rs;}_1c8.place(_1d9,_1d7,"after");_1c8.place(_1d8,_1d9,"after");_1c8.destroy(rs);_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1d8,0);_1d6.setEnd(_1d8,_1d8.length);_1d4.removeAllRanges();_1d4.addRange(_1d6);if(_1dc&&!has("webkit")){this.editor._sCall("remove",[]);}else{this.editor._sCall("collapse",[true]);}}else{var _1de;if(_1d5.startOffset>=0){_1de=rs.childNodes[_1d5.startOffset];}var _1d9=doc.createElement("br");var _1d8=doc.createTextNode("");if(!_1de){rs.appendChild(_1d9);rs.appendChild(_1d8);}else{_1c8.place(_1d9,_1de,"before");_1c8.place(_1d8,_1d9,"after");}_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1d8,0);_1d6.setEnd(_1d8,_1d8.length);_1d4.removeAllRanges();_1d4.addRange(_1d6);this.editor._sCall("collapse",[true]);}}}else{_1cc.prototype.execCommand.call(this.editor,"inserthtml","<br>");}}return false;}var _1df=true;_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);if(!_1d5.collapsed){_1d5.deleteContents();_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);}var _1e0=_1cd.getBlockAncestor(_1d5.endContainer,null,this.editor.editNode);var _1e1=_1e0.blockNode;if((this._checkListLater=(_1e1&&(_1e1.nodeName=="LI"||_1e1.parentNode.nodeName=="LI")))){if(has("mozilla")){this._pressedEnterInBlock=_1e1;}if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_1e1.innerHTML)){_1e1.innerHTML="";if(has("webkit")){_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1e1,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);}this._checkListLater=false;}return true;}if(!_1e0.blockNode||_1e0.blockNode===this.editor.editNode){try{_1cc.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);}catch(e2){}_1e0={blockNode:this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_1e0.blockNode){if(_1e0.blockNode!=this.editor.editNode&&(!(_1e0.blockNode.textContent||_1e0.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){this.removeTrailingBr(_1e0.blockNode);return false;}}else{_1e0.blockNode=this.editor.editNode;}_1d4=_1cd.getSelection(this.editor.window);_1d5=_1d4.getRangeAt(0);}var _1e2=doc.createElement(this.blockNodeForEnter);_1e2.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_1e0.blockNode);var _1e3=_1d5.endOffset;var node=_1d5.endContainer;if(node.length<_1e3){var ret=this._adjustNodeAndOffset(node,_1e3);node=ret.node;_1e3=ret.offset;}if(_1cd.atEndOfContainer(_1e0.blockNode,node,_1e3)){if(_1e0.blockNode===_1e0.blockContainer){_1e0.blockNode.appendChild(_1e2);}else{_1c8.place(_1e2,_1e0.blockNode,"after");}_1df=false;_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1e2,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);if(this.editor.height){_1ca.scrollIntoView(_1e2);}}else{if(_1cd.atBeginningOfContainer(_1e0.blockNode,_1d5.startContainer,_1d5.startOffset)){_1c8.place(_1e2,_1e0.blockNode,_1e0.blockNode===_1e0.blockContainer?"first":"before");if(_1e2.nextSibling&&this.editor.height){_1d6=_1cd.create(this.editor.window);_1d6.setStart(_1e2.nextSibling,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);_1ca.scrollIntoView(_1e2.nextSibling);}_1df=false;}else{if(_1e0.blockNode===_1e0.blockContainer){_1e0.blockNode.appendChild(_1e2);}else{_1c8.place(_1e2,_1e0.blockNode,"after");}_1df=false;if(_1e0.blockNode.style){if(_1e2.style){if(_1e0.blockNode.style.cssText){_1e2.style.cssText=_1e0.blockNode.style.cssText;}}}rs=_1d5.startContainer;var _1e4;if(rs&&rs.nodeType==3){var _1e5,_1e6;_1e3=_1d5.endOffset;if(rs.length<_1e3){ret=this._adjustNodeAndOffset(rs,_1e3);rs=ret.node;_1e3=ret.offset;}txt=rs.nodeValue;_1d7=doc.createTextNode(txt.substring(0,_1e3));_1d8=doc.createTextNode(txt.substring(_1e3,txt.length));_1c8.place(_1d7,rs,"before");_1c8.place(_1d8,rs,"after");_1c8.destroy(rs);var _1e7=_1d7.parentNode;while(_1e7!==_1e0.blockNode){var tg=_1e7.tagName;var _1e8=doc.createElement(tg);if(_1e7.style){if(_1e8.style){if(_1e7.style.cssText){_1e8.style.cssText=_1e7.style.cssText;}}}if(_1e7.tagName==="FONT"){if(_1e7.color){_1e8.color=_1e7.color;}if(_1e7.face){_1e8.face=_1e7.face;}if(_1e7.size){_1e8.size=_1e7.size;}}_1e5=_1d8;while(_1e5){_1e6=_1e5.nextSibling;_1e8.appendChild(_1e5);_1e5=_1e6;}_1c8.place(_1e8,_1e7,"after");_1d7=_1e7;_1d8=_1e8;_1e7=_1e7.parentNode;}_1e5=_1d8;if(_1e5.nodeType==1||(_1e5.nodeType==3&&_1e5.nodeValue)){_1e2.innerHTML="";}_1e4=_1e5;while(_1e5){_1e6=_1e5.nextSibling;_1e2.appendChild(_1e5);_1e5=_1e6;}}_1d6=_1cd.create(this.editor.window);var _1e9;var _1ea=_1e4;if(this.blockNodeForEnter!=="BR"){while(_1ea){_1e9=_1ea;_1e6=_1ea.firstChild;_1ea=_1e6;}if(_1e9&&_1e9.parentNode){_1e2=_1e9.parentNode;_1d6.setStart(_1e2,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);if(this.editor.height){_1ca.scrollIntoView(_1e2);}if(has("mozilla")){this._pressedEnterInBlock=_1e0.blockNode;}}else{_1df=true;}}else{_1d6.setStart(_1e2,0);_1d4.removeAllRanges();_1d4.addRange(_1d6);if(this.editor.height){_1ca.scrollIntoView(_1e2);}if(has("mozilla")){this._pressedEnterInBlock=_1e0.blockNode;}}}}return _1df;},_adjustNodeAndOffset:function(node,_1eb){while(node.length<_1eb&&node.nextSibling&&node.nextSibling.nodeType==3){_1eb=_1eb-node.length;node=node.nextSibling;}return {"node":node,"offset":_1eb};},removeTrailingBr:function(_1ec){var para=/P|DIV|LI/i.test(_1ec.tagName)?_1ec:this.editor._sCall("getParentOfType",[_1ec,["P","DIV","LI"]]);if(!para){return;}if(para.lastChild){if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||para.lastChild.tagName=="BR"){_1c8.destroy(para.lastChild);}}if(!para.childNodes.length){para.innerHTML=this.bogusHtmlContent;}}});});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_1ed,_1ee,_1ef,_1f0,lang,dom,_1f1,_1f2,_1f3,on,_1f4,dnd,_1f5){var _1f6=_1ee("dojo.dnd.Selector",_1f5,{constructor:function(node,_1f7){if(!_1f7){_1f7={};}this.singular=_1f7.singular;this.autoSync=_1f7.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_1f4.press,lang.hitch(this,"onMouseDown")),on(this.node,_1f4.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _1f3();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_1f1.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_1f0.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_1f6.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_1ed.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_1f8,data,_1f9,_1fa){var _1fb=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_1fb.call(this,item,hint);if(_1f8){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_1f6.superclass.insertNodes.call(this,data,_1f9,_1fa);this._normalizedCreator=_1fb;return this;},destroy:function(){_1f6.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_1f2.isLeft(e)){_1ef.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_1ef.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_1f4.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _1f6;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_1fc,_1fd,dom,_1fe,_1ff,lang,_200,on,_201,_202,pm,_203,_204,_205,_206){return _1fd("dijit._MenuBase",[_204,_206,_205],{parentMenu:null,popupDelay:500,autoFocus:false,postCreate:function(){var self=this,_207=function(node){return _1ff.contains(node,"dijitMenuItem");};this.own(on(this.containerNode,on.selector(_207,_200.enter),function(){self.onItemHover(_203.byNode(this));}),on(this.containerNode,on.selector(_207,_200.leave),function(){self.onItemUnhover(_203.byNode(this));}),on(this.containerNode,on.selector(_207,_202),function(evt){self.onItemClick(_203.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _208=this._getTopMenu();if(_208&&_208._isMenuBar){_208.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _209=this.currentPopup.parentMenu;if(_209.focusedChild){_209.focusedChild._setSelected(false);}_209.focusedChild=this.currentPopup.from_item;_209.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _20a=item.popup;if(_20a){this._stopPendingCloseTimer(_20a);_20a._pendingClose_timer=this.defer(function(){_20a._pendingClose_timer=null;if(_20a.parentMenu){_20a.parentMenu.currentPopup=null;}pm.close(_20a);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_20b){if(_20b._pendingClose_timer){_20b._pendingClose_timer=_20b._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_20c){this._stopPopupTimer();var _20d=this.focusedChild;if(!_20d){return;}var _20e=_20d.popup;if(!_20e.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_20e.parentMenu=this;_20e.from_item=_20d;var self=this;pm.open({parent:this,popup:_20e,around:_20d.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_20d);self._cleanUp();_20d._setSelected(true);self.focusedChild=_20d;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_20e;_20e.connect(_20e.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_20c&&_20e.focus){_20e._focus_timer=this.defer(lang.hitch(_20e,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_1ff.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_1ff.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_1fc.indexOf(this._focusManager.activeStack,this.id)>=0){_1fe.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_20f,lang,has,_210,_211,_212,_213){var dhm=lang.getObject("dojox.html.metrics",true);var _214=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _215={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_212.doc.documentElement.style.fontSize="100%";}var div=_212.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_212.body().appendChild(div);for(var p in _215){ds.fontSize=p;_215[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_212.body().removeChild(div);div=null;return _215;};var _216=null;dhm.getCachedFontMeasurements=function(_217){if(_217||!_216){_216=dhm.getFontMeasurements();}return _216;};var _218=null,_219={};dhm.getTextBox=function(text,_21a,_21b){var m,s;if(!_218){m=_218=_212.doc.createElement("div");var c=_212.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_212.body().appendChild(c);}else{m=_218;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_21a){for(var i in _21a){if(i in _219){continue;}s[i]=_21a[i];}}if(arguments.length>2&&_21b){m.className=_21b;}m.innerHTML=text;var box=_213.position(m);box.w=m.parentNode.scrollWidth;return box;};var _21c={w:16,h:16};dhm.getScrollbar=function(){return {w:_21c.w,h:_21c.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_21d){var f=dhm._fontResizeNode=_212.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_214._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_214._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_212.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_211.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_210(function(){try{var n=_212.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_212.body().appendChild(n);_21c.w=n.offsetWidth-n.clientWidth;_21c.h=n.offsetHeight-n.clientHeight;_212.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _20f.config&&!!_20f.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/dijit/editing/tools/MenuItemBase":function(){define(["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/ToolBase,dijit/MenuItem,esri/toolbars/draw"],function(_21e,dojo,_21f){dojo.provide("esri.dijit.editing.tools.MenuItemBase");dojo.require("esri.dijit.editing.tools.ToolBase");dojo.require("dijit.MenuItem");dojo.require("esri.toolbars.draw");dojo.declare("esri.dijit.editing.tools.MenuItemBase",[_21e.MenuItem,esri.dijit.editing.tools.ToolBase],{destroy:function(){_21e.MenuItem.prototype.destroy.apply(this,arguments);esri.dijit.editing.tools.ToolBase.prototype.destroy.apply(this,arguments);}});});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_220,_221,_222,i18n){return _221("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_223){this.value=_223;this.onChange(_223);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_224){var _225=this._createMenuItem();var _226=_224(item);if(_226.html){_225.innerHTML=_226.label;}else{_225.appendChild(_225.ownerDocument.createTextNode(_226.label));}if(_225.innerHTML==""){_225.innerHTML="&#160;";}this.applyTextDir(_225,(_225.innerText||_225.textContent||""));return _225;},createOptions:function(_227,_228,_229){this.items=_227;this.previousButton.style.display=(_228.start==0)?"none":"";_222.set(this.previousButton,"id",this.id+"_prev");_220.forEach(_227,function(item,i){var _22a=this._createOption(item,_229);_22a.setAttribute("item",i);_222.set(_22a,"id",this.id+i);this.nextButton.parentNode.insertBefore(_22a,this.nextButton);},this);var _22b=false;if(_227.total&&!_227.total.then&&_227.total!=-1){if((_228.start+_228.count)<_227.total){_22b=true;}else{if((_228.start+_228.count)>_227.total&&_228.count==_227.length){_22b=true;}}}else{if(_228.count==_227.length){_22b=true;}}this.nextButton.style.display=_22b?"":"none";_222.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _22c=this.containerNode;while(_22c.childNodes.length>2){_22c.removeChild(_22c.childNodes[_22c.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this.selected;}});});},"dijit/form/_SearchMixin":function(){define("dijit/form/_SearchMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/sniff","dojo/string","dojo/when","../registry"],function(_22d,_22e,_22f,keys,lang,_230,has,_231,when,_232){return _22e("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_abortQuery:function(){if(this.searchTimer){this.searchTimer=this.searchTimer.remove();}if(this._queryDeferHandle){this._queryDeferHandle=this._queryDeferHandle.remove();}if(this._fetchHandle){if(this._fetchHandle.abort){this._cancelingQuery=true;this._fetchHandle.abort();this._cancelingQuery=false;}if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_processInput:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _233=false;this._prev_key_backspace=false;switch(key){case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;this._maskValidSubsetError=true;_233=true;break;default:_233=typeof key=="string"||key==229;}if(_233){if(!this.store){this.onSearch();}else{this.searchTimer=this.defer("_startSearchFromInput",1);}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_startSearch:function(text){this._abortQuery();var _234=this,_230=lang.clone(this.query),_235={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_231.substitute(this.queryExpr,[text]),q,_236=function(){var _237=_234._fetchHandle=_234.store.query(_230,_235);if(_234.disabled||_234.readOnly||(q!==_234._lastQuery)){return;}when(_237,function(res){_234._fetchHandle=null;if(!_234.disabled&&!_234.readOnly&&(q===_234._lastQuery)){when(_237.total,function(_238){res.total=_238;var _239=_234.pageSize;if(isNaN(_239)||_239>res.total){_239=res.total;}res.nextPage=function(_23a){_235.direction=_23a=_23a!==false;_235.count=_239;if(_23a){_235.start+=res.length;if(_235.start>=res.total){_235.count=0;}}else{_235.start-=_239;if(_235.start<0){_235.count=Math.max(_239+_235.start,0);_235.start=0;}}if(_235.count<=0){res.length=0;_234.onSearch(res,_230,_235);}else{_236();}};_234.onSearch(res,_230,_235);});}},function(err){_234._fetchHandle=null;if(!_234._cancelingQuery){console.error(_234.declaredClass+" "+err.toString());}});};lang.mixin(_235,this.fetchProperties);if(this.store._oldAPI){q=qs;}else{q=_22d.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_230[this.searchAttr]=q;this._queryDeferHandle=this.defer(_236,this.searchDelay);},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var list=this.list;if(list){this.store=_232.byId(list);}}this.inherited(arguments);}});});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_23b,_23c){return _23b("dojox.grid._RowSelector",_23c,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_23d,_23e){var w=this.contentWidth||0;_23e.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_23f,_240){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_23f)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_23f)){n.push("dojoxGridRowbarSelected");}_240.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_241,_242,_243,lang,win,_244,_245,has,keys,on,_246,_247,dnd,_248,_249){var _24a=_242("dojo.dnd.Manager",[_245],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_24b){if(this.avatar){this.target=(_24b&&_24b.targetState!="Disabled")?_24b:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_246.publish("/dnd/source/over",_24b);},outSource:function(_24c){if(this.avatar){if(this.target==_24c){this.target=null;this.canDropFlag=false;this.avatar.update();_246.publish("/dnd/source/over",null);}}else{_246.publish("/dnd/source/over",null);}},startDrag:function(_24d,_24e,copy){_248.autoScrollStart(win.doc);this.source=_24d;this.nodes=_24e;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_246.publish("/dnd/start",_24d,_24e,this.copy);this.events=[on(win.doc,_247.move,lang.hitch(this,"onMouseMove")),on(win.doc,_247.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_243.stop),on(win.body(),"selectstart",_243.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_244.add(win.body(),c);},canDrop:function(flag){var _24f=Boolean(this.target&&flag);if(this.canDropFlag!=_24f){this.canDropFlag=_24f;this.avatar.update();}},stopDrag:function(){_244.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_241.forEach(this.events,function(_250){_250.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _249(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_248.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_246.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_246.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_246.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_246.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_244.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_24a.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _24a();}return dnd._manager;};return _24a;});},"dijit/form/NumberSpinner":function(){define("dijit/form/NumberSpinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","./_Spinner","./NumberTextBox"],function(_251,_252,keys,_253,_254){return _251("dijit.form.NumberSpinner",[_253,_254.Mixin],{adjust:function(val,_255){var tc=this.constraints,v=isNaN(val),_256=!isNaN(tc.max),_257=!isNaN(tc.min);if(v&&_255!=0){val=(_255>0)?_257?tc.min:_256?tc.max:0:_256?this.constraints.max:_257?tc.min:0;}var _258=val+_255;if(v||isNaN(_258)){return val;}if(_256&&(_258>tc.max)){_258=tc.max;}if(_257&&(_258<tc.min)){_258=tc.min;}return _258;},_onKeyPress:function(e){if((e.charOrCode==keys.HOME||e.charOrCode==keys.END)&&!(e.ctrlKey||e.altKey||e.metaKey)&&typeof this.get("value")!="undefined"){var _259=this.constraints[(e.charOrCode==keys.HOME?"min":"max")];if(typeof _259=="number"){this._setValueAttr(_259,false);}_252.stop(e);}}});});},"dijit/form/DateTextBox":function(){define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(_25a,_25b,_25c){return _25a("dijit.form.DateTextBox",_25c,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:_25b,_selector:"date",value:new Date("")});});},"esri/dijit/editing/tools/Selection":function(){define("esri/dijit/editing/tools/Selection",["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/DropDownToolBase,esri/dijit/editing/Util,esri/dijit/editing/tools/SelectionTools"],function(_25d,dojo,_25e){dojo.provide("esri.dijit.editing.tools.Selection");dojo.require("esri.dijit.editing.tools.DropDownToolBase");dojo.require("esri.dijit.editing.Util");dojo.require("esri.dijit.editing.tools.SelectionTools");dojo.declare("esri.dijit.editing.tools.Selection",[esri.dijit.editing.tools.DropDownToolBase],{_enabled:true,activate:function(){this.inherited(arguments);this._sConnect=dojo.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");},deactivate:function(){this.inherited(arguments);dojo.disconnect(this._sConnect);delete this._sConnect;},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"];},_onDrawEnd:function(_25f){this.inherited(arguments);this._settings.editor._hideAttributeInspector();var _260=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(_260,_25f,this._selectMethod,dojo.hitch(this,"onFinished"));},_createSymbols:function(){this._pointSelectionSymbol=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0]),1),new dojo.Color([255,0,0,0.5]));this._polylineSelectionSymbol=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,200,255]),2);this._polygonSelectionSymbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0]),1),new dojo.Color([0,200,255,0.5]));},_initializeLayers:function(){var _261=this._settings.layers;dojo.forEach(_261,this._setSelectionSymbol,this);},_setSelectionSymbol:function(_262){var _263=null;switch(_262.geometryType){case "esriGeometryPoint":_263=this._pointSelectionSymbol;break;case "esriGeometryPolyline":_263=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":_263=this._polygonSelectionSymbol;break;}_262.setSelectionSymbol(_262._selectionSymbol||_263);},_createTools:function(){dojo.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_264){var _265=dojo.mixin(esri.dijit.editing.tools.SelectionTools[_264],{settings:this._settings,onClick:dojo.hitch(this,"onItemClicked")});this._tools[_264.toUpperCase()]=new esri.dijit.editing.tools.Edit(_265);}});});},"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n","dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","dojo/string","./DataList","../registry","./_TextBoxMixin","./_SearchMixin"],function(_266,_267,_268,_269,keys,lang,_26a,_26b,has,_26c,_26d,_26e,_26f,_270){return _267("dijit.form._AutoCompleterMixin",_270,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_271){var pos=0;if(typeof (_271.selectionStart)=="number"){pos=_271.selectionStart;}else{if(has("ie")){var tr=_271.ownerDocument.selection.createRange().duplicate();var ntr=_271.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_272,_273){_273=parseInt(_273);_26f.selectInputText(_272,_273,_273);},_setDisabledAttr:function(_274){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_274?"true":"false");},_onKey:function(evt){if(evt.charCode>=32){return;}var key=evt.charCode||evt.keyCode;if(key==keys.ALT||key==keys.CTRL||key==keys.META||key==keys.SHIFT){return;}var pw=this.dropDown;var _275=null;this._abortQuery();this.inherited(arguments);if(evt.altKey||evt.ctrlKey||evt.metaKey){return;}if(this._opened){_275=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_275);}_269.stop(evt);break;case keys.ENTER:if(_275){if(_275==pw.nextButton){this._nextSearch(1);_269.stop(evt);break;}else{if(_275==pw.previousButton){this._nextSearch(-1);_269.stop(evt);break;}}_269.stop(evt);}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}case keys.TAB:var _276=this.get("displayedValue");if(pw&&(_276==pw._messages["previousMessage"]||_276==pw._messages["nextMessage"])){break;}if(_275){this._selectOption(_275);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}},_autoCompleteText:function(text){var fn=this.focusNode;_26f.selectInputText(fn,fn.value.length);var _277=this.ignoreCase?"toLowerCase":"substr";if(text[_277](0).indexOf(this.focusNode.value[_277](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_26f.selectInputText(fn,cpos);}}else{fn.value=text;_26f.selectInputText(fn);}},_openResultList:function(_278,_279,_27a){var _27b=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_278.length&&_27a.start==0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_27c){_278.nextPage(_27c!==-1);this.focus();});this.dropDown.createOptions(_278,_27a,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if("direction" in _27a){if(_27a.direction){this.dropDown.highlightFirstOption();}else{if(!_27a.direction){this.dropDown.highlightLastOption();}}if(_27b){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_279[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _27d=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_27d==pw._messages["previousMessage"]||_27d==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_27d);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_27e,_27f){var _280="";if(item){if(!_27f){_27f=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_280=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_27f;}this.set("value",_280,_27e,_27f,item);},_announceOption:function(node){if(!node){return;}var _281;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_281=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_281=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_281);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_268.get(node,"id"));this._autoCompleteText(_281);},_selectOption:function(_282){this.closeDropDown();if(_282){this._announceOption(_282);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _283=this.id+"_popup",_284=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _284({onChange:lang.hitch(this,this._selectOption),id:_283,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_283);}this._lastInput=key;this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _285=this.srcNodeRef;this.store=new _26d({},_285);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _286=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_286):item[_286];}}}},postCreate:function(){var _287=_26a("label[for=\""+this.id+"\"]");if(_287.length){if(!_287[0].id){_287[0].id=this.id+"_label";}this.domNode.setAttribute("aria-labelledby",_287[0].id);}this.inherited(arguments);this.connect(this,"onSearch","_openResultList");},_getMenuLabelFromItem:function(item){var _288=this.labelFunc(item,this.store),_289=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_288=this.doHighlight(_288,this._lastInput);_289="html";}return {html:_289=="html",label:_288};},doHighlight:function(_28a,find){var _28b=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_26b.escapeString(find);return this._escapeHtml(_28a.replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_28b),"$1")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_28c){return (_28c._oldAPI?_28c.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_28d,_28e,_28f,item){this._set("item",item||null);if(_28d==null){_28d="";}this.inherited(arguments);},_setTextDirAttr:function(_290){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_290);}}});});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_291,_292,lang,_293){return _291("dojox.grid.Selection",null,{constructor:function(_294){this.grid=_294;this.selected=[];this.setMode(_294.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_295){return this.grid.onCanSelect(_295);},onCanDeselect:function(_296){return this.grid.onCanDeselect(_296);},onSelected:function(_297){},onDeselected:function(_298){},onChanging:function(){},onChanged:function(){},isSelected:function(_299){if(this.mode=="none"){return false;}return this.selected[_299];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_29a){if(this.mode=="none"){return -1;}for(var i=_29a+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _29b=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_29b.push(i);}}return _29b;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_29c){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_29c);this.addToSelection(_29c);}else{this.toggleSelect(_29c);}},addToSelection:function(_29d){if(this.mode=="none"){return;}if(lang.isArray(_29d)){_292.forEach(_29d,this.addToSelection,this);return;}_29d=Number(_29d);if(this.selected[_29d]){this.selectedIndex=_29d;}else{if(this.onCanSelect(_29d)!==false){this.selectedIndex=_29d;var _29e=this.grid.getRowNode(_29d);if(_29e){_293.set(_29e,"aria-selected","true");}this._beginUpdate();this.selected[_29d]=true;this.onSelected(_29d);this._endUpdate();}}},deselect:function(_29f){if(this.mode=="none"){return;}if(lang.isArray(_29f)){_292.forEach(_29f,this.deselect,this);return;}_29f=Number(_29f);if(this.selectedIndex==_29f){this.selectedIndex=-1;}if(this.selected[_29f]){if(this.onCanDeselect(_29f)===false){return;}var _2a0=this.grid.getRowNode(_29f);if(_2a0){_293.set(_2a0,"aria-selected","false");}this._beginUpdate();delete this.selected[_29f];this.onDeselected(_29f);this._endUpdate();}},setSelected:function(_2a1,_2a2){this[(_2a2?"addToSelection":"deselect")](_2a1);},toggleSelect:function(_2a3){if(lang.isArray(_2a3)){_292.forEach(_2a3,this.toggleSelect,this);return;}this.setSelected(_2a3,!this.selected[_2a3]);},_range:function(_2a4,inTo,func){var s=(_2a4>=0?_2a4:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_2a5,inTo){this._range(_2a5,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_2a6,inTo){this._range(_2a6,inTo,lang.hitch(this,"deselect"));},insert:function(_2a7){this.selected.splice(_2a7,0,false);if(this.selectedIndex>=_2a7){this.selectedIndex++;}},remove:function(_2a8){this.selected.splice(_2a8,1);if(this.selectedIndex>=_2a8){this.selectedIndex--;}},deselectAll:function(_2a9){for(var i in this.selected){if((i!=_2a9)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_2aa,_2ab,_2ac){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_2aa);}else{var _2ad=this.selectedIndex;if(!_2ab){this.deselectAll(_2aa);}if(_2ac){this.selectRange(_2ad,_2aa);}else{if(_2ab){this.toggleSelect(_2aa);}else{this.addToSelection(_2aa);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"dijit/form/MappedTextBox":function(){define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_2ae,_2af,_2b0){return _2ae("dijit.form.MappedTextBox",_2b0,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_2af.place("<input type='hidden'"+(this.name?" name=\""+this.name.replace(/"/g,"&quot;")+"\"":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/ComboBoxMixin":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_2b1,_2b2,_2b3,lang,_2b4,_2b5,_2b6,_2b7,_2b8){return _2b1("dijit.form.ComboBoxMixin",[_2b7,_2b5],{dropDownClass:_2b6,hasDownArrow:true,templateString:_2b8,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_2b9){if(!_2b9.get){lang.mixin(_2b9,{_oldAPI:true,get:function(id){var _2ba=new _2b2();this.fetchItemByIdentity({identity:id,onItem:function(_2bb){_2ba.resolve(_2bb);},onError:function(_2bc){_2ba.reject(_2bc);}});return _2ba.promise;},query:function(_2bd,_2be){var _2bf=new _2b2(function(){_2c0.abort&&_2c0.abort();});_2bf.total=new _2b2();var _2c0=this.fetch(lang.mixin({query:_2bd,onBegin:function(_2c1){_2bf.total.resolve(_2c1);},onComplete:function(_2c2){_2bf.resolve(_2c2);},onError:function(_2c3){_2bf.reject(_2c3);}},_2be));return _2b4(_2bf);}});}this._set("store",_2b9);},postMixInProperties:function(){var _2c4=this.params.store||this.store;if(_2c4){this._setStoreAttr(_2c4);}this.inherited(arguments);if(!this.params.store&&!this.store._oldAPI){var _2c5=this.declaredClass;lang.mixin(this.store,{getValue:function(item,attr){_2b3.deprecated(_2c5+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return item[attr];},getLabel:function(item){_2b3.deprecated(_2c5+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return item.name;},fetch:function(args){_2b3.deprecated(_2c5+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var shim=["dojo/data/ObjectStore"];require(shim,lang.hitch(this,function(_2c6){new _2c6({objectStore:this}).fetch(args);}));}});}}});});},"dojo/_base/query":function(){define(["../query","./NodeList"],function(_2c7){return _2c7;});},"dijit/form/SimpleTextarea":function(){define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_2c8,_2c9,has,_2ca){return _2c8("dijit.form.SimpleTextarea",_2ca,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_2c9.add(this.textbox,"dijitTextAreaCols");}},filter:function(_2cb){if(_2cb){_2cb=_2cb.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _2cc=parseInt(this.maxLength);var _2cd=this.textbox.value.replace(/\r/g,"");var _2ce=_2cd.length-_2cc;if(_2ce>0){var _2cf=this.textbox;if(_2cf.selectionStart){var pos=_2cf.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_2cd.substring(0,pos-_2ce-cr)+_2cd.substring(pos-cr);_2cf.setSelectionRange(pos-_2ce,pos-_2ce);}else{if(this.ownerDocument.selection){_2cf.focus();var _2d0=this.ownerDocument.selection.createRange();_2d0.moveStart("character",-_2ce);_2d0.text="";_2d0.select();}}}}this.inherited(arguments);}});});},"esri/toolbars/_Box":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/Moveable,dojox/gfx/matrix"],function(_2d1,dojo,_2d2){dojo.provide("esri.toolbars._Box");dojo.require("dojox.gfx.Moveable");dojo.require("dojox.gfx.matrix");dojo.declare("esri.toolbars._Box",null,{constructor:function(_2d3,map,_2d4,_2d5,_2d6,_2d7){this._graphic=_2d3;this._map=map;this._toolbar=_2d4;this._scale=_2d5;this._rotate=_2d6;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_2d7;var _2d8=_2d4._options;this._markerSymbol=_2d8.boxHandleSymbol;this._lineSymbol=_2d8.boxLineSymbol;this._moveStartHandler=dojo.hitch(this,this._moveStartHandler);this._firstMoveHandler=dojo.hitch(this,this._firstMoveHandler);this._moveStopHandler=dojo.hitch(this,this._moveStopHandler);this._moveHandler=dojo.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){dojo.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){dojo.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){dojo.forEach(this._connects,dojo.disconnect,dojo);}var _2d9=this._toolbar._scratchGL;if(this._anchors){dojo.forEach(this._anchors,function(info){_2d9.remove(info.graphic);var mov=info.moveable;if(mov){mov.destroy();}});}if(this._box){_2d9.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_2da=this._toolbar._scratchGL;var _2db=this._getBoxCoords();var _2dc=new esri.geometry.Polyline(map.spatialReference);var path=dojo.clone(dojo.filter(_2db,function(pt,_2dd){return (_2dd!==8&&_2dd%2===0);}));if(path[0]){path.push([path[0][0],path[0][1]]);}_2dc.addPath(path);if(this._rotate){_2dc.addPath([_2db[1],_2db[8]]);}if(this._box){this._box.setGeometry(_2dc);}else{this._box=new esri.Graphic(_2dc,this._lineSymbol);_2da.add(this._box);}if(this._anchors){dojo.forEach(this._anchors,function(info,_2de){if(!this._scale){_2de=8;}var _2df=new esri.geometry.Point(_2db[_2de],map.spatialReference);info.graphic.setGeometry(_2df);var mov=info.moveable,_2e0=info.graphic.getDojoShape();if(_2e0){if(!mov){info.moveable=this._getMoveable(info.graphic,_2de);}else{if(_2e0!==mov.shape){mov.destroy();info.moveable=this._getMoveable(info.graphic,_2de);}}}},this);}else{this._anchors=[];this._connects=[];dojo.forEach(_2db,function(_2e1,_2e2){if(!this._scale&&_2e2<8){return;}_2e1=new esri.geometry.Point(_2e1,map.spatialReference);var _2e3=new esri.Graphic(_2e1,this._markerSymbol);_2da.add(_2e3);this._anchors.push({graphic:_2e3,moveable:this._getMoveable(_2e3,_2e2)});},this);}},_getBoxCoords:function(_2e4){var _2e5=this._graphic,map=this._map,bbox=this._getTransformedBoundingBox(_2e5),_2e6=[],pt,next,_2e7;dojo.forEach(bbox,function(_2e8,_2e9,arr){pt=_2e8;next=arr[_2e9+1];if(!next){next=arr[0];}_2e7={x:(pt.x+next.x)/2,y:(pt.y+next.y)/2};if(!_2e4){pt=map.toMap(pt);_2e7=map.toMap(_2e7);}_2e6.push([pt.x,pt.y]);_2e6.push([_2e7.x,_2e7.y]);});if(this._rotate){var _2ea=dojo.clone(_2e6[1]);_2ea=_2e4?{x:_2ea[0],y:_2ea[1]}:map.toScreen({x:_2ea[0],y:_2ea[1],spatialReference:map.spatialReference});_2ea.y-=this._toolbar._options.rotateHandleOffset;if(!_2e4){_2ea=map.toMap(_2ea);}_2e6.push([_2ea.x,_2ea.y]);}return _2e6;},_getTransformedBoundingBox:function(_2eb){var map=this._map,_2ec=_2eb.geometry.getExtent(),_2ed=_2eb.geometry.spatialReference,_2ee=new esri.geometry.Point(_2ec.xmin,_2ec.ymax,_2ed),_2ef=new esri.geometry.Point(_2ec.xmax,_2ec.ymin,_2ed);_2ee=map.toScreen(_2ee);_2ef=map.toScreen(_2ef);return [{x:_2ee.x,y:_2ee.y},{x:_2ef.x,y:_2ee.y},{x:_2ef.x,y:_2ef.y},{x:_2ee.x,y:_2ef.y}];},_getAllGraphics:function(){var _2f0=[this._box];if(this._anchors){dojo.forEach(this._anchors,function(_2f1){_2f0.push(_2f1.graphic);});}_2f0=dojo.filter(_2f0,esri._isDefined);return _2f0;},_getMoveable:function(_2f2,_2f3){var _2f4=_2f2.getDojoShape();if(!_2f4){return;}var _2f5=new _2d2.gfx.Moveable(_2f4);_2f5._index=_2f3;this._connects.push(dojo.connect(_2f5,"onMoveStart",this._moveStartHandler));this._connects.push(dojo.connect(_2f5,"onFirstMove",this._firstMoveHandler));this._connects.push(dojo.connect(_2f5,"onMoveStop",this._moveStopHandler));_2f5.onMove=this._moveHandler;var node=_2f4.getEventSource();if(node){dojo.style(node,"cursor",this._toolbar._cursors["box"+_2f3]);}return _2f5;},_moveStartHandler:function(_2f6){this._toolbar["on"+(_2f6.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_2f7){var _2f8=_2f7.host._index,_2f9=(this._wrapOffset=_2f7.host.shape._wrapOffsets[0]||0),_2fa=this._graphic.getLayer()._div.getTransform(),mx=_2d2.gfx.matrix,_2fb,_2fc,_2fd,_2fe=dojo.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_2f9,y:arr[1]};});_2fd={x:_2fe[1].x,y:_2fe[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_2fa),_2fd);if(_2f8===8){_2fb=mx.multiplyPoint(mx.invert(_2fa),_2fe[1]);this._startLine=[this._centerCoord,_2fb];this._moveLine=dojo.clone(this._startLine);}else{_2fb=mx.multiplyPoint(mx.invert(_2fa),_2fe[_2f8]);_2fc=mx.multiplyPoint(mx.invert(_2fa),_2fe[(_2f8+4)%8]);this._firstMoverToCenter=Math.sqrt((_2fb.x-this._centerCoord.x)*(_2fb.x-this._centerCoord.x)+(_2fb.y-this._centerCoord.y)*(_2fb.y-this._centerCoord.y));this._startBox=_2fc;this._startBox.width=(_2fe[4].x-_2fe[0].x);this._startBox.height=(_2fe[4].y-_2fe[0].y);this._moveBox=dojo.clone(this._startBox);this._xfactor=_2fb.x>_2fc.x?1:-1;this._yfactor=_2fb.y>_2fc.y?1:-1;if(_2f8===1||_2f8===5){this._xfactor=0;}else{if(_2f8===3||_2f8===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_2f8===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_2ff,_300){var _301=_2ff.host._index,args=this._defaultEventArgs,_302,move,tx,pt,_303,_304,_305,_306=0,_307=0,_308,_309,_30a;args.angle=0;args.scaleX=1;args.scaleY=1;if(_301===8){_302=this._startLine;move=this._moveLine;pt=move[1];pt.x+=_300.dx;pt.y+=_300.dy;_303=this._getAngle(_302,move);tx=_2d2.gfx.matrix.rotategAt(_303,_302[0]);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.angle=_303;args.around=_302[0];}else{_302=this._startBox;move=this._moveBox;move.width+=(_300.dx*this._xfactor);move.height+=(_300.dy*this._yfactor);if(this._uniformScaling){_308=move.x+this._xfactor*move.width;_309=move.y+this._yfactor*move.height;_30a=Math.sqrt((_308-this._centerCoord.x)*(_308-this._centerCoord.x)+(_309-this._centerCoord.y)*(_309-this._centerCoord.y));_304=_305=_30a/this._firstMoverToCenter;_306=this._xfactor*_302.width/2;_307=this._yfactor*_302.height/2;}else{_304=move.width/_302.width;_305=move.height/_302.height;}if(isNaN(_304)||_304===Infinity||_304===-Infinity){_304=1;}if(isNaN(_305)||_305===Infinity||_305===-Infinity){_305=1;}tx=_2d2.gfx.matrix.scaleAt(_304,_305,_302.x+_306,_302.y+_307);this._graphic.getDojoShape().setTransform(tx);args.transform=tx;args.scaleX=_304;args.scaleY=_305;args.around={x:_302.x+_306,y:_302.y+_307};}this._toolbar["on"+(_301===8?this._rotateEvent:this._scaleEvent)](this._graphic,args);},_moveStopHandler:function(_30b){var _30c=this._graphic,_30d=this._toolbar,_30e=_30d._geo?esri.geometry.geographicToWebMercator(_30c.geometry):_30c.geometry,_30f=_30e.spatialReference,_310=_30c.getDojoShape(),_311=_310.getTransform(),_312=_30c.getLayer()._div.getTransform();_30e=_30e.toJson();this._updateSegments(_30e.paths||_30e.rings,_311,_312,_30f);_310.setTransform(null);_30e=esri.geometry.fromJson(_30e);_30c.setGeometry(_30d._geo?esri.geometry.webMercatorToGeographic(_30e,true):_30e);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_30d._endOperation("BOX");this._defaultEventArgs.transform=_311;_30d["on"+(_30b.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_313,_314,_315,_316){var mx=_2d2.gfx.matrix,map=this._map,_317=this._wrapOffset||0;dojo.forEach(_313,function(_318){dojo.forEach(_318,function(_319){var _31a=map.toScreen({x:_319[0],y:_319[1],spatialReference:_316},true);_31a.x+=_317;_31a=mx.multiplyPoint([_315,_314,mx.invert(_315)],_31a);_31a.x-=_317;var _31b=map.toMap(_31a);_319[0]=_31b.x;_319[1]=_31b.y;});});},_getAngle:function(_31c,_31d){var _31e=Math.atan2(_31c[0].y-_31c[1].y,_31c[0].x-_31c[1].x)*180/Math.PI,_31f=Math.atan2(_31d[0].y-_31d[1].y,_31d[0].x-_31d[1].x)*180/Math.PI;return _31f-_31e;}});});},"dijit/_editor/plugins/TextColor":function(){define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_320,_321,_322,lang,_323,_324){var _325=_322("dijit._editor.plugins.TextColor",_323,{buttonClass:_324,useDefaultCommand:false,_initButton:function(){this.inherited(arguments);var self=this;this.button.loadDropDown=function(_326){_320(["../../ColorPalette"],lang.hitch(this,function(_327){this.dropDown=new _327({ownerDocument:self.editor.ownerDocument,value:self.value,onChange:function(_328){self.editor.execCommand(self.command,_328);}});_326();}));};},updateState:function(){var _329=this.editor;var _32a=this.command;if(!_329||!_329.isLoaded||!_32a.length){return;}if(this.button){var _32b=this.get("disabled");this.button.set("disabled",_32b);if(_32b){return;}var _32c;try{_32c=_329.queryCommandValue(_32a)||"";}catch(e){_32c="";}}if(_32c==""){_32c="#000000";}if(_32c=="transparent"){_32c="#ffffff";}if(typeof _32c=="string"){if(_32c.indexOf("rgb")>-1){_32c=_321.fromRgb(_32c).toHex();}}else{_32c=((_32c&255)<<16)|(_32c&65280)|((_32c&16711680)>>>16);_32c=_32c.toString(16);_32c="#000000".slice(0,7-_32c.length)+_32c;}this.value=_32c;var _32d=this.button.dropDown;if(_32d&&_32c!==_32d.get("value")){_32d.set("value",_32c,false);}}});_323.registry["foreColor"]=function(){return new _325({command:"foreColor"});};_323.registry["hiliteColor"]=function(){return new _325({command:"hiliteColor"});};return _325;});},"esri/dijit/editing/tools/ButtonToolBase":function(){define(["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/ToolBase,dijit/form/Button"],function(_32e,dojo,_32f){dojo.provide("esri.dijit.editing.tools.ButtonToolBase");dojo.require("esri.dijit.editing.tools.ToolBase");dojo.require("dijit.form.Button");dojo.declare("esri.dijit.editing.tools.ButtonToolBase",[_32e.form.Button,esri.dijit.editing.tools.ToolBase],{postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_32e.form.Button.prototype.destroy.apply(this,arguments);esri.dijit.editing.tools.ToolBase.prototype.destroy.apply(this,arguments);}});});},"esri/dijit/editing/tools/Editing":function(){define("esri/dijit/editing/tools/Editing",["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/DropDownToolBase,esri/dijit/editing/Util,esri/dijit/editing/tools/EditingTools"],function(_330,dojo,_331){dojo.provide("esri.dijit.editing.tools.Editing");dojo.require("esri.dijit.editing.tools.DropDownToolBase");dojo.require("esri.dijit.editing.Util");dojo.require("esri.dijit.editing.tools.EditingTools");dojo.declare("esri.dijit.editing.tools.Editing",[esri.dijit.editing.tools.DropDownToolBase],{_enabled:false,deactivate:function(){if(!this._enabled){return;}this._enabled=false;this.inherited(arguments);this._settings.templatePicker.clearSelection();},onItemClicked:function(evt){this.inherited(arguments);if(this._activeTool===this._tools.AUTOCOMPLETE){this._settings.editor._drawingTool=esri.layers.FeatureTemplate.TOOL_AUTO_COMPLETE_POLYGON;}},_activateTool:function(_332,_333){this.enable(_333);for(var i in this._tools){if(this._tools.hasOwnProperty(i)){this.dropDown.removeChild(this._tools[i]);if(this._tools[i]._enabled===true){this.dropDown.addChild(this._tools[i]);}}}if(this._geometryType!==_333||this._activeTool._enabled===false){this._activeTool=this._tools[_332.toUpperCase()];}this._geometryType=_333;this._activeTool.activate();this._activeTool.setChecked(true);this._updateUI();},_initializeTool:function(_334){this.inherited(arguments);this._initializeTools();},_initializeTools:function(){var _335=this._settings.layers;var _336=this._settings.editor;var _337=false,line=false,poly=false;var _338=this._toolTypes=[];var _339;dojo.forEach(_335,function(_33a){_339=_33a.geometryType;_337=_337||_339==="esriGeometryPoint";line=line||_339==="esriGeometryPolyline";poly=poly||_339==="esriGeometryPolygon";_338=_338.concat(dojo.map(this._getTemplatesFromLayer(_33a),dojo.hitch(this,function(_33b){return _336._toDrawTool(_33b.drawingTool,_33a);})));},this);var _33c=this._settings.createOptions;if(_337){this._toolTypes.push("point");}if(line){this._toolTypes=this._toolTypes.concat(_33c.polylineDrawTools);}if(poly){this._toolTypes=this._toolTypes.concat(_33c.polygonDrawTools);}this._toolTypes=this._toUnique(this._toolTypes.concat(_338));},_toUnique:function(arr){var test={};return dojo.filter(arr,function(val){return test[val]?false:(test[val]=true);});},_getTemplatesFromLayer:function(_33d){var _33e=_33d.templates||[];var _33f=_33d.types;dojo.forEach(_33f,function(type){_33e=_33e.concat(type.templates);});return dojo.filter(_33e,esri._isDefined);},_createTools:function(){dojo.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_340){var _341=dojo.mixin(esri.dijit.editing.tools.EditingTools[_340],{settings:this._settings,onClick:dojo.hitch(this,"onItemClicked")});this._tools[_340.toUpperCase()]=new esri.dijit.editing.tools.Edit(_341);}});});},"esri/dijit/AttributeInspector":function(){define(["dijit","dojo","dojox","dojo/require!dojo/fx,dojox/gfx,dijit/_Widget,dijit/_Templated,dijit/Editor,dijit/_editor/plugins/LinkDialog,dijit/_editor/plugins/TextColor,esri/dijit/editing/AttachmentEditor,esri/dijit/editing/Util,esri/tasks/query,dijit/form/DateTextBox,dijit/form/TextBox,dijit/form/NumberTextBox,dijit/form/FilteringSelect,dijit/form/NumberSpinner,dijit/form/Button,dijit/form/SimpleTextarea,dijit/Tooltip,dojo/data/ItemFileReadStore,dojox/date/islamic,dojox/date/islamic/Date,dojox/date/islamic/locale"],function(_342,dojo,_343){dojo.provide("esri.dijit.AttributeInspector");dojo.require("dojo.fx");dojo.require("dojox.gfx");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dijit.Editor");dojo.require("dijit._editor.plugins.LinkDialog");dojo.require("dijit._editor.plugins.TextColor");dojo.require("esri.dijit.editing.AttachmentEditor");dojo.require("esri.dijit.editing.Util");dojo.require("esri.tasks.query");dojo.require("dijit.form.DateTextBox");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.NumberSpinner");dojo.require("dijit.form.Button");dojo.require("dijit.form.SimpleTextarea");dojo.require("dijit.Tooltip");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojox.date.islamic");dojo.require("dojox.date.islamic.Date");dojo.require("dojox.date.islamic.locale");dojo.declare("esri.dijit.AttributeInspector",[_342._Widget,_342._Templated],{widgetsInTemplate:true,templateString:"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n",_navMessage:"( ${idx} ${of} ${numFeatures} )",onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},constructor:function(_344,_345){dojo.mixin(this,esri.bundle.widgets.attributeInspector);_344=_344||{};if(!_344.featureLayer&&!_344.layerInfos){console.error("esri.AttributeInspector: please provide correct parameter in the constructor");}this._userIds={};if(_344.featureLayer&&_344.featureLayer.credential){var _346=_344.featureLayer.id;this._userIds[_346]=_344.featureLayer.credential.userId;}else{if(_344.layerInfos){var _347=_344.layerInfos;dojo.forEach(_347,function(_348){if(_348.featureLayer){var _349=_348.featureLayer.id;if(_348.featureLayer.credential){this._userIds[_349]=_348.featureLayer.credential.userId;}if(_348.userId){this._userIds[_349]=_348.userId;}}},this);}}this._datePackage=this._getDatePackage(_344);this._layerInfos=_344.layerInfos||[{featureLayer:_344.featureLayer,options:_344.options||[]}];this._aiConnects=[];this._selection=[];this._toolTips=[];this._numFeatures=0;this._featureIdx=0;this._currentLInfo=null;this._currentFeature=null;this._hideNavButtons=_344.hideNavButtons||false;},postCreate:function(){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();},destroy:function(){this._destroyAttributeTable();dojo.forEach(this._aiConnects,dojo.disconnect);delete this._aiConnects;if(this._attachmentEditor){this._attachmentEditor.destroy();delete this._attachmentEditor;}delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments);},refresh:function(){this._updateSelection();},first:function(){this.onFirstFeature();},last:function(){this.onLastFeature();},next:function(){this.onNextFeature();},previous:function(){this.onPreviousFeature();},showFeature:function(_34a,_34b){if(_34b){this._createOnlyFirstTime=true;}this._updateSelection([_34a],_34b);this._updateUI();},onLayerSelectionChange:function(_34c,_34d,_34e){this._createOnlyFirstTime=false;this._featureIdx=(_34e===esri.layers.FeatureLayer.SELECTION_NEW)?0:this._featureIdx;this._updateSelection();this._updateUI();},onLayerSelectionClear:function(){if(!this._selection||this._selection.length<=0){return;}this._numFeatures=0;this._featureIdx=0;this._selection=[];this._currentFeature=null;this._currentLInfo=null;this._updateUI();},onLayerEditsComplete:function(_34f,adds,_350,_351){_351=_351||[];if(_351.length){var _352=this._selection;var _353=_34f.featureLayer.objectIdField;dojo.forEach(_351,dojo.hitch(this,function(del){dojo.some(_352,dojo.hitch(this,function(item,idx){if(item.attributes[_353]!==del.objectId){return false;}this._selection.splice(idx,1);return true;}));}));}adds=adds||[];if(adds.length){this._selection=esri.dijit.editing.Util.LayerHelper.findFeatures(adds,_34f.featureLayer);this._featureIdx=0;}var _354=this._numFeatures=this._selection?this._selection.length:0;if(adds.length){var _355=_354?this._selection[this._featureIdx]:null;if(_355){var _356=_355.getLayer();var _357=_356.getEditCapabilities();if(!(_357.canCreate&&!_357.canUpdate)){this._showFeature(_355);}}}this._updateUI();},onFieldValueChange:function(_358,_359){_359=(typeof _359==="undefined")?null:_359;var _35a=_358.field;if(_35a.type==="esriFieldTypeDate"){_359=(_359&&_359.getTime)?_359.getTime():(_359&&_359.toGregorian?_359.toGregorian().getTime():_359);}if(this._currentFeature.attributes[_35a.name]===_359){return;}var _35b=this._currentLInfo;var _35c=this._currentFeature;var _35d=_35a.name;if(_35d===_35b.typeIdField){var type=this._findFirst(_35b.types,"id",_359);var _35e=_35b.fieldInfos;dojo.forEach(_35e,function(_35f){_35a=_35f.field;if(!_35a||_35a.name===_35b.typeIdField){return;}var node=_35f.dijit;var _360=this._setFieldDomain(node,type,_35a);if(_360&&node){this._setValue(node,_35c.attributes[_35a.name]+"");if(node.isValid()===false){this._setValue(node,null);}}},this);}this.onAttributeChange(_35c,_35d,_359);},onDeleteBtn:function(evt){this._deleteFeature();},onNextFeature:function(evt){this._onNextFeature(1);},onPreviousFeature:function(evt){this._onNextFeature(-1);},onFirstFeature:function(evt){this._onNextFeature(this._featureIdx*-1);},onLastFeature:function(evt){this._onNextFeature((this._numFeatures-1)-this._featureIdx);},_initLayerInfos:function(){var _361=this._layerInfos;this._editorTrackingInfos={};dojo.forEach(_361,this._initLayerInfo,this);},_initLayerInfo:function(_362){var _363=_362.featureLayer;this._connect(_363,"onSelectionComplete",dojo.hitch(this,"onLayerSelectionChange",_362));this._connect(_363,"onSelectionClear",dojo.hitch(this,"onLayerSelectionClear",_362));this._connect(_363,"onEditsComplete",dojo.hitch(this,"onLayerEditsComplete",_362));_362.showAttachments=_363.hasAttachments?(esri._isDefined(_362.showAttachments)?_362.showAttachments:true):false;_362.hideFields=_362.hideFields||[];_362.htmlFields=_362.htmlFields||[];_362.isEditable=_363.isEditable()?(esri._isDefined(_362.isEditable)?_362.isEditable:true):false;_362.typeIdField=_363.typeIdField;_362.layerId=_363.id;_362.types=_363.types;if(!_362.showGlobalID&&_363.globalIdField){_362.hideFields.push(_363.globalIdField);}if(!_362.showObjectID){_362.hideFields.push(_363.objectIdField);}var _364=this._getFields(_362.featureLayer);if(!_364){return;}var _365=_362.fieldInfos||[];_365=dojo.map(_365,function(_366){return dojo.mixin({},_366);});if(!_365.length){_364=dojo.filter(_364,dojo.hitch(this,function(_367){return !this._isInFields(_367.name,_362.hideFields);}));_362.fieldInfos=dojo.map(_364,dojo.hitch(this,function(_368){var _369=(this._isInFields(_368.name,_362.htmlFields)?esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT:esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTBOX);return {"fieldName":_368.name,"field":_368,"stringFieldOption":_369};}));}else{_362.fieldInfos=dojo.filter(dojo.map(_365,dojo.hitch(this,function(_36a){var _36b=_36a.stringFieldOption||(this._isInFields(_36a.fieldName,_362.htmlFields)?esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT:esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTBOX);return dojo.mixin(_36a,{"field":this._findFirst(_364,"name",_36a.fieldName),"stringFieldOption":_36b});})),"return item.field;");}var _36c=[];if(_363.editFieldsInfo){if(_363.editFieldsInfo.creatorField){_36c.push(_363.editFieldsInfo.creatorField);}if(_363.editFieldsInfo.creationDateField){_36c.push(_363.editFieldsInfo.creationDateField);}if(_363.editFieldsInfo.editorField){_36c.push(_363.editFieldsInfo.editorField);}if(_363.editFieldsInfo.editDateField){_36c.push(_363.editFieldsInfo.editDateField);}}this._editorTrackingInfos[_363.id]=_36c;},_createAttachmentEditor:function(){this._attachmentEditor=null;var _36d=this._layerInfos;var _36e=dojo.filter(_36d,"return item.showAttachments");if(!_36e||!_36e.length){return;}this._attachmentEditor=new esri.dijit.editing.AttachmentEditor({"class":"atiAttachmentEditor"},this.attachmentEditor);this._attachmentEditor.startup();},_setCurrentLInfo:function(_36f){var _370=this._currentLInfo?this._currentLInfo.featureLayer:null;var _371=_36f.featureLayer;if(_370&&_370.id===_371.id&&!_370.ownershipBasedAccessControlForFeatures){var _372=_371.getEditCapabilities();if(!(_372.canCreate&&!_372.canUpdate)){return;}}this._currentLInfo=_36f;this._createTable();},_updateSelection:function(_373,_374){this._selection=_373||[];var _375=this._layerInfos;dojo.forEach(_375,this._getSelection,this);var _376=this._numFeatures=this._selection.length;var _377=_376?this._selection[this._featureIdx]:null;this._showFeature(_377,_374);},_getSelection:function(_378){var _379=_378.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(_379);},_updateUI:function(){var _37a=this._numFeatures;var _37b=this._currentLInfo;this.layerName.innerHTML=(!_37b||_37a===0)?this.NLS_noFeaturesSelected:(_37b.featureLayer?_37b.featureLayer.name:"");dojo.style(this.attributeTable,"display",_37a?"":"none");dojo.style(this.editButtons,"display",_37a?"":"none");dojo.style(this.navButtons,"display",(!this._hideNavButtons&&(_37a>1)?"":"none"));this.navMessage.innerHTML=esri.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);if(this._attachmentEditor){dojo.style(this._attachmentEditor.domNode,"display",((_37b&&_37b.showAttachments)&&_37a)?"":"none");}var _37c=((_37b&&_37b.showDeleteButton===false)||!this._canDelete)?false:true;dojo.style(this.deleteBtn.domNode,"display",_37c?"":"none");if(this.domNode.parentNode&&this.domNode.parentNode.scrollTop>0){this.domNode.parentNode.scrollTop=0;}},_onNextFeature:function(_37d){this._featureIdx+=_37d;if(this._featureIdx<0){this._featureIdx=this._numFeatures-1;}else{if(this._featureIdx>=this._numFeatures){this._featureIdx=0;}}var _37e=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(_37e);this._updateUI();this.onNext(_37e);},_deleteFeature:function(){this.onDelete(this._currentFeature);},_showFeature:function(_37f,_380){if(!_37f){return;}this._currentFeature=_37f;var _381=_380?_380:_37f.getLayer();var _382=_381.getEditCapabilities({feature:_37f,userId:this._userIds[_381.id]});this._canUpdate=_382.canUpdate;this._canDelete=_382.canDelete;var _383=this._getLInfoFromFeatureLayer(_381);if(!_383){return;}this._setCurrentLInfo(_383);var _384=_37f.attributes;var type=this._findFirst(_383.types,"id",_384[_383.typeIdField]);var node,_385=null;var _386=_383.fieldInfos;dojo.forEach(_386,function(_387){_385=_387.field;node=_387.dijit||null;if(!node){return;}var _388=this._setFieldDomain(node,type,_385);var _389=_384[_385.name];_389=(_389&&_388&&_388.codedValues&&_388.codedValues.length)?(_388.codedValues[_389]?_388.codedValues[_389].name:_389):_389;if(!esri._isDefined(_389)){_389="";}if(node.declaredClass==="dijit.form.DateTextBox"){_389=(_389==="")?null:new Date(_389);}else{if(node.declaredClass==="dijit.form.FilteringSelect"){node._lastValueReported=null;_389=_384[_385.name]+"";}}try{this._setValue(node,_389);if(node.declaredClass==="dijit.form.FilteringSelect"&&node.isValid()===false){this._setValue(node,null);}}catch(error){node.set("displayedValue",this.NLS_errorInvalid,false);}},this);if(this._attachmentEditor&&_383.showAttachments){this._attachmentEditor.showAttachments(this._currentFeature);}var _38a=_381.getEditSummary(_37f);if(_38a){this.editorTrackingInfoDiv.innerHTML=_38a;esri.show(this.editorTrackingInfoDiv);}else{esri.hide(this.editorTrackingInfoDiv);}},_setFieldDomain:function(node,type,_38b){if(!node){return null;}var _38c=_38b.domain;if(type&&type.domains){if(type.domains[_38b.name]&&type.domains[_38b.name] instanceof esri.layers.InheritedDomain===false){_38c=type.domains[_38b.name];}}if(!_38c){return null;}if(_38c.codedValues&&_38c.codedValues.length>0){node.set("store",this._toStore(dojo.map(_38c.codedValues,"return { id: item.code += '', name: item.name };")));this._setValue(node,_38c.codedValues[0].code);}else{node.constraints={min:esri._isDefined(_38c.minValue)?_38c.minValue:Number.MIN_VALUE,max:esri._isDefined(_38c.maxValue)?_38c.maxValue:Number.MAX_VALUE};this._setValue(node,node.constraints.min);}return _38c;},_setValue:function(node,_38d){if(!node.set){return;}node._onChangeActive=false;node.set("value",_38d,true);node._onChangeActive=true;},_getFields:function(_38e){var _38f=_38e._getOutFields();if(!_38f){return null;}var _390=_38e.fields;return (_38f=="*")?_390:dojo.filter(dojo.map(_38f,dojo.hitch(this,"_findFirst",_390,"name")),esri._isDefined);},_isInFields:function(_391,_392){if(!_391||!_392&&!_392.length){return false;}return dojo.some(_392,function(name){return name.toLowerCase()===_391.toLowerCase();});},_findFirst:function(_393,_394,_395){var _396=dojo.filter(_393,function(item){return item.hasOwnProperty(_394)&&item[_394]===_395;});return (_396&&_396.length)?_396[0]:null;},_getLInfoFromFeatureLayer:function(_397){var _398=_397?_397.id:null;return this._findFirst(this._layerInfos,"layerId",_398);},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=dojo.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var _399=dojo.create("tbody",null,this._attributes);var _39a=this._currentFeature;var _39b=this._currentLInfo;var type=this._findFirst(_39b.types,"id",_39a.attributes[_39b.typeIdField]);var _39c=_39b.fieldInfos;dojo.forEach(_39c,dojo.hitch(this,"_createField",type,_399),this);this._createOnlyFirstTime=false;},_createField:function(type,_39d,_39e){var _39f=this._currentLInfo;var _3a0=_39e.field;if(this._isInFields(_3a0.name,_39f.hideFields)){return;}if(this._isInFields(_3a0.name,this._editorTrackingInfos[_39f.featureLayer.id])){return;}var node=dojo.create("tr",null,_39d);var td=dojo.create("td",{innerHTML:_39e.label||_3a0.alias||_3a0.name,"class":"atiLabel"},node);td=dojo.create("td",null,node);var _3a1=null;var _3a2=false;if(_39e.customField){dojo.place(_39e.customField.domNode||_39e.customField,dojo.create("div",null,td),"first");_3a1=_39e.customField;}else{if(_39f.isEditable===false||_3a0.editable===false||_39e.isEditable===false||_3a0.type==="esriFieldTypeOID"||_3a0.type==="esriFieldTypeGlobalID"||(!this._canUpdate&&!this._createOnlyFirstTime)){_3a2=true;}}if(!_3a1&&(_39f.typeIdField&&_3a0.name.toLowerCase()==_39f.typeIdField.toLowerCase())){_3a1=this._createTypeField(_3a0,_39e,td);}else{if(!_3a1){_3a1=this._createDomainField(_3a0,_39e,type,td);}}if(!_3a1){switch(_3a0.type){case "esriFieldTypeString":_3a1=this._createStringField(_3a0,_39e,td);break;case "esriFieldTypeDate":_3a1=this._createDateField(_3a0,_39e,td);break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":_3a1=this._createIntField(_3a0,_39e,td);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":_3a1=this._createFltField(_3a0,_39e,td);break;default:_3a1=this._createStringField(_3a0,_39e,td);break;}}if(_39e.tooltip&&_39e.tooltip.length){this._toolTips.push(new _342.Tooltip({connectId:[_3a1.id],label:_39e.tooltip}));}_3a1.onChange=dojo.hitch(this,"onFieldValueChange",_39e);_3a1.set("disabled",_3a2);_39e.dijit=_3a1;},_createTypeField:function(_3a3,_3a4,node){return new _342.form.FilteringSelect({"class":"atiField",name:_3a3.alias||_3a3.name,store:this._toStore(dojo.map(this._currentLInfo.types,"return { id: item.id, name: item.name };")),searchAttr:"name"},dojo.create("div",null,node));},_createDomainField:function(_3a5,_3a6,type,node){var _3a7=_3a5.domain;if(type&&type.domains){if(type.domains[_3a5.name]&&type.domains[_3a5.name] instanceof esri.layers.InheritedDomain===false){_3a7=type.domains[_3a5.name];}}if(!_3a7){return null;}if(_3a7.codedValues){return new _342.form.FilteringSelect({"class":"atiField",name:_3a5.alias||_3a5.name,searchAttr:"name",required:_3a5.nullable||false},dojo.create("div",null,node));}else{return new _342.form.NumberSpinner({"class":"atiField"},dojo.create("div",null,node));}},_createStringField:function(_3a8,_3a9,node){var _3aa={"class":"atiField",trim:true,maxLength:_3a8.length};if(_3a9.stringFieldOption===esri.dijit.AttributeInspector.STRING_FIELD_OPTION_TEXTAREA){_3aa["class"]+=" atiTextAreaField";return new _342.form.SimpleTextarea(_3aa,dojo.create("div",null,node));}else{if(_3a9.stringFieldOption===esri.dijit.AttributeInspector.STRING_FIELD_OPTION_RICHTEXT){_3aa["class"]+=" atiRichTextField";_3aa.height="100%";_3aa.width="100%";_3aa.plugins=_3a9.richTextPlugins||["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];return new _342.Editor(_3aa,dojo.create("div",null,node));}else{return new _342.form.TextBox(_3aa,dojo.create("div",null,node));}}},_createDateField:function(_3ab,_3ac,node){var _3ad={"class":"atiField","trim":true};if(this._datePackage){_3ad.datePackage=this._datePackage;}return new _342.form.DateTextBox(_3ad,dojo.create("div",null,node));},_createIntField:function(_3ae,_3af,node){return new _342.form.NumberTextBox({"class":"atiField",constraints:{places:0},invalidMessage:this.NLS_validationInt,trim:true},dojo.create("div",null,node));},_createFltField:function(_3b0,_3b1,node){return new _342.form.NumberTextBox({"class":"atiField",trim:true,invalidMessage:this.NLS_validationFlt},dojo.create("div",null,node));},_toStore:function(_3b2){return new dojo.data.ItemFileReadStore({data:{identifier:"id",label:"name",items:_3b2}});},_connect:function(node,evt,func){this._aiConnects.push(dojo.connect(node,evt,func));},_getDatePackage:function(_3b3){if(_3b3.datePackage===null){return null;}else{if(_3b3.datePackage){return _3b3.datePackage;}else{if(dojo.locale==="ar"){return "dojox.date.islamic";}}}return null;},_destroyAttributeTable:function(){var _3b4=this._layerInfos;dojo.forEach(_3b4,function(_3b5){var _3b6=_3b5.fieldInfos;dojo.forEach(_3b6,function(_3b7){var _3b8=_3b7.dijit;if(_3b8){_3b8._onChangeHandle=null;if(_3b7.customField){return;}if(_3b8.destroyRecursive){_3b8.destroyRecursive();}else{if(_3b8.destroy){_3b8.destroy();}}}_3b7.dijit=null;},this);},this);var _3b9=this._toolTips;dojo.forEach(_3b9,"item.destroy(); delete item;");this._toolTips=[];if(this._attributes){dojo.destroy(this._attributes);}}});dojo.mixin(esri.dijit.AttributeInspector,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});});},"esri/dijit/editing/Editor":function(){define(["dijit","dojo","dojox","dojo/require!dijit/ProgressBar,dijit/_Widget,dijit/_Templated,esri/toolbars/edit,esri/toolbars/draw,esri/layers/FeatureLayer,esri/dijit/editing/Util,esri/dijit/editing/toolbars/Drawing,esri/dijit/editing/TemplatePicker,esri/dijit/AttributeInspector,esri/dijit/editing/SelectionHelper,esri/undoManager,esri/dijit/editing/editOperation"],function(_3ba,dojo,_3bb){dojo.provide("esri.dijit.editing.Editor");dojo.require("dijit.ProgressBar");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("esri.toolbars.edit");dojo.require("esri.toolbars.draw");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.dijit.editing.Util");dojo.require("esri.dijit.editing.toolbars.Drawing");dojo.require("esri.dijit.editing.TemplatePicker");dojo.require("esri.dijit.AttributeInspector");dojo.require("esri.dijit.editing.SelectionHelper");dojo.require("esri.undoManager");dojo.require("esri.dijit.editing.editOperation");dojo.declare("esri.dijit.editing.Editor",[_3ba._Widget,_3ba._Templated],{widgetsInTemplate:true,templateString:"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>",constructor:function(_3bc,_3bd){_3bc=_3bc||{};if(!_3bc.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_3bc.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_3bc.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();this._initLayers();this._connectEvents();this._createWidgets();this._reset();this._enableMapClickHandler();},stopEditing:function(_3be){this._updateCurrentFeature(dojo.hitch(this,function(){this._clearSelection(false);_3be&&_3be();}));},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();dojo.forEach(this._eConnects,"dojo.disconnect(item);");dojo.disconnect(this._dtConnect);dojo.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new esri.toolbars.Draw(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new esri.toolbars.Edit(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=dojo.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=dojo.mixin({polylineDrawTools:[esri.dijit.editing.Editor.CREATE_TOOL_POLYLINE],polygonDrawTools:[esri.dijit.editing.Editor.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;this._datePackage=this._settings.datePackage;var _3bf=esri.config.defaults;this._settings.geometryService=this._settings.geometryService||_3bf.geometryService;_3bf.geometryService=_3bf.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};var _3c0=this._settings.layerInfos;dojo.forEach(_3c0,function(_3c1){if(_3c1.featureLayer&&_3c1.featureLayer.loaded){this._settings.layers.push(_3c1.featureLayer);var _3c2=_3c1.featureLayer.id;if(_3c1.featureLayer.credential){this._settings.userIds[_3c2]=_3c1.featureLayer.credential.userId;}if(_3c1.userId){this._settings.userIds[_3c2]=_3c1.userId;}var _3c3=_3c1.featureLayer.getEditCapabilities();if(_3c3.canCreate&&!_3c3.canUpdate){this._settings.createOnlyLayer[_3c2]=true;}else{this._settings.createOnlyLayer[_3c2]=false;}}},this);},_reset:function(){this._hideAttributeInspector();this._editToolbar.deactivate();this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;},_saveFeatureOnClient:function(_3c4){var _3c5=this.templatePicker.getSelected();var _3c6;if(_3c5.template){_3c6=_3c5.featureLayer.renderer.getSymbol(_3c5.template.prototype);}else{_3c6=_3c5.symbolInfo.symbol;}var _3c7=_3c5.featureLayer.fields;var att={};dojo.forEach(_3c7,function(_3c8,idx){att[_3c8.name]=null;});this._tempGraphic=new esri.Graphic(_3c4,_3c6,att,null);var map=this._settings.map;map.graphics.add(this._tempGraphic);var _3c9=this._findCenterPoint(_3c4);this._createAttributeInspector(true);map.infoWindow.setTitle(_3c5.featureLayer?_3c5.featureLayer.name:esri.bundle.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,_3c5.featureLayer);this._showInfoWindow(_3c9,map.getInfoWindowAnchor(_3c9));if(this._settings.createOnlyLayer[_3c5.featureLayer.id]){this._infoWindowHideEvent=dojo.connect(map.infoWindow,"onHide",this,"_infoWindowHide");}dojo.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}this._templatePickerOnSelectionChangeEvent=dojo.connect(this.templatePicker,"onSelectionChange",dojo.hitch(this,"_onCreateFeature"));},_saveAttributesOnClient:function(_3ca,_3cb,_3cc){this._tempGraphic.attributes[_3cb]=(typeof (_3cc)==="number"&&isNaN(_3cc))?null:_3cc;},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);dojo.disconnect(this._infoWindowHideEvent);},_createFeature:function(_3cd,_3ce){this._editClickPoint=this._findCenterPoint(_3cd);if(!_3cd.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_3cd,_3ce)]}]);return;}this._simplify(_3cd,dojo.hitch(this,function(_3cf){if(this._drawingTool!==esri.layers.FeatureTemplate.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_3cf,_3ce)]}]);}else{this._autoComplete(_3cf,dojo.hitch(this,function(_3d0){if(_3d0&&_3d0.length){this._applyEdits([{layer:this._layer,adds:dojo.map(_3d0,dojo.hitch(this,function(_3d1){return this._createGraphic(_3d1,_3ce);}))}]);}}));}}));},_updateCurrentFeature:function(_3d2){var _3d3=this._isModified();if(_3d3){this._updateFeature(_3d3,_3d2);}else{if(_3d2){_3d2(false);}}},_updateFeature:function(_3d4,_3d5){var geom=_3d4.geometry;if(!geom.rings){this._applyEdits([{layer:_3d4.getLayer(),updates:[_3d4]}],_3d5);}else{this._simplify(geom,dojo.hitch(this,function(_3d6){this._applyEdits([{layer:_3d4.getLayer(),updates:[dojo.mixin(_3d4,{geometry:_3d6})]}],_3d5);}));}},_deleteFeature:function(_3d7,_3d8){var _3d9=[];if(!_3d7){var _3da=this._settings.layers;_3d9=dojo.map(dojo.filter(_3da,function(_3db){return _3db.getSelectedFeatures().length>0;}),"return {layer:item, deletes: item.getSelectedFeatures()}");if((!_3d9||!_3d9.length)&&this._currentGraphic){_3d9.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_3d9.push({layer:_3d7.getLayer(),deletes:[_3d7]});}this._applyEdits(_3d9,(_3d8));},_stopEditing:function(_3dc,adds,_3dd,_3de){esri.hide(this.progressBar.domNode);this._undoRedoAdd();var _3df;if(_3dc._isSelOnly===true){if(adds&&adds.length){this.templatePicker.clearSelection();var _3e0=new esri.tasks.Query();_3e0.objectIds=[adds[0].objectId];if(!this._settings.createOnlyLayer[_3dc.id]){this._selectFeatures([_3dc],_3e0,dojo.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}else{_3df=this._selectionHelper.findMapService(this._settings.map,_3dc);if(_3df){_3df.refresh();}if(adds&&adds.length){this.templatePicker.clearSelection();if(!this._settings.createOnlyLayer[_3dc.id]){esri.dijit.editing.Util.LayerHelper.findFeatures(adds,_3dc,dojo.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}if(_3de&&_3de.length){this._clearSelection(true);if(this._undoRedo){_3df=this._selectionHelper.findMapService(_3dc,this._settings.map);if(_3df){_3df.refresh();}}}if(this._undoRedo&&_3dd&&_3dd.length){_3df=this._selectionHelper.findMapService(_3dc,this._settings.map);if(_3df){_3df.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var edit=(this._edits&&this._edits.length)?this._edits[0]:null;if(!edit){return;}var adds=edit.adds||[];var _3e1=edit.updates||[];var _3e2=edit.deletes||[];var _3e3={featureLayer:edit.layer};if(adds.length){this.undoManager.add(new esri.dijit.editing.Add(dojo.mixin(_3e3,{addedGraphics:adds})));}else{if(_3e2.length){this.undoManager.add(new esri.dijit.editing.Delete(dojo.mixin(_3e3,{deletedGraphics:_3e2})));}else{if(_3e1.length){this.undoManager.add(new esri.dijit.editing.Update(dojo.mixin(_3e3,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_3e1})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_3e4){this._layer=_3e4.featureLayer;this._activeType=_3e4.type;this._activeTemplate=_3e4.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_3e4.featureLayer);dojo.disconnect(this._dtConnect);if(this._settings.createOnlyLayer[_3e4.featureLayer.id]){this._dtConnect=dojo.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient");}else{this._dtConnect=dojo.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");}this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_3e5,info){var _3e6=_3e5.getLayer();var _3e7=_3e6?_3e6.geometryType:null;var _3e8=esri.toolbars.Edit.MOVE;if(_3e7!=="esriGeometryPoint"&&this._isNotesFeature(_3e5)===true){_3e8=_3e8|esri.toolbars.Edit.ROTATE|esri.toolbars.Edit.SCALE;this._editVertices=false;}else{if(_3e7!=="esriGeometryPoint"&&this._editVertices===true){_3e8=_3e8|esri.toolbars.Edit.ROTATE|esri.toolbars.Edit.SCALE;this._editVertices=false;}else{_3e8=_3e8|esri.toolbars.Edit.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new esri.Graphic(dojo.clone(_3e5.toJson()));var _3e9=_3e6.getEditCapabilities({feature:_3e5,userId:this._settings.userIds[_3e6.id]});var _3ea=dojo.filter(this._settings.layerInfos,function(item){return item.featureLayer["layerId"]===_3e6.layerId;})[0];if(_3e9.canUpdate&&!_3ea.disableGeometryUpdate&&_3e6.allowGeometryUpdates){this._editToolbar.activate(_3e8,_3e5);}if(!this._settings.map.infoWindow.isShowing){var _3eb=(info&&info.screenPoint)||this._findCenterPoint(_3e5);this._showInfoWindow(_3eb,this._settings.map.getInfoWindowAnchor(_3eb));}},_createGraphic:function(_3ec,_3ed){var _3ee=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _3ef=new esri.Graphic(_3ec,_3ee,_3ed);if(this._activeTemplate||_3ed){_3ef.attributes=_3ed||dojo.mixin({},this._activeTemplate.prototype.attributes);}else{_3ef.attributes=_3ef.attributes||[];dojo.forEach(this._layer.fields,function(_3f0){_3ef.attributes[_3f0.name]=null;},this);}return _3ef;},_connectEvents:function(){var _3f1=this._settings.layers;dojo.forEach(_3f1,"this._connect(item, 'onEditsComplete', dojo.hitch(this, '_stopEditing', item))",this);dojo.forEach(_3f1,"this._connect(item, 'onBeforeApplyEdits', dojo.hitch(this, function() { esri.show(this.progressBar.domNode); this._settings._isApplyEditsCall = true;  }))",this);this._connect(this._editToolbar,"onGraphicClick",dojo.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",dojo.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",dojo.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",dojo.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",dojo.hitch(this,"_hideAttributeInspector"));},_connect:function(node,evt,func){this._eConnects.push(dojo.connect(node,evt,func));},_createWidgets:function(){this._selectionHelper=new esri.dijit.editing.SelectionHelper(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){var _3f2=dojo.filter(this._settings.layers,function(item){return item.getEditCapabilities().canCreate;});this.templatePicker=new esri.dijit.editing.TemplatePicker({"class":"esriTemplatePicker",featureLayers:_3f2,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;esri.hide(this.templatePickerDiv);}this._templatePickerOnSelectionChangeEvent=dojo.connect(this.templatePicker,"onSelectionChange",dojo.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(_3f3){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new esri.dijit.AttributeInspector({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},dojo.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(esri.bundle.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);dojo.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",dojo.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",dojo.hitch(this,function(_3f4){this._updateCurrentFeature(dojo.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_3f4);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,dojo.hitch(this.attributeInspector,"next"),dojo.hitch(this.attributeInspector,"previous"));}if(_3f3){this._connect(this.attributeInspector,"onAttributeChange",dojo.hitch(this,"_saveAttributesOnClient"));}else{this._connect(this.attributeInspector,"onAttributeChange",dojo.hitch(this,function(_3f5,_3f6,_3f7){this._preUpdates=new esri.Graphic(dojo.clone(_3f5.toJson()));this._currentGraphic.attributes[_3f6]=(typeof (_3f7)==="number"&&isNaN(_3f7))?null:_3f7;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));}},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new esri.dijit.editing.toolbars.Drawing({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:dojo.hitch(this,"_deleteFeature"),onApplyEdits:dojo.hitch(this,"_applyEdits"),onShowAttributeInspector:dojo.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new esri.UndoManager({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",dojo.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=dojo.connect(this._settings.map,"onClick",dojo.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(dojo.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){dojo.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _3f8=this.templatePicker.getSelected();if(_3f8){this._updateCurrentFeature(dojo.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_3f8);}));}else{this._reset();dojo.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_3f9,_3fa){_3f9=(dojo.isArray(_3f9)?_3f9[0]:_3f9)||null;if(!_3f9){return;}if(!this._customAttributeInspector){_3fa=_3fa||this._editClickPoint||this._findCenterPoint(_3f9);var _3fb=_3f9.getLayer();this._settings.map.infoWindow.setTitle(_3fb?_3fb.name:esri.bundle.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._showInfoWindow(_3fa,this._settings.map.getInfoWindowAnchor(_3fa));}this._editClickPoint=null;}if(_3f9===this._currentGraphic){return;}this._editVertices=true;this._layer=_3f9.getLayer();this._currentGraphic=_3f9;if(_3f9.getDojoShape()){_3f9.getDojoShape().moveToFront();}this._activateEditToolbar(_3f9);},_applyEdits:function(_3fc,_3fd){_3fc=_3fc||[];if(_3fc.length<=0){return;}this._edits=_3fc;var _3fe=dojo.map(_3fc,function(edit){return edit.layer.applyEdits(edit.adds,edit.updates,edit.deletes);});this._deferredsList=new dojo.DeferredList(_3fe).addCallback(dojo.hitch(this,function(){esri.hide(this.progressBar.domNode);if(_3fd){_3fd();}var map=this._settings.map;if(map&&map.infoWindow.reposition&&map.infoWindow.isShowing){map.infoWindow.reposition();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_3ff,_400){if(esri.geometry.polygonSelfIntersecting(_3ff)){this._settings.geometryService.simplify([_3ff],function(_401){var _402=(_401&&_401.length)?_401[0]:_402;if(_400){_400(_402);}});}else{if(_400){_400(_3ff);}}},_autoComplete:function(_403,_404){var _405=this._getLayers("esriGeometryPolygon");var _406=new esri.tasks.Query();_406.geometry=_403;_406.returnGeometry=true;this._selectFeatures(_405,_406,dojo.hitch(this,function(_407){if(!_407||_407.length<=0){if(_404){_404([_403]);}}else{this._settings.geometryService.autoComplete(esri.getGeometries(_407),this._toPolylines([_406.geometry]),function(_408){if(_404){_404(_408);}});}}));},_getLayers:function(_409){var _40a=this._settings.layers;return dojo.filter(_40a,function(_40b){return _40b.geometryType===_409;});},_selectFeatures:function(_40c,_40d,_40e,mode){this._selectionHelper.selectFeatures(_40c,_40d,mode||esri.layers.FeatureLayer.SELECTION_NEW,_40e);},_updateSelection:function(evt){var _40f=evt.mapPoint;var _410=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_40f,esri.layers.FeatureLayer.SELECTION_NEW,dojo.hitch(this,function(_411){var _412=dojo.some(_411,dojo.hitch(this,function(item){return item==_410;}));if(_410&&!_412){var _413=_410.getLayer();if(this._isValidLayer(_413)){var _414=new esri.tasks.Query();_414.objectIds=[_410.attributes[_413.objectIdField]];this._selectionHelper.selectFeatures([_413],_414,esri.layers.FeatureLayer.SELECTION_ADD,dojo.hitch(this,function(_415){this._updatePopupButtons(_415);this._onEditFeature(_415,_40f);}));}else{this._clearSelection();}}else{if(_411&&_411.length){this._updatePopupButtons(_411);this._onEditFeature(_411,_40f);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_416){if(!this._usePopup||!_416){return;}var _417=_416.length;var _418=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];dojo.forEach(_418,dojo.hitch(this,function(item){(_417>1)?dojo.removeClass(item,"hidden"):dojo.addClass(item,"hidden");}));},_clearSelection:function(_419){this._selectionHelper.clearSelection(_419||false);this._reset();},_findCenterPoint:function(_41a){var _41b=_41a.geometry||_41a;var _41c;switch(_41b.type){case "point":_41c=_41b;break;case "polyline":var _41d=_41b.paths[0].length;_41c=_41b.getPoint(0,Math.ceil(_41d/2));break;case "polygon":var _41e=_41b.rings.length-1;var _41f=_41b.rings[_41e].length-1;_41c=_41b.getPoint(_41e,_41f);break;}return this._settings.map.toScreen(_41c);},_hideAttributeInspector:function(){if(!this._customAttributeInspector&&this._settings.map.infoWindow){this._settings.map.infoWindow.hide();}},_toPolylines:function(_420){var _421=dojo.map(_420,function(_422){var _423=new esri.geometry.Polyline(_422.spatialReference);dojo.forEach(_422.rings,function(ring){_423.addPath(ring);});return _423;});return _421;},_isNotesFeature:function(_424){var _425=_424.getLayer();var _426=_425?_425.types||null:null;if(!_426){return false;}var _427=_424.attributes[_425.typeIdField];var _428;dojo.some(_426,function(type){if(type.id===_427){_428=type.templates;return true;}return false;});if(!_428){return false;}var _429=_428[0]||null;if(!_429){return false;}var _42a=this._isShapeTool(_429.drawingTool)||null;return _42a?true:false;},_isValidLayer:function(_42b){var _42c=this._settings.layerInfos;for(var i=0;i<_42c.length;i++){var _42d=_42c[i];if(_42b.id==_42d.layerId){return true;}}return false;},_isShapeTool:function(_42e){switch(_42e){case esri.layers.FeatureTemplate.TOOL_ARROW:return esri.toolbars.Draw.ARROW;case esri.layers.FeatureTemplate.TOOL_LEFT_ARROW:return esri.toolbars.Draw.LEFT_ARROW;case esri.layers.FeatureTemplate.TOOL_RIGHT_ARROW:return esri.toolbars.Draw.RIGHT_ARROW;case esri.layers.FeatureTemplate.TOOL_UP_ARROW:return esri.toolbars.Draw.UP_ARROW;case esri.layers.FeatureTemplate.TOOL_DOWN_ARROW:return esri.toolbars.Draw.DOWN_ARROW;case esri.layers.FeatureTemplate.TOOL_CIRCLE:return esri.toolbars.Draw.CIRCLE;case esri.layers.FeatureTemplate.TOOL_ELLIPSE:return esri.toolbars.Draw.ELLIPSE;case esri.layers.FeatureTemplate.TOOL_TRIANGLE:return esri.toolbars.Draw.TRIANGLE;case esri.layers.FeatureTemplate.TOOL_RECTANGLE:return esri.toolbars.Draw.RECTANGLE;default:return null;}},_toDrawTool:function(_42f,_430){var _431=_430.geometryType;switch(_42f){case esri.layers.FeatureTemplate.TOOL_POINT:return esri.toolbars.Draw.POINT;case esri.layers.FeatureTemplate.TOOL_ARROW:return esri.toolbars.Draw.ARROW;case esri.layers.FeatureTemplate.TOOL_LEFT_ARROW:return esri.toolbars.Draw.LEFT_ARROW;case esri.layers.FeatureTemplate.TOOL_RIGHT_ARROW:return esri.toolbars.Draw.RIGHT_ARROW;case esri.layers.FeatureTemplate.TOOL_UP_ARROW:return esri.toolbars.Draw.UP_ARROW;case esri.layers.FeatureTemplate.TOOL_DOWN_ARROW:return esri.toolbars.Draw.DOWN_ARROW;case esri.layers.FeatureTemplate.TOOL_CIRCLE:return esri.toolbars.Draw.CIRCLE;case esri.layers.FeatureTemplate.TOOL_ELLIPSE:return esri.toolbars.Draw.ELLIPSE;case esri.layers.FeatureTemplate.TOOL_TRIANGLE:return esri.toolbars.Draw.TRIANGLE;case esri.layers.FeatureTemplate.TOOL_RECTANGLE:return esri.toolbars.Draw.RECTANGLE;case esri.layers.FeatureTemplate.TOOL_LINE:return esri.toolbars.Draw.POLYLINE;case esri.layers.FeatureTemplate.TOOL_POLYGON:return esri.toolbars.Draw.POLYGON;case esri.layers.FeatureTemplate.TOOL_FREEHAND:if(_431==="esriGeometryPolyline"){return esri.toolbars.Draw.FREEHAND_POLYLINE;}else{return esri.toolbars.Draw.FREEHAND_POLYGON;}break;default:var _432=esri.toolbars.Draw.POINT;if(_431==="esriGeometryPolyline"){_432=esri.toolbars.Draw.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===esri.dijit.editing.Editor.CREATE_TOOL_FREEHAND_POLYLINE){_432=esri.toolbars.Draw.FREEHAND_POLYLINE;}}else{if(_431==="esriGeometryPolygon"){_432=esri.toolbars.Draw.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===esri.dijit.editing.Editor.CREATE_TOOL_FREEHAND_POLYGON){_432=esri.toolbars.Draw.FREEHAND_POLYGON;}}}return _432;}},_isModified:function(){var _433=this._editToolbar.getCurrentState();return ((_433.isModified||this._attributeChanged)&&_433.graphic)?_433.graphic:null;},_showInfoWindow:function(_434,_435){if(!this._customAttributeInspector){this._settings.map.infoWindow.show(_434,_435);}}});dojo.mixin(esri.dijit.editing.Editor,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});});},"esri/dijit/editing/tools/DropDownToolBase":function(){define(["dijit","dojo","dojox","dojo/require!dijit/form/ComboButton,esri/dijit/editing/tools/ToolBase"],function(_436,dojo,_437){dojo.provide("esri.dijit.editing.tools.DropDownToolBase");dojo.require("dijit.form.ComboButton");dojo.require("esri.dijit.editing.tools.ToolBase");dojo.declare("esri.dijit.editing.tools.DropDownToolBase",[_436.form.ComboButton,esri.dijit.editing.tools.ToolBase],{_enabled:false,_checked:false,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){var _438=this._tools;for(var tool in _438){if(_438.hasOwnProperty(tool)&&esri._isDefined(_438[tool])){_438[tool].destroy();}}this.inherited(arguments);},_createTools:function(){var mnu=new _436.Menu();this.dropDown=mnu;for(var i in this._tools){if(this._tools.hasOwnProperty(i)){mnu.addChild(this._tools[i]);}}this._activeTool=mnu.getChildren()[0];this._updateUI();},activate:function(_439){this.inherited(arguments);if(!this._activeTool){this._activateDefaultTool();}else{this._activeTool.activate();}},deactivate:function(){this.inherited(arguments);if(this._activeTool){this._activeTool.deactivate();}},enable:function(_43a){for(var tool in this._tools){if(this._tools.hasOwnProperty(tool)){this._tools[tool].enable(_43a);}}this.setEnabled(true);this.inherited(arguments);},setChecked:function(_43b){this._checked=_43b;this._updateUI();},_onDrawEnd:function(_43c){},onLayerChange:function(_43d,type,_43e){this._activeTool=null;this._activeType=type;this._activeTemplate=_43e;this._activeLayer=_43d;},onItemClicked:function(evt){if(this._activeTool){this._activeTool.deactivate();}this._activeTool=_436.byId(evt.currentTarget.id);if(this._checked===false){this._onClick();}else{this._updateUI();if(this._activeTool){this._activeTool.activate();this._activeTool.setChecked(true);}}},_onClick:function(evt){if(this._enabled===false){return;}this._checked=!this._checked;this.inherited(arguments);},_updateUI:function(){this.attr("disabled",!this._enabled);dojo.style(this.focusNode,{outline:"none"});dojo.style(this.titleNode,{padding:"0px",border:"none"});if(this._checked){dojo.style(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"});}else{dojo.style(this.titleNode,{backgroundColor:"",border:""});}if(this._activeTool){this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon);this.attr("label",this._activeTool.label);}}});});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/mouse","dojo/on","dojo/touch","./_ListBase"],function(_43f,_440,on,_441,_442){return _43f("dijit.form._ListMouseMixin",_442,{postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,_441.press,function(evt){evt.preventDefault();}));this._listConnect(_441.press,"_onMouseDown");this._listConnect(_441.release,"_onMouseUp");this._listConnect(_440.enter,"_onMouseOver");this._listConnect(_440.leave,"_onMouseOut");},_onMouseDown:function(evt,_443){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(_443);},_onMouseUp:function(evt,_444){this._isDragging=false;var _445=this.selected;var _446=this._hoveredNode;if(_445&&_444==_445){this.onClick(_445);}else{if(_446&&_444==_446){this._setSelectedAttr(_446);this.onClick(_446);}}},_onMouseOut:function(evt,_447){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt,_448){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}this._hoveredNode=_448;this.onHover(_448);if(this._isDragging){this._setSelectedAttr(_448);}}});});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n","dijit/ProgressBar":function(){require({cache:{"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"}});define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_449,_44a,_44b,lang,_44c,_44d,_44e,_44f){return _44a("dijit.ProgressBar",[_44d,_44e],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_44f,_indeterminateHighContrastImagePath:_449.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!(this.params&&"value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_450){lang.mixin(this,_450||{});var tip=this.internalProgress,ap=this.domNode;var _451=1;if(this.indeterminate){ap.removeAttribute("aria-valuenow");ap.removeAttribute("aria-valuemin");ap.removeAttribute("aria-valuemax");}else{if(String(this.progress).indexOf("%")!=-1){_451=Math.min(parseFloat(this.progress)/100,1);this.progress=_451*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_451=this.maximum?this.progress/this.maximum:0;}ap.setAttribute("aria-describedby",this.labelNode.id);ap.setAttribute("aria-valuenow",this.progress);ap.setAttribute("aria-valuemin",0);ap.setAttribute("aria-valuemax",this.maximum);}this.labelNode.innerHTML=this.report(_451);_44b.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_451*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_452){this._set("label",_452);this.update();},_setIndeterminateAttr:function(_453){this.indeterminate=_453;this.update();},report:function(_454){return this.label?this.label:(this.indeterminate?"&#160;":_44c.format(_454,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_455,has,_456){return _455("dojox.grid._ViewManager",null,{constructor:function(_457){this.grid=_457;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_458){_458.idx=this.views.length;this.views.push(_458);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _459=[];for(var i=0,v;v=this.views[i];i++){_459.push(v.contentNode);}return _459;},forEach:function(_45a){for(var i=0,v;v=this.views[i];i++){_45a(v,i);}},onEach:function(_45b,_45c){_45c=_45c||[];for(var i=0,v;v=this.views[i];i++){if(_45b in v){v[_45b].apply(v,_45c);}}},normalizeHeaderNodeHeight:function(){var _45d=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_45d.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_45d);},normalizeRowNodeHeights:function(_45e){var h=0;var _45f=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_45e.length<=1){return;}for(var i=0,n;(n=_45e[i]);i++){if(!_456.contains(n,"dojoxGridNonNormalizedCell")){_45f[i]=n.firstChild.offsetHeight;h=Math.max(h,_45f[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_45e[i]);i++){if(_45f[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_460){var _461=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_460));i++){n.firstChild.style.height="";_461.push(n);}this.normalizeRowNodeHeights(_461);},getViewWidth:function(_462){return this.views[_462].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_463){_463.headerContentNode.style.height="";});var h=0;this.forEach(function(_464){h=Math.max(_464.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_465){h=Math.max(_465.domNode.offsetHeight,h);});return h;},findClient:function(_466){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _467=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_467(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_467(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_467(v,l);}return l;},renderRow:function(_468,_469,_46a){var _46b=[];for(var i=0,v,n,_46c;(v=this.views[i])&&(n=_469[i]);i++){_46c=v.renderRow(_468);n.appendChild(_46c);_46b.push(_46c);}if(!_46a){this.normalizeRowNodeHeights(_46b);}},rowRemoved:function(_46d){this.onEach("rowRemoved",[_46d]);},updateRow:function(_46e,_46f){for(var i=0,v;v=this.views[i];i++){v.updateRow(_46e);}if(!_46f){this.renormalizeRow(_46e);}},updateRowStyles:function(_470){this.onEach("updateRowStyles",[_470]);},setScrollTop:function(_471){var top=_471;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_471);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/dijit/editing/tools/SelectionTools":function(){define("esri/dijit/editing/tools/SelectionTools",["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/ButtonToolBase"],function(_472,dojo,_473){dojo.require("esri.dijit.editing.tools.ButtonToolBase");dojo.provide("esri.dijit.editing.tools.SelectionTools");esri.dijit.editing.tools.SelectionTools={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:esri.toolbars.Draw.EXTENT,_selectMethod:esri.layers.FeatureLayer.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:esri.toolbars.Draw.EXTENT,_selectMethod:esri.layers.FeatureLayer.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:esri.toolbars.Draw.EXTENT,_selectMethod:esri.layers.FeatureLayer.SELECTION_SUBTRACT,_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:false,_label:"NLS_selectionClearLbl"}};});},"dijit/form/NumberTextBox":function(){define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(_474,lang,_475,_476){var _477=_474("dijit.form.NumberTextBoxMixin",null,{pattern:_475.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:_475.format,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},_setConstraintsAttr:function(_478){var _479=typeof _478.places=="number"?_478.places:0;if(_479){_479++;}if(typeof _478.max!="number"){_478.max=9*Math.pow(10,15-_479);}if(typeof _478.min!="number"){_478.min=-9*Math.pow(10,15-_479);}this.inherited(arguments,[_478]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _47a=this.format(val,this.constraints);if(_47a!==undefined){this.textbox.value=_47a;}}this.inherited(arguments);},format:function(_47b,_47c){var _47d=String(_47b);if(typeof _47b!="number"){return _47d;}if(isNaN(_47b)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_47b,_47c))&&_47c.exponent!==false&&/\de[-+]?\d/i.test(_47d)){return _47d;}if(this.editOptions&&this.focused){_47c=lang.mixin({},_47c,this.editOptions);}return this._formatter(_47b,_47c);},_parser:_475.parse,parse:function(_47e,_47f){var v=this._parser(_47e,lang.mixin({},_47f,(this.editOptions&&this.focused)?this.editOptions:{}));if(this.editOptions&&this.focused&&isNaN(v)){v=this._parser(_47e,_47f);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_480){return (_480==null||_480==="")?NaN:this.inherited(arguments);},serialize:function(_481,_482){return (typeof _481!="number"||isNaN(_481))?"":this.inherited(arguments);},_setBlurValue:function(){var val=lang.hitch(lang.mixin({},this,{focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_483,_484,_485){if(_483!==undefined&&_485===undefined){_485=String(_483);if(typeof _483=="number"){if(isNaN(_483)){_485="";}else{if(("rangeCheck" in this&&this.rangeCheck(_483,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_485)){_485=undefined;}}}else{if(!_483){_485="";_483=NaN;}else{_483=undefined;}}}this.inherited(arguments,[_483,_484,_485]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+_475._realNumberRegexp(lang.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_486){if(!this.focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});var _487=_474("dijit.form.NumberTextBox",[_476,_477],{baseClass:"dijitTextBox dijitNumberTextBox"});_487.Mixin=_477;return _487;});},"esri/toolbars/_GraphicMover":function(){define("esri/toolbars/_GraphicMover",["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_488,dojo,_489){dojo.provide("esri.toolbars._GraphicMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars._Mover",_489.gfx.Mover,{constructor:function(_48a,e,host){this.__e=e;}});dojo.declare("esri.toolbars._GraphicMover",null,{constructor:function(_48b,map,_48c){this.graphic=_48b;this.map=map;this.toolbar=_48c;this._enableGraphicMover();this._moved=false;},refresh:function(_48d){var _48e=this.graphic.getDojoShape();if(_48e&&(_48d||!_48e._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _48f=this.graphic,_490=_48f.getDojoShape();if(_490){_490._hostGraphic=_48f;this._moveable=new _489.gfx.Moveable(_490,{mover:esri.toolbars._Mover});this._moveStartHandle=dojo.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=dojo.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=dojo.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_490.getEventSource();if(node){dojo.style(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _491=this._moveable;if(_491){dojo.disconnect(this._moveStartHandle);dojo.disconnect(this._firstMoveHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._moveStopHandle);var _492=_491.shape;if(_492){_492._hostGraphic=null;var node=_492.getEventSource();if(node){dojo.style(node,"cursor",null);}}_491.destroy();}this._moveable=null;},_moveStartHandler:function(){var _493=this.graphic,map=this.map;this._startTx=_493.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_493);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_494){this.toolbar.onGraphicMove(this.graphic,_494.shape.getTransform());},_moveStopHandler:function(_495){var _496=this.graphic,_497=this.toolbar,map=this.map,mx=_489.gfx.matrix,_498=_497._geo?esri.geometry.geographicToWebMercator(_496.geometry):_496.geometry,type=_498.type,_499=_496.getDojoShape(),tx=_499.getTransform();if(dojo.toJson(tx)!==dojo.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _49a=[tx,mx.invert(this._startTx)],_49b;if(map.snappingManager){_49b=map.snappingManager._snappingPoint;}_498=_49b||map.toMap(mx.multiplyPoint(_49a,map.toScreen(_498,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_498=this._updatePolyGeometry(_498,_498.paths,tx);break;case "polygon":_498=this._updatePolyGeometry(_498,_498.rings,tx);break;}_499.setTransform(null);_496.setGeometry(_497._geo?esri.geometry.webMercatorToGeographic(_498,true):_498);}else{this._moved=false;}_497._endOperation("MOVE");_497.onGraphicMoveStop(_496,tx);if(!this._moved){var e=_495.__e,_49c=this.map.position,pt=new esri.geometry.ScreenPoint(e.pageX-_49c.x,e.pageY-_49c.y);_497.onGraphicClick(_496,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_49d,_49e,_49f){var map=this.map,_4a0=_49d.getPoint(0,0),_4a1=map.toMap(map.toScreen(_4a0).offset(_49f.dx,_49f.dy)),_4a2=_4a1.x-_4a0.x,_4a3=_4a1.y-_4a0.y,i,j,seg,_4a4;for(i=0;i<_49e.length;i++){seg=_49e[i];for(j=0;j<seg.length;j++){_4a4=_49d.getPoint(i,j);_49d.setPoint(i,j,_4a4.offset(_4a2,_4a3));}}return _49d;}});});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","esri/dijit/editing/Util":function(){define(["dijit","dojo","dojox","dojo/require!dojo/DeferredList"],function(_4a5,dojo,_4a6){dojo.provide("esri.dijit.editing.Util");dojo.require("dojo.DeferredList");esri.dijit.editing.Util.LayerHelper={findFeatures:function(ids,_4a7,_4a8){var _4a9=_4a7.objectIdField;var _4aa=_4a7.graphics;var _4ab=dojo.filter(_4aa,function(_4ac){return dojo.some(ids,function(id){return _4ac.attributes[_4a9]===id.objectId;});});if(_4a8){_4a8(_4ab);}else{return _4ab;}},getSelection:function(_4ad){var _4ae=[];dojo.forEach(_4ad,function(_4af){var _4b0=_4af.getSelectedFeatures();dojo.forEach(_4b0,function(_4b1){_4ae.push(_4b1);});});return _4ae;}};});},"dojox/date/islamic/locale":function(){define("dojox/date/islamic/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","dojo/i18n!dojo/cldr/nls/islamic"],function(_4b2,lang,arr,dd,i18n,_4b3,_4b4,_4b5,_4b6){var _4b7=lang.getObject("date.islamic.locale",true,_4b2);function _4b8(_4b9,_4ba,_4bb,_4bc,_4bd){return _4bd.replace(/([a-z])\1*/ig,function(_4be){var s,pad;var c=_4be.charAt(0);var l=_4be.length;var _4bf=["abbr","wide","narrow"];switch(c){case "G":s=_4ba["eraAbbr"][0];break;case "y":s=String(_4b9.getFullYear());break;case "M":var m=_4b9.getMonth();if(l<3){s=m+1;pad=true;}else{var _4c0=["months","format",_4bf[l-3]].join("-");s=_4ba[_4c0][m];}break;case "d":s=_4b9.getDate(true);pad=true;break;case "E":var d=_4b9.getDay();if(l<3){s=d+1;pad=true;}else{var _4c1=["days","format",_4bf[l-3]].join("-");s=_4ba[_4c1][d];}break;case "a":var _4c2=(_4b9.getHours()<12)?"am":"pm";s=_4ba["dayPeriods-format-wide-"+_4c2];break;case "h":case "H":case "K":case "k":var h=_4b9.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_4b9.getMinutes();pad=true;break;case "s":s=_4b9.getSeconds();pad=true;break;case "S":s=Math.round(_4b9.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "z":s=dd.getTimezoneName(_4b9.toGregorian());if(s){break;}l=4;case "Z":var _4c3=_4b9.toGregorian().getTimezoneOffset();var tz=[(_4c3<=0?"+":"-"),_4b4.pad(Math.floor(Math.abs(_4c3)/60),2),_4b4.pad(Math.abs(_4c3)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+_4bd);}if(pad){s=_4b4.pad(s,l);}return s;});};_4b7.format=function(_4c4,_4c5){_4c5=_4c5||{};var _4c6=i18n.normalizeLocale(_4c5.locale);var _4c7=_4c5.formatLength||"short";var _4c8=_4b7._getIslamicBundle(_4c6);var str=[];var _4c9=lang.hitch(this,_4b8,_4c4,_4c8,_4c6,_4c5.fullYear);if(_4c5.selector=="year"){var year=_4c4.getFullYear();return year;}if(_4c5.selector!="time"){var _4ca=_4c5.datePattern||_4c8["dateFormat-"+_4c7];if(_4ca){str.push(_4cb(_4ca,_4c9));}}if(_4c5.selector!="date"){var _4cc=_4c5.timePattern||_4c8["timeFormat-"+_4c7];if(_4cc){str.push(_4cb(_4cc,_4c9));}}var _4cd=str.join(" ");return _4cd;};_4b7.regexp=function(_4ce){return _4b7._parseInfo(_4ce).regexp;};_4b7._parseInfo=function(_4cf){_4cf=_4cf||{};var _4d0=i18n.normalizeLocale(_4cf.locale);var _4d1=_4b7._getIslamicBundle(_4d0);var _4d2=_4cf.formatLength||"short";var _4d3=_4cf.datePattern||_4d1["dateFormat-"+_4d2];var _4d4=_4cf.timePattern||_4d1["timeFormat-"+_4d2];var _4d5;if(_4cf.selector=="date"){_4d5=_4d3;}else{if(_4cf.selector=="time"){_4d5=_4d4;}else{_4d5=(typeof (_4d4)=="undefined")?_4d3:_4d3+" "+_4d4;}}var _4d6=[];var re=_4cb(_4d5,lang.hitch(this,_4d7,_4d6,_4d1,_4cf));return {regexp:re,tokens:_4d6,bundle:_4d1};};_4b7.parse=function(_4d8,_4d9){_4d8=_4d8.replace(/[\u200E\u200F\u202A\u202E]/g,"");if(!_4d9){_4d9={};}var info=_4b7._parseInfo(_4d9);var _4da=info.tokens,_4b6=info.bundle;var _4db=info.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");var re=new RegExp("^"+_4db+"$");var _4dc=re.exec(_4d8);var _4dd=i18n.normalizeLocale(_4d9.locale);if(!_4dc){return null;}var date,_4de;var _4df=[1389,0,1,0,0,0,0];var amPm="";var _4e0=0;var _4e1=["abbr","wide","narrow"];var _4e2=arr.every(_4dc,function(v,i){if(!i){return true;}var _4e3=_4da[i-1];var l=_4e3.length;switch(_4e3.charAt(0)){case "y":_4df[0]=Number(v);break;case "M":if(l>2){var _4e4=_4b6["months-format-"+_4e1[l-3]].concat();if(!_4d9.strict){v=v.replace(".","").toLowerCase();_4e4=arr.map(_4e4,function(s){return s?s.replace(".","").toLowerCase():s;});}v=arr.indexOf(_4e4,v);if(v==-1){return false;}_4e0=l;}else{v--;}_4df[1]=Number(v);break;case "D":_4df[1]=0;case "d":_4df[2]=Number(v);break;case "a":var am=_4d9.am||_4b6["dayPeriods-format-wide-am"],pm=_4d9.pm||_4b6["dayPeriods-format-wide-pm"];if(!_4d9.strict){var _4e5=/\./g;v=v.replace(_4e5,"").toLowerCase();am=am.replace(_4e5,"").toLowerCase();pm=pm.replace(_4e5,"").toLowerCase();}if(_4d9.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":_4df[3]=Number(v);break;case "m":_4df[4]=Number(v);break;case "s":_4df[5]=Number(v);break;case "S":_4df[6]=Number(v);}return true;});var _4e6=+_4df[3];if(amPm==="p"&&_4e6<12){_4df[3]=_4e6+12;}else{if(amPm==="a"&&_4e6==12){_4df[3]=0;}}var _4e7=new _4b5(_4df[0],_4df[1],_4df[2],_4df[3],_4df[4],_4df[5],_4df[6]);return _4e7;};function _4cb(_4e8,_4e9,_4ea,_4eb){var _4ec=function(x){return x;};_4e9=_4e9||_4ec;_4ea=_4ea||_4ec;_4eb=_4eb||_4ec;var _4ed=_4e8.match(/(''|[^'])+/g);var _4ee=_4e8.charAt(0)=="'";arr.forEach(_4ed,function(_4ef,i){if(!_4ef){_4ed[i]="";}else{_4ed[i]=(_4ee?_4ea:_4e9)(_4ef);_4ee=!_4ee;}});return _4eb(_4ed.join(""));};function _4d7(_4f0,_4f1,_4f2,_4f3){_4f3=_4b3.escapeString(_4f3);var _4f4=i18n.normalizeLocale(_4f2.locale);return _4f3.replace(/([a-z])\1*/ig,function(_4f5){var s;var c=_4f5.charAt(0);var l=_4f5.length;var p2="",p3="";if(_4f2.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d+";break;case "M":s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-2]";break;case "d":s="[12]\\d|"+p2+"[1-9]|3[01]";break;case "E":s="\\S+";break;case "h":s=p2+"[1-9]|1[0-2]";break;case "k":s=p2+"\\d|1[01]";break;case "H":s=p2+"\\d|1\\d|2[0-3]";break;case "K":s=p2+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":s=p2+"\\d|[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_4f2.am||_4f1["dayPeriods-format-wide-am"],pm=_4f2.pm||_4f1["dayPeriods-format-wide-pm"];if(_4f2.strict){s=am+"|"+pm;}else{s=am+"|"+pm;if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}}break;default:s=".*";}if(_4f0){_4f0.push(_4f5);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _4f6=[];_4b7.addCustomFormats=function(_4f7,_4f8){_4f6.push({pkg:_4f7,name:_4f8});};_4b7._getIslamicBundle=function(_4f9){var _4fa={};arr.forEach(_4f6,function(desc){var _4fb=i18n.getLocalization(desc.pkg,desc.name,_4f9);_4fa=lang.mixin(_4fa,_4fb);},this);return _4fa;};_4b7.addCustomFormats("dojo.cldr","islamic");_4b7.getNames=function(item,type,_4fc,_4fd,date){var _4fe;var _4ff=_4b7._getIslamicBundle(_4fd);var _500=[item,_4fc,type];if(_4fc=="standAlone"){var key=_500.join("-");_4fe=_4ff[key];if(_4fe[0]==1){_4fe=undefined;}}_500[1]="format";return (_4fe||_4ff[_500.join("-")]).concat();};_4b7.weekDays=_4b7.getNames("days","wide","format");_4b7.months=_4b7.getNames("months","wide","format");return _4b7;});},"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n","dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_501){return _501.grid.cells;});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_502,_503,_504,lang,_505){return _503("dojox.grid._Layout",null,{constructor:function(_506){this.grid=_506;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_507,_508,_509,_50a,_50b){var _50c=this.structure[_507].cells[0];var _50d=this.structure[_508].cells[0];var cell=null;var _50e=0;var _50f=0;for(var i=0,c;c=_50c[i];i++){if(c.index==_509){_50e=i;break;}}cell=_50c.splice(_50e,1)[0];cell.view=this.grid.views.views[_508];for(i=0,c=null;c=_50d[i];i++){if(c.index==_50a){_50f=i;break;}}if(!_50b){_50f+=1;}_50d.splice(_50f,0,cell);var _510=this.grid.getCell(this.grid.getSortIndex());if(_510){_510._currentlySorted=this.grid.getSortAsc();}this.cells=[];_509=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_509;this.cells.push(c);if("_currentlySorted" in c){var si=_509+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_509++;}}}_504.forEach(this.cells,function(c){var _511=c.markup[2].split(" ");var _512=parseInt(_511[1].substring(5));if(_512!=c.index){_511[1]="idx=\""+c.index+"\"";c.markup[2]=_511.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_513,_514){var cell=this.cells[_513];if(cell.hidden==_514){cell.hidden=!_514;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_505.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_515,_516,_517){var self=this;var _518=function(_519){var w=0;if(_519.colSpan>1){w=0;}else{w=_519.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _51a={grid:this.grid,subrow:_515,layoutIndex:_516,index:this.cells.length};if(_517&&_517 instanceof _502.grid.cells._Base){var _51b=lang.clone(_517);_51a.unitWidth=_518(_51b._props);_51b=lang.mixin(_51b,this._defaultCellProps,_517._props,_51a);return _51b;}var _51c=_517.type||_517.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_502.grid.cells.Cell;if(lang.isString(_51c)){_51c=lang.getObject(_51c);}_51a.unitWidth=_518(_517);return new _51c(lang.mixin({},this._defaultCellProps,_517,_51a));},addRowDef:function(_51d,_51e){var _51f=[];var _520=0,_521=0,_522=true;for(var i=0,def,cell;(def=_51e[i]);i++){cell=this.addCellDef(_51d,i,def);_51f.push(cell);this.cells.push(cell);if(_522&&cell.relWidth){_520+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_521+=window.parseInt(w,10);}else{if(w=="auto"){_522=false;}}}}}if(_520&&_522){_504.forEach(_51f,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_520)*(100-_521))+"%";}});}return _51f;},addRowsDef:function(_523){var _524=[];if(lang.isArray(_523)){if(lang.isArray(_523[0])){for(var i=0,row;_523&&(row=_523[i]);i++){_524.push(this.addRowDef(i,row));}}else{_524.push(this.addRowDef(0,_523));}}return _524;},addViewDef:function(_525){this._defaultCellProps=_525.defaultCell||{};if(_525.width&&_525.width=="auto"){delete _525.width;}return lang.mixin({},_525,{cells:this.addRowsDef(_525.rows||_525.cells)});},setStructure:function(_526){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_502._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _527=this.grid.rowSelector;if(_527=="false"){sel=null;}else{if(_527!="true"){sel["width"]=_527;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _528=function(def){return ("name" in def||"field" in def||"get" in def);};var _529=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_528(def[0])){return true;}}return false;};var _52a=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_528(def))));};if(lang.isArray(_526)){var _52b=false;for(var i=0,st;(st=_526[i]);i++){if(_52a(st)){_52b=true;break;}}if(!_52b){s.push(this.addViewDef({cells:_526}));}else{for(i=0;(st=_526[i]);i++){if(_529(st)){s.push(this.addViewDef({cells:st}));}else{if(_52a(st)){s.push(this.addViewDef(st));}}}}}else{if(_52a(_526)){s.push(this.addViewDef(_526));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dijit/form/RangeBoundTextBox":function(){define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(_52c,i18n,_52d){var _52e=_52c("dijit.form.RangeBoundTextBox",_52d,{rangeMessage:"",rangeCheck:function(_52f,_530){return ("min" in _530?(this.compare(_52f,_530.min)>=0):true)&&("max" in _530?(this.compare(_52f,_530.max)<=0):true);},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");if(val==null){return false;}var _531=false;if("min" in this.constraints){var min=this.constraints.min;_531=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min)<0;}if(!_531&&("max" in this.constraints)){var max=this.constraints.max;_531=this.compare(val,((typeof max!="number")||max>0)?max:0)>0;}return _531;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_532){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_532));},getErrorMessage:function(_533){var v=this.get("value");if(v!=null&&v!==""&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_533)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},_setConstraintsAttr:function(_534){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){this.focusNode.setAttribute("aria-valuemin",this.constraints.min);}else{this.focusNode.removeAttribute("aria-valuemin");}if(this.constraints.max!==undefined){this.focusNode.setAttribute("aria-valuemax",this.constraints.max);}else{this.focusNode.removeAttribute("aria-valuemax");}}},_setValueAttr:function(_535,_536){this.focusNode.setAttribute("aria-valuenow",_535);this.inherited(arguments);},applyTextDir:function(){}});return _52e;});},"dijit/_editor/RichText":function(){define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/ready","dojo/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/_base/window","../_Widget","../_CssStateMixin","./selection","./range","./html","../focus","../main"],function(_537,_538,_539,_53a,dom,_53b,_53c,_53d,_53e,_53f,_540,_541,keys,lang,on,_542,_543,has,_544,_545,_546,win,_547,_548,_549,_54a,_54b,_54c,_54d){var _54e=_539("dijit._editor.RichText",[_547,_548],{constructor:function(_54f){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};if(_54f&&lang.isString(_54f.value)){this.value=_54f.value;}this.onLoadDeferred=new _53a();},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"===this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}this.contentPreFilters=[lang.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);if(has("mozilla")){this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);}if(has("webkit")){this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);}if(has("ie")){this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);this.contentDomPostFilters=[lang.hitch(this,this._stripBreakerNodes)].concat(this.contentDomPostFilters);}this.inherited(arguments);_544.publish(_54d._scopeName+"._editor.RichText::init",this);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=lang.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _550={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!has("ie")){_550.Z=exec("redo");}var key;for(key in _550){this.addKeyHandler(key,true,false,_550[key]);}},events:["onKeyPress","onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(_54e._editorCommandsLocalized){this._local2NativeFormatNames=_54e._local2NativeFormatNames;this._native2LocalFormatNames=_54e._native2LocalFormatNames;return;}_54e._editorCommandsLocalized=true;_54e._local2NativeFormatNames={};_54e._native2LocalFormatNames={};this._local2NativeFormatNames=_54e._local2NativeFormatNames;this._native2LocalFormatNames=_54e._native2LocalFormatNames;var _551=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _552="",_553,i=0;while((_553=_551[i++])){if(_553.charAt(1)!=="l"){_552+="<"+_553+"><span>content</span></"+_553+"><br/>";}else{_552+="<"+_553+"><li>content</li></"+_553+"><br/>";}}var _554={position:"absolute",top:"0px",zIndex:10,opacity:0.01};var div=_53d.create("div",{style:_554,innerHTML:_552});this.ownerDocumentBody.appendChild(div);var _555=lang.hitch(this,function(){var node=div.firstChild;while(node){try{this._sCall("selectElement",[node.firstChild]);var _556=node.tagName.toLowerCase();this._local2NativeFormatNames[_556]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_556]]=_556;node=node.nextSibling.nextSibling;}catch(e){}}_53d.destroy(div);});this.defer(_555);},open:function(_557){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _53a();}if(!this.isClosed){this.close();}_544.publish(_54d._scopeName+"._editor.RichText::open",this);if(arguments.length===1&&_557.nodeName){this.domNode=_557;}var dn=this.domNode;var html;if(lang.isString(this.value)){html=this.value;delete this.value;dn.innerHTML="";}else{if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=ta.value;dn=this.domNode=this.ownerDocument.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_53d.place(dn,ta,"before");var _558=lang.hitch(this,function(){_53f.set(ta,{display:"block",position:"absolute",top:"-1000px"});if(has("ie")){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(has("ie")){this.defer(_558,10);}else{_558();}if(ta.form){var _559=ta.value;this.reset=function(){var _55a=this.getValue();if(_55a!==_559){this.replaceValue(_559);}};on(ta.form,"submit",lang.hitch(this,function(){_53b.set(ta,"disabled",this.disabled);ta.value=this.getValue();}));}}else{html=_54b.getChildrenHtml(dn);dn.innerHTML="";}}this.value=html;if(dn.nodeName&&dn.nodeName==="LI"){dn.innerHTML=" <br>";}this.header=dn.ownerDocument.createElement("div");dn.appendChild(this.header);this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);this.footer=dn.ownerDocument.createElement("div");dn.appendChild(this.footer);if(!this.name){this.name=this.id+"_AUTOGEN";}if(this.name!==""&&(!_538["useXDomain"]||_538["allowXdRichTextSave"])){var _55b=dom.byId(_54d._scopeName+"._editor.RichText.value");if(_55b&&_55b.value!==""){var _55c=_55b.value.split(this._SEPARATOR),i=0,dat;while((dat=_55c[i++])){var data=dat.split(this._NAME_CONTENT_SEP);if(data[0]===this.name){html=data[1];_55c=_55c.splice(i,1);_55b.value=_55c.join(this._SEPARATOR);break;}}}if(!_54e._globalSaveHandler){_54e._globalSaveHandler={};_545.addOnUnload(function(){var id;for(id in _54e._globalSaveHandler){var f=_54e._globalSaveHandler[id];if(lang.isFunction(f)){f();}}});}_54e._globalSaveHandler[this.id]=lang.hitch(this,"_saveContent");}this.isClosed=false;var ifr=(this.editorObject=this.iframe=this.ownerDocument.createElement("iframe"));ifr.id=this.id+"_iframe";ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(has("ie")>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=lang.hitch(this,function(w){this.window=w;this.document=this.window.document;if(has("ie")){this._localizeEditorCommands();}this.onLoad(html);});var src=this._getIframeDocTxt(),s="javascript: '"+src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(has("safari")<=4){src=ifr.getAttribute("src");if(!src||src.indexOf("javascript")===-1){this.defer(function(){ifr.setAttribute("src",s);});}}if(dn.nodeName==="LI"){dn.lastChild.style.marginTop="-1.2em";}_53c.add(this.domNode,this.baseClass);},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var _55d=_53f.getComputedStyle(this.domNode);var html="";var _55e=true;if(has("ie")||has("webkit")||(!this.height&&!has("mozilla"))){html="<div id='dijitEditorBody'></div>";_55e=false;}else{if(has("mozilla")){this._cursorToStart=true;html="&#160;";}}var font=[_55d.fontWeight,_55d.fontSize,_55d.fontFamily].join(" ");var _55f=_55d.lineHeight;if(_55f.indexOf("px")>=0){_55f=parseFloat(_55f)/parseFloat(_55d.fontSize);}else{if(_55f.indexOf("em")>=0){_55f=parseFloat(_55f);}else{_55f="normal";}}var _560="";var self=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_561){_561=_561.replace(/^;/ig,"")+";";var s=_561.split(":")[0];if(s){s=lang.trim(s);s=s.toLowerCase();var i;var sC="";for(i=0;i<s.length;i++){var c=s.charAt(i);switch(c){case "-":i++;c=s.charAt(i).toUpperCase();default:sC+=c;}}_53f.set(self.domNode,sC,"");}_560+=_561+";";});var _562=_542("label[for=\""+this.id+"\"]");return [this.isLeftToRight()?"<html>\n<head>\n":"<html dir='rtl'>\n<head>\n",(has("mozilla")&&_562.length?"<title>"+_562[0].innerHTML+"</title>\n":""),"<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n",((has("webkit"))?"\t\twidth: 100%;\n":""),((has("webkit"))?"\t\theight: 100%;\n":""),"\t}\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",font,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tmin-height:",this.minHeight,";\n","\t\tline-height:",_55f,";\n","\t}\n","\tp{ margin: 1em 0; }\n",(!_55e&&!this.height?"\tbody,html {overflow-y: hidden;}\n":""),"\t#dijitEditorBody{overflow-x: auto; overflow-y:"+(this.height?"auto;":"hidden;")+" outline: 0px;}\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(!has("ie")?"\tli{ min-height:1.2em; }\n":""),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body ",(_55e?"id='dijitEditorBody' ":""),"onload='frameElement && frameElement._loadFunc(window,document)' ","style='"+_560+"'>",html,"</body>\n</html>"].join("");},_applyEditingAreaStyleSheets:function(){var _563=[];if(this.styleSheets){_563=this.styleSheets.split(";");this.styleSheets="";}_563=_563.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_563[i++])){var _564=(new _546(win.global.location,url)).toString();this.editingAreaStyleSheets.push(_564);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_564+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _546(win.global.location,url)).toString();}if(_537.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);this.onLoadDeferred.then(lang.hitch(this,function(){if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _565=this.document.createElement("link");_565.rel="stylesheet";_565.type="text/css";_565.href=url;head.appendChild(_565);}}));},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _546(win.global.location,url)).toString();}var _566=_537.indexOf(this.editingAreaStyleSheets,url);if(_566===-1){return;}delete this.editingAreaStyleSheets[_566];_542("link:[href=\""+url+"\"]",this.window.document).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_567){_567=!!_567;this._set("disabled",_567);if(!this.isLoaded){return;}if(has("ie")||has("webkit")||has("opera")){var _568=has("ie")&&(this.isLoaded||!this.focusOnLoad);if(_568){this.editNode.unselectable="on";}this.editNode.contentEditable=!_567;if(_568){this.defer(function(){if(this.editNode){this.editNode.unselectable="off";}});}}else{try{this.document.designMode=(_567?"off":"on");}catch(e){return;}if(!_567&&this._mozSettingProps){var ps=this._mozSettingProps;var n;for(n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e2){}}}}}this._disabledOK=true;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;this._iframeRegHandle=_54c.registerIframe(this.iframe);}if(!has("ie")&&!has("webkit")&&(this.height||has("mozilla"))){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _569=this;if(has("ie")){this.tabStop=_53d.create("div",{tabIndex:-1},this.editingArea);this.iframe.onfocus=function(){_569.editNode.setActive();};}}this.focusNode=this.editNode;var _56a=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_537.forEach(_56a,function(item){this.connect(ap,item.toLowerCase(),item);},this);this.connect(ap,"onmouseup","onClick");if(has("ie")){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}else{this.connect(this.document,"onmousedown",function(){delete this._cursorToStart;});}if(has("webkit")){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");this.connect(this.document,"onmousedown",function(e){var t=e.target;if(t&&(t===this.document.body||t===this.document)){this.defer("placeCursorAtEnd");}});}if(has("ie")){try{this.document.execCommand("RespectVisibilityInDesign",true,null);}catch(e){}}this.isLoaded=true;this.set("disabled",this.disabled);var _56b=lang.hitch(this,function(){this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.resolve(true);}this.onDisplayChanged();if(this.focusOnLoad){_543(lang.hitch(this,"defer","focus",this.updateInterval));}this.value=this.getValue(true);});if(this.setValueDeferred){this.setValueDeferred.then(_56b);}else{_56b();}},onKeyDown:function(e){if(e.keyCode===keys.TAB&&this.isTabIndent){_540.stop(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(has("ie")){if(e.keyCode==keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===keys.BACKSPACE&&this.document.selection.type==="Control"){_540.stop(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}if(has("ff")){if(e.keyCode===keys.PAGE_UP||e.keyCode===keys.PAGE_DOWN){if(this.editNode.clientHeight>=this.editNode.scrollHeight){e.preventDefault();}}}return true;},onKeyUp:function(){},setDisabled:function(_56c){_541.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.set("disabled",_56c);},_setValueAttr:function(_56d){this.setValue(_56d);},_setDisableSpellCheckAttr:function(_56e){if(this.document){_53b.set(this.document.body,"spellcheck",!_56e);}else{this.onLoadDeferred.then(lang.hitch(this,function(){_53b.set(this.document.body,"spellcheck",!_56e);}));}this._set("disableSpellCheck",_56e);},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode,_56f=this._keyHandlers[c],args=arguments;if(_56f&&!e.altKey){_537.some(_56f,function(h){if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){if(!h.handler.apply(this,args)){e.preventDefault();}return true;}},this);}if(!this._onKeyHitch){this._onKeyHitch=lang.hitch(this,"onKeyPressed");}this.defer("_onKeyHitch",1);return true;},addKeyHandler:function(key,ctrl,_570,_571){if(!lang.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_570||false,ctrl:ctrl||false,handler:_571});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(){if(!this.focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _572=this.getValue(true);if(_572!==this.value){this.onChange(_572);}this._set("value",_572);},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.set("disabled",false);}this.inherited(arguments);}},blur:function(){if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(this.ownerDocumentBody.focus){this.ownerDocumentBody.focus();}}},focus:function(){if(!this.isLoaded){this.focusOnLoad=true;return;}if(this._cursorToStart){delete this._cursorToStart;if(this.editNode.childNodes){this.placeCursorAtStart();return;}}if(!has("ie")){_54c.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){if(this._updateTimer){this._updateTimer.remove();}this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(){},_normalizeCommand:function(cmd,_573){var _574=cmd.toLowerCase();if(_574==="formatblock"){if(has("safari")&&_573===undefined){_574="heading";}}else{if(_574==="hilitecolor"&&!has("mozilla")){_574="backcolor";}}return _574;},_qcaCache:{},queryCommandAvailable:function(_575){var ca=this._qcaCache[_575];if(ca!==undefined){return ca;}return (this._qcaCache[_575]=this._queryCommandAvailable(_575));},_queryCommandAvailable:function(_576){var ie=1;var _577=1<<1;var _578=1<<2;var _579=1<<3;function _57a(_57b){return {ie:Boolean(_57b&ie),mozilla:Boolean(_57b&_577),webkit:Boolean(_57b&_578),opera:Boolean(_57b&_579)};};var _57c=null;switch(_576.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_57c=_57a(_577|ie|_578|_579);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_57c=_57a(_577|ie|_579|_578);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_57c=_57a(ie);break;case "cut":case "copy":case "paste":_57c=_57a(ie|_577|_578|_579);break;case "inserttable":_57c=_57a(_577|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_57c=_57a(ie|_577);break;default:return false;}return (has("ie")&&_57c.ie)||(has("mozilla")&&_57c.mozilla)||(has("webkit")&&_57c.webkit)||(has("opera")&&_57c.opera);},execCommand:function(_57d,_57e){var _57f;this.focus();_57d=this._normalizeCommand(_57d,_57e);if(_57e!==undefined){if(_57d==="heading"){throw new Error("unimplemented");}else{if((_57d==="formatblock")&&has("ie")){_57e="<"+_57e+">";}}}var _580="_"+_57d+"Impl";if(this[_580]){_57f=this[_580](_57e);}else{_57e=arguments.length>1?_57e:null;if(_57e||_57d!=="createlink"){_57f=this.document.execCommand(_57d,false,_57e);}}this.onDisplayChanged();return _57f;},queryCommandEnabled:function(_581){if(this.disabled||!this._disabledOK){return false;}_581=this._normalizeCommand(_581);var _582="_"+_581+"EnabledImpl";if(this[_582]){return this[_582](_581);}else{return this._browserQueryCommandEnabled(_581);}},queryCommandState:function(_583){if(this.disabled||!this._disabledOK){return false;}_583=this._normalizeCommand(_583);try{return this.document.queryCommandState(_583);}catch(e){return false;}},queryCommandValue:function(_584){if(this.disabled||!this._disabledOK){return false;}var r;_584=this._normalizeCommand(_584);if(has("ie")&&_584==="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_584)];}else{if(has("mozilla")&&_584==="hilitecolor"){var _585;try{_585=this.document.queryCommandValue("styleWithCSS");}catch(e){_585=false;}this.document.execCommand("styleWithCSS",false,true);r=this.document.queryCommandValue(_584);this.document.execCommand("styleWithCSS",false,_585);}else{r=this.document.queryCommandValue(_584);}}return r;},_sCall:function(name,args){return win.withGlobal(this.window,name,_549,args);},placeCursorAtStart:function(){this.focus();var _586=false;if(has("mozilla")){var _587=this.editNode.firstChild;while(_587){if(_587.nodeType===3){if(_587.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_586=true;this._sCall("selectElement",[_587]);break;}}else{if(_587.nodeType===1){_586=true;var tg=_587.tagName?_587.tagName.toLowerCase():"";if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){this._sCall("selectElement",[_587]);}else{this._sCall("selectElementChildren",[_587]);}break;}}_587=_587.nextSibling;}}else{_586=true;this._sCall("selectElementChildren",[this.editNode]);}if(_586){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _588=false;if(has("mozilla")){var last=this.editNode.lastChild;while(last){if(last.nodeType===3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_588=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType===1){_588=true;this._sCall("selectElement",[last.lastChild||last]);break;}}last=last.previousSibling;}}else{_588=true;this._sCall("selectElementChildren",[this.editNode]);}if(_588){this._sCall("collapse",[false]);}},getValue:function(_589){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_589);},_getValueAttr:function(){return this.getValue(true);},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.then(lang.hitch(this,function(){this.setValue(html);}));return;}this._cursorToStart=true;if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;if(html&&has("mozilla")&&html.toLowerCase()==="<p></p>"){html="<p>&#160;</p>";}if(!html&&has("webkit")){html="&#160;";}node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();this._set("value",this.getValue(true));},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!has("mozilla")){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(!html){this._cursorToStart=true;html="&#160;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}this._set("value",this.getValue(true));},_preFilterContent:function(html){var ec=html;_537.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_537.forEach(this.contentDomPreFilters,function(ef){if(ef&&lang.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_58a){var ec;if(!lang.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_58a){dom=lang.clone(dom);}_537.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_54b.getChildrenHtml(dom);}else{ec=dom;}if(!lang.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_537.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(){var _58b=dom.byId(_54d._scopeName+"._editor.RichText.value");if(_58b){if(_58b.value){_58b.value+=this._SEPARATOR;}_58b.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);}},escapeXml:function(str,_58c){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_58c){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){_541.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return _54b.getNodeHtml(node);},getNodeChildrenHtml:function(dom){_541.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return _54b.getChildrenHtml(dom);},close:function(save){if(this.isClosed){return;}if(!arguments.length){save=true;}if(save){this._set("value",this.getValue(true));}if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(has("ie")){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this._iframeRegHandle){this._iframeRegHandle.remove();delete this._iframeRegHandle;}if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(has("ie")){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=this.value;_53d.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=this.value;}delete this.iframe;_53c.remove(this.domNode,this.baseClass);this.isClosed=true;this.isLoaded=false;delete this.editNode;delete this.focusNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;},destroy:function(){if(!this.isClosed){this.close(false);}if(this._updateTimer){this._updateTimer.remove();}this.inherited(arguments);if(_54e._globalSaveHandler){delete _54e._globalSaveHandler[this.id];}},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");},_removeWebkitBogus:function(html){html=html.replace(/\sclass="webkit-block-placeholder"/gi,"");html=html.replace(/\sclass="apple-style-span"/gi,"");html=html.replace(/<meta charset=\"utf-8\" \/>/gi,"");return html;},_normalizeFontStyle:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");},_browserQueryCommandEnabled:function(_58d){if(!_58d){return false;}var elem=has("ie")?this.document.selection.createRange():this.document;try{return elem.queryCommandEnabled(_58d);}catch(e){return false;}},_createlinkEnabledImpl:function(){var _58e=true;if(has("opera")){var sel=this.window.getSelection();if(sel.isCollapsed){_58e=true;}else{_58e=this.document.queryCommandEnabled("createlink");}}else{_58e=this._browserQueryCommandEnabled("createlink");}return _58e;},_unlinkEnabledImpl:function(){var _58f=true;if(has("mozilla")||has("webkit")){_58f=this._sCall("hasAncestorElement",["a"]);}else{_58f=this._browserQueryCommandEnabled("unlink");}return _58f;},_inserttableEnabledImpl:function(){var _590=true;if(has("mozilla")||has("webkit")){_590=true;}else{_590=this._browserQueryCommandEnabled("inserttable");}return _590;},_cutEnabledImpl:function(){var _591=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_591=!!sel;}else{_591=this._browserQueryCommandEnabled("cut");}return _591;},_copyEnabledImpl:function(){var _592=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_592=!!sel;}else{_592=this._browserQueryCommandEnabled("copy");}return _592;},_pasteEnabledImpl:function(){var _593=true;if(has("webkit")){return true;}else{_593=this._browserQueryCommandEnabled("paste");}return _593;},_inserthorizontalruleImpl:function(_594){if(has("ie")){return this._inserthtmlImpl("<hr>");}return this.document.execCommand("inserthorizontalrule",false,_594);},_unlinkImpl:function(_595){if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);return this.document.execCommand("unlink",false,null);}return this.document.execCommand("unlink",false,_595);},_hilitecolorImpl:function(_596){var _597;var _598=this._handleTextColorOrProperties("hilitecolor",_596);if(!_598){if(has("mozilla")){this.document.execCommand("styleWithCSS",false,true);console.log("Executing color command.");_597=this.document.execCommand("hilitecolor",false,_596);this.document.execCommand("styleWithCSS",false,false);}else{_597=this.document.execCommand("hilitecolor",false,_596);}}return _597;},_backcolorImpl:function(_599){if(has("ie")){_599=_599?_599:null;}var _59a=this._handleTextColorOrProperties("backcolor",_599);if(!_59a){_59a=this.document.execCommand("backcolor",false,_599);}return _59a;},_forecolorImpl:function(_59b){if(has("ie")){_59b=_59b?_59b:null;}var _59c=false;_59c=this._handleTextColorOrProperties("forecolor",_59b);if(!_59c){_59c=this.document.execCommand("forecolor",false,_59b);}return _59c;},_inserthtmlImpl:function(_59d){_59d=this._preFilterContent(_59d);var rv=true;if(has("ie")){var _59e=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()==="CONTROL"){var n=_59e.item(0);while(_59e.length){_59e.remove(_59e.item(0));}n.outerHTML=_59d;}else{_59e.pasteHTML(_59d);}_59e.select();}else{if(has("mozilla")&&!_59d.length){this._sCall("remove");}else{rv=this.document.execCommand("inserthtml",false,_59d);}}return rv;},_boldImpl:function(_59f){var _5a0=false;if(has("ie")){this._adaptIESelection();_5a0=this._adaptIEFormatAreaAndExec("bold");}if(!_5a0){_5a0=this.document.execCommand("bold",false,_59f);}return _5a0;},_italicImpl:function(_5a1){var _5a2=false;if(has("ie")){this._adaptIESelection();_5a2=this._adaptIEFormatAreaAndExec("italic");}if(!_5a2){_5a2=this.document.execCommand("italic",false,_5a1);}return _5a2;},_underlineImpl:function(_5a3){var _5a4=false;if(has("ie")){this._adaptIESelection();_5a4=this._adaptIEFormatAreaAndExec("underline");}if(!_5a4){_5a4=this.document.execCommand("underline",false,_5a3);}return _5a4;},_strikethroughImpl:function(_5a5){var _5a6=false;if(has("ie")){this._adaptIESelection();_5a6=this._adaptIEFormatAreaAndExec("strikethrough");}if(!_5a6){_5a6=this.document.execCommand("strikethrough",false,_5a5);}return _5a6;},_superscriptImpl:function(_5a7){var _5a8=false;if(has("ie")){this._adaptIESelection();_5a8=this._adaptIEFormatAreaAndExec("superscript");}if(!_5a8){_5a8=this.document.execCommand("superscript",false,_5a7);}return _5a8;},_subscriptImpl:function(_5a9){var _5aa=false;if(has("ie")){this._adaptIESelection();_5aa=this._adaptIEFormatAreaAndExec("subscript");}if(!_5aa){_5aa=this.document.execCommand("subscript",false,_5a9);}return _5aa;},_fontnameImpl:function(_5ab){var _5ac;if(has("ie")){_5ac=this._handleTextColorOrProperties("fontname",_5ab);}if(!_5ac){_5ac=this.document.execCommand("fontname",false,_5ab);}return _5ac;},_fontsizeImpl:function(_5ad){var _5ae;if(has("ie")){_5ae=this._handleTextColorOrProperties("fontsize",_5ad);}if(!_5ae){_5ae=this.document.execCommand("fontsize",false,_5ad);}return _5ae;},_insertorderedlistImpl:function(_5af){var _5b0=false;if(has("ie")){_5b0=this._adaptIEList("insertorderedlist",_5af);}if(!_5b0){_5b0=this.document.execCommand("insertorderedlist",false,_5af);}return _5b0;},_insertunorderedlistImpl:function(_5b1){var _5b2=false;if(has("ie")){_5b2=this._adaptIEList("insertunorderedlist",_5b1);}if(!_5b2){_5b2=this.document.execCommand("insertunorderedlist",false,_5b1);}return _5b2;},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header);},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer);},_getNodeChildrenHeight:function(node){var h=0;if(node&&node.childNodes){var i;for(i=0;i<node.childNodes.length;i++){var size=_53e.position(node.childNodes[i]);h+=size.h;}}return h;},_isNodeEmpty:function(node,_5b3){if(node.nodeType===1){if(node.childNodes.length>0){return this._isNodeEmpty(node.childNodes[0],_5b3);}return true;}else{if(node.nodeType===3){return (node.nodeValue.substring(_5b3)==="");}}return false;},_removeStartingRangeFromRange:function(node,_5b4){if(node.nextSibling){_5b4.setStart(node.nextSibling,0);}else{var _5b5=node.parentNode;while(_5b5&&_5b5.nextSibling==null){_5b5=_5b5.parentNode;}if(_5b5){_5b4.setStart(_5b5.nextSibling,0);}}return _5b4;},_adaptIESelection:function(){var _5b6=_54a.getSelection(this.window);if(_5b6&&_5b6.rangeCount&&!_5b6.isCollapsed){var _5b7=_5b6.getRangeAt(0);var _5b8=_5b7.startContainer;var _5b9=_5b7.startOffset;while(_5b8.nodeType===3&&_5b9>=_5b8.length&&_5b8.nextSibling){_5b9=_5b9-_5b8.length;_5b8=_5b8.nextSibling;}var _5ba=null;while(this._isNodeEmpty(_5b8,_5b9)&&_5b8!==_5ba){_5ba=_5b8;_5b7=this._removeStartingRangeFromRange(_5b8,_5b7);_5b8=_5b7.startContainer;_5b9=0;}_5b6.removeAllRanges();_5b6.addRange(_5b7);}},_adaptIEFormatAreaAndExec:function(_5bb){var _5bc=_54a.getSelection(this.window);var doc=this.document;var rs,ret,_5bd,txt,_5be,_5bf,_5c0,_5c1;if(_5bb&&_5bc&&_5bc.isCollapsed){var _5c2=this.queryCommandValue(_5bb);if(_5c2){var _5c3=this._tagNamesForCommand(_5bb);_5bd=_5bc.getRangeAt(0);var fs=_5bd.startContainer;if(fs.nodeType===3){var _5c4=_5bd.endOffset;if(fs.length<_5c4){ret=this._adjustNodeAndOffset(rs,_5c4);fs=ret.node;_5c4=ret.offset;}}var _5c5;while(fs&&fs!==this.editNode){var _5c6=fs.tagName?fs.tagName.toLowerCase():"";if(_537.indexOf(_5c3,_5c6)>-1){_5c5=fs;break;}fs=fs.parentNode;}if(_5c5){rs=_5bd.startContainer;var _5c7=doc.createElement(_5c5.tagName);_53d.place(_5c7,_5c5,"after");if(rs&&rs.nodeType===3){var _5c8,_5c9;var _5ca=_5bd.endOffset;if(rs.length<_5ca){ret=this._adjustNodeAndOffset(rs,_5ca);rs=ret.node;_5ca=ret.offset;}txt=rs.nodeValue;_5be=doc.createTextNode(txt.substring(0,_5ca));var _5cb=txt.substring(_5ca,txt.length);if(_5cb){_5bf=doc.createTextNode(_5cb);}_53d.place(_5be,rs,"before");if(_5bf){_5c0=doc.createElement("span");_5c0.className="ieFormatBreakerSpan";_53d.place(_5c0,rs,"after");_53d.place(_5bf,_5c0,"after");_5bf=_5c0;}_53d.destroy(rs);var _5cc=_5be.parentNode;var _5cd=[];var _5ce;while(_5cc!==_5c5){var tg=_5cc.tagName;_5ce={tagName:tg};_5cd.push(_5ce);var _5cf=doc.createElement(tg);if(_5cc.style){if(_5cf.style){if(_5cc.style.cssText){_5cf.style.cssText=_5cc.style.cssText;_5ce.cssText=_5cc.style.cssText;}}}if(_5cc.tagName==="FONT"){if(_5cc.color){_5cf.color=_5cc.color;_5ce.color=_5cc.color;}if(_5cc.face){_5cf.face=_5cc.face;_5ce.face=_5cc.face;}if(_5cc.size){_5cf.size=_5cc.size;_5ce.size=_5cc.size;}}if(_5cc.className){_5cf.className=_5cc.className;_5ce.className=_5cc.className;}if(_5bf){_5c8=_5bf;while(_5c8){_5c9=_5c8.nextSibling;_5cf.appendChild(_5c8);_5c8=_5c9;}}if(_5cf.tagName==_5cc.tagName){_5c0=doc.createElement("span");_5c0.className="ieFormatBreakerSpan";_53d.place(_5c0,_5cc,"after");_53d.place(_5cf,_5c0,"after");}else{_53d.place(_5cf,_5cc,"after");}_5be=_5cc;_5bf=_5cf;_5cc=_5cc.parentNode;}if(_5bf){_5c8=_5bf;if(_5c8.nodeType===1||(_5c8.nodeType===3&&_5c8.nodeValue)){_5c7.innerHTML="";}while(_5c8){_5c9=_5c8.nextSibling;_5c7.appendChild(_5c8);_5c8=_5c9;}}var _5d0;if(_5cd.length){_5ce=_5cd.pop();var _5d1=doc.createElement(_5ce.tagName);if(_5ce.cssText&&_5d1.style){_5d1.style.cssText=_5ce.cssText;}if(_5ce.className){_5d1.className=_5ce.className;}if(_5ce.tagName==="FONT"){if(_5ce.color){_5d1.color=_5ce.color;}if(_5ce.face){_5d1.face=_5ce.face;}if(_5ce.size){_5d1.size=_5ce.size;}}_53d.place(_5d1,_5c7,"before");while(_5cd.length){_5ce=_5cd.pop();var _5d2=doc.createElement(_5ce.tagName);if(_5ce.cssText&&_5d2.style){_5d2.style.cssText=_5ce.cssText;}if(_5ce.className){_5d2.className=_5ce.className;}if(_5ce.tagName==="FONT"){if(_5ce.color){_5d2.color=_5ce.color;}if(_5ce.face){_5d2.face=_5ce.face;}if(_5ce.size){_5d2.size=_5ce.size;}}_5d1.appendChild(_5d2);_5d1=_5d2;}_5c1=doc.createTextNode(".");_5c0.appendChild(_5c1);_5d1.appendChild(_5c1);_5d0=_54a.create(this.window);_5d0.setStart(_5c1,0);_5d0.setEnd(_5c1,_5c1.length);_5bc.removeAllRanges();_5bc.addRange(_5d0);this._sCall("collapse",[false]);_5c1.parentNode.innerHTML="";}else{_5c0=doc.createElement("span");_5c0.className="ieFormatBreakerSpan";_5c1=doc.createTextNode(".");_5c0.appendChild(_5c1);_53d.place(_5c0,_5c7,"before");_5d0=_54a.create(this.window);_5d0.setStart(_5c1,0);_5d0.setEnd(_5c1,_5c1.length);_5bc.removeAllRanges();_5bc.addRange(_5d0);this._sCall("collapse",[false]);_5c1.parentNode.innerHTML="";}if(!_5c7.firstChild){_53d.destroy(_5c7);}return true;}}return false;}else{_5bd=_5bc.getRangeAt(0);rs=_5bd.startContainer;if(rs&&rs.nodeType===3){var _5c4=_5bd.startOffset;if(rs.length<_5c4){ret=this._adjustNodeAndOffset(rs,_5c4);rs=ret.node;_5c4=ret.offset;}txt=rs.nodeValue;_5be=doc.createTextNode(txt.substring(0,_5c4));var _5cb=txt.substring(_5c4);if(_5cb!==""){_5bf=doc.createTextNode(txt.substring(_5c4));}_5c0=doc.createElement("span");_5c1=doc.createTextNode(".");_5c0.appendChild(_5c1);if(_5be.length){_53d.place(_5be,rs,"after");}else{_5be=rs;}_53d.place(_5c0,_5be,"after");if(_5bf){_53d.place(_5bf,_5c0,"after");}_53d.destroy(rs);var _5d0=_54a.create(this.window);_5d0.setStart(_5c1,0);_5d0.setEnd(_5c1,_5c1.length);_5bc.removeAllRanges();_5bc.addRange(_5d0);doc.execCommand(_5bb);_53d.place(_5c0.firstChild,_5c0,"before");_53d.destroy(_5c0);_5d0.setStart(_5c1,0);_5d0.setEnd(_5c1,_5c1.length);_5bc.removeAllRanges();_5bc.addRange(_5d0);this._sCall("collapse",[false]);_5c1.parentNode.innerHTML="";return true;}}}else{return false;}},_adaptIEList:function(_5d3){var _5d4=_54a.getSelection(this.window);if(_5d4.isCollapsed){if(_5d4.rangeCount&&!this.queryCommandValue(_5d3)){var _5d5=_5d4.getRangeAt(0);var sc=_5d5.startContainer;if(sc&&sc.nodeType==3){if(!_5d5.startOffset){var _5d6="ul";if(_5d3==="insertorderedlist"){_5d6="ol";}var list=this.document.createElement(_5d6);var li=_53d.create("li",null,list);_53d.place(list,sc,"before");li.appendChild(sc);_53d.create("br",null,list,"after");var _5d7=_54a.create(this.window);_5d7.setStart(sc,0);_5d7.setEnd(sc,sc.length);_5d4.removeAllRanges();_5d4.addRange(_5d7);this._sCall("collapse",[true]);return true;}}}}return false;},_handleTextColorOrProperties:function(_5d8,_5d9){var _5da=_54a.getSelection(this.window);var doc=this.document;var rs,ret,_5db,txt,_5dc,_5dd,_5de,_5df;_5d9=_5d9||null;if(_5d8&&_5da&&_5da.isCollapsed){if(_5da.rangeCount){_5db=_5da.getRangeAt(0);rs=_5db.startContainer;if(rs&&rs.nodeType===3){var _5e0=_5db.startOffset;if(rs.length<_5e0){ret=this._adjustNodeAndOffset(rs,_5e0);rs=ret.node;_5e0=ret.offset;}txt=rs.nodeValue;_5dc=doc.createTextNode(txt.substring(0,_5e0));var _5e1=txt.substring(_5e0);if(_5e1!==""){_5dd=doc.createTextNode(txt.substring(_5e0));}_5de=doc.createElement("span");_5df=doc.createTextNode(".");_5de.appendChild(_5df);var _5e2=doc.createElement("span");_5de.appendChild(_5e2);if(_5dc.length){_53d.place(_5dc,rs,"after");}else{_5dc=rs;}_53d.place(_5de,_5dc,"after");if(_5dd){_53d.place(_5dd,_5de,"after");}_53d.destroy(rs);var _5e3=_54a.create(this.window);_5e3.setStart(_5df,0);_5e3.setEnd(_5df,_5df.length);_5da.removeAllRanges();_5da.addRange(_5e3);if(has("webkit")){var _5e4="color";if(_5d8==="hilitecolor"||_5d8==="backcolor"){_5e4="backgroundColor";}_53f.set(_5de,_5e4,_5d9);this._sCall("remove",[]);_53d.destroy(_5e2);_5de.innerHTML="&#160;";this._sCall("selectElement",[_5de]);this.focus();}else{this.execCommand(_5d8,_5d9);_53d.place(_5de.firstChild,_5de,"before");_53d.destroy(_5de);_5e3.setStart(_5df,0);_5e3.setEnd(_5df,_5df.length);_5da.removeAllRanges();_5da.addRange(_5e3);this._sCall("collapse",[false]);_5df.parentNode.removeChild(_5df);}return true;}}}return false;},_adjustNodeAndOffset:function(node,_5e5){while(node.length<_5e5&&node.nextSibling&&node.nextSibling.nodeType===3){_5e5=_5e5-node.length;node=node.nextSibling;}return {"node":node,"offset":_5e5};},_tagNamesForCommand:function(_5e6){if(_5e6==="bold"){return ["b","strong"];}else{if(_5e6==="italic"){return ["i","em"];}else{if(_5e6==="strikethrough"){return ["s","strike"];}else{if(_5e6==="superscript"){return ["sup"];}else{if(_5e6==="subscript"){return ["sub"];}else{if(_5e6==="underline"){return ["u"];}}}}}}return [];},_stripBreakerNodes:function(node){if(!this.isLoaded){return;}_542(".ieFormatBreakerSpan",node).forEach(function(b){while(b.firstChild){_53d.place(b.firstChild,b,"before");}_53d.destroy(b);});return node;}});return _54e;});},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_5e7){return function(_5e8,_5e9){switch(typeof _5e8){default:throw new Error("Can not query with a "+typeof _5e8);case "object":case "undefined":var _5ea=_5e8;_5e8=function(_5eb){for(var key in _5ea){var _5ec=_5ea[key];if(_5ec&&_5ec.test){if(!_5ec.test(_5eb[key],_5eb)){return false;}}else{if(_5ec!=_5eb[key]){return false;}}}return true;};break;case "string":if(!this[_5e8]){throw new Error("No filter function "+_5e8+" was found in store");}_5e8=this[_5e8];case "function":}function _5ed(_5ee){var _5ef=_5e7.filter(_5ee,_5e8);var _5f0=_5e9&&_5e9.sort;if(_5f0){_5ef.sort(typeof _5f0=="function"?_5f0:function(a,b){for(var sort,i=0;sort=_5f0[i];i++){var _5f1=a[sort.attribute];var _5f2=b[sort.attribute];if(_5f1!=_5f2){return !!sort.descending==(_5f1==null||_5f1>_5f2)?-1:1;}}return 0;});}if(_5e9&&(_5e9.start||_5e9.count)){var _5f3=_5ef.length;_5ef=_5ef.slice(_5e9.start||0,(_5e9.start||0)+(_5e9.count||Infinity));_5ef.total=_5f3;}return _5ef;};_5ed.matches=_5e8;return _5ed;};});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(dojo,_5f4,_5f5,_5f6,_5f7,lang,_5f8,has,_5f9,win,_5fa,_5fb,_5fc,_5fd,_5fe,util,html,_5ff,_600,_601){var _602=function(_603,_604){return _603.style.cssText==undefined?_603.getAttribute("style"):_603.style.cssText;};var _605=_5f6("dojox.grid._View",[_5fc,_5fd],{defaultWidth:"18em",viewWidth:"",templateString:_5fa,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_5ff._HeaderBuilder,_contentBuilderClass:_5ff._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");util.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);util.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){html.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);html.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_606){var vs=(this.structure=_606);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_607){if(_607){_5f7.forEach(_5f9("[widgetId]",_607).map(_5f4.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_608,_609){this._onBeforeRow(_608,_609);if(_608>=0){this._cleanupRowWidgets(this.getRowNode(_608));}},onAfterRow:function(_60a,_60b,_60c){this._onAfterRow(_60a,_60b,_60c);var g=this.grid;_5f7.forEach(_5f9(".dojoxGridStubNode",_60c),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _60d=window.parseInt(html.attr(n,"cellIdx"),10);var _60e=g.getCell(_60d);var w=_5f4.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}dojo.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _60f=this.hasVScrollbar();var _610=html.style(this.scrollboxNode,"overflow");if(this.noscroll||!_610||_610=="hidden"){_60f=false;}else{if(_610=="scroll"){_60f=true;}}return (_60f?_5fe.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?h.firstChild.offsetWidth:0;},setColumnsWidth:function(_611){this.headerContentNode.firstChild.style.width=_611+"px";if(this.viewWidth){this.viewWidth=_611+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,html._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _612=this.grid.layout.cells;var _613=lang.hitch(this,function(node,_614){!this.grid.isLeftToRight()&&(_614=!_614);var inc=_614?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_612[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_612[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _615="dojoxGrid_bottomMarker";var _616="dojoxGrid_topMarker";if(this.bottomMarker){html.destroy(this.bottomMarker);}this.bottomMarker=html.byId(_615);if(this.topMarker){html.destroy(this.topMarker);}this.topMarker=html.byId(_616);if(!this.bottomMarker){this.bottomMarker=html.create("div",{"id":_615,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=html.create("div",{"id":_616,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=html.contentBox(this.bottomMarker);var _617=html.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _5fb(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:lang.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_5fb.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:lang.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_5fb.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:lang.hitch(this,function(_618){var src=this.source;if(src.current==src.targetAnchor&&src.before==_618){return;}if(src.targetAnchor&&_613(src.targetAnchor,src.before)){src._removeItemClass(_613(src.targetAnchor,src.before),src.before?"After":"Before");}_5fb.prototype._markTargetAnchor.call(src,_618);var _619=_618?src.targetAnchor:_613(src.targetAnchor,src.before);var _61a=0;if(!_619){_619=src.targetAnchor;_61a=html.contentBox(_619).w+this.arrowDim.w/2+2;}var pos=html.position(_619,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_61a);html.style(this.bottomMarker,"visibility","visible");html.style(this.topMarker,"visibility","visible");html.style(this.bottomMarker,{"left":left+"px","top":(_617+pos.y)+"px"});html.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_613(src.targetAnchor,src.before)){src._addItemClass(_613(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:lang.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_613(src.targetAnchor,src.before)){src._removeItemClass(_613(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_5fb.prototype._unmarkTargetAnchor.call(src);}),destroy:lang.hitch(this,function(){_5f8.disconnect(this._source_conn);_5f8.unsubscribe(this._source_sub);_5fb.prototype.destroy.call(this.source);if(this.bottomMarker){html.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){html.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:lang.hitch(this,function(){_5fb.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_5f8.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_5f8.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){html.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_61b,_61c,copy){if(_601.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _61d=this.grid.views.views;var _61e=_61d[_61b.viewIndex];var _61f=_61d[this.index];if(_61f!=_61e){_61e.convertColPctToFixed();_61f.convertColPctToFixed();}},_onDndDrop:function(_620,_621,copy){if(_601.manager().target!==this.source){if(_601.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _622=function(n){return n?html.attr(n,"idx"):null;};var w=html.marginBox(_621[0]).w;if(_620.viewIndex!==this.index){var _623=this.grid.views.views;var _624=_623[_620.viewIndex];var _625=_623[this.index];if(_624.viewWidth&&_624.viewWidth!="auto"){_624.setColumnsWidth(_624.getColumnsWidth()-w);}if(_625.viewWidth&&_625.viewWidth!="auto"){_625.setColumnsWidth(_625.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _626=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_626.moveColumn(_620.viewIndex,idx,_622(_621[0]),_622(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_627){var n=_627.name||_627.grid.getCellName(_627);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_627.index!=_627.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_627.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_627.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_628){var _629=this._hasHScroll||false;if(this._hasHScroll==undefined||_628){if(this.noscroll){this._hasHScroll=false;}else{var _62a=html.style(this.scrollboxNode,"overflow");if(_62a=="hidden"){this._hasHScroll=false;}else{if(_62a=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_629!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_62b){var _62c=this._hasVScroll||false;if(this._hasVScroll==undefined||_62b){if(this.noscroll){this._hasVScroll=false;}else{var _62d=html.style(this.scrollboxNode,"overflow");if(_62d=="hidden"){this._hasVScroll=false;}else{if(_62d=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_62c!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _62e=false;this.grid.initialWidth="";var _62f=_5f9("th",this.headerContentNode);var _630=_5f7.map(_62f,function(c,vIdx){var w=c.style.width;html.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_62e=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return html.contentBox(c).w;});if(_62e){_5f7.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _631=cell.view.getHeaderCellNode(cell.index);if(_631&&html.hasAttr(_631,"vIdx")){var vIdx=window.parseInt(html.attr(_631,"vIdx"));this.setColWidth(idx,_630[vIdx]);html.removeAttr(_631,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_632){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _633=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_632||(this.noscroll&&_633())){h-=_5fe.getScrollbar().h;}util.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_634){var _635=this.createRowNode(_634);this.buildRow(_634,_635);return _635;},createRowNode:function(_636){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _5f5.grid._RowSelector){html.attr(node,"role","presentation");}else{html.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[util.gridViewTag]=this.id;node[util.rowIndexTag]=_636;this.rowNodes[_636]=node;return node;},buildRow:function(_637,_638){this.buildRowContent(_637,_638);this.styleRow(_637,_638);},buildRowContent:function(_639,_63a){_63a.innerHTML=this.content.generateHtml(_639,_639);if(this.flexCells&&this.contentWidth){_63a.firstChild.style.width=this.contentWidth;}util.fire(this,"onAfterRow",[_639,this.structure.cells,_63a]);},rowRemoved:function(_63b){if(_63b>=0){this._cleanupRowWidgets(this.getRowNode(_63b));}this.grid.edit.save(this,_63b);delete this.rowNodes[_63b];},getRowNode:function(_63c){return this.rowNodes[_63c];},getCellNode:function(_63d,_63e){var row=this.getRowNode(_63d);if(row){return this.content.getCellNode(row,_63e);}},getHeaderCellNode:function(_63f){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_63f);}},styleRow:function(_640,_641){_641._style=_602(_641);this.styleRowNode(_640,_641);},styleRowNode:function(_642,_643){if(_643){this.doStyleRowNode(_642,_643);}},doStyleRowNode:function(_644,_645){this.grid.styleRowNode(_644,_645);},updateRow:function(_646){var _647=this.getRowNode(_646);if(_647){_647.style.height="";this.buildRow(_646,_647);}return _647;},updateRowStyles:function(_648){this.styleRowNode(_648,this.getRowNode(_648));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_649){if(has("ff")>=13){this._nativeScroll=true;}var _64a=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_64a&&this.firstScroll==1)||(_64a&&this.firstScroll===0)){var s=html.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_64a?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_64b){this.lastTop=_64b;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_64b;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_64c,_64d){this.grid.setCellWidth(_64c,_64d+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _64e=_5f6("dojox.grid._GridAvatar",_600,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _64f=this.manager.source,node;if(_64f.creator){node=_64f._normalizedCreator(_64f.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _650,_651;if(node.tagName.toLowerCase()=="tr"){_650=dd.createElement("table");_651=dd.createElement("tbody");_651.appendChild(node);_650.appendChild(_651);node=_650;}else{if(node.tagName.toLowerCase()=="th"){_650=dd.createElement("table");_651=dd.createElement("tbody");var r=dd.createElement("tr");_650.cellPadding=_650.cellSpacing="0";r.appendChild(node);_651.appendChild(r);_650.appendChild(_651);node=_650;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);html.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_601.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_601.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _652=_601.manager().makeAvatar;_601.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!html.hasClass(win.body(),"dijit_a11y")){return new _64e(this);}return _652.call(_601.manager());};return _605;});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_653,dom,_654,_655,_656,has,_657,_658,_659,_65a,_65b){return _653("dijit.MenuItem",[_657,_658,_659,_65a],{templateString:_65b,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_65c){if(_65c&&!("label" in this.params)){this.set("label",_65c.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _65d=this.id+"_text";_654.set(this.containerNode,"id",_65d);if(this.accelKeyNode){_654.set(this.accelKeyNode,"id",this.id+"_accel");_65d+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_65d);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_65e){_655.toggle(this.domNode,"dijitMenuItemSelected",_65e);},setLabel:function(_65f){_656.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_65f);},setDisabled:function(_660){_656.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_660);},_setDisabledAttr:function(_661){this.focusNode.setAttribute("aria-disabled",_661?"true":"false");this._set("disabled",_661);},_setAccelKeyAttr:function(_662){this.accelKeyNode.style.display=_662?"":"none";this.accelKeyNode.innerHTML=_662;_654.set(this.containerNode,"colSpan",_662?"1":"2");this._set("accelKey",_662);},_setTextDirAttr:function(_663){if(!this._created||this.textDir!=_663){this._set("textDir",_663);this.applyTextDir(this.focusNode,this.label);}}});});},"esri/dijit/editing/AttachmentEditor":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(_664,dojo,_665){dojo.provide("esri.dijit.editing.AttachmentEditor");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.declare("esri.dijit.editing.AttachmentEditor",[_664._Widget,_664._Templated],{widgetsInTemplate:true,templateString:"<div class=\"attachmentEditor\">\r\n    <br />\r\n    <div>\r\n        <b>${NLS_attachments}</b>\r\n        <hr />\r\n        <div dojoAttachPoint=\"_attachmentError\" style='color:red;display:none'></div>\r\n        <br />\r\n        <span dojoAttachPoint='_attachmentList' style='word-wrap: break-word;'></span>\r\n        <br><br>\r\n        <form dojoAttachPoint='_uploadForm'> ${NLS_add}:&nbsp;&nbsp;<input type='file' name='attachment' dojoAttachPoint='_uploadField' /> </form>\r\n    </div>\r\n</div>",basePath:dojo.moduleUrl("esri.dijit.editing"),_listHtml:"<span id='node_${oid}_${attid}'><a href='${href}' target='_blank'>${name}</a>",_deleteBtnHtml:"(<span style='cursor:pointer;color:red;font-weight:bold;' class='deleteAttachment' id='${attid}');'>X</span>)",_endHtml:"<br/></span>",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(_666,_667){dojo.mixin(this,esri.bundle.widgets.attachmentEditor);},startup:function(){this.inherited(arguments);this._uploadField_connect=dojo.connect(this._uploadField,"onchange",this,"_addAttachment");this._uploadFieldFocus_connect=dojo.connect(this._uploadField,"onfocus",dojo.hitch(this,function(e){esri.hide(this._attachmentError);}));},destroy:function(){dojo.forEach(this._aeConnects,dojo.disconnect);dojo.disconnect(this._uploadField_connect);dojo.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments);},showAttachments:function(_668,_669){var list=this._attachmentList;list.innerHTML=this.NLS_none;this._uploadField.value="";dojo.forEach(this.domNode.children,function(_66a,idx){esri.show(_66a);});esri.hide(this._attachmentError);if(!_668){return;}this._featureLayer=_668.getLayer()||_669;if(!this._featureLayer){return;}if(this._featureLayer.declaredClass!=="esri.layers.FeatureLayer"||!this._featureLayer.getEditCapabilities){esri.hide(this._uploadForm);dojo.forEach(this.domNode.children,function(_66b,idx){esri.hide(_66b);});return;}this._currentLayerId=this._featureLayer.id;if(!this._layerEditingCapChecked[this._currentLayerId]){this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities();this._layerEditingCapChecked[this._currentLayerId]=true;}this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:_668}).canUpdate;this._oid=_668.attributes[this._featureLayer.objectIdField];this._getAttachments(_668);},_getAttachments:function(_66c){if(!this._featureLayer||!this._featureLayer.queryAttachmentInfos){return;}this._featureLayer.queryAttachmentInfos(this._oid,dojo.hitch(this,"_onQueryAttachmentInfosComplete"));},_addAttachment:function(){esri.hide(this._attachmentError);if(!this._featureLayer||!this._featureLayer.addAttachment){return;}this._featureLayer.addAttachment(this._oid,this._uploadForm,dojo.hitch(this,"_onAddAttachmentComplete"),dojo.hitch(this,"_onAddAttachmentError"));},_deleteAttachment:function(oid,_66d){this._featureLayer.deleteAttachments(oid,[_66d],dojo.hitch(this,"_onDeleteAttachmentComplete"));},_onQueryAttachmentInfosComplete:function(_66e){var _66f=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";if((!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate)||(!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate)){_66f=this._listHtml+this._endHtml;this._uploadForm.style.display="none";}else{if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_66f=this._listHtml+this._endHtml;}}var list=this._attachmentList,_670=dojo.map(_66e,dojo.hitch(this,function(info){return esri.substitute({href:info.url,name:info.name,oid:info.objectId,attid:info.id},_66f);}));list.innerHTML=_670.join("")||this.NLS_none;this._updateConnects();},_onAddAttachmentComplete:function(_671){var _672=this._uploadField;var _673=_672.value;var pos=_673.lastIndexOf("\\");if(pos>-1){_673=_673.substring(pos+1,_673.length);}_673=_673.replace(/\ /g,"_");var list=this._attachmentList,_674=dojo.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var _675=this._listHtml+this._deleteBtnHtml+this._endHtml;if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_675=this._listHtml+this._endHtml;}var link=esri.substitute({href:this._featureLayer._url.path+"/"+_671.objectId+"/attachments/"+_671.attachmentId+(_674?("?"+_674):""),name:_673,oid:_671.objectId,attid:_671.attachmentId},_675);list.innerHTML=list.innerHTML==this.NLS_none?link:(list.innerHTML+link);this._updateConnects();_672.value="";},_onAddAttachmentError:function(_676){if(_676&&esri._isDefined(_676.code)){var _677,_678=this._attachmentError;if(_676.code===400){_677=this.NLS_fileNotSupported;}else{_677=_676.message||(_676.details&&_676.details.length&&_676.details[0]);}dojo.attr(_678,"innerHTML",(_677||this.NLS_error));esri.show(_678);}},_onDeleteAttachmentComplete:function(_679){var _67a=dojo.every(_679,function(_67b){return _67b.success;}),list=this._attachmentList;if(_67a){dojo.query("#node_"+_679[0].objectId+"_"+_679[0].attachmentId).orphan();if(!list.children||!list.children.length){list.innerHTML=this.NLS_none;}}},_updateConnects:function(){dojo.forEach(this._aeConnects,dojo.disconnect);dojo.query(".deleteAttachment").forEach(function(item){this._aeConnects.push(dojo.connect(item,"onclick",dojo.hitch(this,"_deleteAttachment",this._oid,item.id)));},this);}});});},"dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_67c,dom,_67d,_67e){return _67c("dijit.ToolbarSeparator",[_67d,_67e],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","../Viewport","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style"],function(lang,_67f,_680,_681,_682,_683,_684,_685,_686){return _683("dijit.layout._LayoutWidget",[_67f,_680,_681],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_684.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _687=this.getParent&&this.getParent();if(!(_687&&_687.isLayoutContainer)){this.resize();this.own(_682.on("resize",lang.hitch(this,"resize")));}},resize:function(_688,_689){var node=this.domNode;if(_688){_685.setMarginBox(node,_688);}var mb=_689||{};lang.mixin(mb,_688||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_685.getMarginBox(node),mb);}var cs=_686.getComputedStyle(node);var me=_685.getMarginExtents(node,cs);var be=_685.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_685.getPadExtents(node,cs);this._contentBox={l:_686.toPixelValue(node,cs.paddingLeft),t:_686.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_68a){var cls=this.baseClass+"-child "+(_68a.baseClass?this.baseClass+"-"+_68a.baseClass:"");_684.add(_68a.domNode,cls);},addChild:function(_68b,_68c){this.inherited(arguments);if(this._started){this._setupChild(_68b);}},removeChild:function(_68d){var cls=this.baseClass+"-child"+(_68d.baseClass?" "+this.baseClass+"-"+_68d.baseClass:"");_684.remove(_68d.domNode,cls);this.inherited(arguments);}});});},"dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_68e,lang,_68f){var _690=function(_691,_692){if(_691.style.cssText==undefined){_691.setAttribute("style",_692);}else{_691.style.cssText=_692;}};return _68e("dojox.grid._RowManager",null,{constructor:function(_693){this.grid=_693;},linesToEms:2,overRow:-2,prepareStylingRow:function(_694,_695){return {index:_694,node:_695,odd:Boolean(_694&1),selected:!!this.grid.selection.isSelected(_694),over:this.isOver(_694),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_696,_697){var row=this.prepareStylingRow(_696,_697);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_698){var i=_698;i.node.className=i.customClasses;var h=i.node.style.height;_690(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_699){this.grid.updateRowStyles(_699);},setOverRow:function(_69a){var last=this.overRow;this.overRow=_69a;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_69b){return (this.overRow==_69b&&!_68f.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_69c,win,dom,_69d,_69e,_69f,has,_6a0){return _69c("dojo.dnd.Avatar",null,{constructor:function(_6a1){this.manager=_6a1;this.construct();},construct:function(){var a=_69f.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_6a2=this.manager.source,node,b=_69f.create("tbody",null,a),tr=_69f.create("tr",null,b),td=_69f.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_69f.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_69f.create("span",{innerHTML:_6a2.generateText?this._generateText():""},td);_69d.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_6a2.creator){node=_6a2._normalizedCreator(_6a2.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _6a3=_69f.create("table"),_6a4=_69f.create("tbody",null,_6a3);_6a4.appendChild(node);node=_6a3;}}node.id="";tr=_69f.create("tr",null,b);td=_69f.create("td",null,tr);td.appendChild(node);_69d.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_69f.destroy(this.node);this.node=false;},update:function(){_69e.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_6a0(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"dijit/form/_Spinner":function(){require({cache:{"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n"}});define("dijit/form/_Spinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/mouse","../typematic","./RangeBoundTextBox","dojo/text!./templates/Spinner.html","./_TextBoxMixin"],function(_6a5,_6a6,keys,lang,has,_6a7,_6a8,_6a9,_6aa,_6ab){return _6a5("dijit.form._Spinner",_6a9,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:_6aa,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{"upArrowNode":"dijitUpArrowButton","downArrowNode":"dijitDownArrowButton"},adjust:function(val){return val;},_arrowPressed:function(_6ac,_6ad,_6ae){if(this.disabled||this.readOnly){return;}this._setValueAttr(this.adjust(this.get("value"),_6ad*_6ae),false);_6ab.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(){this._wheelTimer=null;},_typematicCallback:function(_6af,node,evt){var inc=this.smallDelta;if(node==this.textbox){var key=evt.charOrCode;inc=(key==keys.PAGE_UP||key==keys.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==keys.UP_ARROW||key==keys.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_6af==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){_6a6.stop(evt);var _6b0=evt.wheelDelta/120;if(Math.floor(_6b0)!=_6b0){_6b0=evt.wheelDelta>0?1:-1;}var _6b1=evt.detail?(evt.detail*-1):_6b0;if(_6b1!==0){var node=this[(_6b1>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_6b1,this.smallDelta);if(this._wheelTimer){this._wheelTimer.remove();}this._wheelTimer=this.defer(function(){this._arrowReleased(node);},50);}},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_6a7.wheel,"_mouseWheeled");this.own(_6a8.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_6a8.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_6a8.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_6a8.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));}});});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_6b2,arr,_6b3,_6b4,_6b5,_6b6,win,_6b7,_6b8){return _6b2("dojox.gfx.Moveable",null,{constructor:function(_6b9,_6ba){this.shape=_6b9;this.delay=(_6ba&&_6ba.delay>0)?_6ba.delay:0;this.mover=(_6ba&&_6ba.mover)?_6ba.mover:_6b7;this.leftButtonOnly=_6ba&&_6ba.leftButtonOnly;this.events=[this.shape.connect(_6b5.press,this,"onMouseDown")];},destroy:function(){arr.forEach(this.events,this.shape.disconnect,this.shape);this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_6b5.move,this,"onMouseMove"),this.shape.connect(_6b5.release,this,"onMouseUp"));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_6b8.isLeft(e)){new this.mover(this.shape,e,this);}}_6b3.stop(e);},onMouseMove:function(e){if(Math.abs(e.clientX-this._lastX)>this.delay||Math.abs(e.clientY-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_6b3.stop(e);},onMouseUp:function(e){this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());this.shape.disconnect(this.events.pop());},onMoveStart:function(_6bb){_6b4.publish("/gfx/move/start",_6bb);_6b6.add(win.body(),"dojoMove");},onMoveStop:function(_6bc){_6b4.publish("/gfx/move/stop",_6bc);_6b6.remove(win.body(),"dojoMove");},onFirstMove:function(_6bd){},onMove:function(_6be,_6bf){this.onMoving(_6be,_6bf);this.shape.applyLeftTransform(_6bf);this.onMoved(_6be,_6bf);},onMoving:function(_6c0,_6c1){},onMoved:function(_6c2,_6c3){}});});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_6c4,_6c5,_6c6){var base=null;return _6c4("dojo.store.Memory",base,{constructor:function(_6c7){for(var i in _6c7){this[i]=_6c7[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_6c6,get:function(id){return this.data[this.index[id]];},getIdentity:function(_6c8){return _6c8[this.idProperty];},put:function(_6c9,_6ca){var data=this.data,_6cb=this.index,_6cc=this.idProperty;var id=_6c9[_6cc]=(_6ca&&"id" in _6ca)?_6ca.id:_6cc in _6c9?_6c9[_6cc]:Math.random();if(id in _6cb){if(_6ca&&_6ca.overwrite===false){throw new Error("Object already exists");}data[_6cb[id]]=_6c9;}else{_6cb[id]=data.push(_6c9)-1;}return id;},add:function(_6cd,_6ce){(_6ce=_6ce||{}).overwrite=false;return this.put(_6cd,_6ce);},remove:function(id){var _6cf=this.index;var data=this.data;if(id in _6cf){data.splice(_6cf[id],1);this.setData(data);return true;}},query:function(_6d0,_6d1){return _6c5(this.queryEngine(_6d0,_6d1)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_6d2,_6d3,_6d4,_6d5,_6d6,_6d7,_6d8,_6d9,_6da,_6db,_6dc,_6dd,util,_6de,_6df,_6e0,_6e1,_6e2,_6e3,lang,has,_6e4,html,_6e5){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _6e6=_6d3("dojox.grid._Grid",[_6de,_6df,_6d4],{templateString:_6e1,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_6d6,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_6e4.initOnFontResize();this.connect(_6e4,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}},postMixInProperties:function(){this.inherited(arguments);var _6e7=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_6e2.substitute(this.loadingMessage,_6e7);this.errorMessage=_6e2.substitute(this.errorMessage,_6e7);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_6e3.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_6e8){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_6e8){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _6d9(this);this.focus=new _6da(this);this.edit=new _6db(this);},createSelection:function(){this.selection=new _6dc(this);},createScroller:function(){this.scroller=new _6d5();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_6e9){},createViews:function(){this.views=new _6d8(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_6ea,idx){var c=lang.getObject(_6ea);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_6d2._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_6eb){var s=_6eb;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_6ec){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_6ec);},getColumnTogglingItems:function(){var _6ed,_6ee=[];_6ed=_6e3.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _6e0({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_6ef){if(self.layout.setColumnVisibility(this._gridCell.index,_6ef)){var _6f0=this._gridCell.menuItems;if(_6f0.length>1){_6e3.forEach(_6f0,function(item){if(item!==this){item.setAttribute("checked",_6ef);}},this);}_6ef=_6e3.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_6e3.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_6ef.length==1){_6e3.forEach(_6ef[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _6f1=_6e3.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_6f1,1);delete this._gridCell;_6e0.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_6ee.push(item);}return item;},this);if(_6ee.length==1){_6ee[0].set("disabled",true);}return _6ed;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_6e3.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_6e3.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_6f2){this.setScrollTop(0);},getItem:function(_6f3){return null;},showMessage:function(_6f4){if(_6f4){this.messagesNode.innerHTML=_6f4;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_6f5,_6f6){if(dojo.isIE&&!_6f5&&!_6f6&&this._autoHeight){return;}this._pendingChangeSize=_6f5;this._pendingResultSize=_6f6;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_6f7,_6f8){_6f7=_6f7||this._pendingChangeSize;_6f8=_6f8||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _6f9=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_6f9.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_6f8){_6f7=_6f8;}if(!this._autoHeight&&_6f7){html.marginBox(this.domNode,_6f7);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=this._parentContentBoxHeight||html._getContentBox(pn).h;this.domNode.style.height=Math.max(0,h)+"px";}}var _6fa=_6e3.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_6fa&&hh===undefined){hh=this._getHeaderHeight();}}if(_6fa){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _6fb=(!this.initialWidth&&this.autoWidth);var w=_6fb?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_6fb){this.domNode.style.width=vw+"px";}},adaptHeight:function(_6fc){var t=_6fc===undefined?this._getHeaderHeight():_6fc;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _6fd=0,_6fe=0;var _6ff=_6e3.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_6fd++;}else{_6fe++;}return (!has);});if(_6fd>0&&_6fe>0){_6e3.forEach(_6ff,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_700,_701){this.views.renderRow(_700,_701,this._skipRowRenormalize);},rowRemoved:function(_702){this.views.rowRemoved(_702);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_703){_703=Number(_703);if(this.updating){this.invalidated[_703]=true;}else{this.views.updateRow(_703);this.scroller.rowHeightChanged(_703);}},updateRows:function(_704,_705){_704=Number(_704);_705=Number(_705);var i;if(this.updating){for(i=0;i<_705;i++){this.invalidated[i+_704]=true;}}else{for(i=0;i<_705;i++){this.views.updateRow(i+_704,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_704);}},updateRowCount:function(_706){if(this.updating){this.invalidated.rowCount=_706;}else{this.rowCount=_706;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_706);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_707){this.views.updateRowStyles(_707);},getRowNode:function(_708){if(this.focus.focusView&&!(this.focus.focusView instanceof _6dd)){return this.focus.focusView.rowNodes[_708];}else{for(var i=0,_709;(_709=this.views.views[i]);i++){if(!(_709 instanceof _6dd)){return _709.rowNodes[_708];}}}return null;},rowHeightChanged:function(_70a){this.views.renormalizeRow(_70a);this.scroller.rowHeightChanged(_70a);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_70b){if(!this.fastScroll){this.setScrollTop(_70b);return;}var _70c=Math.abs(this.lastScrollTop-_70b);this.lastScrollTop=_70b;if(_70c>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_70b;this.views.setScrollTop(_70b);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _70d=this;this._pendingScroll=window.setTimeout(function(){delete _70d._pendingScroll;_70d.finishScrollJob();},200);}else{this.setScrollTop(_70b);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_70e){this.scroller.scroll(this.views.setScrollTop(_70e));},scrollToRow:function(_70f){this.setScrollTop(this.scroller.findScrollTop(_70f)+1);},styleRowNode:function(_710,_711){if(_711){this.rows.styleRowNode(_710,_711);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_712){return this.layout.cells[_712];},setCellWidth:function(_713,_714){this.getCell(_713).unitWidth=_714;},getCellName:function(_715){return "Cell "+_715.index;},canSort:function(_716){},sort:function(){},getSortAsc:function(_717){_717=_717==undefined?this.sortInfo:_717;return Boolean(_717>0);},getSortIndex:function(_718){_718=_718==undefined?this.sortInfo:_718;return Math.abs(_718)-1;},setSortIndex:function(_719,_71a){var si=_719+1;if(_71a!=undefined){si*=(_71a?1:-1);}else{if(this.getSortIndex()==_719){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_71b){if(this.canSort(_71b)){this.sortInfo=_71b;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_71c,_71d){this.onStartEdit(_71c,_71d);},doApplyCellEdit:function(_71e,_71f,_720){this.onApplyCellEdit(_71e,_71f,_720);},doCancelEdit:function(_721){this.onCancelEdit(_721);},doApplyEdit:function(_722){this.onApplyEdit(_722);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_6e6.markupFactory=function(_723,node,ctor,_724){var _725=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_723.structure&&node.nodeName.toLowerCase()=="table"){_723.structure=_6e5("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_725(cg);}return v;});if(!_723.structure.length){_723.structure.push({__span:Infinity,cells:[]});}_6e5("thead > tr",node).forEach(function(tr,_726){var _727=0;var _728=0;var _729;var _72a=null;_6e5("> th",tr).map(function(th){if(!_72a){_729=0;_72a=_723.structure[0];}else{if(_727>=(_729+_72a.__span)){_728++;_729+=_72a.__span;var _72b=_72a;_72a=_723.structure[_728];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_727+=cell.colSpan;var _72c=html.attr(th,"rowspan");if(_72c){cell.rowSpan=_72c;}if(html.hasAttr(th,"width")){cell.width=_725(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_724){_724(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_6d2.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_72a.cells[_726]){_72a.cells[_726]=[];}_72a.cells[_726].push(cell);});});}return new ctor(_723,node);};return _6e6;});},"dijit/Editor":function(){define("dijit/Editor",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/string","dojo/topic","dojo/_base/window","./_base/focus","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText","./main","dojo/i18n!./_editor/nls/commands"],function(_72d,_72e,_72f,i18n,_730,_731,_732,_733,_734,keys,lang,has,_735,_736,win,_737,_738,_739,_73a,_73b,_73c,_73d,_73e,html,_73f,_740,_741){var _742=_72e("dijit.Editor",_740,{plugins:null,extraPlugins:null,constructor:function(){if(!lang.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_73e];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(has("ie")){this.events.push("onBeforeDeactivate");this.events.push("onBeforeActivate");}},postMixInProperties:function(){this.setValueDeferred=new _72f();this.inherited(arguments);},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(lang.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new _739({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang});this.header.appendChild(this.toolbar.domNode);}_72d.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(true);_731.add(this.iframe.parentNode,"dijitEditorIFrameContainer");_731.add(this.iframe,"dijitEditorIFrame");_730.set(this.iframe,"allowTransparency",true);if(has("webkit")){_733.set(this.domNode,"KhtmlUserSelect","none");}this.toolbar.startup();this.onNormalizedDisplayChanged();},destroy:function(){_72d.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_743,_744){var args=lang.isString(_743)?{name:_743}:lang.isFunction(_743)?{ctor:_743}:_743;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};if(args.name){if(_73d.registry[args.name]){o.plugin=_73d.registry[args.name](args);}else{_736.publish(_741._scopeName+".Editor.getPlugin",o);}}if(!o.plugin){try{var pc=args.ctor||lang.getObject(args.name)||require(args.name);if(pc){o.plugin=new pc(args);}}catch(e){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}}if(!o.plugin){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}_743=o.plugin;}if(arguments.length>1){this._plugins[_744]=_743;}else{this._plugins.push(_743);}_743.setEditor(this);if(lang.isFunction(_743.setToolbar)){_743.setToolbar(this.toolbar);}},resize:function(size){if(size){_73b.prototype.resize.apply(this,arguments);}},layout:function(){var _745=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_732.getPadBorderExtents(this.iframe.parentNode).h+_732.getMarginExtents(this.iframe.parentNode).h));this.editingArea.style.height=_745+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){var _746;var b=this.document.body;var _747=b.clientWidth;var _748=b.clientHeight;var _749=b.clientLeft;var _74a=b.offsetWidth;var _74b=b.offsetHeight;var _74c=b.offsetLeft;if(/^rtl$/i.test(b.dir||"")){if(_747<_74a&&e.x>_747&&e.x<_74a){_746=true;}}else{if(e.x<_749&&e.x>_74c){_746=true;}}if(!_746){if(_748<_74b&&e.y>_748&&e.y<_74b){_746=true;}}if(!_746){delete this._cursorToStart;delete this._savedSelection;if(e.target.tagName=="BODY"){this.defer("placeCursorAtEnd");}this.inherited(arguments);}},onBeforeActivate:function(){this._restoreSelection();},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}if(e.target.tagName!="BODY"){this._saveSelection();}},customUndo:true,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){this._editTimer.remove();}this._editTimer=this.defer("endEditing",this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}var r=this.inherited(arguments);if(this.customUndo){this._endEditing();}return r;}},_pasteImpl:function(){return this._clipboardCommand("paste");},_cutImpl:function(){return this._clipboardCommand("cut");},_copyImpl:function(){return this._clipboardCommand("copy");},_clipboardCommand:function(cmd){var r;try{r=this.document.execCommand(cmd,false,null);if(has("webkit")&&!r){throw {code:1011};}}catch(e){if(e.code==1011||(e.code==9&&has("opera"))){var sub=_735.substitute,_74d={cut:"X",copy:"C",paste:"V"};alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[has("mac")?"appleKey":"ctrlKey"],[_74d[cmd]])]));}r=false;}return r;},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited(arguments);}},_moveToBookmark:function(b){var _74e=b.mark;var mark=b.mark;var col=b.isCollapsed;var r,_74f,_750,sel;if(mark){if(has("ie")<9){if(lang.isArray(mark)){_74e=[];_72d.forEach(mark,function(n){_74e.push(_73f.getNode(n,this.editNode));},this);win.withGlobal(this.window,"moveToBookmark",_737,[{mark:_74e,isCollapsed:col}]);}else{if(mark.startContainer&&mark.endContainer){sel=_73f.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_73f.create(this.window);_74f=_73f.getNode(mark.startContainer,this.editNode);_750=_73f.getNode(mark.endContainer,this.editNode);if(_74f&&_750){r.setStart(_74f,mark.startOffset);r.setEnd(_750,mark.endOffset);sel.addRange(r);}}}}}else{sel=_73f.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_73f.create(this.window);_74f=_73f.getNode(mark.startContainer,this.editNode);_750=_73f.getNode(mark.endContainer,this.editNode);if(_74f&&_750){r.setStart(_74f,mark.startOffset);r.setEnd(_750,mark.endOffset);sel.addRange(r);}}}}},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._steps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();delete this._undoRedoActive;ret=true;}delete this._undoRedoActive;}return ret;},redo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();ret=true;}delete this._undoRedoActive;}return ret;},endEditing:function(_751){if(this._editTimer){this._editTimer=this._editTimer.remove();}if(this._inEditing){this._endEditing(_751);this._inEditing=false;}},_getBookmark:function(){var b=win.withGlobal(this.window,_737.getBookmark);var tmp=[];if(b&&b.mark){var mark=b.mark;if(has("ie")<9){var sel=_73f.getSelection(this.window);if(!lang.isArray(mark)){if(sel){var _752;if(sel.rangeCount){_752=sel.getRangeAt(0);}if(_752){b.mark=_752.cloneRange();}else{b.mark=win.withGlobal(this.window,_737.getBookmark);}}}else{_72d.forEach(b.mark,function(n){tmp.push(_73f.getIndex(n,this.editNode).o);},this);b.mark=tmp;}}try{if(b.mark&&b.mark.startContainer){tmp=_73f.getIndex(b.mark.startContainer,this.editNode).o;b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_73f.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};}}catch(e){b.mark=null;}}return b;},_beginEditing:function(){if(this._steps.length===0){this._steps.push({"text":html.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});}},_endEditing:function(){var v=html.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!has("ie")&&!this.iframe&&e.keyCode==keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){_734.stop(e);this.undo();return;}else{if(k==89||k==121){_734.stop(e);this.redo();return;}}}this.inherited(arguments);switch(k){case keys.ENTER:case keys.BACKSPACE:case keys.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");}else{this.beginEditing("paste");}this.defer("endEditing",1);break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<keys.F1||e.keyCode>keys.F15)){this.beginEditing();break;}case keys.ALT:this.endEditing();break;case keys.UP_ARROW:case keys.DOWN_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:case keys.HOME:case keys.END:case keys.PAGE_UP:case keys.PAGE_DOWN:this.endEditing(true);break;case keys.CTRL:case keys.SHIFT:case keys.TAB:break;}},_onBlur:function(){this.inherited(arguments);this.endEditing(true);},_saveSelection:function(){try{this._savedSelection=this._getBookmark();}catch(e){}},_restoreSelection:function(){if(this._savedSelection){delete this._cursorToStart;if(win.withGlobal(this.window,"isCollapsed",_737)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},onClick:function(){this.endEditing(true);this.inherited(arguments);},replaceValue:function(html){if(!this.customUndo){this.inherited(arguments);}else{if(this.isClosed){this.setValue(html);}else{this.beginEditing();if(!html){html="&#160;";}this.setValue(html);this.endEditing();}}},_setDisabledAttr:function(_753){this.setValueDeferred.then(lang.hitch(this,function(){if((!this.disabled&&_753)||(!this._buttonEnabledPlugins&&_753)){_72d.forEach(this._plugins,function(p){p.set("disabled",true);});}else{if(this.disabled&&!_753){_72d.forEach(this._plugins,function(p){p.set("disabled",false);});}}}));this.inherited(arguments);},_setStateClass:function(){try{this.inherited(arguments);if(this.document&&this.document.body){_733.set(this.document.body,"color",_733.get(this.iframe,"color"));}}catch(e){}}});function _754(args){return new _73d({command:args.name});};function _755(args){return new _73d({buttonClass:_73c,command:args.name});};lang.mixin(_73d.registry,{"undo":_754,"redo":_754,"cut":_754,"copy":_754,"paste":_754,"insertOrderedList":_754,"insertUnorderedList":_754,"indent":_754,"outdent":_754,"justifyCenter":_754,"justifyFull":_754,"justifyLeft":_754,"justifyRight":_754,"delete":_754,"selectAll":_754,"removeFormat":_754,"unlink":_754,"insertHorizontalRule":_754,"bold":_755,"italic":_755,"underline":_755,"strikethrough":_755,"subscript":_755,"superscript":_755,"|":function(){return new _73d({setEditor:function(_756){this.editor=_756;this.button=new _73a({ownerDocument:_756.ownerDocument});}});}});return _742;});},"dojo/request/iframe":function(){define(["module","require","./watch","./util","./handlers","../_base/lang","../io-query","../query","../has","../dom","../dom-construct","../_base/window"],function(_757,_758,_759,util,_75a,lang,_75b,_75c,has,dom,_75d,win){var mid=_757.id.replace(/[\/\.\-]/g,"_"),_75e=mid+"_onload";if(!win.global[_75e]){win.global[_75e]=function(){var dfd=_75f._currentDfd;if(!dfd){_75f._fireNextRequest();return;}var _760=dfd.response,_761=_760.options,_762=dom.byId(_761.form)||dfd._tmpForm;if(_762){var _763=dfd._contentToClean;for(var i=0;i<_763.length;i++){var key=_763[i];for(var j=0;j<_762.childNodes.length;j++){var _764=_762.childNodes[j];if(_764.name===key){_75d.destroy(_764);break;}}}dfd._originalAction&&_762.setAttribute("action",dfd._originalAction);if(dfd._originalMethod){_762.setAttribute("method",dfd._originalMethod);_762.method=dfd._originalMethod;}if(dfd._originalTarget){_762.setAttribute("target",dfd._originalTarget);_762.target=dfd._originalTarget;}}if(dfd._tmpForm){_75d.destroy(dfd._tmpForm);delete dfd._tmpForm;}dfd._finished=true;};}function _765(name,_766,uri){if(win.global[name]){return win.global[name];}if(win.global.frames[name]){return win.global.frames[name];}if(!uri){if(has("config-useXDomain")&&!has("config-dojoBlankHtmlUrl")){console.warn("dojo/request/iframe: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}uri=(has("config-dojoBlankHtmlUrl")||_758.toUrl("dojo/resources/blank.html"));}var _767=_75d.place("<iframe id=\""+name+"\" name=\""+name+"\" src=\""+uri+"\" onload=\""+_766+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",win.body());win.global[name]=_767;return _767;};function _768(_769,src,_76a){var _76b=win.global.frames[_769.name];if(_76b.contentWindow){_76b=_76b.contentWindow;}try{if(!_76a){_76b.location=src;}else{_76b.location.replace(src);}}catch(e){console.log("dojo/request/iframe.setSrc: ",e);}};function doc(_76c){if(_76c.contentDocument){return _76c.contentDocument;}var name=_76c.name;if(name){var _76d=win.doc.getElementsByTagName("iframe");if(_76c.document&&_76d[name].contentWindow&&_76d[name].contentWindow.document){return _76d[name].contentWindow.document;}else{if(win.doc.frames[name]&&win.doc.frames[name].document){return win.doc.frames[name].document;}}}return null;};function _76e(){return _75d.create("form",{name:mid+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},win.body());};function _76f(){var dfd;try{if(_75f._currentDfd||!_75f._dfdQueue.length){return;}do{dfd=_75f._currentDfd=_75f._dfdQueue.shift();}while(dfd&&(dfd.canceled||(dfd.isCanceled&&dfd.isCanceled()))&&_75f._dfdQueue.length);if(!dfd||dfd.canceled||(dfd.isCanceled&&dfd.isCanceled())){_75f._currentDfd=null;return;}var _770=dfd.response,_771=_770.options,c2c=dfd._contentToClean=[],_772=dom.byId(_771.form),_773=util.notify,data=_771.data||null,_774;if(!dfd._legacy&&_771.method==="POST"&&!_772){_772=dfd._tmpForm=_76e();}else{if(_771.method==="GET"&&_772&&_770.url.indexOf("?")>-1){_774=_770.url.slice(_770.url.indexOf("?")+1);data=lang.mixin(_75b.queryToObject(_774),data);}}if(_772){if(!dfd._legacy){var _775=_772;while(_775=_775.parentNode&&_775!==win.doc.documentElement){}if(!_775){_772.style.position="absolute";_772.style.left="-1000px";_772.style.top="-1000px";win.body().appendChild(_772);}if(!_772.name){_772.name=mid+"_form";}}if(data){var _776=function(name,_777){_75d.create("input",{type:"hidden",name:name,value:_777},_772);c2c.push(name);};for(var x in data){var val=data[x];if(lang.isArray(val)&&val.length>1){for(var i=0;i<val.length;i++){_776(x,val[i]);}}else{if(!_772[x]){_776(x,val);}else{_772[x].value=val;}}}}var _778=_772.getAttributeNode("action"),_779=_772.getAttributeNode("method"),_77a=_772.getAttributeNode("target");if(_770.url){dfd._originalAction=_778?_778.value:null;if(_778){_778.value=_770.url;}else{_772.setAttribute("action",_770.url);}}if(!dfd._legacy){dfd._originalMethod=_779?_779.value:null;if(_779){_779.value=_771.method;}else{_772.setAttribute("method",_771.method);}}else{if(!_779||!_779.value){if(mthdNode){mthdNode.value=_771.method;}else{fn.setAttribute("method",_771.method);}}}dfd._originalTarget=_77a?_77a.value:null;if(_77a){_77a.value=_75f._iframeName;}else{_772.setAttribute("target",_75f._iframeName);}_772.target=_75f._iframeName;_773&&_773.emit("send",_770,dfd.promise.cancel);_75f._notifyStart(_770);_772.submit();}else{var _77b="";if(_770.options.data){_77b=_770.options.data;if(typeof _77b!=="string"){_77b=_75b.objectToQuery(_77b);}}var _77c=_770.url+(_770.url.indexOf("?")>-1?"&":"?")+_77b;_773&&_773.emit("send",_770,dfd.promise.cancel);_75f._notifyStart(_770);_75f.setSrc(_75f._frame,_77c,true);}}catch(e){dfd.reject(e);}};function _77d(_77e){return !this.isFulfilled();};function _77f(_780){return !!this._finished;};function _781(_782,_783){if(!_783){try{var _784=_782.options,doc=_75f.doc(_75f._frame),_785=_784.handleAs;if(_785!=="html"){if(_785==="xml"){if(doc.documentElement.tagName.toLowerCase()==="html"){_75c("a",doc.documentElement).orphan();var _786=doc.documentElement.innerText;_786=_786.replace(/>\s+</g,"><");_782.text=lang.trim(_786);}else{_782.data=doc;}}else{_782.text=doc.getElementsByTagName("textarea")[0].value;}_75a(_782);}else{_782.data=doc;}}catch(e){_783=e;}}if(_783){this.reject(_783);}else{if(this._finished){this.resolve(_782);}else{this.reject(new Error("Invalid dojo/request/iframe request state"));}}};function last(_787){this._callNext();};var _788={method:"POST"};function _75f(url,_789,_78a){var _78b=util.parseArgs(url,util.deepCreate(_788,_789),true);url=_78b.url;_789=_78b.options;if(_789.method!=="GET"&&_789.method!=="POST"){throw new Error(_789.method+" not supported by dojo/request/iframe");}if(!_75f._frame){_75f._frame=_75f.create(_75f._iframeName,_75e+"();");}var dfd=util.deferred(_78b,null,_77d,_77f,_781,last);dfd._callNext=function(){if(!this._calledNext){this._calledNext=true;_75f._currentDfd=null;_75f._fireNextRequest();}};dfd._legacy=_78a;_75f._dfdQueue.push(dfd);_75f._fireNextRequest();_759(dfd);return _78a?dfd:dfd.promise;};_75f.create=_765;_75f.doc=doc;_75f.setSrc=_768;_75f._iframeName=mid+"_IoIframe";_75f._notifyStart=function(){};_75f._dfdQueue=[];_75f._currentDfd=null;_75f._fireNextRequest=_76f;util.addCommonMethods(_75f,["GET","POST"]);return _75f;});},"dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_78c,_78d,has,keys,_78e,_78f,_790,_791){if(has("dijit-legacy-requires")){_78e(0,function(){var _792=["dijit/ToolbarSeparator"];_78c(_792);});}return _78d("dijit.Toolbar",[_78f,_791,_790],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_793,_794,keys,_795,_796,_797){return _793("dijit.DropDownMenu",[_797,_796],{templateString:_795,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_794.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_794.stop(evt);}break;}}});});},"dijit/_editor/plugins/LinkDialog":function(){define("dijit/_editor/plugins/LinkDialog",["require","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/query","dojo/string","../../_Widget","../_Plugin","../../form/DropDownButton","../range"],function(_798,_799,_79a,keys,lang,has,_79b,_79c,_79d,_79e,_79f,_7a0){var _7a1=_799("dijit._editor.plugins.LinkDialog",_79e,{buttonClass:_79f,useDefaultCommand:false,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",emailRegExp:"<?(mailto\\:)([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+"+"@"+"((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*>?",htmlTemplate:"<a href=\"${urlInput}\" _djrealurl=\"${urlInput}\""+" target=\"${targetSelect}\""+">${textInput}</a>",tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' "+"id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_targetSelect'>${target}</label>","</td><td>","<select id='${id}_targetSelect' name='targetSelect' data-dojo-type='dijit.form.Select'>","<option selected='selected' value='_self'>${currentWindow}</option>","<option value='_blank'>${newWindow}</option>","<option value='_top'>${topWindow}</option>","<option value='_parent'>${parentWindow}</option>","</select>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),_initButton:function(){this.inherited(arguments);this.button.loadDropDown=lang.hitch(this,"_loadDropDown");this._connectTagEvents();},_loadDropDown:function(_7a2){_798(["dojo/i18n","../../TooltipDialog","../../registry","../../form/Button","../../form/Select","../../form/ValidationTextBox","dojo/i18n!../../nls/common","dojo/i18n!../nls/LinkDialog"],lang.hitch(this,function(i18n,_7a3,_7a4){var _7a5=this;this.tag=this.command=="insertImage"?"img":"a";var _7a6=lang.delegate(i18n.getLocalization("dijit","common",this.lang),i18n.getLocalization("dijit._editor","LinkDialog",this.lang));var _7a7=(this.dropDown=this.button.dropDown=new _7a3({title:_7a6[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:lang.hitch(this,"setValue"),onOpen:function(){_7a5._onOpenDialog();_7a3.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(lang.hitch(_7a5,"_onCloseDialog"),0);}}));_7a6.urlRegExp=this.urlRegExp;_7a6.id=_7a4.getUniqueId(this.editor.id);this._uniqueId=_7a6.id;this._setContent(_7a7.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_79c.substitute(this.linkDialogTemplate,_7a6));_7a7.startup();this._urlInput=_7a4.byId(this._uniqueId+"_urlInput");this._textInput=_7a4.byId(this._uniqueId+"_textInput");this._setButton=_7a4.byId(this._uniqueId+"_setButton");this.connect(_7a4.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel();});if(this._urlInput){this.connect(this._urlInput,"onChange","_checkAndFixInput");}if(this._textInput){this.connect(this._textInput,"onChange","_checkAndFixInput");}this._urlRegExp=new RegExp("^"+this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=lang.hitch(this,function(){var _7a8=this._urlInput.get("value");return this._urlRegExp.test(_7a8)||this._emailRegExp.test(_7a8);});this.connect(_7a7.domNode,"onkeypress",function(e){if(e&&e.charOrCode==keys.ENTER&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){if(!this._setButton.get("disabled")){_7a7.onExecute();_7a7.execute(_7a7.get("value"));}}});_7a2();}));},_checkAndFixInput:function(){var self=this;var url=this._urlInput.get("value");var _7a9=function(url){var _7aa=false;var _7ab=false;if(url&&url.length>1){url=lang.trim(url);if(url.indexOf("mailto:")!==0){if(url.indexOf("/")>0){if(url.indexOf("://")===-1){if(url.charAt(0)!=="/"&&url.indexOf("./")&&url.indexOf("../")!==0){if(self._hostRxp.test(url)){_7aa=true;}}}}else{if(self._userAtRxp.test(url)){_7ab=true;}}}}if(_7aa){self._urlInput.set("value","http://"+url);}if(_7ab){self._urlInput.set("value","mailto:"+url);}self._setButton.set("disabled",!self._isValid());};if(this._delayedCheck){clearTimeout(this._delayedCheck);this._delayedCheck=null;}this._delayedCheck=setTimeout(function(){_7a9(url);},250);},_connectTagEvents:function(){this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);}));},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid();},_setContent:function(_7ac){this.dropDown.set({parserScope:"dojo",content:_7ac});},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}return args;},setValue:function(args){this._onCloseDialog();if(has("ie")<9){var sel=_7a0.getSelection(this.editor.window);var _7ad=sel.getRangeAt(0);var a=_7ad.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(a&&(a.nodeName&&a.nodeName.toLowerCase()===this.tag)){if(this.editor.queryCommandEnabled("unlink")){this.editor._sCall("selectElementChildren",[a]);this.editor.execCommand("unlink");}}}args=this._checkValues(args);this.editor.execCommand("inserthtml",_79c.substitute(this.htmlTemplate,args));_79b("a",this.editor.document).forEach(function(a){if(!a.innerHTML&&!_79a.has(a,"name")){a.parentNode.removeChild(a);}},this);},_onCloseDialog:function(){this.editor.focus();},_getCurrentValues:function(a){var url,text,_7ae;if(a&&a.tagName.toLowerCase()===this.tag){url=a.getAttribute("_djrealurl")||a.getAttribute("href");_7ae=a.getAttribute("target")||"_self";text=a.textContent||a.innerText;this.editor._sCall("selectElement",[a,true]);}else{text=this.editor._sCall("getSelectedText");}return {urlInput:url||"",textInput:text||"",targetSelect:_7ae||""};},_onOpenDialog:function(){var a,b,fc;if(has("ie")){var sel=_7a0.getSelection(this.editor.window);var _7af=sel.getRangeAt(0);a=_7af.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(!a||(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){b=this.editor._sCall("getAncestorElement",[this.tag]);if(b&&(b.nodeName&&b.nodeName.toLowerCase()==this.tag)){a=b;this.editor._sCall("selectElement",[a]);}else{if(_7af.startContainer===_7af.endContainer){fc=_7af.startContainer.firstChild;if(fc&&(fc.nodeName&&fc.nodeName.toLowerCase()==this.tag)){a=fc;this.editor._sCall("selectElement",[a]);}}}}}else{a=this.editor._sCall("getAncestorElement",[this.tag]);}this.dropDown.reset();this._setButton.set("disabled",true);this.dropDown.set("value",this._getCurrentValues(a));},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_79a.get(t,"href")){var _7b0=this.editor;this.editor._sCall("selectElement",[t]);_7b0.onDisplayChanged();if(_7b0._updateTimer){_7b0._updateTimer.remove();delete _7b0._updateTimer;}_7b0.onNormalizedDisplayChanged();var _7b1=this.button;setTimeout(function(){_7b1.set("disabled",false);_7b1.loadAndOpenDropDown().then(function(){if(_7b1.dropDown.focus){_7b1.dropDown.focus();}});},10);}}}});var _7b2=_799("dijit._editor.plugins.ImgLinkDialog",[_7a1],{linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' "+"required='true' id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='false' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","</td><td>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),htmlTemplate:"<img src=\"${urlInput}\" _djrealurl=\"${urlInput}\" alt=\"${textInput}\" />",tag:"img",_getCurrentValues:function(img){var url,text;if(img&&img.tagName.toLowerCase()===this.tag){url=img.getAttribute("_djrealurl")||img.getAttribute("src");text=img.getAttribute("alt");this.editor._sCall("selectElement",[img,true]);}else{text=this.editor._sCall("getSelectedText",[]);}return {urlInput:url||"",textInput:text||""};},_isValid:function(){return this._urlInput.isValid();},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"onmousedown",this._selectTag);}));},_selectTag:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag){this.editor._sCall("selectElement",[t]);}}},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}if(args&&args.textInput){args.textInput=args.textInput.replace(/"/g,"&quot;");}return args;},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_79a.get(t,"src")){var _7b3=this.editor;this.editor._sCall("selectElement",[t]);_7b3.onDisplayChanged();if(_7b3._updateTimer){_7b3._updateTimer.remove();delete _7b3._updateTimer;}_7b3.onNormalizedDisplayChanged();var _7b4=this.button;setTimeout(function(){_7b4.set("disabled",false);_7b4.loadAndOpenDropDown().then(function(){if(_7b4.dropDown.focus){_7b4.dropDown.focus();}});},10);}}}});_79e.registry["createLink"]=function(){return new _7a1({command:"createLink"});};_79e.registry["insertImage"]=function(){return new _7b2({command:"insertImage"});};_7a1.ImgLinkDialog=_7b2;return _7a1;});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_7b5,_7b6){var _7b7={};lang.setObject("dojo.data.util.simpleFetch",_7b7);_7b7.errorHandler=function(_7b8,_7b9){if(_7b9.onError){var _7ba=_7b9.scope||_7b5.global;_7b9.onError.call(_7ba,_7b8,_7b9);}};_7b7.fetchHandler=function(_7bb,_7bc){var _7bd=_7bc.abort||null,_7be=false,_7bf=_7bc.start?_7bc.start:0,_7c0=(_7bc.count&&(_7bc.count!==Infinity))?(_7bf+_7bc.count):_7bb.length;_7bc.abort=function(){_7be=true;if(_7bd){_7bd.call(_7bc);}};var _7c1=_7bc.scope||_7b5.global;if(!_7bc.store){_7bc.store=this;}if(_7bc.onBegin){_7bc.onBegin.call(_7c1,_7bb.length,_7bc);}if(_7bc.sort){_7bb.sort(_7b6.createSortFunction(_7bc.sort,this));}if(_7bc.onItem){for(var i=_7bf;(i<_7bb.length)&&(i<_7c0);++i){var item=_7bb[i];if(!_7be){_7bc.onItem.call(_7c1,item,_7bc);}}}if(_7bc.onComplete&&!_7be){var _7c2=null;if(!_7bc.onItem){_7c2=_7bb.slice(_7bf,_7c0);}_7bc.onComplete.call(_7c1,_7c2,_7bc);}};_7b7.fetch=function(_7c3){_7c3=_7c3||{};if(!_7c3.store){_7c3.store=this;}this._fetchItems(_7c3,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _7c3;};return _7b7;});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_7c4,_7c5,_7c6,_7c7,dom,_7c8,_7c9,_7ca,keys,lang,on,has,win,_7cb,pm,_7cc,_7cd){if(has("dijit-legacy-requires")){_7cd(0,function(){var _7ce=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_7c4(_7ce);});}return _7c6("dijit.Menu",_7cc,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_7c5.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_7cf){return _7cb.get(this._iframeContentDocument(_7cf))||this._iframeContentDocument(_7cf)["__parent__"]||(_7cf.name&&win.doc.frames[_7cf.name])||null;},_iframeContentDocument:function(_7d0){return _7d0.contentDocument||(_7d0.contentWindow&&_7d0.contentWindow.document)||(_7d0.name&&win.doc.frames[_7d0.name]&&win.doc.frames[_7d0.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _7d1=node,_7d2=this._iframeContentWindow(_7d1);cn=win.body(_7d2.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _7d3={node:node,iframe:_7d1};_7c8.set(node,"_dijitMenu"+this.id,this._bindings.push(_7d3));var _7d4=lang.hitch(this,function(cn){var _7d5=this.selector,_7d6=_7d5?function(_7d7){return on.selector(_7d5,_7d7);}:function(_7d8){return _7d8;},self=this;return [on(cn,_7d6(this.leftClickToOpen?"click":"contextmenu"),function(evt){_7c7.stop(evt);self._scheduleOpen(this,_7d1,{x:evt.pageX,y:evt.pageY});}),on(cn,_7d6("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_7c7.stop(evt);self._scheduleOpen(this,_7d1);}})];});_7d3.connects=cn?_7d4(cn):[];if(_7d1){_7d3.onloadHandler=lang.hitch(this,function(){var _7d9=this._iframeContentWindow(_7d1);cn=win.body(_7d9.document);_7d3.connects=_7d4(cn);});if(_7d1.addEventListener){_7d1.addEventListener("load",_7d3.onloadHandler,false);}else{_7d1.attachEvent("onload",_7d3.onloadHandler);}}},unBindDomNode:function(_7da){var node;try{node=dom.byId(_7da,this.ownerDocument);}catch(e){return;}var _7db="_dijitMenu"+this.id;if(node&&_7c8.has(node,_7db)){var bid=_7c8.get(node,_7db)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _7dc=b.iframe;if(_7dc){if(_7dc.removeEventListener){_7dc.removeEventListener("load",b.onloadHandler,false);}else{_7dc.detachEvent("onload",b.onloadHandler);}}_7c8.remove(node,_7db);delete this._bindings[bid];}},_scheduleOpen:function(_7dd,_7de,_7df){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_7dd,iframe:_7de,coords:_7df});},1);}},_openMyself:function(args){var _7e0=args.target,_7e1=args.iframe,_7e2=args.coords;this.currentTarget=_7e0;if(_7e2){if(_7e1){var ifc=_7c9.position(_7e1,true),_7e3=this._iframeContentWindow(_7e1),_7e4=_7c9.docScroll(_7e3.document);var cs=_7ca.getComputedStyle(_7e1),tp=_7ca.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_7e1,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_7e1,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_7e1,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_7e1,cs.borderTopWidth):0);_7e2.x+=ifc.x+left-_7e4.x;_7e2.y+=ifc.y+top-_7e4.y;}}else{_7e2=_7c9.position(_7e0,true);_7e2.x+=10;_7e2.y+=10;}var self=this;var _7e5=this._focusManager.get("prevNode");var _7e6=this._focusManager.get("curNode");var _7e7=!_7e6||(dom.isDescendant(_7e6,this.domNode))?_7e5:_7e6;function _7e8(){if(self.refocus&&_7e7){_7e7.focus();}pm.close(self);};pm.open({popup:this,x:_7e2.x,y:_7e2.y,onExecute:_7e8,onCancel:_7e8,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_7c5.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_7e9,_7ea,_7eb,_7ec,keys,_7ed,_7ee,_7ef,lang){return _7ed("dijit._KeyNavContainer",[_7eb,_7ea],{tabIndex:"0",connectKeyNavHandlers:function(_7f0,_7f1){var _7f2=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_7ec.forEach(_7f0,function(code){_7f2[code]=prev;});_7ec.forEach(_7f1,function(code){_7f2[code]=next;});_7f2[keys.HOME]=lang.hitch(this,"focusFirstChild");_7f2[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_7e9.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_7ec.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_7f3,_7f4){this.inherited(arguments);this._startupChild(_7f3);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_7f5,last){if(!_7f5){return;}if(this.focusedChild&&_7f5!==this.focusedChild){this._onChildBlur(this.focusedChild);}_7f5.set("tabIndex",this.tabIndex);_7f5.focus(last?"end":"start");this._set("focusedChild",_7f5);},_startupChild:function(_7f6){_7f6.set("tabIndex","-1");this.connect(_7f6,"_onFocus",function(){_7f6.set("tabIndex",this.tabIndex);});this.connect(_7f6,"_onBlur",function(){_7f6.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_7ef.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_7ef.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_7ee.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_7f7,dir){if(_7f7){_7f7=this._getSiblingOfChild(_7f7,dir);}var _7f8=this.getChildren();for(var i=0;i<_7f8.length;i++){if(!_7f7){_7f7=_7f8[(dir>0)?0:(_7f8.length-1)];}if(_7f7.isFocusable()){return _7f7;}_7f7=this._getSiblingOfChild(_7f7,dir);}return null;}});});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_7f9,_7fa){return _7f9("dijit._Contained",null,{_getSibling:function(_7fb){var node=this.domNode;do{node=node[_7fb+"Sibling"];}while(node&&node.nodeType!=1);return node&&_7fa.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"dojox/gfx/move":function(){define("dojox/gfx/move",["dojo/_base/lang","./Mover","./Moveable"],function(lang){return lang.getObject("dojox.gfx.move",true);});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_7fc,dom,lang,_7fd,_7fe,_7ff){function _800(_801){return {id:_801.value,value:_801.value,name:lang.trim(_801.innerText||_801.textContent||"")};};return _7fc("dijit.form.DataList",_7fe,{constructor:function(_802,_803){this.domNode=dom.byId(_803);lang.mixin(this,_802);if(this.id){_7ff.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_7fd("option",this.domNode).map(_800)}]);},destroy:function(){_7ff.remove(this.id);},fetchSelectedItem:function(){var _804=_7fd("> option[selected]",this.domNode)[0]||_7fd("> option",this.domNode)[0];return _804&&_800(_804);}});});},"dijit/_editor/_Plugin":function(){define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../form/Button"],function(_805,_806,lang,_807){var _808=_806("dijit._editor._Plugin",null,{constructor:function(args){this.params=args||{};lang.mixin(this,this.params);this._connects=[];this._attrPairNames={};},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_807,disabled:false,getLabel:function(key){return this.editor.commands[key];},_initButton:function(){if(this.command.length){var _809=this.getLabel(this.command),_80a=this.editor,_80b=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){var _80c=lang.mixin({label:_809,ownerDocument:_80a.ownerDocument,dir:_80a.dir,lang:_80a.lang,showLabel:false,iconClass:_80b,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});this.button=new this.buttonClass(_80c);}}if(this.get("disabled")&&this.button){this.button.set("disabled",this.get("disabled"));}},destroy:function(){var h;while(h=this._connects.pop()){h.remove();}if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(_805.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_80d,_80e;if(!e||!e.isLoaded||!c.length){return;}var _80f=this.get("disabled");if(this.button){try{_80e=!_80f&&e.queryCommandEnabled(c);if(this.enabled!==_80e){this.enabled=_80e;this.button.set("disabled",!_80e);}if(_80e){if(typeof this.button.checked=="boolean"){_80d=e.queryCommandState(c);if(this.checked!==_80d){this.checked=_80d;this.button.set("checked",e.queryCommandState(c));}}}}catch(e){console.log(e);}}},setEditor:function(_810){this.editor=_810;this._initButton();if(this.button&&this.useDefaultCommand){if(this.editor.queryCommandAvailable(this.command)){this.connect(this.button,"onClick",lang.hitch(this.editor,"execCommand",this.command,this.commandArg));}else{this.button.domNode.style.display="none";}}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_811){if(this.button){_811.addChild(this.button);}},set:function(name,_812){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _813=this._getAttrNames(name);if(this[_813.s]){var _814=this[_813.s].apply(this,Array.prototype.slice.call(arguments,1));}else{this._set(name,_812);}return _814||this;},get:function(name){var _815=this._getAttrNames(name);return this[_815.g]?this[_815.g]():this[name];},_setDisabledAttr:function(_816){this.disabled=_816;this.updateState();},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_817){this[name]=_817;}});_808.registry={};return _808;});},"esri/dijit/editing/tools/EditingTools":function(){define("esri/dijit/editing/tools/EditingTools",["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/MenuItemBase"],function(_818,dojo,_819){dojo.require("esri.dijit.editing.tools.MenuItemBase");dojo.provide("esri.dijit.editing.tools.EditingTools");dojo.declare("esri.dijit.editing.tools.Edit",[esri.dijit.editing.tools.MenuItemBase],{enable:function(_81a){this._enabled=_81a===this._geomType;this.inherited(arguments);}});esri.dijit.editing.tools.EditingTools={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:esri.toolbars.Draw.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:esri.toolbars.Draw.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:esri.toolbars.Draw.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:esri.toolbars.Draw.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:esri.toolbars.Draw.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:esri.toolbars.Draw.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:esri.toolbars.Draw.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:esri.toolbars.Draw.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:esri.toolbars.Draw.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:esri.toolbars.Draw.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:esri.toolbars.Draw.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:esri.toolbars.Draw.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:esri.toolbars.Draw.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:esri.toolbars.Draw.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:esri.toolbars.Draw.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:false,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:false,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:false,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:false,_label:"NLS_redoLbl"}};});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_81b,lang,_81c,_81d,xhr,_81e,_81f,_820,_821){var _822=_81c("dojo.data.ItemFileReadStore",[_81e],{constructor:function(_823){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_823.url;this._ccUrl=_823.url;this.url=_823.url;this._jsonData=_823.data;this.data=null;this._datatypeMap=_823.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_824){return _821.fromISOString(_824);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_823.urlPreventCache!==undefined){this.urlPreventCache=_823.urlPreventCache?true:false;}if(_823.hierarchical!==undefined){this.hierarchical=_823.hierarchical?true:false;}if(_823.clearOnClose){this.clearOnClose=true;}if("failOk" in _823){this.failOk=_823.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_825){if(typeof _825!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_826,_827){var _828=this.getValues(item,_826);return (_828.length>0)?_828[0]:_827;},getValues:function(item,_829){this._assertIsItem(item);this._assertIsAttribute(_829);return (item[_829]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _82a=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_82a.push(key);}}return _82a;},hasAttribute:function(item,_82b){this._assertIsItem(item);this._assertIsAttribute(_82b);return (_82b in item);},containsValue:function(item,_82c,_82d){var _82e=undefined;if(typeof _82d==="string"){_82e=_81f.patternToRegExp(_82d,false);}return this._containsValue(item,_82c,_82d,_82e);},_containsValue:function(item,_82f,_830,_831){return _81d.some(this.getValues(item,_82f),function(_832){if(_832!==null&&!lang.isObject(_832)&&_831){if(_832.toString().match(_831)){return true;}}else{if(_830===_832){return true;}}});},isItem:function(_833){if(_833&&_833[this._storeRefPropName]===this){if(this._arrayOfAllItems[_833[this._itemNumPropName]]===_833){return true;}}return false;},isItemLoaded:function(_834){return this.isItem(_834);},loadItem:function(_835){this._assertIsItem(_835.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_836,_837,_838){var _839=[],i,key;if(_836.query){var _83a,_83b=_836.queryOptions?_836.queryOptions.ignoreCase:false;var _83c={};for(key in _836.query){_83a=_836.query[key];if(typeof _83a==="string"){_83c[key]=_81f.patternToRegExp(_83a,_83b);}else{if(_83a instanceof RegExp){_83c[key]=_83a;}}}for(i=0;i<_837.length;++i){var _83d=true;var _83e=_837[i];if(_83e===null){_83d=false;}else{for(key in _836.query){_83a=_836.query[key];if(!this._containsValue(_83e,key,_83a,_83c[key])){_83d=false;}}}if(_83d){_839.push(_83e);}}_838(_839,_836);}else{for(i=0;i<_837.length;++i){var item=_837[i];if(item!==null){_839.push(item);}}_838(_839,_836);}},_fetchItems:function(_83f,_840,_841){var self=this;if(this._loadFinished){this.filter(_83f,this._getItemsArray(_83f.queryOptions),_840);}else{if(this._jsonFileUrl!==this._ccUrl){_81b.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_83f,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_840)});}else{this._loadInProgress=true;var _842={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _843=xhr.get(_842);_843.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_83f,self._getItemsArray(_83f.queryOptions),_840);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_841(e,_83f);}});_843.addErrback(function(_844){self._loadInProgress=false;_841(_844,_83f);});var _845=null;if(_83f.abort){_845=_83f.abort;}_83f.abort=function(){var df=_843;if(df&&df.fired===-1){df.cancel();df=null;}if(_845){_845.call(_83f);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_83f,this._getItemsArray(_83f.queryOptions),_840);}catch(e){_841(e,_83f);}}else{_841(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_83f);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _846=this._queuedFetches[i],_847=_846.args,_848=_846.filter,_849=_846.findCallback;if(_848){_848(_847,this._getItemsArray(_847.queryOptions),_849);}else{this.fetchItemByIdentity(_847);}}this._queuedFetches=[];}},_getItemsArray:function(_84a){if(_84a&&_84a.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_84b){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_84c){var _84d=false,self=this;function _84e(_84f){return (_84f!==null)&&(typeof _84f==="object")&&(!lang.isArray(_84f)||_84d)&&(!lang.isFunction(_84f))&&(_84f.constructor==Object||lang.isArray(_84f))&&(typeof _84f._reference==="undefined")&&(typeof _84f._type==="undefined")&&(typeof _84f._value==="undefined")&&self.hierarchical;};function _850(_851){self._arrayOfAllItems.push(_851);for(var _852 in _851){var _853=_851[_852];if(_853){if(lang.isArray(_853)){var _854=_853;for(var k=0;k<_854.length;++k){var _855=_854[k];if(_84e(_855)){_850(_855);}}}else{if(_84e(_853)){_850(_853);}}}}};this._labelAttr=_84c.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_84c.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_84d=true;}_850(item);item[this._rootItemPropName]=true;}var _856={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _857=item[key];if(_857!==null){if(!lang.isArray(_857)){item[key]=[_857];}}else{item[key]=[null];}}_856[key]=key;}}while(_856[this._storeRefPropName]){this._storeRefPropName+="_";}while(_856[this._itemNumPropName]){this._itemNumPropName+="_";}while(_856[this._reverseRefMap]){this._reverseRefMap+="_";}var _858;var _859=_84c.identifier;if(_859){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_859;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_858=item[_859];var _85a=_858[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_85a)){this._itemsByIdentity[_85a]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_859+"].  Value collided: ["+_85a+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_859+"].  Value collided: ["+_85a+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_858=item[key];for(var j=0;j<_858.length;++j){_857=_858[j];if(_857!==null&&typeof _857=="object"){if(("_type" in _857)&&("_value" in _857)){var type=_857._type;var _85b=this._datatypeMap[type];if(!_85b){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_85b)){_858[j]=new _85b(_857._value);}else{if(lang.isFunction(_85b.deserialize)){_858[j]=_85b.deserialize(_857._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_857._reference){var _85c=_857._reference;if(!lang.isObject(_85c)){_858[j]=this._getItemByIdentity(_85c);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _85d=this._arrayOfAllItems[k],_85e=true;for(var _85f in _85c){if(_85d[_85f]!=_85c[_85f]){_85e=false;}}if(_85e){_858[j]=_85d;}}}if(this.referenceIntegrity){var _860=_858[j];if(this.isItem(_860)){this._addReferenceToMap(_860,item,key);}}}else{if(this.isItem(_857)){if(this.referenceIntegrity){this._addReferenceToMap(_857,item,key);}}}}}}}},_addReferenceToMap:function(_861,_862,_863){},getIdentity:function(item){var _864=this._features["dojo.data.api.Identity"];if(_864===Number){return item[this._itemNumPropName];}else{var _865=item[_864];if(_865){return _865[0];}}return null;},fetchItemByIdentity:function(_866){var item,_867;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_81b.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_866});}else{this._loadInProgress=true;var _868={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _869=xhr.get(_868);_869.addCallback(function(data){var _86a=_866.scope?_866.scope:_81b.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_866.identity);if(_866.onItem){_866.onItem.call(_86a,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_866.onError){_866.onError.call(_86a,error);}}});_869.addErrback(function(_86b){self._loadInProgress=false;if(_866.onError){var _86c=_866.scope?_866.scope:_81b.global;_866.onError.call(_86c,_86b);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_866.identity);if(_866.onItem){_867=_866.scope?_866.scope:_81b.global;_866.onItem.call(_867,item);}}}}else{item=this._getItemByIdentity(_866.identity);if(_866.onItem){_867=_866.scope?_866.scope:_81b.global;_866.onItem.call(_867,item);}}},_getItemByIdentity:function(_86d){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_86d)){item=this._itemsByIdentity[_86d];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_86d)){item=this._arrayOfAllItems[_86d];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _86e=this._features["dojo.data.api.Identity"];if(_86e===Number){return null;}else{return [_86e];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_81b.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _86f={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _870=xhr.get(_86f);_870.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_870.addErrback(function(_871){throw _871;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_822,_820);return _822;});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_872,_873,_874,_875,lang,_876,_877,_878,_879,_87a,dnd,_87b,_87c){if(!_875.isAsync){_879(0,function(){var _87d=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_87d);});}var _87e=_874("dojo.dnd.Source",_87b,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_87f){lang.mixin(this,lang.mixin({},_87f));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_876.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_876.add(this.node,"dojoDndTarget");}if(this.horizontal){_876.add(this.node,"dojoDndHorizontal");}this.topics=[_87a.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_87a.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_87a.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_87a.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_880,_881){if(this==_880){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_881.length;++i){var type=_880.getItem(_881[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_882,self){if(_882){return true;}if(arguments.length<2){self=this==_87c.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_87e.superclass.destroy.call(this);_872.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_87e.superclass.onMouseMove.call(this,e);var m=_87c.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _883=this.getSelectedNodes();if(_883.length){m.startDrag(this,_883,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _884=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_877.position(this.current,true);}if(this.horizontal){_884=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_877.isBodyLtr(this.current.ownerDocument);}else{_884=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_884!=this.before){this._markTargetAnchor(_884);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_87e.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_87e.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_885){if(this!==_885){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_87c.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_886,_887,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_886?(copy?"Copied":"Moved"):"");}var _888=this.accept&&this.checkAcceptance(_886,_887);this._changeState("Target",_888?"":"Disabled");if(this==_886){_87c.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_889,_88a,copy,_88b){if(this==_88b){this.onDrop(_889,_88a,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_88c,_88d,copy){if(this!=_88c){this.onDropExternal(_88c,_88d,copy);}else{this.onDropInternal(_88d,copy);}},onDropExternal:function(_88e,_88f,copy){var _890=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _890.call(this,_88e.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_88e.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_88e.getItem(node.id);_88e.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_88e.selectNone();}this.insertNodes(true,_88f,this.before,this.current);if(!copy&&this.creator){_88e.deleteSelectedNodes();}this._normalizedCreator=_890;},onDropInternal:function(_891,copy){var _892=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _892.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_891,this.before,this.current);this._normalizedCreator=_892;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_87e.superclass.onOverEvent.call(this);_87c.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_87e.superclass.onOutEvent.call(this);_87c.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_893){if(this.current==this.targetAnchor&&this.before==_893){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_893;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_878.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_876.contains(node,"dojoDndHandle")){return true;}if(_876.contains(node,"dojoDndItem")||_876.contains(node,"dojoDndIgnore")){break;}}return false;}});return _87e;});},"esri/toolbars/_VertexMover":function(){define(["dijit","dojo","dojox","dojo/require!dojox/gfx/move"],function(_894,dojo,_895){dojo.provide("esri.toolbars._VertexMover");dojo.require("dojox.gfx.move");dojo.declare("esri.toolbars.VertexMover",null,{constructor:function(_896,_897,_898,_899,_89a,_89b,_89c,_89d){this.point=_896;this.symbol=_897;this.relatedGraphic=_898;this.segIndex=_899;this.ptIndex=_89a;this.segLength=_89b;this.editor=_89c;this.map=_89c.map;this._scratchGL=_89c.toolbar._scratchGL;this._placeholder=_89d||false;this._type=_898.geometry.type;this._init();this._enable();},refresh:function(_89e){if(_89e||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _89f=new esri.geometry.Point(this.point.toJson());var _8a0=new esri.Graphic(_89f,this.symbol);switch(this._type){case "multipoint":_8a0._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_8a0);break;}this.graphic=_8a0;},_enable:function(){var _8a1=this.graphic.getDojoShape();if(_8a1){_8a1._hasMover=true;this._moveable=this._getMoveable(_8a1);var node=_8a1.getEventSource();if(node){dojo.style(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _8a2=this._moveable;if(_8a2){dojo.disconnect(this._startHandle);dojo.disconnect(this._firstHandle);dojo.disconnect(this._movingHandle);dojo.disconnect(this._stopHandle);var _8a3=_8a2.shape;if(_8a3){var node=_8a3.getEventSource();if(node){dojo.style(node,"cursor",null);}}_8a2.destroy();this._moveable=null;}},_needRefresh:function(){var _8a4=this.graphic.getDojoShape(),need=false;if(_8a4){switch(this._type){case "multipoint":var _8a5=this.relatedGraphic.getDojoShape();if(_8a5){var _8a6=_8a5.children[this.ptIndex];if(_8a4!==_8a6){_8a4=_8a6;this.graphic._shape=_8a4;need=true;}}break;case "polyline":case "polygon":need=!_8a4._hasMover;break;}}return need;},_getMoveable:function(_8a7){var _8a8=new _895.gfx.Moveable(_8a7,dojo.isMac&&dojo.isFF&&!esri.isTouchEnabled&&{leftButtonOnly:true});this._startHandle=dojo.connect(_8a8,"onMoveStart",this,this._moveStartHandler);this._firstHandle=dojo.connect(_8a8,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=dojo.connect(_8a8,"onMoving",this,this._movingHandler);this._stopHandle=dojo.connect(_8a8,"onMoveStop",this,this._moveStopHandler);return _8a8;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_8a9){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_8a9.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_8aa){var _8ab=_8aa.shape;var _8ac=this._getControlEdges();var _8ad=this._scratchGL._div;var i,_8ae=[],_8af=_8aa.host.shape._wrapOffsets[0]||0;for(i=0;i<_8ac.length;i++){var edge=_8ac[i];edge.x1+=_8af;edge.x2+=_8af;_8ae.push([_8ad.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_8ab._lines=_8ae;_8aa.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_8b0){var _8b1=_8b0.shape,tx=_8b1.getTransform();var i,_8b2=_8b1._lines;for(i=0;i<_8b2.length;i++){var line=_8b2[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_8b3){var _8b4=_8b3.shape,_8b5=this.editor.toolbar,tx=_8b4.getTransform(),map=this.map,host=this.graphic,_8b6=_8b5._geo?esri.geometry.geographicToWebMercator(host.geometry):host.geometry;var i,_8b7=_8b4._lines;if(_8b7){for(i=0;i<_8b7.length;i++){_8b7[i][0].removeShape();}_8b4._lines=null;}var ph=false,_8b8=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_8b8=false;}var _8b9;if(map.snappingManager){_8b9=map.snappingManager._snappingPoint;}var _8ba=_8b9||map.toMap(map.toScreen(_8b6).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_8b4.setTransform(null);host.setGeometry(_8b5._geo?esri.geometry.webMercatorToGeographic(_8ba,true):_8ba);this.constructor.onMoveStop(this,tx);_8b5.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_8b8){_8b5.onVertexClick(this.relatedGraphic,info);}if(ph){_8b5.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _8bb=this.relatedGraphic.geometry;var _8bc=this.segIndex,_8bd=this.ptIndex,_8be=this.segLength;var _8bf=this._scratchGL._div;var _8c0=_8bf.getTransform();var sdx=_8c0.dx,sdy=_8c0.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _8c1=[];var _8c2=this.editor._getControlPoints(this,_8bb,_8bc,_8bd,_8be);if(_8c2[0]){_8c1.push({x1:x,y1:y,x2:_8c2[0].x-sdx,y2:_8c2[0].y-sdy});}if(_8c2[1]){_8c1.push({x1:x,y1:y,x2:_8c2[1].x-sdx,y2:_8c2[1].y-sdy});}return _8c1;}});dojo.mixin(esri.toolbars.VertexMover,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dijit","dojo","dojox","dojo/require!esri/toolbars/_toolbar,esri/toolbars/_GraphicMover,esri/toolbars/_VertexEditor,esri/toolbars/_Box"],function(_8c3,dojo,_8c4){dojo.provide("esri.toolbars.edit");dojo.require("esri.toolbars._toolbar");dojo.require("esri.toolbars._GraphicMover");dojo.require("esri.toolbars._VertexEditor");dojo.require("esri.toolbars._Box");dojo.declare("esri.toolbars.Edit",esri.toolbars._Toolbar,{constructor:function(map,_8c5){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _8c6=esri.isTouchEnabled;this._defaultOptions=dojo.mixin({vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_8c6?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([128,128,128])),ghostVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,_8c6?18:10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75])),ghostLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DOT,new dojo.Color([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_8c6?24:16,boxLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new dojo.Color([64,64,64]),1),boxHandleSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,_8c6?16:9,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.5]),1),new dojo.Color([255,255,255,0.75]))},_8c5||{});},activate:function(tool,_8c7,_8c8){this.deactivate();this._graphic=_8c7;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),_8c8||{});var MOVE=esri.toolbars.Edit.MOVE,EDIT=esri.toolbars.Edit.EDIT_VERTICES,_8c9=esri.toolbars.Edit.SCALE,_8ca=esri.toolbars.Edit.ROTATE,move=false,edit=false,box=false,map=this._map,_8cb=map.spatialReference,_8cc=_8c7.geometry.spatialReference;this._geo=!!(_8cb&&_8cc&&!_8cb.equals(_8cc)&&_8cb.isWebMercator()&&_8cc.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_8c7);}var _8cd=((tool&_8c9)===_8c9),_8ce=((tool&_8ca)===_8ca);if(_8cd||_8ce){box=this._enableBoxEditing(_8c7,_8cd,_8ce);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_8c7);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] "+esri.bundle.toolbars.edit.invalidType);}this._tool=tool;if(this._tool){this._mapPanEndHandle=dojo.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=dojo.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_8c7);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_8cf=this._graphic;if(!tool){return;}var _8d0=!!this._modified;this._clear();dojo.disconnect(this._mapPanEndHandle);dojo.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_8cf,{isModified:_8d0});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_8d1){},onDeactivate:function(tool,_8d2,info){},onGraphicMoveStart:function(_8d3){},onGraphicFirstMove:function(_8d4){this._modified=true;},onGraphicMove:function(_8d5,_8d6){},onGraphicMoveStop:function(_8d7,_8d8){},onGraphicClick:function(_8d9,info){},onVertexMoveStart:function(_8da,_8db){},onVertexFirstMove:function(_8dc,_8dd){this._modified=true;},onVertexMove:function(_8de,_8df,_8e0){},onVertexMoveStop:function(_8e1,_8e2,_8e3){},onVertexAdd:function(_8e4,_8e5){this._modified=true;},onVertexClick:function(_8e6,_8e7){},onVertexMouseOver:function(_8e8,_8e9){},onVertexMouseOut:function(_8ea,_8eb){},onVertexDelete:function(_8ec,_8ed){this._modified=true;},onScaleStart:function(_8ee){},onScaleFirstMove:function(_8ef){this._modified=true;},onScale:function(_8f0,info){},onScaleStop:function(_8f1,info){},onRotateStart:function(_8f2){},onRotateFirstMove:function(_8f3){this._modified=true;},onRotate:function(_8f4,info){},onRotateStop:function(_8f5,info){},_enableMove:function(_8f6){var map=this._map,type=_8f6.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new esri.toolbars._GraphicMover(_8f6,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_8f7){var map=this._map,type=_8f7.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=esri.toolbars._GraphicVertexEditor.create(_8f7,map,this);return true;}return false;},_enableBoxEditing:function(_8f8,_8f9,_8fa){var map=this._map,type=_8f8.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new esri.toolbars._Box(_8f8,map,this,_8f9,_8fa,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _8fb=this._graphicMover;if(_8fb){_8fb.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _8fc=this._vertexEditor;if(_8fc){_8fc.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_8fd){if(_8fd){this._refreshMoveables();}},_refreshMoveables:function(_8fe){var _8ff=dojo.filter([this._graphicMover,this._vertexEditor,this._boxEditor],esri._isDefined);dojo.forEach(_8ff,function(mov){mov.refresh(_8fe);});},_beginOperation:function(_900){dojo.forEach(this._getAffectedTools(_900),function(tool){tool.suspend();});},_endOperation:function(_901){dojo.forEach(this._getAffectedTools(_901),function(tool){tool.resume();});},_getAffectedTools:function(_902){var _903=[];switch(_902){case "MOVE":_903=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_903=[this._boxEditor];break;case "BOX":_903=[this._vertexEditor];break;}_903=dojo.filter(_903,esri._isDefined);return _903;}});dojo.mixin(esri.toolbars.Edit,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _904={};lang.setObject("dojo.data.util.filter",_904);_904.patternToRegExp=function(_905,_906){var rxp="^";var c=null;for(var i=0;i<_905.length;i++){c=_905.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_905.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_906){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _904;});},"esri/dijit/editing/toolbars/Drawing":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_CssStateMixin,esri/dijit/editing/toolbars/ToolbarBase,esri/dijit/editing/tools/Editing,esri/dijit/editing/tools/Selection,esri/dijit/editing/tools/AdvancedTools"],function(_907,dojo,_908){dojo.provide("esri.dijit.editing.toolbars.Drawing");dojo.require("dijit._CssStateMixin");dojo.require("esri.dijit.editing.toolbars.ToolbarBase");dojo.require("esri.dijit.editing.tools.Editing");dojo.require("esri.dijit.editing.tools.Selection");dojo.require("esri.dijit.editing.tools.AdvancedTools");dojo.declare("esri.dijit.editing.toolbars.Drawing",[esri.dijit.editing.toolbars.ToolbarBase,_907._CssStateMixin],{onShowAttributeInspector:function(){},_activateTool:function(tool,_909){this._settings.editor._activeTool=tool;if(tool!=="EDITING"){this._settings.templatePicker.clearSelection();}if(tool!=="ATTRIBUTES"){this._settings.editor._hideAttributeInspector();}if(tool==="CLEAR"){return;}this.inherited(arguments);},_initializeToolbar:function(){var _90a=this._settings.layers;dojo.forEach(_90a,function(_90b){this._tbConnects.push(dojo.connect(_90b,"onSelectionComplete",this,"_updateUI"));},this);},activateEditing:function(_90c,_90d){this._tools.EDITING._activateTool(_90c,_90d.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(true);},_updateUI:function(){if(this._settings.undoManager){this._tools.UNDO.set("disabled",this._settings.undoManager.canUndo===false);this._tools.REDO.set("disabled",this._settings.undoManager.canRedo===false);}this._selectedFeatures=esri.dijit.editing.Util.LayerHelper.getSelection(this._settings.layers);var _90e=this._selectedFeatures.length;if(this._tools.DELETE){this._tools.DELETE.set("disabled",_90e<=0);}if(this._tools.CLEAR){this._tools.CLEAR.set("disabled",_90e<=0);}if(this._tools.ATTRIBUTES){this._tools.ATTRIBUTES.set("disabled",_90e<=0);}if(this._tools.UNION){this._tools.UNION.set("disabled",_90e<2);}},_toolFinished:function(tool){if(tool==="ATTRIBUTES"&&(this._selectedFeatures&&this._selectedFeatures.length)){this.onShowAttributeInspector(this._selectedFeatures[0]);}if(tool==="SELECT"||tool==="CUT"||tool==="RESHAPING"||tool==="EDITING"){this._activeTool.deactivate();this._activeTool.setChecked(false);this._activeTool=null;}if(tool==="DELETE"){this.onDelete();}this._updateUI();},_createTools:function(){this._tools.SELECT=new esri.dijit.editing.tools.Selection({settings:this._settings,onClick:dojo.hitch(this,"_activateTool","SELECT",true),onFinished:dojo.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new esri.dijit.editing.tools.ButtonToolBase(dojo.mixin(esri.dijit.editing.tools.SelectionTools.selectClear,{settings:this._settings,onClick:dojo.hitch(this._settings.editor,"_clearSelection",false)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new esri.dijit.editing.tools.ButtonToolBase(dojo.mixin(esri.dijit.editing.tools.EditingTools.attributes,{settings:this._settings,onClick:dojo.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new esri.dijit.editing.tools.Editing({settings:this._settings,onClick:dojo.hitch(this,"_activateTool","EDITING",true),onApplyEdits:dojo.hitch(this,"onApplyEdits"),onFinished:dojo.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new esri.dijit.editing.tools.ButtonToolBase(dojo.mixin(esri.dijit.editing.tools.EditingTools.del,{settings:this._settings,onClick:dojo.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);if(this._settings.toolbarOptions){if(this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible){this._createSeparator();}if(this._settings.toolbarOptions.cutVisible){this._tools.CUT=new esri.dijit.editing.tools.Cut({settings:this._settings,onFinished:dojo.hitch(this,"_toolFinished","CUT"),onClick:dojo.hitch(this,"_activateTool","CUT",true),onApplyEdits:dojo.hitch(this,"onApplyEdits")});this.addChild(this._tools.CUT);}if(this._settings.toolbarOptions.mergeVisible){this._tools.UNION=new esri.dijit.editing.tools.Union({settings:this._settings,onFinished:dojo.hitch(this,"_toolFinished","UNION"),onApplyEdits:dojo.hitch(this,"onApplyEdits")});this.addChild(this._tools.UNION);}if(this._settings.toolbarOptions.reshapeVisible){this._tools.RESHAPING=new esri.dijit.editing.tools.Reshape({settings:this._settings,onClick:dojo.hitch(this,"_activateTool","RESHAPING",true),onFinished:dojo.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:dojo.hitch(this,"onApplyEdits")});this.addChild(this._tools.RESHAPING);}}if(this._settings.enableUndoRedo){this._createSeparator();this._tools.UNDO=new esri.dijit.editing.tools.ButtonToolBase(dojo.mixin(esri.dijit.editing.tools.EditingTools.undo,{settings:this._settings,onClick:dojo.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._undo();})}));this.addChild(this._tools.UNDO);this._tools.REDO=new esri.dijit.editing.tools.ButtonToolBase(dojo.mixin(esri.dijit.editing.tools.EditingTools.redo,{settings:this._settings,onClick:dojo.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._redo();})}));this.addChild(this._tools.REDO);}}});});},"esri/dijit/editing/tools/ToggleToolBase":function(){define(["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/ToolBase,dijit/form/ToggleButton,esri/toolbars/draw"],function(_90f,dojo,_910){dojo.provide("esri.dijit.editing.tools.ToggleToolBase");dojo.require("esri.dijit.editing.tools.ToolBase");dojo.require("dijit.form.ToggleButton");dojo.require("esri.toolbars.draw");dojo.declare("esri.dijit.editing.tools.ToggleToolBase",[_90f.form.ToggleButton,esri.dijit.editing.tools.ToolBase],{postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_90f.form.ToggleButton.prototype.destroy.apply(this,arguments);esri.dijit.editing.tools.ToolBase.prototype.destroy.apply(this,arguments);},setChecked:function(_911){_90f.form.ToggleButton.prototype.setChecked.apply(this,arguments);}});});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_912,_913,lang,win,_914,has,_915,_916,_917,util,html){var dg=_912.grid;var _918=function(td){return td.cellIndex>=0?td.cellIndex:_913.indexOf(td.parentNode.cells,td);};var _919=function(tr){return tr.rowIndex>=0?tr.rowIndex:_913.indexOf(tr.parentNode.childNodes,tr);};var _91a=function(_91b,_91c){return _91b&&((_91b.rows||0)[_91c]||_91b.childNodes[_91c]);};var _91d=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _91e=function(_91f,_920){for(var n=_91f;n&&_920(n);n=n.parentNode){}return n;};var _921=function(_922){var name=_922.toUpperCase();return function(node){return node.tagName!=name;};};var _923=util.rowIndexTag;var _924=util.gridViewTag;var _925=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_926,_927,_928,_929){var _92a=[],html;if(_929){var _92b=_926.index!=_926.grid.getSortIndex()?"":_926.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_926.id){_926.id=this.grid.id+"Hdr"+_926.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_92b,"id=\"",_926.id,"\""];}else{var _92c=this.grid.editable&&!_926.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_92c];}if(_926.colSpan){html.push(" colspan=\"",_926.colSpan,"\"");}if(_926.rowSpan){html.push(" rowspan=\"",_926.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_926.classes){html.push(_926.classes," ");}if(_928){html.push(_928," ");}_92a.push(html.join(""));_92a.push("");html=["\" idx=\"",_926.index,"\" style=\""];if(_927&&_927[_927.length-1]!=";"){_927+=";";}html.push(_926.styles,_927||"",_926.hidden?"display:none;":"");if(_926.unitWidth){html.push("width:",_926.unitWidth,";");}_92a.push(html.join(""));_92a.push("");html=["\""];if(_926.attrs){html.push(" ",_926.attrs);}html.push(">");_92a.push(html.join(""));_92a.push("");_92a.push(_929?"</th>":"</td>");return _92a;},isCellNode:function(_92d){return Boolean(_92d&&_92d!=win.doc&&html.attr(_92d,"idx"));},getCellNodeIndex:function(_92e){return _92e?Number(html.attr(_92e,"idx")):-1;},getCellNode:function(_92f,_930){for(var i=0,row;((row=_91a(_92f.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_930){return cell;}}}return null;},findCellTarget:function(_931,_932){var n=_931;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_924 in n.offsetParent.parentNode&&n.offsetParent.parentNode[_924]!=this.view.id))&&(n!=_932)){n=n.parentNode;}return n!=_932?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_933,_934){var n=_933;while(n&&(n!=this.domNode)&&(!(_934 in n)||(_924 in n&&n[_924]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_935){return this.findTarget(_935,_923);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _936=dg._ContentBuilder=lang.extend(function(view){_925.call(this,view);},_925.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _937=this.grid.get,_938=this.view.structure.cells;for(var j=0,row;(row=_938[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_937;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_939,_93a){var html=this.getTableArray(),v=this.view,_93b=v.structure.cells,item=this.grid.getItem(_93a);util.fire(this.view,"onBeforeRow",[_93a,_93b]);for(var j=0,row;(row=_93b[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_93a,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_923];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _93c=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_925.call(this,view);},_925.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_93d,_93e){var html=this.getTableArray(),_93f=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_93f]);for(var j=0,row;(row=_93f[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_940;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_940=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_940[5]=(_93e!=undefined?_93e:_93d(cell));_940[3]=cell.customStyles.join(";");_940[1]=cell.customClasses.join(" ");html.push(_940.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_91e(e.target,_921("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_91e(n,_921("table"));x-=(table&&table.offsetLeft)||0;}}n=_91e(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_914.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_914.stop(e);return true;}return false;},colResizeSetup:function(e,_941){var _942=html.contentBox(e.sourceView.headerNode);if(_941){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _943=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_917.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_943.h+_942.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _944=[],_945=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_945[i]);i++){_944.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _946=e.grid.views.views;var _947=[];for(var j=view.idx+adj,_948;(_948=_946[j]);j=j+adj){_947.push({node:_948.headerNode,left:window.parseInt(_948.headerNode.style.left)});}var _949=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_942.w,table:_949,tw:html.contentBox(_949).w,spanners:_944,followers:_947};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _916(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_915.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_94a,_94b,_94c){var _94d=_94c.l;var data={deltaX:_94d,w:_94a.w+(this.grid.isLeftToRight()?_94d:-_94d),vw:_94a.vw+_94d,tw:_94a.tw+_94d};this.dragRecord={inDrag:_94a,mover:_94b,leftTop:_94c};if(data.w>=this.minColWidth){if(!_94b){this.doResizeNow(_94a,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_94e){if(this.dragRecord){var _94f=this.dragRecord.leftTop;var _950=this.grid.isLeftToRight()?_94f.l:-_94f.l;_950+=Math.max(_94e.w+_950,this.minColWidth)-(_94e.w+_950);if(has("webkit")&&_94e.spanners.length){_950+=html._getPadBorderExtents(_94e.spanners[0].node).w;}var data={deltaX:_950,w:_94e.w+_950,vw:_94e.vw+_950,tw:_94e.tw+_950};this.doResizeNow(_94e,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_94e.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_94e.index);},doResizeNow:function(_951,data){_951.view.convertColPctToFixed();if(_951.view.flexCells&&!_951.view.testFlexCells()){var t=_91d(_951.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_951.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_951.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_951.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_951.node.style.width=data.w+"px";_951.view.setColWidth(_951.index,data.w);_951.view.headerNode.style.width=data.vw+"px";_951.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_951.view.headerNode.scrollLeft=_951.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_952){var _953=_952.length;if(!_953){return;}this.map=[];var row;for(var k=0;(row=_952[k]);k++){this.map[k]=[];}for(var j=0;(row=_952[j]);j++){for(var i=0,x=0,cell,_954,_955;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_955=cell.rowSpan||1;_954=cell.colSpan||1;for(var y=0;y<_955;y++){for(var s=0;s<_954;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_954;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_956,_957){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_957&&cell.r==_956){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_958,_959,_95a){var row=_958&&_958.rows[_959];return row&&row.cells[_95a];},_findOverlappingNodes:function(_95b,_95c,_95d){var _95e=[];var m=this.getMapCoords(_95c,_95d);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_95b,rw.r,rw.c):null);if(n){_95e.push(n);}}return _95e;},findOverlappingNodes:function(_95f){return this._findOverlappingNodes(_91d(_95f),_919(_95f.parentNode),_918(_95f));}});return {_Builder:_925,_HeaderBuilder:_93c,_ContentBuilder:_936};});},"dijit/form/FilteringSelect":function(){define("dijit/form/FilteringSelect",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(_960,_961,lang,when,_962,_963){return _961("dijit.form.FilteringSelect",[_962,_963],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return !!this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_964,_965,_966,_967){if((_965&&_965[this.searchAttr]!==this._lastQuery)||(!_965&&_964.length&&this.store.getIdentity(_964[0])!=this._lastQuery)){return;}if(!_964.length){this.set("value","",_967||(_967===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_964[0],_967);}},_openResultList:function(_968,_969,_96a){if(_969[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(_96b,_96c,_96d,item){if(!this._onChangeActive){_96c=null;}if(item===undefined){if(_96b===null||_96b===""){_96b="";if(!lang.isString(_96d)){this._setDisplayedValueAttr(_96d||"",_96c);return;}}var self=this;this._lastQuery=_96b;when(this.store.get(_96b),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_96c);});}else{this.valueNode.value=_96b;this.inherited(arguments);}},_setItemAttr:function(item,_96e,_96f){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(_970,_971){if(_970==null){_970="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_971=false;}if(this.store){this.closeDropDown();var _972=lang.clone(this.query);var qs=this._getDisplayQueryString(_970),q;if(this.store._oldAPI){q=qs;}else{q=_960.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_972[this.searchAttr]=q;this.textbox.value=_970;this._lastDisplayedValue=_970;this._set("displayedValue",_970);var _973=this;var _974={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_974,this.fetchProperties);this._fetchHandle=this.store.query(_972,_974);when(this._fetchHandle,function(_975){_973._fetchHandle=null;_973._callbackSetLabel(_975||[],_972,_974,_971);},function(err){_973._fetchHandle=null;if(!_973._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_976,_977,_978,has,util){return _977("dojox.grid._EditManager",null,{constructor:function(_979){this.grid=_979;if(has("ie")){this.connections=[_978.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_978.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_976.forEach(this.connections,_978.disconnect);},cellFocus:function(_97a,_97b){if(this.grid.singleClickEdit||this.isEditRow(_97b)){this.setEditCell(_97a,_97b);}else{this.apply();}if(this.isEditing()||(_97a&&_97a.editable&&_97a.alwaysEditing)){this._focusEditor(_97a,_97b);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_97c){if(_97c.index==this.info.rowIndex){_97c.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_97d,_97e){return (this.info.rowIndex===_97d)&&(this.info.cell.index==_97e);},isEditRow:function(_97f){return this.info.rowIndex===_97f;},setEditCell:function(_980,_981){if(!this.isEditCell(_981,_980.index)&&this.grid.canEdit&&this.grid.canEdit(_980,_981)){this.start(_980,_981,this.isEditRow(_981)||_980.editable);}},_focusEditor:function(_982,_983){util.fire(_982,"focus",[_983]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_984,_985,_986){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_985)){this.applyRowEdit();this.grid.updateRow(_985);}if(_986){this.info={cell:_984,rowIndex:_985};this.grid.doStartEdit(_984,_985);this.grid.updateRow(_985);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_984,_985);this._doCatchBoomerang();},_editorDo:function(_987){var c=this.info.cell;if(c&&c.editable){c[_987](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_988,_989,_98a){if(this.grid.canEdit(_989,_98a)){this.grid.doApplyCellEdit(_988,_98a,_989.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_98b,_98c){var c=this.info.cell;if(this.isEditRow(_98b)&&(!_98c||c.view==_98c)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_98d,_98e){var c=this.info.cell;if(this.isEditRow(_98e)&&c.view==_98d&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _98f={};lang.setObject("dojo.data.util.sorter",_98f);_98f.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_98f.createSortFunction=function(_990,_991){var _992=[];function _993(attr,dir,comp,s){return function(_994,_995){var a=s.getValue(_994,attr);var b=s.getValue(_995,attr);return dir*comp(a,b);};};var _996;var map=_991.comparatorMap;var bc=_98f.basicComparator;for(var i=0;i<_990.length;i++){_996=_990[i];var attr=_996.attribute;if(attr){var dir=(_996.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_992.push(_993(attr,dir,comp,_991));}}return function(rowA,rowB){var i=0;while(i<_992.length){var ret=_992[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _98f;});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_997,_998){var _999={};lang.setObject("dojo.colors",_999);var _99a=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_997.fromRgb=function(_99b,obj){var m=_99b.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_998.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _997.fromArray(a,obj);}return _997.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_99a(m1,m2,H+1/3)*256,_99a(m1,m2,H)*256,_99a(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _997.fromArray(a,obj);}}return null;};var _99c=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_997.prototype.sanitize=function(){var t=this;t.r=Math.round(_99c(t.r,0,255));t.g=Math.round(_99c(t.g,0,255));t.b=Math.round(_99c(t.b,0,255));t.a=_99c(t.a,0,1);return this;};_999.makeGrey=_997.makeGrey=function(g,a){return _997.fromArray([g,g,g,a]);};lang.mixin(_997.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _997;});},"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n","dojox/date/islamic/Date":function(){define("dojox/date/islamic/Date",["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(lang,_99d,dd){var _99e=_99d("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var len=arguments.length;if(!len){this.fromGregorian(new Date());}else{if(len==1){var arg0=arguments[0];if(typeof arg0=="number"){arg0=new Date(arg0);}if(arg0 instanceof Date){this.fromGregorian(arg0);}else{if(arg0==""){this._date=new Date("");}else{this._year=arg0._year;this._month=arg0._month;this._date=arg0._date;this._hours=arg0._hours;this._minutes=arg0._minutes;this._seconds=arg0._seconds;this._milliseconds=arg0._milliseconds;}}}else{if(len>=3){this._year+=arguments[0];this._month+=arguments[1];this._date+=arguments[2];this._hours+=arguments[3]||0;this._minutes+=arguments[4]||0;this._seconds+=arguments[5]||0;this._milliseconds+=arguments[6]||0;}}}},getDate:function(){return this._date;},getMonth:function(){return this._month;},getFullYear:function(){return this._year;},getDay:function(){return this.toGregorian().getDay();},getHours:function(){return this._hours;},getMinutes:function(){return this._minutes;},getSeconds:function(){return this._seconds;},getMilliseconds:function(){return this._milliseconds;},setDate:function(date){date=parseInt(date);if(date>0&&date<=this.getDaysInIslamicMonth(this._month,this._year)){this._date=date;}else{var _99f;if(date>0){for(_99f=this.getDaysInIslamicMonth(this._month,this._year);date>_99f;date-=_99f,_99f=this.getDaysInIslamicMonth(this._month,this._year)){this._month++;if(this._month>=12){this._year++;this._month-=12;}}this._date=date;}else{for(_99f=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1);date<=0;_99f=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1)){this._month--;if(this._month<0){this._year--;this._month+=12;}date+=_99f;}this._date=date;}}return this;},setFullYear:function(year){this._year=+year;},setMonth:function(_9a0){this._year+=Math.floor(_9a0/12);if(_9a0>0){this._month=Math.floor(_9a0%12);}else{this._month=Math.floor(((_9a0%12)+12)%12);}},setHours:function(){var _9a1=arguments.length;var _9a2=0;if(_9a1>=1){_9a2=parseInt(arguments[0]);}if(_9a1>=2){this._minutes=parseInt(arguments[1]);}if(_9a1>=3){this._seconds=parseInt(arguments[2]);}if(_9a1==4){this._milliseconds=parseInt(arguments[3]);}while(_9a2>=24){this._date++;var _9a3=this.getDaysInIslamicMonth(this._month,this._year);if(this._date>_9a3){this._month++;if(this._month>=12){this._year++;this._month-=12;}this._date-=_9a3;}_9a2-=24;}this._hours=_9a2;},_addMinutes:function(_9a4){_9a4+=this._minutes;this.setMinutes(_9a4);this.setHours(this._hours+parseInt(_9a4/60));return this;},_addSeconds:function(_9a5){_9a5+=this._seconds;this.setSeconds(_9a5);this._addMinutes(parseInt(_9a5/60));return this;},_addMilliseconds:function(_9a6){_9a6+=this._milliseconds;this.setMilliseconds(_9a6);this._addSeconds(parseInt(_9a6/1000));return this;},setMinutes:function(_9a7){this._minutes=_9a7%60;return this;},setSeconds:function(_9a8){this._seconds=_9a8%60;return this;},setMilliseconds:function(_9a9){this._milliseconds=_9a9%1000;return this;},toString:function(){if(isNaN(this._date)){return "Invalidate Date";}else{var x=new Date();x.setHours(this._hours);x.setMinutes(this._minutes);x.setSeconds(this._seconds);x.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+x.toTimeString();}},toGregorian:function(){var _9aa=this._year;var _9ab=this._month;var _9ac=this._date;var _9ad=_9ac+Math.ceil(29.5*_9ab)+(_9aa-1)*354+Math.floor((3+(11*_9aa))/30)+this._ISLAMIC_EPOCH-1;var wjd=Math.floor(_9ad-0.5)+0.5,_9ae=wjd-this._GREGORIAN_EPOCH,_9af=Math.floor(_9ae/146097),dqc=this._mod(_9ae,146097),cent=Math.floor(dqc/36524),_9b0=this._mod(dqc,36524),quad=Math.floor(_9b0/1461),_9b1=this._mod(_9b0,1461),_9b2=Math.floor(_9b1/365),year=(_9af*400)+(cent*100)+(quad*4)+_9b2;if(!(cent==4||_9b2==4)){year++;}var _9b3=this._GREGORIAN_EPOCH+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400);var _9b4=wjd-_9b3;var tjd=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((739/12)+((dd.isLeapYear(new Date(year,3,1))?-1:-2))+1);var _9b5=((wjd<tjd)?0:(dd.isLeapYear(new Date(year,3,1))?1:2));var _9b6=Math.floor((((_9b4+_9b5)*12)+373)/367);var tjd2=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((((367*_9b6)-362)/12)+((_9b6<=2)?0:(dd.isLeapYear(new Date(year,_9b6,1))?-1:-2))+1);var day=(wjd-tjd2)+1;var _9b7=new Date(year,(_9b6-1),day,this._hours,this._minutes,this._seconds,this._milliseconds);return _9b7;},fromGregorian:function(_9b8){var date=new Date(_9b8);var _9b9=date.getFullYear(),_9ba=date.getMonth(),gDay=date.getDate();var _9bb=(this._GREGORIAN_EPOCH-1)+(365*(_9b9-1))+Math.floor((_9b9-1)/4)+(-Math.floor((_9b9-1)/100))+Math.floor((_9b9-1)/400)+Math.floor((((367*(_9ba+1))-362)/12)+(((_9ba+1)<=2)?0:(dd.isLeapYear(date)?-1:-2))+gDay);_9bb=Math.floor(_9bb)+0.5;var days=_9bb-this._ISLAMIC_EPOCH;var _9bc=Math.floor((30*days+10646)/10631);var _9bd=Math.ceil((days-29-this._yearStart(_9bc))/29.5);_9bd=Math.min(_9bd,11);var hDay=Math.ceil(days-this._monthStart(_9bc,_9bd))+1;this._date=hDay;this._month=_9bd;this._year=_9bc;this._hours=date.getHours();this._minutes=date.getMinutes();this._seconds=date.getSeconds();this._milliseconds=date.getMilliseconds();this._day=date.getDay();return this;},valueOf:function(){return this.toGregorian().valueOf();},_yearStart:function(year){return (year-1)*354+Math.floor((3+11*year)/30);},_monthStart:function(year,_9be){return Math.ceil(29.5*_9be)+(year-1)*354+Math.floor((3+11*year)/30);},_civilLeapYear:function(year){return (14+11*year)%30<11;},getDaysInIslamicMonth:function(_9bf,year){var _9c0=0;_9c0=29+((_9bf+1)%2);if(_9bf==11&&this._civilLeapYear(year)){_9c0++;}return _9c0;},_mod:function(a,b){return a-(b*Math.floor(a/b));}});_99e.getDaysInIslamicMonth=function(_9c1){return new _99e().getDaysInIslamicMonth(_9c1.getMonth(),_9c1.getFullYear());};return _99e;});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","esri/dijit/editing/TemplatePicker":function(){define("esri/dijit/editing/TemplatePicker",["dijit","dojo","dojox","dojo/require!dojo/data/ItemFileReadStore,dojox/grid/DataGrid,dijit/_Widget,dijit/_Templated,dojox/gfx,esri/utils,esri/symbol"],function(_9c2,dojo,_9c3){dojo.provide("esri.dijit.editing.TemplatePicker");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojox.grid.DataGrid");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dojox.gfx");dojo.require("esri.utils");dojo.require("esri.symbol");dojo.declare("esri.dijit.editing.TemplatePicker",[_9c2._Widget,_9c2._Templated],{widgetsInTemplate:true,templateString:"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>",basePath:dojo.moduleUrl("esri.dijit.editing"),featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_9c4,_9c5){_9c4=_9c4||{};if(!_9c4.items&&!_9c4.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(dojo.version.minor>=4);this._itemWidgets={};if(_9c4.featureLayers&&_9c4.featureLayers.length){this._flChanged=1;}this._nls=dojo.getObject("bundle.widgets.templatePicker",false,esri);this.emptyMessage=_9c4.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=dojo.contentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=dojo.contentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();dojo.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(dojo.isIE<9){this._repaintItems=dojo.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _9c6=this._selectedCell,info=this._selectedInfo;if(_9c6){this._rowClicked({cellNode:_9c6,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_9c7){var _9c8=(this.rows==="auto"&&this.columns==="auto"&&_9c7)?true:false,grid=this.grid,box;if(_9c8){var _9c9=this.domNode,id=_9c9.id,_9ca,item=dojo.query("#"+id+".templatePicker div.item")[0];box=dojo.contentBox(_9c9);item=item&&item.parentNode;if(item){_9ca=dojo.coords(item).w;}else{_9ca=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_9ca);this._columns=this._columns||1;}var _9cb=this._rows;this._preprocess();var _9cc=this._rows;this._setGridLayout();this._setGridData();if(_9cc!==_9cb){grid.set("autoHeight",this._rows,false);}if(_9c8){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_9cd=this.getSelected();if(_9cd){grid.store.fetch({onComplete:function(its){var _9ce=self._locate(_9cd,self._selectedInfo,its);var _9cf=_9ce&&grid.views.views[0].getCellNode(_9ce[0],_9ce[1]);if(_9cf){self._rowClicked({cellNode:_9cf,rowIndex:_9ce[0],cellIndex:_9ce[1]},true);}}});}if(dojo.isIE<9){setTimeout(this._repaintItems,this._ieTimer);}var _9d0=this.featureLayers,_9d1=this.items;if((!_9d0||!_9d0.length)&&(!_9d1||!_9d1.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _9d2=this.useLegend;if(!this._started||_9d2!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_9d3){var _9d4=this.featureLayers;if(!this._started||_9d4!==_9d3){this._flChanged=1;}this.featureLayers=_9d3;},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _9d5;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}_9d5=this._flItems=this._getItemsFromLayers(this.featureLayers);}else{_9d5=this._itItems=this._getItemsFromItems(this.items);}if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_9d5.length;dojo.forEach(_9d5,function(_9d6){len+=Math.ceil(_9d6.length/this.columns);},this);}else{dojo.forEach(_9d5,function(_9d7){len+=_9d7.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_9d5.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{dojo.forEach(_9d5,function(_9d8){len+=_9d8.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_9d5.length/this.rows);}this._columns=len;}}},_processSelectionLayers:function(){var map,_9d9,info,_9da,key,_9db,_9dc,_9dd={};dojo.forEach(this.featureLayers,function(_9de,idx){if(_9de.mode===esri.layers.FeatureLayer.MODE_SELECTION&&_9de._map&&_9de.url&&_9de._params.drawMode&&!_9de.source){_9d9=dojo.trim(_9de._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_9dd[_9d9]=_9dd[_9d9]||{});_9da=(info.featureLayers=info.featureLayers||{});_9db=(info.indices=info.indices||[]);_9da[idx]=_9de;_9db.push(idx);map=_9de._map;}});if(map){dojo.forEach(map.layerIds,function(_9df){_9df=map.getLayer(_9df);if(_9df&&_9df.url&&(_9df.getImageUrl||_9df.getTileUrl)&&_9df.loaded&&_9df.version>=10.1){_9d9=dojo.trim(_9df._url.path).replace(/(\/MapServer).*/ig,"$1");key=_9d9.replace(/^https?:\/\//ig,"").toLowerCase();if(_9dd[key]&&(!_9dd[key].mapServiceUrl)){info=_9dd[key];info.mapServiceUrl=_9d9;info.mapServiceLayer=_9df;this._legendIndices=this._legendIndices.concat(info.indices);_9dc=this._fetchLegend({pickerInstance:this,info:info},key);if(_9dc.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_9dc);}else{this._processLegendResponse(_9dc,info);}}}},this);}},_fetchLegend:function(_9e0,key){var _9e1=esri.dijit.editing.TemplatePicker.prototype,_9e2=_9e1.legendCache[key];if(!_9e2){_9e2=(_9e1.legendCache[key]=esri.request({url:_9e0.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_9e2._contexts=[_9e0];_9e2.addBoth(function(_9e3){if(_9e2.canceled){return;}_9e1.legendCache[key]=_9e3;var _9e4=_9e2._contexts;_9e2._contexts=null;dojo.forEach(_9e4,function(ctxt){var _9e5=ctxt.pickerInstance,info=ctxt.info,_9e6;if(_9e5._destroyed){return;}dojo.forEach(info.indices,function(idx){_9e6=dojo.indexOf(_9e5._loadingIndices,idx);if(_9e6>-1){_9e5._loadingIndices.splice(_9e6,1);}});_9e6=dojo.indexOf(_9e5._loadingLegends,_9e2);if(_9e6>-1){_9e5._loadingLegends.splice(_9e6,1);}_9e5._processLegendResponse(_9e3,info);});});}else{if(_9e2.then){_9e2._contexts.push(_9e0);}}return _9e2;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){dojo.forEach(this._loadingLegends,function(_9e7){var _9e8=-1;dojo.some(_9e7._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_9e8=idx;}return (_9e8>-1);},this);if(_9e8>-1){_9e7._contexts.splice(_9e8,1);}},this);}},_processLegendResponse:function(_9e9,info){if(_9e9&&!(_9e9 instanceof Error)){dojo.forEach(info.indices,function(idx){var _9ea=info.featureLayers[idx].layerId,i,_9eb=info.mapServiceUrl+"/"+_9ea+"/images/",_9ec=info.mapServiceLayer._getToken(),_9ed,obj,_9ee,url;if(this._legendSymbols[idx]){return;}_9ed=null;dojo.some(_9e9.layers,function(_9ef){if(_9ef.layerId==_9ea){_9ed=_9ef;}return !!_9ed;});if(_9ed){obj=(this._legendSymbols[idx]={});dojo.forEach(_9ed.legend,function(_9f0){_9ee=_9f0.values;if(_9ee&&_9ee.length){for(i=0;i<_9ee.length;i++){obj[_9ee[i]]=_9f0;}}else{obj.defaultSymbol=_9f0;}url=_9f0.url;if(url&&!_9f0._fixed){_9f0._fixed=1;if((url.search(/https?\:/)===-1)){_9f0.url=_9eb+url;}if(_9ec&&_9f0.url.search(/https?\:/)!==-1){_9f0.url+=(((_9f0.url.indexOf("?")>-1)?"&":"?")+"token="+_9ec);}}});}},this);}else{var _9f1;dojo.forEach(info.indices,function(idx){_9f1=dojo.indexOf(this._legendIndices,idx);if(_9f1>-1){this._legendIndices.splice(_9f1,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _9f2=grid.adaptWidth,_9f3,i,view;grid.adaptWidth=function(){_9f3=this.views.views;for(i=0;view=_9f3[i];i++){dojo.style(view.headerNode,"display","block");}_9f2.apply(this,arguments);for(i=0;view=_9f3[i];i++){dojo.style(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _9f4=dojo.connect(grid,"_onFetchComplete",this,function(){dojo.disconnect(_9f4);this.grid.set("autoHeight",this._rows);});}dojo.connect(grid,"_onDelete",this,this._destroyItems);dojo.connect(grid,"_clearData",this,this._destroyItems);dojo.connect(grid,"destroy",this,this._destroyItems);var _9f5=grid.focus;if(_9f5&&_9f5.findAndFocusGridCell){_9f5.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _9f6=function(_9f7){return function(_9f8,_9f9){return this._cellGet(_9f7,_9f8,_9f9);};};var _9fa=dojo.hitch(this,this._cellFormatter),_9fb=[],cols=this._columns,i;for(i=0;i<cols;i++){_9fb.push({field:"cell"+i,get:dojo.hitch(this,_9f6(i)),formatter:_9fa});}var _9fc={cells:[_9fb]};if(this.grouping){var _9fd={field:"groupName",colSpan:cols,get:dojo.hitch(this,this._cellGetGroup),formatter:dojo.hitch(this,this._cellGroupFormatter)};_9fc.cells.push([_9fd]);}var grid=this.grid,_9fe=_9c3.grid.DataGrid.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_9fe)?this._rows:_9fe);grid.set("structure",_9fc);},_setGridData:function(){var _9ff=[];if(this.grouping){this._groupRowIndices=[];var _a00,_a01,cols=this._columns;dojo.forEach(this._flItems,function(_a02,idx){_9ff.push({});var _a03=(idx===0)?0:(_a00+_a01+1);this._groupRowIndices.push(_a03);_a00=_a03;_a01=Math.ceil(_a02.length/cols);_9ff=_9ff.concat(this._getStoreItems(_a02));},this);}else{if(this.featureLayers){dojo.forEach(this._flItems,function(_a04){_9ff=_9ff.concat(_a04);});_9ff=this._getStoreItems(_9ff);}else{_9ff=this._getStoreItems(this._itItems);}}var _a05=new dojo.data.ItemFileReadStore({data:{items:_9ff}});this.grid.setStore(_a05);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=dojo.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=dojo.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=dojo.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){dojo.disconnect(this._mouseOverConnect);dojo.disconnect(this._mouseOutConnect);dojo.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_a06){var _a07=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_a07,row,col);if(!cell){return;}var _a08=this.grid.store;if(_a08.getValue(cell,"loadingCell")){return;}if(this._selectedCell){dojo.removeClass(this._selectedCell,"selectedItem");}if(_a07!==this._selectedCell){dojo.addClass(_a07,"selectedItem");this._selectedCell=_a07;this._selectedItem={featureLayer:_a08.getValue(cell,"layer"),type:_a08.getValue(cell,"type"),template:_a08.getValue(cell,"template"),symbolInfo:_a08.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_a08.getValue(cell,"index1"),index2:_a08.getValue(cell,"index2"),index:_a08.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_a06){this.onSelectionChange();}},_locate:function(_a09,info,_a0a){var _a0b=this.grid.store,cols=new Array(this._columns);var _a0c,_a0d=info.index1,_a0e=info.index2,_a0f=info.index,item=_a09.item;dojo.some(_a0a,function(_a10,_a11){return dojo.some(cols,function(_a12,_a13){var cell=_a0b.getValue(_a10,"cell"+_a13);if(cell&&(item?(_a0f===_a0b.getValue(cell,"index")):(_a0d===_a0b.getValue(cell,"index1")&&_a0e===_a0b.getValue(cell,"index2")))){_a0c=[_a11,_a13];return true;}else{return false;}});});return _a0c;},_getCellInfo:function(_a14,row,col){if(!_a14){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _a15=this.items;if(_a15){return _a15[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _a16=this.tooltip;var _a17=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_a17,row,col);if(_a16&&cell){var _a18=this.grid.store;var _a19=_a18.getValue(cell,"template");var type=_a18.getValue(cell,"type");var _a1a=_a18.getValue(cell,"symbolInfo");var _a1b=_a18.getValue(cell,"layer");var item=this._getItem(cell);var _a1c=(item&&(item.label+(item.description?(": "+item.description):"")))||(_a19&&(_a19.name+(_a19.description?(": "+_a19.description):"")))||(type&&type.name)||(_a1a&&(_a1a.label+(_a1a.description?(": "+_a1a.description):"")))||((_a1b&&_a1b.name+": ")+"Default");_a16.style.display="none";_a16.innerHTML=_a1c;var _a1d=dojo.coords(_a17.firstChild);dojo.style(_a16,{left:(_a1d.x)+"px",top:(_a1d.y+_a1d.h+5)+"px"});_a16.style.display="";}},_cellMouseOut:function(){var _a1e=this.tooltip;if(_a1e){_a1e.style.display="none";}},_destroyItems:function(){var _a1f=this._itemWidgets,w;for(w in _a1f){if(!_a1f[w]){continue;}_a1f[w].destroy();delete _a1f[w];}},_repaintItems:function(){var _a20=this._itemWidgets,w;for(w in _a20){var _a21=_a20[w];if(_a21){_a21._repaint(_a21._surface);}}},_getStoreItems:function(_a22){var uid=this._uniqueId;_a22=dojo.map(_a22,function(item){return dojo.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_a22.length,_a23=0,obj={},k=0,prop,_a24=[],flag=true,cols=this._columns;while(_a23<len){flag=true;prop="cell"+k;obj[prop]=_a22[_a23];_a23++;k++;if(k%cols===0){flag=false;_a24.push(obj);obj={};k=0;}}if(flag&&len){_a24.push(obj);}return _a24;},_getItemsFromLayers:function(_a25){var _a26=[];dojo.forEach(_a25,function(_a27,_a28){_a26.push(this._getItemsFromLayer(_a27,_a28));},this);return _a26;},_getItemsFromLayer:function(_a29,_a2a){var _a2b=[];if(this.useLegend&&dojo.indexOf(this._loadingIndices,_a2a)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_a29,type:null,template:null,index1:_a2a,index2:0,loadingCell:1}];}var _a2c=[];_a2c=_a2c.concat(_a29.templates);dojo.forEach(_a29.types,function(_a2d){var _a2e=_a2d.templates;dojo.forEach(_a2e,function(_a2f){_a2f._type_=_a2d;});_a2c=_a2c.concat(_a2e);});_a2c=dojo.filter(_a2c,esri._isDefined);var _a30=_a29.renderer;if(_a30){var _a31=_a30.declaredClass.replace("esri.renderer.","");if(_a2c.length>0){dojo.forEach(_a2c,function(_a32){var _a33=_a32.prototype;if(_a33){var _a34=_a30.getSymbol(_a33);if(_a34){var _a35=null,pms,_a36;if(this.useLegend&&dojo.indexOf(this._legendIndices,_a2a)>-1){_a36=this._legendSymbols&&this._legendSymbols[_a2a];if(_a36){switch(_a31){case "SimpleRenderer":_a35=_a36.defaultSymbol;break;case "UniqueValueRenderer":dojo.some(_a30.infos,function(info){if(info.symbol===_a34){_a35=_a36[info.value];}return !!_a35;});break;case "ClassBreaksRenderer":dojo.some(_a30.infos,function(info){if(info.symbol===_a34){_a35=_a36[info.maxValue];}return !!_a35;});break;}}if(_a35){pms=dojo.fromJson(dojo.toJson(esri.symbol.defaultPictureMarkerSymbol));pms.url=_a35.url;pms.imageData=_a35.imageData;pms.contentType=_a35.contentType;pms.width=_a35.width;pms.height=_a35.height;if(!esri._isDefined(pms.width)||!esri._isDefined(pms.height)){pms.width=15;pms.height=15;}_a35=new esri.symbol.PictureMarkerSymbol(pms);}}_a2b.push({label:this._trimLabel(_a32.name),symbol:_a35||_a34,legendOverride:!!_a35,layer:_a29,type:_a32._type_,template:_a32,index1:_a2a,index2:_a2b.length});}}delete _a32._type_;},this);}else{var _a37=[];if(_a31==="TemporalRenderer"){_a30=_a30.observationRenderer;if(_a30){_a31=_a30.declaredClass.replace("esri.renderer.","");}}switch(_a31){case "SimpleRenderer":_a37=[{symbol:_a30.symbol,label:_a30.label,description:_a30.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_a37=_a30.infos;break;}_a2b=dojo.map(_a37,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:dojo.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_a29,index1:_a2a,index2:idx};},this);}}return _a2b;},_getItemsFromItems:function(_a38){return dojo.map(_a38,function(item,idx){item=dojo.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_a39){var max=this.maxLabelLength;if(max&&_a39){if(_a39.length>max){_a39=_a39.substr(0,max)+"...";}}return _a39||"";},_cellGet:function(_a3a,_a3b,_a3c){if(!_a3c){return "";}return this.grid.store.getValue(_a3c,"cell"+_a3a);},_cellFormatter:function(_a3d){if(_a3d){var _a3e=this._itemWidgets,_a3f=this.grid.store;var sid=_a3f.getValue(_a3d,"surfaceId");var w=_a3e[sid];if(!w){w=(_a3e[sid]=new esri.dijit.editing.TemplatePickerItem({id:sid,label:_a3f.getValue(_a3d,"label"),symbol:_a3f.getValue(_a3d,"symbol"),legendOverride:_a3f.getValue(_a3d,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_a3f.getValue(_a3d,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_a40,_a41){if(!this._groupRowIndices){return "";}var _a42=dojo.indexOf(this._groupRowIndices,_a40);if(!_a41||_a42===-1){return "";}return (this.featureLayers[_a42]&&this.featureLayers[_a42].name)||"";},_cellGroupFormatter:function(_a43){if(_a43){return "<div class='groupLabel'>"+_a43+"</div>";}else{return "";}}});dojo.declare("esri.dijit.editing.TemplatePickerItem",[_9c2._Widget,_9c2._Templated],{templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_a44,_a45,_a46,_a47){if(!_a44){return;}var _a48=_9c3.gfx.createSurface(node,_a45,_a46);if(dojo.isIE<9){var _a49=_a48.getEventSource();dojo.style(_a49,"position","relative");dojo.style(_a49.parentNode,"position","relative");}var _a4a=(!this.legendOverride&&this._getDrawingToolShape(_a44,_a47))||esri.symbol.getShapeDescriptors(_a44);var _a4b;try{_a4b=_a48.createShape(_a4a.defaultShape).setFill(_a4a.fill).setStroke(_a4a.stroke);}catch(e){_a48.clear();_a48.destroy();return;}var dim=_a48.getDimensions();var _a4c={dx:dim.width/2,dy:dim.height/2};var bbox=_a4b.getBoundingBox(),_a4d=bbox.width,_a4e=bbox.height;if(_a4d>_a45||_a4e>_a46){var _a4f=_a4d>_a4e?_a4d:_a4e;var _a50=_a45<_a46?_a45:_a46;var _a51=(_a50-5)/_a4f;dojo.mixin(_a4c,{xx:_a51,yy:_a51});}_a4b.applyTransform(_a4c);return _a48;},_getDrawingToolShape:function(_a52,_a53){var _a54,_a55=_a53?_a53.drawingTool||null:null;switch(_a55){case "esriFeatureEditToolArrow":_a54={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_a54={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_a54={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_a54={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_a54={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_a54={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_a54={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_a54={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_a54={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_a52.type==="simplelinesymbol"||_a52.type==="cartographiclinesymbol"){_a54={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_a54={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_a54,fill:_a52.getFill(),stroke:_a52.getStroke()};},_repaint:function(_a56){if(!_a56){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_a56.getStroke&&_a56.setStroke){_a56.setStroke(_a56.getStroke());}if(_a56.getFill&&_a56.setFill){_a56.setFill(_a56.getFill());}if(_a56.children&&dojo.isArray(_a56.children)){dojo.forEach(_a56.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});});},"dijit/_editor/range":function(){define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","../main"],function(_a57,_a58,lang,win,_a59){_a59.range={};_a59.range.getIndex=function(node,_a5a){var ret=[],retR=[];var _a5b=node;var _a5c,n;while(node!=_a5a){var i=0;_a5c=node.parentNode;while((n=_a5c.childNodes[i++])){if(n===node){--i;break;}}ret.unshift(i);retR.unshift(i-_a5c.childNodes.length);node=_a5c;}if(ret.length>0&&_a5b.nodeType==3){n=_a5b.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=_a5b.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};_a59.range.getNode=function(_a5d,_a5e){if(!lang.isArray(_a5d)||_a5d.length==0){return _a5e;}var node=_a5e;_a57.every(_a5d,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;return false;}return true;});return node;};_a59.range.getCommonAncestor=function(n1,n2,root){root=root||n1.ownerDocument.body;var _a5f=function(n){var as=[];while(n){as.unshift(n);if(n!==root){n=n.parentNode;}else{break;}}return as;};var n1as=_a5f(n1);var n2as=_a5f(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};_a59.range.getAncestor=function(node,_a60,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(_a60.test(name)){return node;}node=node.parentNode;}return null;};_a59.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;_a59.range.getBlockAncestor=function(node,_a61,root){root=root||node.ownerDocument.body;_a61=_a61||_a59.range.BlockTagNames;var _a62=null,_a63;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!_a62&&_a61.test(name)){_a62=node;}if(!_a63&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_a63=node;}node=node.parentNode;}return {blockNode:_a62,blockContainer:_a63||node.ownerDocument.body};};_a59.range.atBeginningOfContainer=function(_a64,node,_a65){var _a66=false;var _a67=(_a65==0);if(!_a67&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(0,_a65))){_a67=true;}}if(_a67){var _a68=node;_a66=true;while(_a68&&_a68!==_a64){if(_a68.previousSibling){_a66=false;break;}_a68=_a68.parentNode;}}return _a66;};_a59.range.atEndOfContainer=function(_a69,node,_a6a){var _a6b=false;var _a6c=(_a6a==(node.length||node.childNodes.length));if(!_a6c&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(_a6a))){_a6c=true;}}if(_a6c){var _a6d=node;_a6b=true;while(_a6d&&_a6d!==_a69){if(_a6d.nextSibling){_a6b=false;break;}_a6d=_a6d.parentNode;}}return _a6b;};_a59.range.adjacentNoneTextNode=function(_a6e,next){var node=_a6e;var len=(0-_a6e.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};_a59.range.create=function(win){win=win||window;if(win.getSelection){return win.document.createRange();}else{return new _a59.range.W3CRange();}};_a59.range.getSelection=function(_a6f,_a70){if(_a6f.getSelection){return _a6f.getSelection();}else{var s=new _a59.range.ie.selection(_a6f);if(!_a70){s._getCurrentSelection();}return s;}};if(!window.getSelection){_a59.range.ie={cachedSelection:{},selection:function(_a71){this._ranges=[];this.addRange=function(r,_a72){this._ranges.push(r);if(!_a72){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _a73=function(){var r=_a71.document.selection.createRange();var type=_a71.document.selection.type.toUpperCase();if(type=="CONTROL"){return new _a59.range.W3CRange(_a59.range.ie.decomposeControlRange(r));}else{return new _a59.range.W3CRange(_a59.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_a73();if(r){this.addRange(r,true);this.isCollapsed=r.collapsed;}else{this.isCollapsed=true;}};},decomposeControlRange:function(_a74){var _a75=_a74.item(0),_a76=_a74.item(_a74.length-1);var _a77=_a75.parentNode,_a78=_a76.parentNode;var _a79=_a59.range.getIndex(_a75,_a77).o[0];var _a7a=_a59.range.getIndex(_a76,_a78).o[0]+1;return [_a77,_a79,_a78,_a7a];},getEndPoint:function(_a7b,end){var _a7c=_a7b.duplicate();_a7c.collapse(!end);var _a7d="EndTo"+(end?"End":"Start");var _a7e=_a7c.parentElement();var _a7f,_a80,_a81;if(_a7e.childNodes.length>0){_a57.every(_a7e.childNodes,function(node,i){var _a82;if(node.nodeType!=3){_a7c.moveToElementText(node);if(_a7c.compareEndPoints(_a7d,_a7b)>0){if(_a81&&_a81.nodeType==3){_a7f=_a81;_a82=true;}else{_a7f=_a7e;_a80=i;return false;}}else{if(i==_a7e.childNodes.length-1){_a7f=_a7e;_a80=_a7e.childNodes.length;return false;}}}else{if(i==_a7e.childNodes.length-1){_a7f=node;_a82=true;}}if(_a82&&_a7f){var _a83=_a59.range.adjacentNoneTextNode(_a7f)[0];if(_a83){_a7f=_a83.nextSibling;}else{_a7f=_a7e.firstChild;}var _a84=_a59.range.adjacentNoneTextNode(_a7f);_a83=_a84[0];var _a85=_a84[1];if(_a83){_a7c.moveToElementText(_a83);_a7c.collapse(false);}else{_a7c.moveToElementText(_a7e);}_a7c.setEndPoint(_a7d,_a7b);_a80=_a7c.text.length-_a85;return false;}_a81=node;return true;});}else{_a7f=_a7e;_a80=0;}if(!end&&_a7f.nodeType==1&&_a80==_a7f.childNodes.length){var _a86=_a7f.nextSibling;if(_a86&&_a86.nodeType==3){_a7f=_a86;_a80=0;}}return [_a7f,_a80];},setEndPoint:function(_a87,_a88,_a89){var _a8a=_a87.duplicate(),node,len;if(_a88.nodeType!=3){if(_a89>0){node=_a88.childNodes[_a89-1];if(node){if(node.nodeType==3){_a88=node;_a89=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_a88=node.nextSibling;_a89=0;}else{_a8a.moveToElementText(node.nextSibling?node:_a88);var _a8b=node.parentNode;var _a8c=_a8b.insertBefore(node.ownerDocument.createTextNode(" "),node.nextSibling);_a8a.collapse(false);_a8b.removeChild(_a8c);}}}}else{_a8a.moveToElementText(_a88);_a8a.collapse(true);}}if(_a88.nodeType==3){var _a8d=_a59.range.adjacentNoneTextNode(_a88);var _a8e=_a8d[0];len=_a8d[1];if(_a8e){_a8a.moveToElementText(_a8e);_a8a.collapse(false);if(_a8e.contentEditable!="inherit"){len++;}}else{_a8a.moveToElementText(_a88.parentNode);_a8a.collapse(true);_a8a.move("character",1);_a8a.move("character",-1);}_a89+=len;if(_a89>0){if(_a8a.move("character",_a89)!=_a89){console.error("Error when moving!");}}}return _a8a;},decomposeTextRange:function(_a8f){var _a90=_a59.range.ie.getEndPoint(_a8f);var _a91=_a90[0],_a92=_a90[1];var _a93=_a90[0],_a94=_a90[1];if(_a8f.htmlText.length){if(_a8f.htmlText==_a8f.text){_a94=_a92+_a8f.text.length;}else{_a90=_a59.range.ie.getEndPoint(_a8f,true);_a93=_a90[0],_a94=_a90[1];}}return [_a91,_a92,_a93,_a94];},setRange:function(_a95,_a96,_a97,_a98,_a99,_a9a){var _a9b=_a59.range.ie.setEndPoint(_a95,_a96,_a97);_a95.setEndPoint("StartToStart",_a9b);if(!_a9a){var end=_a59.range.ie.setEndPoint(_a95,_a98,_a99);}_a95.setEndPoint("EndToEnd",end||_a9b);return _a95;}};_a58("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=_a59.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_a9c){_a9c=parseInt(_a9c);if(this.startContainer===node&&this.startOffset==_a9c){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_a9c;if(!this.endContainer){this.setEnd(node,_a9c);}else{this._updateInternal();}},setEnd:function(node,_a9d){_a9d=parseInt(_a9d);if(this.endContainer===node&&this.endOffset==_a9d){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_a9d;if(!this.startContainer){this.setStart(node,_a9d);}else{this._updateInternal();}},setStartAfter:function(node,_a9e){this._setPoint("setStart",node,_a9e,1);},setStartBefore:function(node,_a9f){this._setPoint("setStart",node,_a9f,0);},setEndAfter:function(node,_aa0){this._setPoint("setEnd",node,_aa0,1);},setEndBefore:function(node,_aa1){this._setPoint("setEnd",node,_aa1,0);},_setPoint:function(what,node,_aa2,ext){var _aa3=_a59.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,_aa3.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();_a59.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var s=this.startContainer,r=this._getIERange();if(s.nodeType===3&&!this.startOffset){this.setStartBefore(s);}r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new _a59.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}return _a59.range;});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(_aa4,lang,_aa5){var _aa6=function(_aa7){if(!_aa7){return _aa7;}if(_aa7.then){_aa7=lang.delegate(_aa7);}function _aa8(_aa9){if(!_aa7[_aa9]){_aa7[_aa9]=function(){var args=arguments;return _aa5.when(_aa7,function(_aaa){Array.prototype.unshift.call(args,_aaa);return _aa6(_aa4[_aa9].apply(_aa4,args));});};}};_aa8("forEach");_aa8("filter");_aa8("map");if(!_aa7.total){_aa7.total=_aa5.when(_aa7,function(_aab){return _aab.length;});}return _aa7;};lang.setObject("dojo.store.util.QueryResults",_aa6);return _aa6;});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/on","dojo/window"],function(_aac,on,_aad){return _aac("dijit.form._ListBase",null,{selected:null,_listConnect:function(_aae,_aaf){var self=this;return self.own(on(self.containerNode,on.selector(function(_ab0,_ab1,_ab2){return _ab0.parentNode==_ab2;},_aae),function(evt){evt.preventDefault();self[_aaf](evt,this);}));},selectFirstNode:function(){var _ab3=this.containerNode.firstChild;while(_ab3&&_ab3.style.display=="none"){_ab3=_ab3.nextSibling;}this._setSelectedAttr(_ab3);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _ab4=this.selected;if(!_ab4){this.selectFirstNode();}else{var next=_ab4.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _ab5=this.selected;if(!_ab5){this.selectLastNode();}else{var prev=_ab5.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _ab6=this.selected;if(_ab6){this.onDeselect(_ab6);this.selected=null;}if(node){this.selected=node;_aad.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}}});});},"esri/dijit/editing/tools/AdvancedTools":function(){define(["dijit","dojo","dojox","dojo/require!esri/dijit/editing/tools/ToggleToolBase,esri/dijit/editing/tools/ButtonToolBase"],function(_ab7,dojo,_ab8){dojo.require("esri.dijit.editing.tools.ToggleToolBase");dojo.require("esri.dijit.editing.tools.ButtonToolBase");dojo.provide("esri.dijit.editing.tools.AdvancedTools");dojo.declare("esri.dijit.editing.tools.Cut",[esri.dijit.editing.tools.ToggleToolBase],{id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:esri.toolbars.Draw.POLYLINE,_enabled:true,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(dojo.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments);},deactivate:function(){this.inherited(arguments);dojo.forEach(this._cutConnects,"dojo.disconnect(item);");this._cutConnects=[];this._edits=[];},_onDrawEnd:function(_ab9){var _aba=this._settings.layers;var _abb=this._cutLayers=dojo.filter(_aba,function(_abc){return ((_abc.geometryType==="esriGeometryPolygon")||(_abc.geometryType==="esriGeometryPolyline")&&_abc.visible&&_abc._isMapAtVisibleScale());});this._cutConnects=this._cutConnects.concat(dojo.map(_abb,dojo.hitch(this,function(_abd){return dojo.connect(_abd,"onEditsComplete",dojo.hitch(this,function(adds,_abe,_abf){if(this._settings.undoRedoManager){var _ac0=this._settings.undoRedoManager;dojo.forEach(this._edits,dojo.hitch(this,function(edit){_ac0.add(new esri.dijit.editing.Cut({featureLayer:edit.layer,addedGraphics:edit.adds,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this.onFinished();}));})));var _ac1=new esri.tasks.Query();_ac1.geometry=_ab9;dojo.forEach(_abb,function(_ac2,idx){this._settings.editor._selectionHelper.selectFeatures([_ac2],_ac1,esri.layers.FeatureLayer.SELECTION_NEW,dojo.hitch(this,"_cutFeatures",_ac2,_ac1));},this);},_cutFeatures:function(_ac3,_ac4,_ac5){if(!_ac5||!_ac5.length){return;}this._edits=[];var _ac6=[];_ac6.push(this._settings.geometryService.cut(esri.getGeometries(_ac5),_ac4.geometry,dojo.hitch(this,"_cutHandler",_ac3,_ac5)));var _ac7=new dojo.DeferredList(_ac6).addCallback(dojo.hitch(this,function(){this.onApplyEdits(this._edits);}));},_cutHandler:function(_ac8,_ac9,_aca){var _acb=[];var _acc=[];var _acd=dojo.map(_ac9,"return new esri.Graphic(dojo.clone(item.toJson()))");var _ace;var _acf;dojo.forEach(_aca.cutIndexes,function(_ad0,i){if(_ace!=_ad0){_ace=_ad0;_acc.push(_ac9[_ad0].setGeometry(_aca.geometries[i]));}else{_acf=new esri.Graphic(_aca.geometries[i],null,dojo.mixin({},_ac9[_ad0].attributes),null);_acf.attributes[_ac9[0].getLayer().objectIdField]=null;_acb.push(_acf);}},this);this._edits.push({layer:_ac8,adds:_acb,updates:_acc,preUpdates:_acd});}});dojo.declare("esri.dijit.editing.tools.Reshape",[esri.dijit.editing.tools.ToggleToolBase],{id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:esri.toolbars.Draw.POLYLINE,_enabled:true,_label:"NLS_reshapeLbl",activate:function(){dojo.disconnect(this._rConnect);this._rConnect=dojo.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments);},deactivate:function(){this.inherited(arguments);dojo.disconnect(this._rConnect);delete this._rConnect;},_onDrawEnd:function(_ad1){var _ad2=this._settings.layers;var _ad3=new esri.tasks.Query();_ad3.geometry=_ad1;var _ad4=this._reshapeLayers=dojo.filter(_ad2,function(_ad5){return (_ad5.geometryType==="esriGeometryPolygon"||"esriGeometryPolyline");});this._settings.editor._selectionHelper.selectFeatures(_ad4,_ad3,esri.layers.FeatureLayer.SELECTION_NEW,dojo.hitch(this,"_reshape",_ad3));},_reshape:function(_ad6,_ad7){var _ad8=[];var _ad9=_ad7;if(_ad9.length!==1){return;}this._settings.geometryService.reshape(_ad9[0].geometry,_ad6.geometry,dojo.hitch(this,function(_ada){var _adb=[_ad9[0].setGeometry(_ada)];this.onApplyEdits([{layer:_ad9[0].getLayer(),updates:_adb}],dojo.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}));}});dojo.declare("esri.dijit.editing.tools.Union",[esri.dijit.editing.tools.ButtonToolBase],{id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:esri.toolbars.Draw.POLYLINE,_enabled:true,_label:"NLS_unionLbl",_onClick:function(evt){this._settings.editor._activeTool="UNION";var _adc=this._settings.layers;var _add=dojo.filter(_adc,"return (item.geometryType === 'esriGeometryPolygon') && (item.visible && item._isMapAtVisibleScale());");var _ade=[];var _adf=0;dojo.forEach(_add,function(_ae0,idx){var _ae1=_ae0.getSelectedFeatures();if(_ae1.length>=2){_adf++;var _ae2=dojo.map(_ae1,"return new esri.Graphic(dojo.clone(item.toJson()))");this._settings.geometryService.union(esri.getGeometries(_ae1),dojo.hitch(this,function(_ae3){var _ae4=[_ae1.pop().setGeometry(_ae3)];_ade.push({layer:_ae0,updates:_ae4,deletes:_ae1,preUpdates:_ae2});_adf--;if(_adf<=0){this.onApplyEdits(_ade,dojo.hitch(this,function(){if(this._settings.undoRedoManager){var _ae5=this._settings.undoRedoManager;dojo.forEach(this._edits,dojo.hitch(this,function(edit){_ae5.add(new esri.dijit.editing.Union({featureLayer:edit.layer,addedGraphics:edit.deletes,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}}));}},this);}});});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_ae6,_ae7){dojo.DeferredList=function(list,_ae8,_ae9,_aea,_aeb){var _aec=[];_ae6.call(this);var self=this;if(list.length===0&&!_ae8){this.resolve([0,[]]);}var _aed=0;_ae7.forEach(list,function(item,i){item.then(function(_aee){if(_ae8){self.resolve([i,_aee]);}else{_aef(true,_aee);}},function(_af0){if(_ae9){self.reject(_af0);}else{_aef(false,_af0);}if(_aea){return null;}throw _af0;});function _aef(_af1,_af2){_aec[i]=[_af1,_af2];_aed++;if(_aed===list.length){self.resolve(_aec);}};});};dojo.DeferredList.prototype=new _ae6();dojo.DeferredList.prototype.gatherResults=function(_af3){var d=new dojo.DeferredList(_af3,false,true,false);d.addCallback(function(_af4){var ret=[];_ae7.forEach(_af4,function(_af5){ret.push(_af5[1]);});return ret;});return d;};return dojo.DeferredList;});},"dijit/CalendarLite":function(){require({cache:{"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n"}});define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/date/stamp","dojo/dom","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/sniff","dojo/string","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html","./hccss"],function(_af6,_af7,_af8,date,_af9,_afa,dom,_afb,_afc,lang,has,_afd,_afe,_aff,_b00){var _b01=_af7("dijit.CalendarLite",[_afe,_aff],{templateString:_b00,dowTemplateString:"<th class=\"dijitReset dijitCalendarDayLabelTemplate\" role=\"columnheader\"><span class=\"dijitCalendarDayLabel\">${d}</span></th>",dateTemplateString:"<td class=\"dijitReset\" role=\"gridcell\" data-dojo-attach-point=\"dateCells\"><span class=\"dijitCalendarDateLabel\" data-dojo-attach-point=\"dateLabels\"></span></td>",weekTemplateString:"<tr class=\"dijitReset dijitCalendarWeekTemplate\" role=\"row\">${d}${d}${d}${d}${d}${d}${d}</tr>",value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",_isValidDate:function(_b02){return _b02&&!isNaN(_b02)&&typeof _b02=="object"&&_b02.toString()!=this.constructor.prototype.value.toString();},_getValueAttr:function(){if(this.value&&!isNaN(this.value)){var _b03=new this.dateClassObj(this.value);_b03.setHours(0,0,0,0);if(_b03.getDate()<this.value.getDate()){_b03=this.dateModule.add(_b03,"hour",1);}return _b03;}else{return null;}},_setValueAttr:function(_b04,_b05){if(typeof _b04=="string"){_b04=_afa.fromISOString(_b04);}_b04=this._patchDate(_b04);if(this._isValidDate(_b04)&&!this.isDisabledDate(_b04,this.lang)){this._set("value",_b04);this.set("currentFocus",_b04);this._markSelectedDates([_b04]);if(this._created&&(_b05||typeof _b05=="undefined")){this.onChange(this.get("value"));}}else{this._set("value",null);this._markSelectedDates([]);}},_patchDate:function(_b06){if(_b06){_b06=new this.dateClassObj(_b06);_b06.setHours(1,0,0,0);}return _b06;},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(node.ownerDocument.createTextNode(text));},_populateGrid:function(){var _b07=new this.dateClassObj(this.currentFocus);_b07.setDate(1);var _b08=_b07.getDay(),_b09=this.dateModule.getDaysInMonth(_b07),_b0a=this.dateModule.getDaysInMonth(this.dateModule.add(_b07,"month",-1)),_b0b=new this.dateClassObj(),_b0c=_af8.getFirstDayOfWeek(this.lang);if(_b0c>_b08){_b0c-=7;}this._date2cell={};_af6.forEach(this.dateCells,function(_b0d,idx){var i=idx+_b0c;var date=new this.dateClassObj(_b07),_b0e,_b0f="dijitCalendar",adj=0;if(i<_b08){_b0e=_b0a-_b08+i+1;adj=-1;_b0f+="Previous";}else{if(i>=(_b08+_b09)){_b0e=i-_b08-_b09+1;adj=1;_b0f+="Next";}else{_b0e=i-_b08+1;_b0f+="Current";}}if(adj){date=this.dateModule.add(date,"month",adj);}date.setDate(_b0e);if(!this.dateModule.compare(date,_b0b,"date")){_b0f="dijitCalendarCurrentDate "+_b0f;}if(this.isDisabledDate(date,this.lang)){_b0f="dijitCalendarDisabledDate "+_b0f;_b0d.setAttribute("aria-disabled","true");}else{_b0f="dijitCalendarEnabledDate "+_b0f;_b0d.removeAttribute("aria-disabled");_b0d.setAttribute("aria-selected","false");}var _b10=this.getClassForDate(date,this.lang);if(_b10){_b0f=_b10+" "+_b0f;}_b0d.className=_b0f+"Month dijitCalendarDateTemplate";var _b11=date.valueOf();this._date2cell[_b11]=_b0d;_b0d.dijitDateValue=_b11;this._setText(this.dateLabels[idx],date.getDateLocalized?date.getDateLocalized(this.lang):date.getDate());},this);},_populateControls:function(){var _b12=new this.dateClassObj(this.currentFocus);_b12.setDate(1);this.monthWidget.set("month",_b12);var y=_b12.getFullYear()-1;var d=new this.dateClassObj();_af6.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(_b13){this.dateModule=_b13.datePackage?lang.getObject(_b13.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_b13.datePackage?lang.getObject(_b13.datePackage+".locale",false):_af9;},_createMonthWidget:function(){return _b01._MonthWidget({id:this.id+"_mw",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){var d=this.dowTemplateString,_b14=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),_b15=_af8.getFirstDayOfWeek(this.lang);this.dayCellsHtml=_afd.substitute([d,d,d,d,d,d,d].join(""),{d:""},function(){return _b14[_b15++%7];});var r=_afd.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[r,r,r,r,r,r].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);dom.setSelectable(this.domNode,false);var _b16=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",_b16,false);},postCreate:function(){this.inherited(arguments);this._connectControls();},_connectControls:function(){var _b17=lang.hitch(this,function(_b18,part,_b19){this.connect(this[_b18],"onclick",function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,part,_b19));});});_b17("incrementMonth","month",1);_b17("decrementMonth","month",-1);_b17("nextYearLabelNode","year",1);_b17("previousYearLabelNode","year",-1);},_setCurrentFocusAttr:function(date,_b1a){var _b1b=this.currentFocus,_b1c=this._getNodeByDate(_b1b);date=this._patchDate(date);this._set("currentFocus",date);if(!this._date2cell||this.dateModule.difference(_b1b,date,"month")!=0){this._populateGrid();this._populateControls();this._markSelectedDates([this.value]);}var _b1d=this._getNodeByDate(date);_b1d.setAttribute("tabIndex",this.tabIndex);if(this.focused||_b1a){_b1d.focus();}if(_b1c&&_b1c!=_b1d){if(has("webkit")){_b1c.setAttribute("tabIndex","-1");}else{_b1c.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onDayClick:function(evt){_afc.stop(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!_afb.contains(node,"dijitCalendarDisabledDate")){this.set("value",node.dijitDateValue);}},_getNodeByDate:function(_b1e){_b1e=this._patchDate(_b1e);return _b1e&&this._date2cell?this._date2cell[_b1e.valueOf()]:null;},_markSelectedDates:function(_b1f){function mark(_b20,cell){_afb.toggle(cell,"dijitCalendarSelectedDate",_b20);cell.setAttribute("aria-selected",_b20?"true":"false");};_af6.forEach(this._selectedCells||[],lang.partial(mark,false));this._selectedCells=_af6.filter(_af6.map(_b1f,this._getNodeByDate,this),function(n){return n;});_af6.forEach(this._selectedCells,lang.partial(mark,true));},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});_b01._MonthWidget=_af7("dijit.CalendarLite._MonthWidget",_afe,{_setMonthAttr:function(_b21){var _b22=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_b21),_b23=(has("ie")==6?"":"<div class='dijitSpacer'>"+_af6.map(_b22,function(s){return "<div>"+s+"</div>";}).join("")+"</div>");this.domNode.innerHTML=_b23+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_b22[_b21.getMonth()]+"</div>";}});return _b01;});},"dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_b24,_b25,_b26,has){return _b25("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_b27){var i=_b27;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_b27);this.edit.styleRow(_b27);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _b28;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_b28=this.focus.getHeaderIndex();if(_b28>=0){this.setSortIndex(_b28);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_b26.stop(e);}if(!e.shiftKey){var _b29=this.edit.isEditing();this.edit.apply();if(!_b29){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _b2a=this.focus.focusView||this.views.views[0];_b2a.content.decorateEvent(e);this.onRowClick(e);_b26.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_b28=this.focus.getHeaderIndex();if(_b28>=0){this.setSortIndex(_b28);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_b26.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _b2b=e.keyCode;_b26.stop(e);_b28=this.focus.getHeaderIndex();if(_b28>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_b28,(_b2b==keys.LEFT_ARROW?-1:1)*5);}else{var _b2c=(_b2b==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_b2c*=-1;}this.focus.move(0,_b2c);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_b26.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_b26.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_b26.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_b26.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_b24.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_b24.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _b2d;if(this._click.length>1&&has("ie")){_b2d=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_b2d=this._click[0];}else{_b2d=e;}}this.focus.setFocusCell(_b2d.cell,_b2d.rowIndex);this.onRowClick(_b2d);this.edit.setEditCell(_b2d.cell,_b2d.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_b2e,_b2f){this.edit.cellFocus(_b2e,_b2f);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_b26.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_b24.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_b24.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_b26.stop(e);}},onStartEdit:function(_b30,_b31){},onApplyCellEdit:function(_b32,_b33,_b34){},onCancelEdit:function(_b35){},onApplyEdit:function(_b36){},onCanSelect:function(_b37){return true;},onCanDeselect:function(_b38){return true;},onSelected:function(_b39){this.updateRowStyles(_b39);},onDeselected:function(_b3a){this.updateRowStyles(_b3a);},onSelectionChanged:function(){}});});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_b3b,_b3c,_b3d,_b3e){return _b3b("dijit.CheckedMenuItem",_b3d,{templateString:_b3e,checked:false,_setCheckedAttr:function(_b3f){_b3c.toggle(this.domNode,"dijitCheckedMenuItemChecked",_b3f);this.domNode.setAttribute("aria-checked",_b3f?"true":"false");this._set("checked",_b3f);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"dojo/io/iframe":function(){define(["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(_b40,json,_b41,lang,xhr,has,win,dom,_b42,_b43,_b44,_b45,_b46){dojo.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var mid=_b46._iframeName;mid=mid.substring(0,mid.lastIndexOf("_"));var _b47=lang.delegate(_b46,{create:function(){return _b47._frame=_b46.create.apply(_b46,arguments);},get:null,post:null,send:function(args){var rDfd;var dfd=xhr._ioSetArgs(args,function(dfd){rDfd&&rDfd.cancel();},function(dfd){var _b48=null,_b49=dfd.ioArgs;try{var _b4a=_b49.handleAs;if(_b4a==="xml"||_b4a==="html"){_b48=rDfd.response.data;}else{_b48=rDfd.response.text;if(_b4a==="json"){_b48=json.fromJson(_b48);}else{if(_b4a==="javascript"){_b48=_b41.eval(_b48);}}}}catch(e){_b48=e;}return _b48;},function(_b4b,dfd){dfd.ioArgs._hasError=true;return _b4b;});var _b4c=dfd.ioArgs;var _b4d="GET",form=dojo.byId(args.form);if(args.method&&args.method.toUpperCase()==="POST"&&form){_b4d="POST";}var _b4e={method:_b4d,handleAs:args.handleAs==="json"||args.handleAs==="javascript"?"text":args.handleAs,form:args.form,query:form?null:args.content,data:form?args.content:null,timeout:args.timeout,ioArgs:_b4c};if(_b4e.method){_b4e.method=_b4e.method.toUpperCase();}if(_b40.ioPublish&&_b41.publish&&_b4c.args.ioPublish!==false){var _b4f=_b45.after(_b46,"_notifyStart",function(data){if(data.options.ioArgs===_b4c){_b4f.remove();xhr._ioNotifyStart(dfd);}},true);}rDfd=_b46(_b4c.url,_b4e,true);_b4c._callNext=rDfd._callNext;rDfd.then(function(){dfd.resolve(dfd);}).otherwise(function(_b50){dfd.ioArgs.error=_b50;dfd.reject(_b50);});return dfd;},_iframeOnload:win.global[mid+"_onload"]});lang.setObject("dojo.io.iframe",_b47);return _b47;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_b51,on,_b52,_b53){return _b51("dojox.gfx.Mover",null,{constructor:function(_b54,e,host){this.shape=_b54;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_b55=on(d,_b52.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_b52.move,lang.hitch(this,"onMouseMove")),on(d,_b52.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_b53,"stop")),on(d,"selectstart",lang.hitch(_b53,"stop")),_b55];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_b53.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(h){h.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_b56,lang,dom){var dgu=lang.getObject("grid.util",true,_b56);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_b57,_b58){if(_b58>=0){var s=_b57.style;var v=_b58+"px";if(_b57&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_b59,_b5a,_b5b,_b5c){var evts=(_b5c?_b5c:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_b5a.connect(_b59,"on"+evts[i],_b5b);}};dgu.removeNode=function(_b5d){_b5d=dom.byId(_b5d);_b5d&&_b5d.parentNode&&_b5d.parentNode.removeChild(_b5d);return _b5d;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_b5e,_b5f,_b60){if(_b5e.length<=_b5f){_b5e[_b5f]=_b60;}else{_b5e.splice(_b5f,0,_b60);}};dgu.arrayRemove=function(_b61,_b62){_b61.splice(_b62,1);};dgu.arraySwap=function(_b63,inI,inJ){var _b64=_b63[inI];_b63[inI]=_b63[inJ];_b63[inJ]=_b64;};return dgu;});},"dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_b65,_b66,_b67,keys,_b68,_b69,_b6a,_b6b){return _b65("dijit.form._ComboBoxMenu",[_b68,_b69,_b6b,_b6a],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_b66.add(this.previousButton,"dijitMenuItemRtl");_b66.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){var item=this.ownerDocument.createElement("div");item.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");item.setAttribute("role","option");return item;},onHover:function(node){_b66.add(node,"dijitMenuItemHover");},onUnhover:function(node){_b66.remove(node,"dijitMenuItemHover");},onSelect:function(node){_b66.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_b66.remove(node,"dijitMenuItemSelected");},_page:function(up){var _b6c=0;var _b6d=this.domNode.scrollTop;var _b6e=_b67.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_b6c<_b6e){var _b6f=this.getHighlightedOption();if(up){if(!_b6f.previousSibling||_b6f.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_b6f.nextSibling||_b6f.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _b70=this.domNode.scrollTop;_b6c+=(_b70-_b6d)*(up?-1:1);_b6d=_b70;}},handleKey:function(evt){switch(evt.keyCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_b71,lang,_b72,_b73,_b74,has,dom,_b75,_b76,_b77,util){var _b78=_b71("dojox.grid._DeferredTextWidget",_b77,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _b79=function(_b7a){try{util.fire(_b7a,"focus");util.fire(_b7a,"select");}catch(e){}};var _b7b=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _b7c=_b71("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_b7d){this._props=_b7d||{};lang.mixin(this,_b7d);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_b7e,_b7f){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_b7e!=this.defaultValue&&f)?f.apply(s,_b7f):_b7e;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _b78({deferred:v},_b76.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_b80,_b81){var f,i=this.grid.edit.info,d=this.get?this.get(_b80,_b81):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_b80&&i.cell==this))){return this.formatEditing(d,_b80);}else{return this._defaultFormat(d,[d,_b80,this]);}},formatEditing:function(_b82,_b83){},getNode:function(_b84){return this.view.getCellNode(_b84,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_b85){return (this.getNode(_b85)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_b86,_b87){if(this.getNode(_b87)){this.grid.edit.applyCellEdit(_b86,this,_b87);}},cancelEdit:function(_b88){this.grid.doCancelEdit(_b88);},_onEditBlur:function(_b89){if(this.grid.edit.isEditCell(_b89,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_b8a,_b8b){if(this.commitOnBlur){_b73.connect(_b8a,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_b8b),250);});}},needFormatNode:function(_b8c,_b8d){this._formatPending=true;_b7b(this,"_formatNode",_b8c,_b8d);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_b8e,_b8f){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_b8f),_b8e,_b8f);}},formatNode:function(_b90,_b91,_b92){if(has("ie")){_b7b(this,"focus",_b92,_b90);}else{this.focus(_b92,_b90);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_b93){return this.getEditNode(_b93)[this._valueProp];},setValue:function(_b94,_b95){var n=this.getEditNode(_b94);if(n){n[this._valueProp]=_b95;}},focus:function(_b96,_b97){_b79(_b97||this.getEditNode(_b96));},save:function(_b98){this.value=this.value||this.getValue(_b98);},restore:function(_b99){this.setValue(_b99,this.value);},_finish:function(_b9a){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_b9b){this.applyEdit(this.getValue(_b9b),_b9b);this._finish(_b9b);},cancel:function(_b9c){this.cancelEdit(_b9c);this._finish(_b9c);}});_b7c.markupFactory=function(node,_b9d){var _b9e=lang.trim(_b75.get(node,"formatter")||"");if(_b9e){_b9d.formatter=lang.getObject(_b9e)||_b9e;}var get=lang.trim(_b75.get(node,"get")||"");if(get){_b9d.get=lang.getObject(get);}var _b9f=function(attr,cell,_ba0){var _ba1=lang.trim(_b75.get(node,attr)||"");if(_ba1){cell[_ba0||attr]=!(_ba1.toLowerCase()=="false");}};_b9f("sortDesc",_b9d);_b9f("editable",_b9d);_b9f("alwaysEditing",_b9d);_b9f("noresize",_b9d);_b9f("draggable",_b9d);var _ba2=lang.trim(_b75.get(node,"loadingText")||_b75.get(node,"defaultValue")||"");if(_ba2){_b9d.defaultValue=_ba2;}var _ba3=function(attr,cell,_ba4){var _ba5=lang.trim(_b75.get(node,attr)||"")||undefined;if(_ba5){cell[_ba4||attr]=_ba5;}};_ba3("styles",_b9d);_ba3("headerStyles",_b9d);_ba3("cellStyles",_b9d);_ba3("classes",_b9d);_ba3("headerClasses",_b9d);_ba3("cellClasses",_b9d);};var Cell=_b71("dojox.grid.cells.Cell",_b7c,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_ba6,_ba7){this.needFormatNode(_ba6,_ba7);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_ba6+"\">";},formatNode:function(_ba8,_ba9,_baa){this.inherited(arguments);this.registerOnBlur(_ba8,_baa);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_b72.stop(e);}}},_finish:function(_bab){this.inherited(arguments);var n=this.getEditNode(_bab);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_bac){_b7c.markupFactory(node,_bac);var _bad=lang.trim(_b75.get(node,"keyFilter")||"");if(_bad){_bac.keyFilter=new RegExp(_bad);}};var _bae=_b71("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_baf){return _baf+1;}});_bae.markupFactory=function(node,_bb0){Cell.markupFactory(node,_bb0);};var _bb1=_b71("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_bb2){this.values=this.values||this.options;},formatEditing:function(_bb3,_bb4){this.needFormatNode(_bb3,_bb4);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_bb3==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_bb5,_bb6){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_b74.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_bb7){var n=this.getEditNode(_bb7);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_bb1.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _bb8=lang.trim(_b75.get(node,"options")||"");if(_bb8){var o=_bb8.split(",");if(o[0]!=_bb8){cell.options=o;}}var _bb9=lang.trim(_b75.get(node,"values")||"");if(_bb9){var v=_bb9.split(",");if(v[0]!=_bb9){cell.values=v;}}};var _bba=_b71("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_bbb,_bbc){this.formatNode(this.getEditNode(_bbc),_bbb,_bbc);},applyStaticValue:function(_bbd){var e=this.grid.edit;e.applyCellEdit(this.getValue(_bbd),this,_bbd);e.start(this,_bbd,true);}});_bba.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_b71("dojox.grid.cells.Bool",_bba,{_valueProp:"checked",formatEditing:function(_bbe,_bbf){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_bbe?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_bba.markupFactory(node,cell);};return _b7c;});},"dijit/form/_DateTimeTextBox":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(date,_bc0,_bc1,_bc2,lang,_bc3,_bc4,_bc5){new Date("X");var _bc6=_bc2("dijit.form._DateTimeTextBox",[_bc3,_bc4],{templateString:_bc5,hasDownArrow:true,cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},pattern:_bc0.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},compare:function(val1,val2){var _bc7=this._isInvalidDate(val1);var _bc8=this._isInvalidDate(val2);return _bc7?(_bc8?0:-1):(_bc8?1:date.compare(val1,val2,this._selector));},forceWidth:true,format:function(_bc9,_bca){if(!_bc9){return "";}return this.dateLocaleModule.format(_bc9,_bca);},"parse":function(_bcb,_bcc){return this.dateLocaleModule.parse(_bcb,_bcc)||(this._isEmpty(_bcb)?null:undefined);},serialize:function(val,_bcd){if(val.toGregorian){val=val.toGregorian();}return _bc1.toISOString(val,_bcd);},dropDownDefaultValue:new Date(),value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(_bce){this.dateModule=_bce.datePackage?lang.getObject(_bce.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_bce.datePackage?lang.getObject(_bce.datePackage+".locale",false):_bc0;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString();},buildRendering:function(){this.inherited(arguments);if(!this.hasDownArrow){this._buttonNode.style.display="none";}if(!this.hasDownArrow){this._buttonNode=this.domNode;this.baseClass+=" dijitComboBoxOpenOnClick";}},_setConstraintsAttr:function(_bcf){_bcf.selector=this._selector;_bcf.fullYear=true;var _bd0=_bc1.fromISOString;if(typeof _bcf.min=="string"){_bcf.min=_bd0(_bcf.min);}if(typeof _bcf.max=="string"){_bcf.max=_bd0(_bcf.max);}this.inherited(arguments);},_isInvalidDate:function(_bd1){return !_bd1||isNaN(_bd1)||typeof _bd1!="object"||_bd1.toString()==this._invalidDate;},_setValueAttr:function(_bd2,_bd3,_bd4){if(_bd2!==undefined){if(typeof _bd2=="string"){_bd2=_bc1.fromISOString(_bd2);}if(this._isInvalidDate(_bd2)){_bd2=null;}if(_bd2 instanceof Date&&!(this.dateClassObj instanceof Date)){_bd2=new this.dateClassObj(_bd2);}}this.inherited(arguments);if(this.value instanceof Date){this.filterString="";}if(this.dropDown){this.dropDown.set("value",_bd2,false);}},_set:function(attr,_bd5){if(attr=="value"&&this.value instanceof Date&&this.compare(_bd5,this.value)==0){return;}this.inherited(arguments);},_setDropDownDefaultValueAttr:function(val){if(this._isInvalidDate(val)){val=new this.dateClassObj();}this.dropDownDefaultValue=val;},openDropDown:function(_bd6){if(this.dropDown){this.dropDown.destroy();}var _bd7=lang.isString(this.popupClass)?lang.getObject(this.popupClass,false):this.popupClass,_bd8=this,_bd9=this.get("value");this.dropDown=new _bd7({onChange:function(_bda){_bd8.set("value",_bda,true);},id:this.id+"_popup",dir:_bd8.dir,lang:_bd8.lang,value:_bd9,currentFocus:!this._isInvalidDate(_bd9)?_bd9:this.dropDownDefaultValue,constraints:_bd8.constraints,filterString:_bd8.filterString,datePackage:_bd8.params.datePackage,isDisabledDate:function(date){return !_bd8.rangeCheck(date,_bd8.constraints);}});this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(_bdb,_bdc){this._setValueAttr(this.parse(_bdb,this.constraints),_bdc,_bdb);}});return _bc6;});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_bdd,_bde,lang,util,html){var _bdf=function(_be0){var i=0,n,p=_be0.parentNode;while((n=p.childNodes[i++])){if(n==_be0){return i-1;}}return -1;};var _be1=function(_be2){if(!_be2){return;}dojo.forEach(_bdd.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_be2,true)){w.destroy();}});};var _be3=function(_be4){var node=html.byId(_be4);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _be5=function(_be6,_be7){var _be8=[];var i=0,n;while((n=_be6.childNodes[i])){i++;if(_be3(n)==_be7){_be8.push(n);}}return _be8;};var _be9=function(_bea){return _be5(_bea,"div");};return _bde("dojox.grid._Scroller",null,{constructor:function(_beb){this.setContentNodes(_beb);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_bec,_bed,_bee){switch(arguments.length){case 3:this.rowsPerPage=_bee;case 2:this.keepRows=_bed;case 1:this.rowCount=_bec;default:break;}this.defaultPageHeight=this.defaultRowHeight*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_bef,_bf0){return _bef?(Math.ceil(_bef/_bf0)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_bf1){this.keepRows=_bf1;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_bf2){this.contentNodes=_bf2;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_bf3){this.invalidateNodes();this.rowCount=_bf3;var _bf4=this.pageCount;if(_bf4===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_bf4){for(var i=_bf4-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_bf4){this.height+=this.defaultPageHeight*(this.pageCount-_bf4-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_bf5){return Boolean(this.getDefaultPageNode(_bf5));},measurePage:function(_bf6){if(this.grid.rowHeight){var _bf7=this.grid.rowHeight+1;return ((_bf6+1)*this.rowsPerPage>this.rowCount?this.rowCount-_bf6*this.rowsPerPage:this.rowsPerPage)*_bf7;}var n=this.getDefaultPageNode(_bf6);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_bf8,_bf9){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_bf8].style.top=_bf9+"px";}},repositionPages:function(_bfa){var _bfb=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_bfb[_bfa];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_bfa):0);for(var p=_bfa+1;p<=last;p++){n=_bfb[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_bfc){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_bfc]);}},preparePage:function(_bfd,_bfe){var p=(_bfe?this.popPage():null);for(var i=0;i<this.colCount;i++){var _bff=this.pageNodes[i];var _c00=(p===null?this.createPageNode():this.invalidatePageNode(p,_bff));_c00.pageIndex=_bfd;_bff[_bfd]=_c00;}},renderPage:function(_c01){var _c02=[];var i,j;for(i=0;i<this.colCount;i++){_c02[i]=this.pageNodes[i][_c01];}for(i=0,j=_c01*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_c02);}},removePage:function(_c03){for(var i=0,j=_c03*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_c04){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_c04,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_c05){},pacifying:false,pacifyTicks:200,setPacifying:function(_c06){if(this.pacifying!=_c06){this.pacifying=_c06;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _c07=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _c07;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _c08=(!this._invalidating);if(!_c08){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_c08=true;}}if(_c08){this.needPage(this.page,this.pageTop);}var _c09=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _c0a=this.getPageHeight(this.page);this.averageRowHeight=(_c0a>0&&_c09>0)?(_c0a/_c09):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _c0b=this.pageCount-1;var _c0c=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_c0b]=_c0c;return _c0c;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_c0d,_c0e,_c0f){if(this.pageExists(_c0d)){var oh=this.getPageHeight(_c0d);var h=(this.measurePage(_c0d));if(h===undefined){h=oh;}this.pageHeights[_c0d]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_c0e)){if(!_c0f){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_c0d);}}else{this.repositionPages(_c0d);}}return h;}return 0;},rowHeightChanged:function(_c10,_c11){this.updatePageHeight(Math.floor(_c10/this.rowsPerPage),false,_c11);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_c12){var ph=this.pageHeights[_c12];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_c13){return this.stack.push(_c13);},popPage:function(){return this.stack.shift();},findPage:function(_c14){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_c14){break;}}this.page=i;this.pageTop=h;},buildPage:function(_c15,_c16,_c17){this.preparePage(_c15,_c16);this.positionPage(_c15,_c17);this.installPage(_c15);this.renderPage(_c15);this.pushPage(_c15);},needPage:function(_c18,_c19){var h=this.getPageHeight(_c18),oh=h;if(!this.pageExists(_c18)){this.buildPage(_c18,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_c19);h=this.updatePageHeight(_c18,true);}else{this.positionPage(_c18,_c19);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_c1a){this.grid.scrollTop=_c1a;if(this.colCount){this.startPacify();this.findPage(_c1a);var h=this.height;var b=this.getScrollBottom(_c1a);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_c1a);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_c1b){return (this.windowHeight>=0?_c1b+this.windowHeight:-1);},processNodeEvent:function(e,_c1c){var t=e.target;while(t&&(t!=_c1c)&&t.parentNode&&(t.parentNode.parentNode!=_c1c)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_c1c)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_bdf(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_c1d,_c1e){},removeRow:function(_c1f){},getDefaultPageNode:function(_c20){return this.getDefaultNodes()[_c20];},positionPageNode:function(_c21,_c22){},getPageNodePosition:function(_c23){return _c23.offsetTop;},invalidatePageNode:function(_c24,_c25){var p=_c25[_c24];if(p){delete _c25[_c24];this.removePage(_c24,p);_be1(p);p.innerHTML="";}return p;},getPageRow:function(_c26){return _c26*this.rowsPerPage;},getLastPageRow:function(_c27){return Math.min(this.rowCount,this.getPageRow(_c27+1))-1;},getFirstVisibleRow:function(_c28,_c29,_c2a){if(!this.pageExists(_c28)){return 0;}var row=this.getPageRow(_c28);var _c2b=this.getDefaultNodes();var rows=_be9(_c2b[_c28]);for(var i=0,l=rows.length;i<l&&_c29<_c2a;i++,row++){_c29+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_c2c,_c2d,_c2e){if(!this.pageExists(_c2c)){return 0;}var _c2f=this.getDefaultNodes();var row=this.getLastPageRow(_c2c);var rows=_be9(_c2f[_c2c]);for(var i=rows.length-1;i>=0&&_c2d>_c2e;i--,row--){_c2d-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_c30){var _c31=this.getDefaultNodes();var rows=_be9(_c31[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_c30){this.offset=h-(t-_c30);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_c32){var _c33=Math.floor(_c32/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_c33;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_c33;this.needPage(_c33,this.pageTop);var _c34=this.getDefaultNodes();var rows=_be9(_c34[_c33]);var r=_c32-this.rowsPerPage*_c33;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dijit/Calendar":function(){define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton"],function(_c35,date,_c36,_c37,_c38,_c39,_c3a,_c3b,keys,lang,has,_c3c,_c3d,_c3e,_c3f,_c40){var _c41=_c37("dijit.Calendar",[_c3c,_c3d,_c3e],{cssStateNodes:{"decrementMonth":"dijitCalendarArrow","incrementMonth":"dijitCalendarArrow","previousYearLabelNode":"dijitCalendarPreviousYear","nextYearLabelNode":"dijitCalendarNextYear"},setValue:function(_c42){_c3b.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",_c42);},_createMonthWidget:function(){return new _c41._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:lang.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeydown","_onKeyDown");this.connect(this.dateRowsNode,"onmouseover","_onDayMouseOver");this.connect(this.dateRowsNode,"onmouseout","_onDayMouseOut");this.connect(this.dateRowsNode,"onmousedown","_onDayMouseDown");this.connect(this.dateRowsNode,"onmouseup","_onDayMouseUp");},_onMonthSelect:function(_c43){var date=new this.dateClassObj(this.currentFocus);date.setDate(1);date.setMonth(_c43);var _c44=this.dateModule.getDaysInMonth(date);var _c45=this.currentFocus.getDate();date.setDate(Math.min(_c45,_c44));this._setCurrentFocusAttr(date);},_onDayMouseOver:function(evt){var node=_c39.contains(evt.target,"dijitCalendarDateLabel")?evt.target.parentNode:evt.target;if(node&&((node.dijitDateValue&&!_c39.contains(node,"dijitCalendarDisabledDate"))||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){_c39.add(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}if(evt.relatedTarget&&evt.relatedTarget.parentNode==this._currentNode){return;}var cls="dijitCalendarHoveredDate";if(_c39.contains(this._currentNode,"dijitCalendarActiveDate")){cls+=" dijitCalendarActiveDate";}_c39.remove(this._currentNode,cls);this._currentNode=null;},_onDayMouseDown:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue&&!_c39.contains(node,"dijitCalendarDisabledDate")){_c39.add(node,"dijitCalendarActiveDate");this._currentNode=node;}},_onDayMouseUp:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue){_c39.remove(node,"dijitCalendarActiveDate");}},handleKey:function(evt){var _c46=-1,_c47,_c48=this.currentFocus;switch(evt.keyCode){case keys.RIGHT_ARROW:_c46=1;case keys.LEFT_ARROW:_c47="day";if(!this.isLeftToRight()){_c46*=-1;}break;case keys.DOWN_ARROW:_c46=1;case keys.UP_ARROW:_c47="week";break;case keys.PAGE_DOWN:_c46=1;case keys.PAGE_UP:_c47=evt.ctrlKey||evt.altKey?"year":"month";break;case keys.END:_c48=this.dateModule.add(_c48,"month",1);_c47="day";case keys.HOME:_c48=new this.dateClassObj(_c48);_c48.setDate(1);break;case keys.ENTER:case keys.SPACE:this.set("value",this.currentFocus);break;default:return true;}if(_c47){_c48=this.dateModule.add(_c48,_c47,_c46);}this._setCurrentFocusAttr(_c48);return false;},_onKeyDown:function(evt){if(!this.handleKey(evt)){_c3a.stop(evt);}},onValueSelected:function(){},onChange:function(_c49){this.onValueSelected(_c49);},getClassForDate:function(){}});_c41._MonthDropDownButton=_c37("dijit.Calendar._MonthDropDownButton",_c40,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new _c41._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect});},_setMonthAttr:function(_c4a){var _c4b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_c4a);this.dropDown.set("months",_c4b);this.containerNode.innerHTML=(has("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_c4b[_c4a.getMonth()]+"</div>";}});_c41._MonthDropDown=_c37("dijit.Calendar._MonthDropDown",[_c3d,_c3f],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' "+"data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(_c4c){this.domNode.innerHTML=_c35.map(_c4c,function(_c4d,idx){return _c4d?"<div class='dijitCalendarMonthLabel' month='"+idx+"'>"+_c4d+"</div>":"";}).join("");},_onClick:function(evt){this.onChange(_c38.get(evt.target,"month"));},onChange:function(){},_onMenuHover:function(evt){_c39.toggle(evt.target,"dijitCalendarMonthLabelHover",evt.type=="mouseover");}});return _c41;});},"dojox/date/islamic":function(){define("dojox/date/islamic",["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(_c4e,lang,dd,_c4f){var _c50=lang.getObject("date.islamic",true,_c4e);_c50.getDaysInMonth=function(_c51){return _c51.getDaysInIslamicMonth(_c51.getMonth(),_c51.getFullYear());};_c50.compare=function(_c52,_c53,_c54){if(_c52 instanceof _c4f){_c52=_c52.toGregorian();}if(_c53 instanceof _c4f){_c53=_c53.toGregorian();}return dd.compare.apply(null,arguments);};_c50.add=function(date,_c55,_c56){var _c57=new _c4f(date);switch(_c55){case "day":_c57.setDate(date.getDate()+_c56);break;case "weekday":var day=date.getDay();if(((day+_c56)<5)&&((day+_c56)>0)){_c57.setDate(date.getDate()+_c56);}else{var _c58=0,_c59=0;if(day==5){day=4;_c59=(_c56>0)?-1:1;}else{if(day==6){day=4;_c59=(_c56>0)?-2:2;}}var add=(_c56>0)?(5-day-1):-day;var _c5a=_c56-add;var div=parseInt(_c5a/5);if(_c5a%5!=0){_c58=(_c56>0)?2:-2;}_c58=_c58+div*7+_c5a%5+add;_c57.setDate(date.getDate()+_c58+_c59);}break;case "year":_c57.setFullYear(date.getFullYear()+_c56);break;case "week":_c56*=7;_c57.setDate(date.getDate()+_c56);break;case "month":var _c5b=date.getMonth();_c57.setMonth(_c5b+_c56);break;case "hour":_c57.setHours(date.getHours()+_c56);break;case "minute":_c57._addMinutes(_c56);break;case "second":_c57._addSeconds(_c56);break;case "millisecond":_c57._addMilliseconds(_c56);break;}return _c57;};_c50.difference=function(_c5c,_c5d,_c5e){_c5d=_c5d||new _c4f();_c5e=_c5e||"day";var _c5f=_c5d.getFullYear()-_c5c.getFullYear();var _c60=1;switch(_c5e){case "weekday":var days=Math.round(_c50.difference(_c5c,_c5d,"day"));var _c61=parseInt(_c50.difference(_c5c,_c5d,"week"));var mod=days%7;if(mod==0){days=_c61*5;}else{var adj=0;var aDay=_c5c.getDay();var bDay=_c5d.getDay();_c61=parseInt(days/7);mod=days%7;var _c62=new _c4f(_c5c);_c62.setDate(_c62.getDate()+(_c61*7));var _c63=_c62.getDay();if(days>0){switch(true){case aDay==5:adj=-1;break;case aDay==6:adj=0;break;case bDay==5:adj=-1;break;case bDay==6:adj=-2;break;case (_c63+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==5:adj=0;break;case aDay==6:adj=1;break;case bDay==5:adj=2;break;case bDay==6:adj=1;break;case (_c63+mod)<0:adj=2;}}}days+=adj;days-=(_c61*2);}_c60=days;break;case "year":_c60=_c5f;break;case "month":var _c64=(_c5d.toGregorian()>_c5c.toGregorian())?_c5d:_c5c;var _c65=(_c5d.toGregorian()>_c5c.toGregorian())?_c5c:_c5d;var _c66=_c64.getMonth();var _c67=_c65.getMonth();if(_c5f==0){_c60=_c64.getMonth()-_c65.getMonth();}else{_c60=12-_c67;_c60+=_c66;var i=_c65.getFullYear()+1;var e=_c64.getFullYear();for(i;i<e;i++){_c60+=12;}}if(_c5d.toGregorian()<_c5c.toGregorian()){_c60=-_c60;}break;case "week":_c60=parseInt(_c50.difference(_c5c,_c5d,"day")/7);break;case "day":_c60/=24;case "hour":_c60/=60;case "minute":_c60/=60;case "second":_c60/=1000;case "millisecond":_c60*=_c5d.toGregorian().getTime()-_c5c.toGregorian().getTime();}return Math.round(_c60);};return _c50;});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_c68,_c69,_c6a,_c6b,lang,win,dom,_c6c,_c6d,_c6e,has,on,_c6f,_c70,_c71,dnd){var _c72=_c69("dojo.dnd.Container",_c6e,{skipForm:false,allowNested:false,constructor:function(node,_c73){this.node=dom.byId(node);if(!_c73){_c73={};}this.creator=_c73.creator||null;this.skipForm=_c73.skipForm;this.parent=_c73.dropParent&&dom.byId(_c73.dropParent);this.map={};this.current=null;this.containerState="";_c6c.add(this.node,"dojoDndContainer");if(!(_c73&&_c73._skipStartup)){this.startup();}this.events=[on(this.node,_c71.over,lang.hitch(this,"onMouseOver")),on(this.node,_c71.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_c6b.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _c6f((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_c74,_c75){if(!this.parent.firstChild){_c75=null;}else{if(_c74){if(!_c75){_c75=this.parent.firstChild;}}else{if(_c75){_c75=_c75.nextSibling;}}}var i,t;if(_c75){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_c75.parentNode.insertBefore(t.node,_c75);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_c68.forEach(this.events,function(_c76){_c76.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_c77,node,Ctor){_c77._skipStartup=true;return new Ctor(node,_c77);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_c6a.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_c78){var _c79="dojoDnd"+type;var _c7a=type.toLowerCase()+"State";_c6c.replace(this.node,_c79+_c78,_c79+this[_c7a]);this[_c7a]=_c78;},_addItemClass:function(node,type){_c6c.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_c6c.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _c7b=node.parentNode;_c7b;node=_c7b,_c7b=node.parentNode){if((_c7b==this.parent||this.allowNested)&&_c6c.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_c6c.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _c6d.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_c6d.create("tr");_c6d.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _c6d.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _c7c=item&&lang.isObject(item),data,type,n;if(_c7c&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_c7c&&item.data)?item.data:item;type=(_c7c&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _c72;});},"dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_c7d,_c7e,_c7f){return _c7d("dojox.grid.DataSelection",_c7f,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _c7e(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_c7f.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_c80){var _c81=this.grid.getItemIndex(_c80);var idx=_c7f.prototype.getNextSelected.call(this,_c81);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _c82=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_c82.push(this.grid.getItem(i));}}return _c82;},addToSelection:function(_c83){if(this.mode=="none"){return;}var idx=null;if(typeof _c83=="number"||typeof _c83=="string"){idx=_c83;}else{idx=this.grid.getItemIndex(_c83);}_c7f.prototype.addToSelection.call(this,idx);},deselect:function(_c84){if(this.mode=="none"){return;}var idx=null;if(typeof _c84=="number"||typeof _c84=="string"){idx=_c84;}else{idx=this.grid.getItemIndex(_c84);}_c7f.prototype.deselect.call(this,idx);},deselectAll:function(_c85){var idx=null;if(_c85||typeof _c85=="number"){if(typeof _c85=="number"||typeof _c85=="string"){idx=_c85;}else{idx=this.grid.getItemIndex(_c85);}_c7f.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"dijit/_editor/selection":function(){define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(dom,lang,has,win,_c86){var _c87={getType:function(){if(win.doc.getSelection){var _c88="text";var oSel;try{oSel=win.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _c89=oSel.getRangeAt(0);if((_c89.startContainer==_c89.endContainer)&&((_c89.endOffset-_c89.startOffset)==1)&&(_c89.startContainer.nodeType!=3)){_c88="control";}}return _c88;}else{return win.doc.selection.type.toLowerCase();}},getSelectedText:function(){if(win.doc.getSelection){var _c8a=win.global.getSelection();return _c8a?_c8a.toString():"";}else{if(_c86._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().text;}},getSelectedHtml:function(){if(win.doc.getSelection){var _c8b=win.global.getSelection();if(_c8b&&_c8b.rangeCount){var i;var html="";for(i=0;i<_c8b.rangeCount;i++){var frag=_c8b.getRangeAt(i).cloneContents();var div=win.doc.createElement("div");div.appendChild(frag);html+=div.innerHTML;}return html;}return null;}else{if(_c86._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().htmlText;}},getSelectedElement:function(){if(_c86._editor.selection.getType()=="control"){if(win.doc.getSelection){var _c8c=win.global.getSelection();return _c8c.anchorNode.childNodes[_c8c.anchorOffset];}else{var _c8d=win.doc.selection.createRange();if(_c8d&&_c8d.item){return win.doc.selection.createRange().item(0);}}}return null;},getParentElement:function(){if(_c86._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(win.doc.getSelection){var _c8e=win.global.getSelection();if(_c8e){var node=_c8e.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}else{var r=win.doc.selection.createRange();r.collapse(true);return r.parentElement();}}return null;},hasAncestorElement:function(_c8f){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_c90){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _c91=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _c92=String(tags[i]).toLowerCase();if(_c91==_c92){return _c92;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_c93){if(win.doc.getSelection){var _c94=win.global.getSelection();if(_c94.removeAllRanges){if(_c93){_c94.collapseToStart();}else{_c94.collapseToEnd();}}else{_c94.collapse(_c93);}}else{var _c95=win.doc.selection.createRange();_c95.collapse(_c93);_c95.select();}},remove:function(){var sel=win.doc.selection;if(win.doc.getSelection){sel=win.global.getSelection();sel.deleteFromDocument();return sel;}else{if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}},selectElementChildren:function(_c96,_c97){var doc=win.doc;var _c98;_c96=dom.byId(_c96);if(win.doc.getSelection){var _c99=win.global.getSelection();if(has("opera")){if(_c99.rangeCount){_c98=_c99.getRangeAt(0);}else{_c98=doc.createRange();}_c98.setStart(_c96,0);_c98.setEnd(_c96,(_c96.nodeType==3)?_c96.length:_c96.childNodes.length);_c99.addRange(_c98);}else{_c99.selectAllChildren(_c96);}}else{_c98=_c96.ownerDocument.body.createTextRange();_c98.moveToElementText(_c96);if(!_c97){try{_c98.select();}catch(e){}}}},selectElement:function(_c9a,_c9b){var _c9c;_c9a=dom.byId(_c9a);var doc=_c9a.ownerDocument;var _c9d=win.global;if(doc.getSelection){var _c9e=_c9d.getSelection();_c9c=doc.createRange();if(_c9e.removeAllRanges){if(has("opera")){if(_c9e.getRangeAt(0)){_c9c=_c9e.getRangeAt(0);}}_c9c.selectNode(_c9a);_c9e.removeAllRanges();_c9e.addRange(_c9c);}}else{try{var tg=_c9a.tagName?_c9a.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){_c9c=win.body(doc).createControlRange();}else{_c9c=win.body(doc).createRange();}_c9c.addElement(_c9a);if(!_c9b){_c9c.select();}}catch(e){this.selectElementChildren(_c9a,_c9b);}}},inSelection:function(node){if(node){var _c9f;var doc=win.doc;var _ca0;if(win.doc.getSelection){var sel=win.global.getSelection();if(sel&&sel.rangeCount>0){_ca0=sel.getRangeAt(0);}if(_ca0&&_ca0.compareBoundaryPoints&&doc.createRange){try{_c9f=doc.createRange();_c9f.setStart(node,0);if(_ca0.compareBoundaryPoints(_ca0.START_TO_END,_c9f)===1){return true;}}catch(e){}}}else{_ca0=doc.selection.createRange();try{_c9f=node.ownerDocument.body.createControlRange();if(_c9f){_c9f.addElement(node);}}catch(e1){try{_c9f=node.ownerDocument.body.createTextRange();_c9f.moveToElementText(node);}catch(e2){}}if(_ca0&&_c9f){if(_ca0.compareEndPoints("EndToStart",_c9f)===1){return true;}}}}return false;}};lang.setObject("dijit._editor.selection",_c87);return _c87;});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_ca1,_ca2,lang,_ca3){return _ca1("dojox.grid._SelectionPreserver",null,{constructor:function(_ca4){this.selection=_ca4;var grid=this.grid=_ca4.grid;this.reset();this._connects=[_ca2.connect(grid,"_setStore",this,"reset"),_ca2.connect(grid,"_addItem",this,"_reSelectById"),_ca2.connect(_ca4,"onSelected",lang.hitch(this,"_selectById",true)),_ca2.connect(_ca4,"onDeselected",lang.hitch(this,"_selectById",false)),_ca2.connect(_ca4,"deselectAll",this,"reset")];},destroy:function(){this.reset();_ca3.forEach(this._connects,_ca2.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_ca5){if(item&&this.grid._hasIdentity){this.selection.selected[_ca5]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_ca6,_ca7){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_ca7,g=this.grid;if(typeof _ca7=="number"||typeof _ca7=="string"){var _ca8=g._by_idx[_ca7];item=_ca8&&_ca8.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_ca6;}return item;}});});},"esri/dijit/editing/editOperation":function(){define(["dijit","dojo","dojox","dojo/require!esri/undoManager"],function(_ca9,dojo,_caa){dojo.provide("esri.dijit.editing.editOperation");dojo.require("esri.undoManager");dojo.declare("esri.dijit.editing.Add",esri.OperationBase,{type:"edit",label:"Add Features",constructor:function(_cab){_cab=_cab||{};if(!_cab.featureLayer){console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided");return;}this._featureLayer=_cab.featureLayer;if(!_cab.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided");return;}this._addedGraphics=_cab.addedGraphics;},performUndo:function(){this._featureLayer.applyEdits(null,null,this._addedGraphics);},performRedo:function(){this._featureLayer.applyEdits(this._addedGraphics,null,null);}});dojo.declare("esri.dijit.editing.Delete",esri.OperationBase,{type:"edit",label:"Delete Features",constructor:function(_cac){_cac=_cac||{};this._add=new esri.dijit.editing.Add({featureLayer:_cac.featureLayer,addedGraphics:_cac.deletedGraphics});},performUndo:function(){this._add.performRedo();},performRedo:function(){this._add.performUndo();}});dojo.declare("esri.dijit.editing.Update",esri.OperationBase,{type:"edit",label:"Update Features",constructor:function(_cad){_cad=_cad||{};if(!_cad.featureLayer){console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");return;}this._featureLayer=_cad.featureLayer;if(!_cad.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(var i=0;i<_cad.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_cad.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_cad.preUpdatedGraphics[i].attributes);}if(!_cad.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_cad.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_cad.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_cad.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(dojo.clone(_cad.postUpdatedGraphics[i].attributes));}},performUndo:function(){for(var i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(esri.geometry.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);},performRedo:function(){for(var i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(esri.geometry.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);}});dojo.declare("esri.dijit.editing.Cut",esri.OperationBase,{type:"edit",label:"Cut Features",constructor:function(_cae){_cae=_cae||{};if(!_cae.featureLayer){console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");return;}this._featureLayer=_cae.featureLayer;if(!_cae.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");return;}this._addedGraphics=_cae.addedGraphics;if(!_cae.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(var i=0;i<_cae.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_cae.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_cae.preUpdatedGraphics[i].attributes);}if(!_cae.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_cae.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_cae.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_cae.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(dojo.clone(_cae.postUpdatedGraphics[i].attributes));}},performUndo:function(){for(var i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(esri.geometry.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics);},performRedo:function(){for(var i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(esri.geometry.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null);}});dojo.declare("esri.dijit.editing.Union",esri.OperationBase,{type:"edit",label:"Union Features",constructor:function(_caf){_caf=_caf||{};this._cut=new esri.dijit.editing.Cut({featureLayer:_caf.featureLayer,addedGraphics:_caf.deletedGraphics,preUpdatedGraphics:_caf.preUpdatedGraphics,postUpdatedGraphics:_caf.postUpdatedGraphics});},performUndo:function(){this._cut.performRedo();},performRedo:function(){this._cut.performUndo();}});});},"esri/layers/FeatureLayer":function(){define(["dijit","dojo","dojox","dojo/require!esri/layers/graphics,esri/tasks/query,dojo/io/iframe,esri/layers/agscommon,dojo/date/locale"],function(_cb0,dojo,_cb1){dojo.provide("esri.layers.FeatureLayer");dojo.require("esri.layers.graphics");dojo.require("esri.tasks.query");dojo.require("dojo.io.iframe");dojo.require("esri.layers.agscommon");dojo.require("dojo.date.locale");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_cb2){this._outFields=_cb2&&_cb2.outFields;this._loadCallback=_cb2&&_cb2.loadCallback;var _cb3=_cb2&&_cb2._usePatch;this._usePatch=(_cb3===null||_cb3===undefined)?true:_cb3;this._trackIdField=_cb2&&_cb2.trackIdField;this.objectIdField=_cb2&&_cb2.objectIdField;this._maxOffset=_cb2&&_cb2.maxAllowableOffset;this._optEditable=_cb2&&_cb2.editable;this._optAutoGen=_cb2&&_cb2.autoGeneralize;this.editSummaryCallback=_cb2&&_cb2.editSummaryCallback;this.userId=_cb2&&_cb2.userId;this.userIsAdmin=_cb2&&_cb2.userIsAdmin;this.useMapTime=(_cb2&&_cb2.hasOwnProperty("useMapTime"))?(!!_cb2.useMapTime):true;this.source=_cb2&&_cb2.source;this.gdbVersion=_cb2&&_cb2.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(esri._isDefined(_cb2&&_cb2.mode)?_cb2.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_cb2&&_cb2.tileWidth)||512;this._tileHeight=(_cb2&&_cb2.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);var _cb4=_cb2&&_cb2.latticeTiling;this.latticeTiling=_cb4;break;case ctor.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);this._editable=false;if(dojo.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new esri.tasks.QueryTask(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _cb5=this._url.path;this._fserver=false;if(_cb5.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _cb6=_cb2&&_cb2.resourceInfo;if(_cb6){this._initLayer(_cb6);}else{if(this.source){var _cb7={source:this.source.toJson()};this._url.query=dojo.mixin(this._url.query,{layer:dojo.toJson(_cb7)});}if(this.gdbVersion){this._url.query=dojo.mixin(this._url.query,{gdbVersion:this.gdbVersion});}esri.request({url:_cb5,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_cb8,io){if(_cb8||io){this._json=_cb8;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_cb8&&_cb8._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_cb8.featureSet;this._nextId=_cb8.nextObjectId;_cb8=_cb8.layerDefinition;}if(_cb8.hasOwnProperty("capabilities")){var _cb9=(this.capabilities=_cb8.capabilities);if(_cb9&&_cb9.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_cb8.geometryType==="esriGeometryPolyline")||(_cb8.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=esri._isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _cba=_cb8.effectiveMinScale||_cb8.minScale,_cbb=_cb8.effectiveMaxScale||_cb8.maxScale;if(!this._hasMin&&_cba){this.setMinScale(_cba);}if(!this._hasMax&&_cbb){this.setMaxScale(_cbb);}this.layerId=_cb8.id;this.name=_cb8.name;this.description=_cb8.description;this.copyright=_cb8.copyrightText;this.type=_cb8.type;this.geometryType=_cb8.geometryType;this.displayField=_cb8.displayField;this.defaultDefinitionExpression=_cb8.definitionExpression;this.fullExtent=new esri.geometry.Extent(_cb8.extent);this.initialExtent=new esri.geometry.Extent(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new esri.SpatialReference(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_cb8.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_cb8.indexedFields;this.maxRecordCount=_cb8.maxRecordCount;this.canModifyLayer=_cb8.canModifyLayer;this.supportsStatistics=_cb8.supportsStatistics;this.supportsAdvancedQueries=_cb8.supportsAdvancedQueries;this.hasLabels=_cb8.hasLabels;this.canScaleSymbols=_cb8.canScaleSymbols;this.supportsRollbackOnFailure=_cb8.supportsRollbackOnFailure;this.syncCanReturnChanges=_cb8.syncCanReturnChanges;this.isDataVersioned=_cb8.isDataVersioned;this.editFieldsInfo=_cb8.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_cb8.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_cb8.relationships;this.allowGeometryUpdates=esri._isDefined(_cb8.allowGeometryUpdates)?_cb8.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _cbc=(this.fields=[]),_cbd=_cb8.fields,i;for(i=0;i<_cbd.length;i++){_cbc.push(new esri.layers.Field(_cbd[i]));}if(!this.objectIdField){this.objectIdField=_cb8.objectIdField;if(!this.objectIdField){_cbd=_cb8.fields;for(i=0;i<_cbd.length;i++){var _cbe=_cbd[i];if(_cbe.type==="esriFieldTypeOID"){this.objectIdField=_cbe.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _cbf=this.objectIdField,_cc0=-1;if(this._collection&&_cbf){var fset=this._featureSet,_cc1=fset&&fset.features,il=_cc1?_cc1.length:0,oid,attr;for(i=0;i<il;i++){attr=_cc1[i].attributes;oid=attr&&attr[_cbf];if(oid>_cc0){_cc0=oid;}}}this._nextId=(_cc0+1);}this.globalIdField=_cb8.globalIdField;var _cc2=(this.typeIdField=_cb8.typeIdField),_cc3;if(_cc2){_cc3=!this._getField(_cc2)&&this._getField(_cc2,true);if(_cc3){this.typeIdField=_cc3.name;}}this.visibilityField=_cb8.visibilityField;var _cc4=_cb8.defaultSymbol;if(_cc4){this.defaultSymbol=esri.symbol.fromJson(_cc4);}var _cc5=this.types=[],_cc6=_cb8.types,_cc7,_cc8,_cc9,_cca=this.editFieldsInfo,_ccb=_cca&&_cca.creatorField,_ccc=_cca&&_cca.editorField,fix=(_ccb||_ccc),_ccd=[];if(_cc6){for(i=0;i<_cc6.length;i++){_cc7=new esri.layers.FeatureType(_cc6[i]);_cc8=_cc7.templates;if(fix&&_cc8&&_cc8.length){_ccd=_ccd.concat(_cc8);}_cc5.push(_cc7);}}var _cce=_cb8.templates,_ccf,_cd0=this.templates=[];if(_cce){for(i=0;i<_cce.length;i++){_ccf=new esri.layers.FeatureTemplate(_cce[i]);if(fix){_ccd.push(_ccf);}_cd0.push(_ccf);}}for(i=0;i<_ccd.length;i++){_cc9=dojo.getObject("prototype.attributes",false,_ccd[i]);if(_cc9){if(_ccb){delete _cc9[_ccb];}if(_ccc){delete _cc9[_ccc];}}}var _cd1=_cb8.timeInfo;if(_cd1){this.timeInfo=new esri.layers.TimeInfo(_cd1);this._startTimeField=_cd1.startTimeField;this._endTimeField=_cd1.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_cd1.trackIdField=this._trackIdField;}else{this._trackIdField=_cd1.trackIdField;}}this.hasAttachments=(!this._collection&&_cb8.hasAttachments)?true:false;this.htmlPopupType=_cb8.htmlPopupType;var _cd2=_cb8.drawingInfo,_cd3;if(!this.renderer){if(_cd2&&_cd2.renderer){_cd3=_cd2.renderer;this.setRenderer(esri.renderer.fromJson(_cd3));if(_cd3.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _cd4=_cd3.type,_cd5=[];_cd3=this.renderer;switch(_cd4){case "simple":_cd5.push(_cd3.symbol);break;case "uniqueValue":case "classBreaks":_cd5.push(_cd3.defaultSymbol);_cd5=_cd5.concat(dojo.map(_cd3.infos,function(info){return info.symbol;}));break;}_cd5=dojo.filter(_cd5,esri._isDefined);var _cd6=this._url.path+"/images/",_cd7=this._getToken();dojo.forEach(_cd5,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_cd6+url;}if(_cd7&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_cd7);}}});}}else{if(_cc4){_cc6=this.types;if(_cc6.length>0){_cd3=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_cc6,function(type){_cd3.addValue(type.id,type.symbol);});}else{_cd3=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_cd3);}else{if(!this._isTable){var _cd8;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_cd8=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_cd8=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_cd8=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_cd8?new esri.renderer.SimpleRenderer(_cd8):null);}}}}var _cd9=(_cd2&&_cd2.transparency)||0;if(!esri._isDefined(this.opacity)&&_cd9>0){this.opacity=1-(_cd9/100);}this.version=_cb8.currentVersion;if(!this.version){var ver;if("capabilities" in _cb8||"drawingInfo" in _cb8||"hasAttachments" in _cb8||"htmlPopupType" in _cb8||"relationships" in _cb8||"timeInfo" in _cb8||"typeIdField" in _cb8||"types" in _cb8){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _cda=function(){this.onLoad(this);var _cdb=this._loadCallback;if(_cdb){delete this._loadCallback;_cdb(this);}};if(this._collection){this._fireUpdateStart();var _cdc=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_cdc));this._fcAdded=true;_cda.call(this);}else{this._forceIdentity(_cda);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _cdd=this.renderer;if(_cdd){this._ager=(_cdd.declaredClass.indexOf("TemporalRenderer")!==-1&&_cdd.observationAger&&_cdd.observationRenderer);var _cde=dojo.filter([_cdd,_cdd.observationRenderer,_cdd.latestObservationRenderer,_cdd.trackRenderer],esri._isDefined);var _cdf=[];dojo.forEach(_cde,function(rnd){if(!dojo.isFunction(rnd.attributeField)){_cdf.push(rnd.attributeField);}_cdf.push(rnd.attributeField2);_cdf.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_cdf,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_unsetMap:function(map,_ce0){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},setEditable:function(_ce1){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_ce1;return this;}var _ce2=this._editable;this._editable=_ce1;this._updateCaps();if(_ce2!==_ce1){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_ce3){var _ce4={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _ce4;}var _ce5=_ce3&&_ce3.feature,_ce6=_ce3&&_ce3.userId,caps=dojo.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),dojo.trim),_ce7=dojo.indexOf(caps,"editing")>-1,_ce8=_ce7&&(dojo.indexOf(caps,"create")>-1),_ce9=_ce7&&(dojo.indexOf(caps,"update")>-1),_cea=_ce7&&(dojo.indexOf(caps,"delete")>-1),_ceb=this.ownershipBasedAccessControlForFeatures,_cec=this.editFieldsInfo,_ced=_cec&&_cec.creatorField,_cee=_cec&&_cec.realm,_cef=_ce5&&_ce5.attributes,_cf0=(_cef&&_ced)?_cef[_ced]:undefined,_cf1,_cf2=!!this.userIsAdmin,_cf3=!_ceb||_cf2||!!(_ceb.allowOthersToUpdate||_ceb.allowUpdateToOthers),_cf4=!_ceb||_cf2||!!(_ceb.allowOthersToDelete||_ceb.allowDeleteToOthers);if(_cf2||(_ce7&&!(_ce8||_ce9||_cea))){_ce8=_ce9=_cea=true;}_cf1={"canCreate":_ce8,"canUpdate":_ce9,"canDelete":_cea};if(_cf0===null){_cf1.canUpdate=_ce9&&_cf3;_cf1.canDelete=_cea&&_cf4;}else{if(_cf0===""){return _cf1;}else{if(_cf0){_ce6=_ce6||this.getUserId();if(_ce6&&_cee){_ce6=_ce6+"@"+_cee;}if(_ce6.toLowerCase()===_cf0.toLowerCase()){return _cf1;}else{_cf1.canUpdate=_ce9&&_cf3;_cf1.canDelete=_cea&&_cf4;}}}}return _cf1;},getUserId:function(){var _cf5;if(this.loaded){_cf5=(this.credential&&this.credential.userId)||this.userId||"";}return _cf5;},setUserIsAdmin:function(_cf6){this.userIsAdmin=_cf6;},setEditSummaryCallback:function(_cf7){this.editSummaryCallback=_cf7;},getEditSummary:function(_cf8,_cf9,_cfa){_cfa=esri._isDefined(_cfa)?_cfa:(new Date()).getTime();var _cfb="",info=this.getEditInfo(_cf8,_cf9,_cfa),_cfc=(_cf9&&_cf9.callback)||this.editSummaryCallback;if(_cfc){info=_cfc(_cf8,info)||"";}if(dojo.isString(info)){_cfb=info;}else{if(info){var _cfd=info.action,_cfe=info.userId,_cff=info.timeValue,_d00=0;if(_cfd){_d00++;}if(_cfe){_d00++;}if(esri._isDefined(_cff)){_d00++;}if(_d00>1){_cfb=(_cfd==="edit"?"edit":"create")+(_cfe?"User":"")+(esri._isDefined(_cff)?info.displayPattern:"");}}_cfb=_cfb&&esri.substitute(info,esri.bundle.layers.FeatureLayer[_cfb]);}return _cfb;},getEditInfo:function(_d01,_d02,_d03){if(!this.loaded){return;}_d03=esri._isDefined(_d03)?_d03:(new Date()).getTime();var _d04=(_d02&&_d02.action)||"last",_d05=this.editFieldsInfo,_d06=_d05&&_d05.creatorField,_d07=_d05&&_d05.creationDateField,_d08=_d05&&_d05.editorField,_d09=_d05&&_d05.editDateField,_d0a=_d05&&_d05.realm,_d0b=_d01&&_d01.attributes,_d0c=(_d0b&&_d06)?_d0b[_d06]:undefined,_d0d=(_d0b&&_d07)?_d0b[_d07]:null,_d0e=(_d0b&&_d08)?_d0b[_d08]:undefined,_d0f=(_d0b&&_d09)?_d0b[_d09]:null,_d10=this._getEditData(_d0c,_d0d,_d03),_d11=this._getEditData(_d0e,_d0f,_d03),_d12;switch(_d04){case "creation":_d12=_d10;break;case "edit":_d12=_d11;break;case "last":_d12=_d11||_d10;break;}if(_d12){_d12.action=(_d12===_d11)?"edit":"creation";}return _d12;},_getEditData:function(_d13,_d14,_d15){var data,_d16,_d17,_d18=60000,_d19=3600000,_d1a=2*_d19,_d1b=24*_d19,_d1c=7*_d1b;if(esri._isDefined(_d14)){_d16=_d15-_d14;if(_d16<0){_d17="Full";}else{if(_d16<_d18){_d17="Seconds";}else{if(_d16<(2*_d18)){_d17="Minute";}else{if(_d16<_d19){_d17="Minutes";}else{if(_d16<_d1a){_d17="Hour";}else{if(_d16<_d1b){_d17="Hours";}else{if(_d16<_d1c){_d17="WeekDay";}else{_d17="Full";}}}}}}}}if((_d13!==undefined)||_d17){data=data||{};data.userId=_d13;if(_d17){var _d1d=dojo.date.locale.format,_d1e=new Date(_d14);data.minutes=Math.floor(_d16/_d18);data.hours=Math.floor(_d16/_d19);data.weekDay=_d1d(_d1e,{datePattern:"EEEE",selector:"date"});data.formattedDate=_d1d(_d1e,{selector:"date"});data.formattedTime=_d1d(_d1e,{selector:"time"});data.displayPattern=_d17;data.timeValue=_d14;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_d1f){if(!this.isEditable()){this._maxOffset=_d1f;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_d20){if(!this.loaded){this._optAutoGen=_d20;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_d20;if(_d20){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_d21){if(!this._collection&&(_d21!==this.gdbVersion)&&(_d21||this.gdbVersion)){this.gdbVersion=_d21;this._task.gdbVersion=_d21;this._url.query=dojo.mixin(this._url.query,{gdbVersion:_d21});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_d22){if(this._isSnapshot){this._timeDefn=_d22;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_d23,_d24){this._timeOffset=_d23;this._timeOffsetUnits=_d24;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_d25,_d26,_d27,_d28){_d26=_d26||this.constructor.SELECTION_NEW;var _d29=this._getShallowClone(_d25),map=this._map,_d2a,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_d29.outFields=this._getOutFields();_d29.returnGeometry=true;if(map){_d29.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_d29)){_d2a={features:[]};this._selectHandler(_d2a,_d26,_d27,_d28,dfd);return dfd;}var _d2b=this._canDoClientSideQuery(_d29);if(_d2b){_d2a={features:this._doQuery(_d29,_d2b)};this._selectHandler(_d2a,_d26,_d27,_d28,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_d28,dfd,true);return dfd;}var self=this;if(this._ts){_d29._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_d29);temp.addCallbacks(function(_d2c){self._selectHandler(_d2c,_d26,_d27,_d28,dfd);},function(err){self._resolve([err],null,_d28,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _d2d=this._selectedFeatures,_d2e=[],item;for(item in _d2d){if(_d2d.hasOwnProperty(item)){_d2e.push(_d2d[item]);}}return _d2e;},clearSelection:function(_d2f){var _d30=this._selectedFeatures,mode=this._mode,item;for(item in _d30){if(_d30.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_d2f){this.onSelectionClear();}return this;},setSelectionSymbol:function(_d31){this._selectionSymbol=_d31;if(_d31){var _d32=this._selectedFeatures,item;for(item in _d32){if(_d32.hasOwnProperty(item)){_d32[item].setSymbol(_d31);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_d33,_d34,_d35,_d36,_d37){var _d38=_d37.assembly,dfd=_d37.dfd;this._applyNormalized(adds,_d38&&_d38[0]);this._applyNormalized(_d33,_d38&&_d38[1]);this.onBeforeApplyEdits(adds,_d33,_d34);var i,_d39={},_d3a=this.objectIdField,_d3b={f:"json"},_d3c=false;if(this._collection){var _d3d={};_d3d.addResults=adds?dojo.map(adds,function(){_d3c=true;return {objectId:this._nextId++,success:true};},this):null;_d3d.updateResults=_d33?dojo.map(_d33,function(_d3e){_d3c=true;var oid=_d3e.attributes[_d3a];_d39[oid]=_d3e;return {objectId:oid,success:true};},this):null;_d3d.deleteResults=_d34?dojo.map(_d34,function(_d3f){_d3c=true;return {objectId:_d3f.attributes[_d3a],success:true};},this):null;if(_d3c){this._editHandler(_d3d,adds,_d39,_d35,_d36,dfd);}return;}if(adds&&adds.length>0){_d3b.adds=this._convertFeaturesToJson(adds,0,1);_d3c=true;}if(_d33&&_d33.length>0){for(i=0;i<_d33.length;i++){var _d40=_d33[i];_d39[_d40.attributes[_d3a]]=_d40;}_d3b.updates=this._convertFeaturesToJson(_d33,0,0,1);_d3c=true;}if(_d34&&_d34.length>0){var ids=[];for(i=0;i<_d34.length;i++){ids.push(_d34[i].attributes[_d3a]);}_d3b.deletes=ids.join(",");_d3c=true;}if(_d3c){var self=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_d3b,this._url.query),callbackParamName:"callback",load:function(_d41){self._editHandler(_d41,adds,_d39,_d35,_d36,dfd);},error:function(err){self._resolve([err],null,_d36,dfd,true);}},{usePost:true});}},queryFeatures:function(_d42,_d43,_d44){return this._query("execute","onQueryFeaturesComplete",_d42,_d43,_d44);},queryRelatedFeatures:function(_d45,_d46,_d47){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_d45,_d46,_d47);},queryIds:function(_d48,_d49,_d4a){return this._query("executeForIds","onQueryIdsComplete",_d48,_d49,_d4a);},queryCount:function(_d4b,_d4c,_d4d){return this._query("executeForCount","onQueryCountComplete",_d4b,_d4c,_d4d);},queryAttachmentInfos:function(_d4e,_d4f,_d50){var url=this._url.path+"/"+_d4e+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_d51){var _d52=_d51.attachmentInfos,_d53;dojo.forEach(_d52,function(info){_d53=dojo.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_d53?("?"+_d53):"");info.objectId=_d4e;});self._resolve([_d52],"onQueryAttachmentInfosComplete",_d4f,dfd);},error:function(err){self._resolve([err],null,_d50,dfd,true);}});return dfd;},addAttachment:function(_d54,_d55,_d56,_d57){return this._sendAttachment("add",_d54,_d55,_d56,_d57);},updateAttachment:function(_d58,_d59,_d5a,_d5b,_d5c){_d5a.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_d59}));return this._sendAttachment("update",_d58,_d5a,_d5b,_d5c);},deleteAttachments:function(_d5d,_d5e,_d5f,_d60){var url=this._url.path+"/"+_d5d+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_d61={f:"json",attachmentIds:_d5e.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_d61,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_d62){var _d63=_d62.deleteAttachmentResults;_d63=dojo.map(_d63,function(_d64){var res=new esri.layers.FeatureEditResult(_d64);res.attachmentId=res.objectId;res.objectId=_d5d;return res;});self._resolve([_d63],"onDeleteAttachmentsComplete",_d5f,dfd);}),error:function(err){self._resolve([err],null,_d60,dfd,true);}},{usePost:true});return dfd;},addType:function(_d65){var _d66=this.types;if(_d66){var _d67=dojo.some(_d66,function(type){if(type.id==_d65.id){return true;}return false;});if(_d67){return false;}else{_d66.push(_d65);}}else{this.types=[_d65];}this._typesDirty=true;return true;},deleteType:function(_d68){if(!this._collection){return;}var _d69=this.types;if(_d69){var _d6a=-1;dojo.some(_d69,function(type,_d6b){if(type.id==_d68){_d6a=_d6b;return true;}return false;});if(_d6a>-1){this._typesDirty=true;return _d69.splice(_d6a,1)[0];}}},toJson:function(){var _d6c=this._json,json=dojo.isString(_d6c)?dojo.fromJson(_d6c):dojo.clone(_d6c);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _d6d=json.layerDefinition,_d6e=this._collection;if(_d6e&&this._typesDirty){_d6d.types=dojo.map(this.types||[],function(type){return type.toJson();});var _d6f=this.renderer,_d70=_d6d.drawingInfo;if(_d70&&_d6f&&_d6f.declaredClass.indexOf("TemporalRenderer")===-1){_d70.renderer=_d6f.toJson();}}var _d71=null;if(!(_d6e&&!this._fcAdded)){_d71={geometryType:_d6d.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=dojo.mixin({},json.featureSet||{},_d71);if(_d6e){json.nextObjectId=this._nextId;_d6d.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_d72){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&esri.id&&esri.id._hasPortalSession()&&esri.id._doPortalSignIn(path)){esri.id.getCredential(path).then(function(){self._findCredential();_d72.call(self);},function(){_d72.call(self);});}else{_d72.call(this);}},_updateCaps:function(){var _d73=this._editable,_d74=dojo.trim(this.capabilities||""),_d75=dojo.map((_d74?_d74.split(","):[]),dojo.trim),caps=dojo.map((_d74?_d74.toLowerCase().split(","):[]),dojo.trim),_d76=dojo.indexOf(caps,"editing"),cap,i,_d77,_d78={"Create":dojo.indexOf(caps,"create"),"Update":dojo.indexOf(caps,"update"),"Delete":dojo.indexOf(caps,"delete")};if(_d73&&_d76===-1){_d75.push("Editing");}else{if(!_d73&&_d76>-1){_d77=[_d76];for(cap in _d78){if(_d78[cap]>-1){_d77.push(_d78[cap]);}}_d77.sort();for(i=_d77.length-1;i>=0;i--){_d75.splice(_d77[i],1);}}}this.capabilities=_d75.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_d79=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_d79&&(_d79.latestObservationRenderer||_d79.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.initialize(map):mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_d7a){var map=this._map;if(_d7a&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_d7b){this._mapTimeExtent=_d7b;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_d7c){var _d7d=this._timeOffset,_d7e=this._timeOffsetUnits;return (_d7c&&_d7d&&_d7e)?_d7c.offset(-1*_d7d,_d7e):_d7c;},_getTimeOverlap:function(_d7f,_d80){if(_d7f&&_d80){return _d7f.intersection(_d80);}else{return _d7f||_d80;}},_getTimeFilter:function(_d81){var _d82=this.getTimeDefinition(),_d83=null,_d84;if(_d82||_d83){_d84=this._getTimeOverlap(_d82,_d83);if(!_d84){return [false];}}if(_d81){_d81=_d84?this._getTimeOverlap(_d81,_d84):_d81;if(!_d81){return [false];}}else{_d81=_d84;}return [true,_d81];},_getAttributeFilter:function(_d85){var _d86=this.getDefinitionExpression();if(_d85){_d85=_d86?"("+_d86+") AND ("+_d85+")":_d85;}else{_d85=_d86;}return _d85;},_applyQueryFilters:function(_d87){_d87.where=this._getAttributeFilter(_d87.where);_d87.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _d88=this._getTimeFilter(_d87.timeExtent);if(!_d88[0]){return false;}else{_d87.timeExtent=_d88[1];}}return true;},_add:function(_d89){var _d8a=this._selectionSymbol,attr=_d89.attributes,_d8b=this.visibilityField;if(_d8a&&this._isSelOnly){_d89.setSymbol(_d8a);}if(_d8b&&attr&&attr.hasOwnProperty(_d8b)){_d89[attr[_d8b]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_d8c){var _d8d=[],map=this._map;if(this._isTable||!map){return;}if(_d8c.text||(_d8c.where&&_d8c.where!==this.getDefinitionExpression())){return;}var _d8e=this._isSnapshot,_d8f=this._isSelOnly;var _d90=_d8c.geometry;if(_d90){if(!_d8f&&_d8c.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_d90.type==="extent"&&(_d8e||map.extent.contains(_d90)))){_d8d.push(1);}else{return;}}var ids=_d8c.objectIds;if(ids){if(_d8e){_d8d.push(2);}else{var len=ids.length,mode=this._mode,_d91=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_d91++;}}if(_d91===len){_d8d.push(2);}else{return;}}}if(this.timeInfo){var _d92=_d8c.timeExtent,_d93=this._mapTimeExtent;if(_d8e){if(_d92){_d8d.push(3);}}else{if(_d8f){if(_d92){return;}}else{if(_d93){if(dojo.indexOf(_d8d,2)!==-1){if(_d92){_d8d.push(3);}}else{return;}}else{if(_d8d.length>0){if(_d92){_d8d.push(3);}}else{if(_d92){return;}}}}}}return _d8d.length>0?_d8d:null;},_doQuery:function(_d94,_d95,_d96){var _d97=[],mode=this._mode,_d98=this.objectIdField,i,len,_d99;if(dojo.indexOf(_d95,2)!==-1){_d97=[];var ids=_d94.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_d97.push(obj);}}if(_d97.length===0){return [];}}if(dojo.indexOf(_d95,1)!==-1){_d99=_d97.length>0?_d97:this.graphics;len=_d99.length;var _d9a=_d94.geometry._normalize(null,true);_d97=[];for(i=0;i<len;i++){var _d9b=_d99[i],_d9c=_d9b.geometry;if(_d9c){if(this.normalization&&_d9a.length){if(_d9a[0].intersects(_d9c)||_d9a[1].intersects(_d9c)){_d97.push(_d9b);}}else{if(_d9a.intersects(_d9c)){_d97.push(_d9b);}}}}if(_d97.length===0){return [];}}if(dojo.indexOf(_d95,3)!==-1){if(this.timeInfo){_d99=_d97.length>0?_d97:this.graphics;var time=_d94.timeExtent,_d9d=this._filterByTime(_d99,time.startTime,time.endTime);_d97=_d9d.match;}}if(_d96){return dojo.map(_d97,function(obj){return obj.attributes[_d98];},this);}else{return _d97;}},_filterByTime:function(_d9e,_d9f,_da0){var _da1=this._startTimeField,_da2=this._endTimeField,_da3;if(!this._twoTimeFields){_da3=_da1||_da2;}var _da4=esri._isDefined,yea=[],nay=[],i,len=_d9e.length,_da5,_da6;_d9f=_d9f?_d9f.getTime():-Infinity;_da0=_da0?_da0.getTime():Infinity;if(_da3){for(i=0;i<len;i++){_da5=_d9e[i];_da6=_da5.attributes;var time=_da6[_da3];if(time>=_d9f&&time<=_da0){yea.push(_da5);}else{nay.push(_da5);}}}else{for(i=0;i<len;i++){_da5=_d9e[i];_da6=_da5.attributes;var _da7=_da6[_da1],end=_da6[_da2];_da7=_da4(_da7)?_da7:-Infinity;end=_da4(end)?end:Infinity;if((_da7>=_d9f&&_da7<=_da0)||(end>=_d9f&&end<=_da0)||(_d9f>=_da7&&_da0<=end)){yea.push(_da5);}else{nay.push(_da5);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_da8,_da9,dfd,_daa){if(_da8){this[_da8].apply(this,args);}if(_da9){_da9.apply(null,args);}if(dfd){esri._resDfd(dfd,args,_daa);}},_getShallowClone:function(_dab){var _dac=new esri.tasks.Query(),prop;for(prop in _dab){if(_dab.hasOwnProperty(prop)){_dac[prop]=_dab[prop];}}return _dac;},_query:function(type,_dad,_dae,_daf,_db0){var that=this,map=this._map,dfd=new dojo.Deferred(esri._dfdCanceller),_db1=_dae;var _db2=function(_db3,_db4){if(!_db4&&type==="execute"&&!that._isTable){var _db5=_db3.features,mode=that._mode,_db6=that.objectIdField,il=_db5.length,i;for(i=il-1;i>=0;i--){var oid=_db5[i].attributes[_db6];var _db7=mode._getFeature(oid);if(_db7){_db5.splice(i,1,_db7);}}}that._resolve([_db3],_dad,_daf,dfd);};if(type!=="executeRelationshipQuery"){_db1=this._getShallowClone(_dae);_db1.outFields=this._getOutFields();_db1.returnGeometry=(!map&&_dae.hasOwnProperty("returnGeometry"))?_dae.returnGeometry:true;var _db8;if(map){_db1.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_db1)){switch(type){case "execute":_db8=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_db8=[];break;case "executeForCount":_db8=0;break;}_db2(_db8,true);return dfd;}var _db9=this._canDoClientSideQuery(_db1);if(_db9){var _dba=this._doQuery(_db1,_db9,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_db8=new esri.tasks.FeatureSet();_db8.features=_dba;break;case "executeForIds":_db8=_dba;break;case "executeForCount":_db8=_dba.length;break;}_db2(_db8,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_db0,dfd,true);return dfd;}if(this._ts){_db1._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_db1);temp.addCallbacks(_db2,function(err){that._resolve([err],null,_db0,dfd,true);});return dfd;},_convertFeaturesToJson:function(_dbb,_dbc,_dbd,_dbe){var json=[],_dbf=this._selectionSymbol,_dc0=this.visibilityField,i,_dc1,_dc2=this.objectIdField;if(this.loaded&&(_dbd||_dbe)){_dc1=dojo.filter(this.fields,function(_dc3){return (_dc3.editable===false)&&(!_dbe||(_dc3.name!==_dc2));});}for(i=0;i<_dbb.length;i++){var _dc4=_dbb[i],_dc5={},_dc6=_dc4.geometry,attr=_dc4.attributes,_dc7=_dc4.symbol;if(_dc6&&(!_dbe||!this.loaded||this.allowGeometryUpdates)){_dc5.geometry=_dc6.toJson();}if(_dc0){_dc5.attributes=attr=dojo.mixin({},attr);attr[_dc0]=_dc4.visible?1:0;}else{if(attr){_dc5.attributes=dojo.mixin({},attr);}}if(_dc5.attributes&&_dc1&&_dc1.length){dojo.forEach(_dc1,function(_dc8){delete _dc5.attributes[_dc8.name];});}if(_dc7&&(_dc7!==_dbf)){_dc5.symbol=_dc7.toJson();}json.push(_dc5);}return _dbc?json:dojo.toJson(json);},_selectHandler:function(_dc9,_dca,_dcb,_dcc,dfd){var _dcd,ctor=this.constructor;switch(_dca){case ctor.SELECTION_NEW:this.clearSelection(true);_dcd=true;break;case ctor.SELECTION_ADD:_dcd=true;break;case ctor.SELECTION_SUBTRACT:_dcd=false;break;}var i,_dce=_dc9.features,mode=this._mode,_dcf=[],_dd0=this.objectIdField,_dd1,oid;if(_dcd){for(i=0;i<_dce.length;i++){_dd1=_dce[i];oid=_dd1.attributes[_dd0];var _dd2=mode._addFeatureIIf(oid,_dd1);_dcf.push(_dd2);this._selectFeatureIIf(oid,_dd2,mode);}}else{for(i=0;i<_dce.length;i++){_dd1=_dce[i];oid=_dd1.attributes[_dd0];this._unSelectFeatureIIf(oid,mode);var _dd3=mode._removeFeatureIIf(oid);_dcf.push(_dd3||_dd1);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_dcf,_dca,_dc9.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_dcb,dfd);if(_dc9.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_dd4,mode){var _dd5=this._selectedFeatures,_dd6=_dd5[oid];if(!_dd6){mode._incRefCount(oid);_dd5[oid]=_dd4;if(!this._isTable){this._setSelectSymbol(_dd4);}}return _dd6||_dd4;},_unSelectFeatureIIf:function(oid,mode){var _dd7=this._selectedFeatures[oid];if(_dd7){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_dd7);}}return _dd7;},_isSelected:function(_dd8){},_setSelectSymbol:function(_dd9){var _dda=this._selectionSymbol;if(_dda&&!this._isSelOnly){_dd9.setSymbol(_dda);}},_setUnSelectSymbol:function(_ddb){var _ddc=this._selectionSymbol;if(_ddc&&!this._isSelOnly){if(_ddc===_ddb.symbol){_ddb.setSymbol(null,true);}}},_getOutFields:function(){var _ddd=dojo.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_dde,_ddf,arr){return !!_dde&&(dojo.indexOf(arr,_dde)===_ddf);});var _de0=dojo.clone(this._outFields);if(_de0){if(dojo.indexOf(_de0,"*")!==-1){return _de0;}dojo.forEach(_ddd,function(_de1){if(dojo.indexOf(_de0,_de1)===-1){_de0.push(_de1);}});return _de0;}else{return _ddd;}},_checkFields:function(_de2){var _de3=_de2||this._getOutFields();dojo.forEach(_de3,function(_de4){if(_de4==="*"){return;}if(!this._getField(_de4)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_de4},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_de2&&!this._isTable&&!this._fserver&&!this._collection){var _de5=dojo.some(this.fields,function(_de6){return (_de6&&_de6.type==="esriFieldTypeGeometry")?true:false;});if(!_de5){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _de7=this.renderer;if(_de7&&this.fields.length>0){var _de8=dojo.filter([_de7,_de7.observationRenderer,_de7.latestObservationRenderer,_de7.trackRenderer],esri._isDefined);var _de9=[];dojo.forEach(_de8,function(rnd){var _dea,_deb;_deb=rnd.attributeField;if(_deb&&!dojo.isFunction(_deb)){_dea=!this._getField(_deb)&&this._getField(_deb,true);if(_dea){rnd.attributeField=_dea.name;}}_deb=rnd.attributeField2;if(_deb){_dea=!this._getField(_deb)&&this._getField(_deb,true);if(_dea){rnd.attributeField2=_dea.name;}}_deb=rnd.attributeField3;if(_deb){_dea=!this._getField(_deb)&&this._getField(_deb,true);if(_dea){rnd.attributeField3=_dea.name;}}if(!dojo.isFunction(rnd.attributeField)){_de9.push(rnd.attributeField);}_de9.push(rnd.attributeField2);_de9.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_de9,esri._isDefined);}},_getField:function(_dec,_ded){var _dee=this.fields;if(_dee.length===0){return null;}var _def;if(_ded){_dec=_dec.toLowerCase();}dojo.some(_dee,function(_df0){var _df1=false;if(_ded){_df1=(_df0&&_df0.name.toLowerCase()===_dec)?true:false;}else{_df1=(_df0&&_df0.name===_dec)?true:false;}if(_df1){_def=_df0;}return _df1;});return _def;},_getDateOpts:function(){if(!this._dtOpts){var _df2=dojo.map(dojo.filter(this.fields,function(_df3){return !!(_df3&&_df3.type==="esriFieldTypeDate");}),function(_df4){return _df4.name;});this._dtOpts={properties:_df2};}return this._dtOpts;},_applyNormalized:function(_df5,_df6){if(_df5&&_df6){dojo.forEach(_df5,function(_df7,_df8){if(_df7&&_df6[_df8]){_df7.setGeometry(_df6[_df8]);}});}},_editHandler:function(_df9,adds,_dfa,_dfb,_dfc,dfd){var _dfd=_df9.addResults,_dfe=_df9.updateResults,_dff=_df9.deleteResults,i,_e00,oid,_e01,attr,_e02=this.objectIdField,mode=this._mode,_e03=this._isTable;var _e04=this.editFieldsInfo,_e05=this._getOutFields()||[],_e06=_e04&&_e04.creatorField,_e07=_e04&&_e04.creationDateField,_e08=_e04&&_e04.editorField,_e09=_e04&&_e04.editDateField,_e0a=_e04&&_e04.realm;if(dojo.indexOf(_e05,"*")===-1){if(_e06&&dojo.indexOf(_e05,_e06)===-1){_e06=null;}if(_e07&&dojo.indexOf(_e05,_e07)===-1){_e07=null;}if(_e08&&dojo.indexOf(_e05,_e08)===-1){_e08=null;}if(_e09&&dojo.indexOf(_e05,_e09)===-1){_e09=null;}}var _e0b=(_e07||_e09)?(new Date()).getTime():null,_e0c=(_e06||_e08)?this.getUserId():undefined;if(_e0c&&_e0a){_e0c=_e0c+"@"+_e0a;}if(_dfd){for(i=0;i<_dfd.length;i++){_dfd[i]=new esri.layers.FeatureEditResult(_dfd[i]);if(_e03){continue;}_e00=_dfd[i];if(_e00.success){oid=_e00.objectId;_e01=adds[i];var gl=_e01._graphicsLayer;if(gl&&gl!==this){gl.remove(_e01);}attr=_e01.attributes||{};attr[_e02]=oid;if(_e06){attr[_e06]=_e0c;}if(_e08){attr[_e08]=_e0c;}if(_e07){attr[_e07]=_e0b;}if(_e09){attr[_e09]=_e0b;}_e01.setAttributes(attr);if(mode._init){mode.drawFeature(_e01);}}}}if(_dfe){for(i=0;i<_dfe.length;i++){_dfe[i]=new esri.layers.FeatureEditResult(_dfe[i]);if(_e03){continue;}_e00=_dfe[i];if(_e00.success){oid=_e00.objectId;_e01=_dfa[oid];var _e0d=mode._getFeature(oid);if(_e0d){if(_e0d.geometry!==_e01.geometry){_e0d.setGeometry(esri.geometry.fromJson(_e01.geometry.toJson()));}this._repaint(_e0d,oid);}_e01=_e0d||_e01;attr=_e01.attributes||{};if(_e08){attr[_e08]=_e0c;}if(_e09){attr[_e09]=_e0b;}_e01.setAttributes(attr);}}}if(_dff){var _e0e=[];for(i=0;i<_dff.length;i++){_dff[i]=new esri.layers.FeatureEditResult(_dff[i]);if(_e03){continue;}_e00=_dff[i];if(_e00.success){oid=_e00.objectId;_e01=mode._getFeature(oid);if(_e01){if(this._unSelectFeatureIIf(oid,mode)){_e0e.push(_e01);}_e01._count=0;mode._removeFeatureIIf(oid);}}}if(_e0e.length>0){this.onSelectionComplete(_e0e,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_dfd,_dfe,_dff],"onEditsComplete",_dfb,dfd);},_sendAttachment:function(type,_e0f,_e10,_e11,_e12){var _e13=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_e0f+"/"+_e13,self=this;var dfd=esri.request({url:url,form:_e10,content:dojo.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_e14){var _e15=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_e16=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_e17=new esri.layers.FeatureEditResult(_e14[_e15]);_e17.attachmentId=_e17.objectId;_e17.objectId=_e0f;self._resolve([_e17],_e16,_e11);return _e17;}).addErrback(function(_e18){self._resolve([_e18],null,_e12,null,true);});return dfd;},_repaint:function(_e19,oid,_e1a){oid=esri._isDefined(oid)?oid:_e19.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_e19.setSymbol(_e19.symbol,_e1a);}},_getKind:function(_e1b){var _e1c=this._trackManager;if(_e1c){return _e1c.isLatestObservation(_e1b)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _e1d=json.symbol;if(_e1d){this.symbol=esri.symbol.fromJson(_e1d);}var _e1e=json.domains,_e1f,i;var _e20=this.domains={};for(_e1f in _e1e){if(_e1e.hasOwnProperty(_e1f)){var _e21=_e1e[_e1f];switch(_e21.type){case "range":_e20[_e1f]=new esri.layers.RangeDomain(_e21);break;case "codedValue":_e20[_e1f]=new esri.layers.CodedValueDomain(_e21);break;case "inherited":_e20[_e1f]=new esri.layers.InheritedDomain(_e21);break;}}}var _e22=json.templates;if(_e22){var _e23=this.templates=[];for(i=0;i<_e22.length;i++){_e23.push(new esri.layers.FeatureTemplate(_e22[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _e24,_e25=this.domains,_e26=this.templates,_e27=esri._sanitize;if(_e25){var _e28=json.domains={};for(_e24 in _e25){if(_e25.hasOwnProperty(_e24)){_e28[_e24]=_e25[_e24]&&_e25[_e24].toJson();}}_e27(_e28);}if(_e26){json.templates=dojo.map(_e26,function(_e29){return _e29.toJson();});}return _e27(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _e2a=json.prototype;this.prototype=new esri.Graphic(_e2a.geometry,null,_e2a.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_e2b){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _e2c=this._featureMap[oid];if(_e2c){_e2c._count++;}},_decRefCount:function(oid){var _e2d=this._featureMap[oid];if(_e2d){_e2d._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_e2e){var fmap=this._featureMap,_e2f=fmap[oid],_e30=this.featureLayer;if(!_e2f){fmap[oid]=_e2e;_e30._add(_e2e);_e2e._count=0;}return _e2f||_e2e;},_removeFeatureIIf:function(oid){var _e31=this._featureMap[oid],_e32=this.featureLayer;if(_e31){if(_e31._count){return;}delete this._featureMap[oid];_e32._remove(_e31);}return _e31;},_clearIIf:function(){var i,_e33=this.featureLayer,_e34=_e33.graphics,_e35=_e33._selectedFeatures,_e36=_e33.objectIdField;for(i=_e34.length-1;i>=0;i--){var _e37=_e34[i];var oid=_e37.attributes[_e36];if(oid in _e35){_e37._count=1;continue;}_e37._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _e38=this.featureLayer,_e39=_e38.graphics,_e3a=show?"show":"hide",i,len=_e39.length;show=show&&_e38._ager;for(i=0;i<len;i++){var _e3b=_e39[i];_e3b[_e3a]();if(show){_e38._repaint(_e3b);}}},_applyTimeFilter:function(_e3c){var _e3d=this.featureLayer;if(!_e3d.timeInfo||_e3d.suspended){return;}if(!_e3c){_e3d._fireUpdateStart();}var _e3e=_e3d._trackManager;if(_e3e){_e3e.clearTracks();}var defn=_e3d.getTimeDefinition(),_e3f=_e3d._getOffsettedTE(_e3d._mapTimeExtent);if(_e3f){_e3f=_e3d._getTimeOverlap(defn,_e3f);if(_e3f){var _e40=_e3d._filterByTime(_e3d.graphics,_e3f.startTime,_e3f.endTime);if(_e3e){_e3e.addFeatures(_e40.match);}dojo.forEach(_e40.match,function(_e41){var _e42=_e41._shape;if(!_e41.visible){_e41.show();_e42=_e41._shape;_e42&&_e42._moveToFront();}if(_e3d._ager&&_e42){_e3d._repaint(_e41);}});dojo.forEach(_e40.noMatch,function(_e43){if(_e43.visible){_e43.hide();}});}else{this._toggleVisibility(false);}}else{if(_e3e){_e3e.addFeatures(_e3d.graphics);}this._toggleVisibility(true);}if(_e3e){_e3e.moveLatestToFront();_e3e.drawTracks();}if(!_e3c){_e3d._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_e44){this.featureLayer=_e44;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_e45){this.featureLayer=_e45;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _e46=this.featureLayer;if(_e46._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_e47){var _e48=this.featureLayer,_e49=_e48.objectIdField,oid=_e47.attributes[_e49];this._addFeatureIIf(oid,_e47);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _e4a=this.featureLayer;if(_e4a._collection){_e4a._fireUpdateStart();_e4a._refresh(true);_e4a._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_e4b){var id="_"+_e4b.name+_e4b.layerId+_e4b._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _e4c=this.featureLayer;if(_e4c._collection){return;}_e4c._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_e4d=this.featureLayer,_e4e=_e4d.getDefinitionExpression();var _e4f=new esri.tasks.Query();_e4f.outFields=_e4d._getOutFields();_e4f.where=_e4e||"1=1";_e4f.returnGeometry=true;_e4f.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_e4f.timeExtent=_e4d.getTimeDefinition();_e4f.maxAllowableOffset=_e4d._maxOffset;if(_e4d._ts){_e4f._ts=(new Date()).getTime();}var _e50;if(_e4d._usePatch){_e50=this._getRequestId(_e4d);this._cancelPendingRequest(null,_e50);}_e4d._task.execute(_e4f,this._drawFeatures,this._queryErrorHandler,_e50);},_drawFeatures:function(_e51){this._purgeRequests();var _e52=_e51.features,_e53=this.featureLayer,_e54=_e53.objectIdField,i,len=_e52.length,_e55,oid;for(i=0;i<len;i++){_e55=_e52[i];oid=_e55.attributes[_e54];this._addFeatureIIf(oid,_e55);this._incRefCount(oid);}this._applyTimeFilter(true);_e53._fireUpdateEnd(null,_e51.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_e51.exceededTransferLimit){_e53.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _e56=this.featureLayer;_e56._errorHandler(err);_e56._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_e57){this.featureLayer=_e57;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_e58){var _e59=this._gridLayer,geom=_e58.geometry,_e5a=[];if(!geom){return;}_e5a=_e59.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _e5b=this._cellMap,i,cell,oid=_e58.attributes[this.featureLayer.objectIdField],_e5c,row,col;for(i=0;i<_e5a.length;i++){cell=_e5a[i];_e5c=cell.latticeID;row=cell.row;col=cell.col;if(_e5c){cell=(_e5b[_e5c]=(_e5b[_e5c]||cell));}else{_e5b[row]=_e5b[row]||{};cell=(_e5b[row][col]=(_e5b[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_e58);this._addFeatureIIf(oid,_e58);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_e5d=this.featureLayer;var _e5e=_e5d._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_e5e?_e5e.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_e5d._tileWidth,height:_e5d._tileHeight},{width:map.width,height:map.height},_e5e);this._ioQueue=[];if(!_e5d.suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=dojo.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);dojo.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _e5f=this.featureLayer,map=this.map;if(_e5f.suspended){return;}_e5f._fireUpdateStart();this._clearIIf();var _e60=_e5f._trackManager;if(_e60){_e60.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_e61,cell){var id="_"+_e61.name+_e61.layerId+_e61._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_e62){this._exceeds=false;var _e63=this.featureLayer,map=this.map,_e64=_e62||map.extent,_e65=this._gridLayer.getCellsInExtent(_e64,_e63.latticeTiling),_e66=_e65.cells;if(!_e63.isEditable()){var _e67=this._cellMap;_e66=dojo.filter(_e66,function(cell){if(cell.lattice){if(_e67[cell.latticeID]){return false;}}else{if(_e67[cell.row]&&_e67[cell.row][cell.col]){return false;}}return true;});}var _e68=_e63._getOutFields(),_e69=_e63.getDefinitionExpression(),time=_e63._getOffsettedTE(_e63._mapTimeExtent),_e6a=_e63._usePatch,_e6b=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_e6c,_e6d;this._pending=this._pending||0;for(i=0;i<_e66.length;i++){cell=_e66[i];_e6c=new esri.tasks.Query();_e6c.geometry=cell.extent||cell.lattice;_e6c.outFields=_e68;_e6c.where=_e69;if(_e63.latticeTiling&&cell.extent){_e6c.spatialRelationship=esri.tasks.Query.SPATIAL_REL_CONTAINS;}_e6c.returnGeometry=true;_e6c.timeExtent=time;_e6c.maxAllowableOffset=_e63._maxOffset;if(_e63._ts){_e6c._ts=(new Date()).getTime();}_e6d=null;if(_e6a){_e6d=this._getRequestId(_e63,cell);if(this._isPending(_e6d)){continue;}}this._pending++;_e6b.push(_e63._task.execute(_e6c,function(){var _e6e=cell;return function(_e6f){func.apply(self,[_e6f,_e6e]);};}.call(this),this._queryErrorHandler,_e6d));}this._removeOldCells(_e64);this._endCheck();},_drawFeatures:function(_e70,cell){this._exceeds=this._exceeds||_e70.exceededTransferLimit;this._finalizeIO();var _e71=this.featureLayer,map=this.map,_e72=map.extent,_e73=cell.extent,row=cell.row,col=cell.col,_e74=_e71.objectIdField,_e75=_e70.features,_e76=this._gridLayer,_e77=this._cellMap,i,len,_e78=cell.latticeID,_e79=_e78?_e77[_e78]:(_e77[row]&&_e77[row][col]);if((cell.resolution!=_e76._resolution)||(_e78?(_e78!==_e76.getLatticeID(_e72)):(!_e76.intersects(_e73,_e72)))){if(_e79){this._removeCell(row,col,_e78);}}else{if(_e79){this._updateCell(_e79,_e75);}else{cell.features=_e75;if(_e78){_e77[_e78]=cell;}else{_e77[row]=_e77[row]||{};_e77[row][col]=cell;}len=_e75.length;for(i=0;i<len;i++){var _e7a=_e75[i];var oid=_e7a.attributes[_e74];this._addFeatureIIf(oid,_e7a);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_e7b){if(this._pending===0){this._processIOQueue();var _e7c=this.featureLayer,_e7d=_e7c._trackManager;if(_e7d){_e7d.clearTracks();_e7d.addFeatures(_e7c.graphics);if(_e7c._ager){dojo.forEach(_e7c.graphics,function(_e7e){if(_e7e._shape){_e7c._repaint(_e7e);}});}_e7d.moveLatestToFront();_e7d.drawTracks();}this.featureLayer._fireUpdateEnd(_e7b&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_e7c.onQueryLimitExceeded();}}},_processIOQueue:function(_e7f){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_e7f){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_e80){var _e81=this._cellMap,_e82=this._gridLayer,_e83,_e84;for(_e83 in _e81){if(_e81[_e83]){var row=_e81[_e83],_e85=row.latticeID,_e86=0,_e87=0;if(_e85){_e86++;if(_e85!==_e82.getLatticeID(_e80)){this._removeCell(null,null,_e85);_e87++;}}else{for(_e84 in row){if(row[_e84]){_e86++;var _e88=row[_e84].extent;if(!_e82.intersects(_e88,_e80)){this._removeCell(_e83,_e84);_e87++;}}}}if(_e87===_e86){delete _e81[_e83];}}}},_updateCell:function(cell,_e89){var _e8a=this.featureLayer,_e8b=_e8a.objectIdField,_e8c=_e8a._selectedFeatures,i,len=_e89.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _e8d=_e89[i];var oid=_e8d.attributes[_e8b];var _e8e=this._addFeatureIIf(oid,_e8d);if(_e8e===_e8d){this._incRefCount(oid);cell.features.push(_e8e);}else{if(!(oid in _e8c)){_e8e.setGeometry(_e8d.geometry);_e8e.setAttributes(_e8d.attributes);}}}},_removeCell:function(row,col,_e8f){var _e90=this._cellMap,_e91=this.featureLayer,_e92=_e91.objectIdField;var cell=_e8f?_e90[_e8f]:(_e90[row]&&_e90[row][col]);if(cell){if(_e8f){delete _e90[_e8f];}else{delete _e90[row][col];}var _e93=cell.features,i;for(i=0;i<_e93.length;i++){var _e94=_e93[i];var oid=_e94.attributes[_e92];this._decRefCount(oid);if(oid in _e91._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_e95,_e96,_e97,_e98){this.origin=_e95;this.cellWidth=_e96.width;this.cellHeight=_e96.height;this.mapWidth=_e97.width;this.mapHeight=_e97.height;this.srInfo=_e98;},setResolution:function(_e99){this._resolution=(_e99.xmax-_e99.xmin)/this.mapWidth;if(this.srInfo){var _e9a=Math.round((2*this.srInfo.valid[1])/this._resolution),_e9b=Math.round(_e9a/this.cellWidth);this._frameStats=[_e9b,0,_e9b-1];}},getCellCoordinates:function(_e9c){var res=this._resolution,_e9d=this.origin;return {row:Math.floor((_e9d.y-_e9c.y)/(this.cellHeight*res)),col:Math.floor((_e9c.x-_e9d.x)/(this.cellWidth*res))};},normalize:function(col){var _e9e=this._frameStats;if(_e9e){var _e9f=_e9e[0],m180=_e9e[1],p180=_e9e[2];if(col<m180){col=col%_e9f;col=col<m180?col+_e9f:col;}else{if(col>p180){col=col%_e9f;}}}return col;},intersects:function(_ea0,_ea1){var _ea2=this.srInfo;if(_ea2){return dojo.some(_ea1._getParts(_ea2),function(_ea3){return _ea0.intersects(_ea3.extent);});}else{return _ea0.intersects(_ea1);}},getCellExtent:function(row,col){var res=this._resolution,_ea4=this.origin,_ea5=this.cellWidth,_ea6=this.cellHeight;return new esri.geometry.Extent((col*_ea5*res)+_ea4.x,_ea4.y-((row+1)*_ea6*res),((col+1)*_ea5*res)+_ea4.x,_ea4.y-(row*_ea6*res),new esri.SpatialReference(_ea4.spatialReference.toJson()));},getLatticeID:function(_ea7){var _ea8=this.getCellCoordinates({x:_ea7.xmin,y:_ea7.ymax}),_ea9=this.getCellCoordinates({x:_ea7.xmax,y:_ea7.ymin}),_eaa=_ea8.row,_eab=_ea9.row,_eac=this.normalize(_ea8.col),_ead=this.normalize(_ea9.col);return _eaa+"_"+_eab+"_"+_eac+"_"+_ead;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_eae,_eaf){var _eb0=this.getCellCoordinates({x:_eae.xmin,y:_eae.ymax}),_eb1=this.getCellCoordinates({x:_eae.xmax,y:_eae.ymin}),_eb2=_eb0.row,_eb3=_eb1.row,_eb4=_eb0.col,_eb5=_eb1.col,_eb6=[],i,j,nj,_eb7=[],_eb8=[],len,xmin,xmax,ymin,ymax,_eb9=[],_eba,_ebb;for(i=_eb2;i<=_eb3;i++){for(j=_eb4;j<=_eb5;j++){nj=this.normalize(j);_eae=this.getCellExtent(i,nj);_eb6.push({row:i,col:nj,extent:_eae,resolution:this._resolution});if(_eaf){_eb7.push(_eae.xmin,_eae.xmax);_eb8.push(_eae.ymin,_eae.ymax);}}}_eb4=this.normalize(_eb4);_eb5=this.normalize(_eb5);_eb7.sort(this.sorter);_eb8.sort(this.sorter);len=_eb7.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_eb7[i]===_eb7[i+1]){_eb7.splice(i,1);}}}len=_eb8.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_eb8[i]===_eb8[i+1]){_eb8.splice(i,1);}}}if(_eb7.length&&_eb8.length){xmin=_eb7[0];xmax=_eb7[_eb7.length-1];ymin=_eb8[0];ymax=_eb8[_eb8.length-1];len=_eb7.length;for(i=0;i<len;i++){_eb9.push([[_eb7[i],ymax],[_eb7[i],ymin]]);}len=_eb8.length;for(i=0;i<len;i++){_eb9.push([[xmin,_eb8[i]],[xmax,_eb8[i]]]);}_eba=new esri.geometry.Polyline({paths:_eb9,spatialReference:this.origin.spatialReference.toJson()});_ebb=_eb2+"_"+_eb3+"_"+_eb4+"_"+_eb5;_eb6.push({latticeID:_ebb,lattice:_eba,resolution:this._resolution});}return {minRow:_eb2,maxRow:_eb3,minCol:_eb4,maxCol:_eb5,cells:_eb6};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_ebc){this.layer=_ebc;this.trackMap={};},initialize:function(map){this.map=map;var _ebd=this.layer,_ebe=_ebd.renderer.trackRenderer;if(_ebe&&(_ebd.geometryType==="esriGeometryPoint")){var _ebf=(this.container=new esri.layers._GraphicsLayer({id:_ebd.id+"_tracks",_child:true}));_ebf.loaded=true;_ebf.onLoad(_ebf);_ebf._setMap(map,_ebd._div);_ebf.setRenderer(_ebe);}},addFeatures:function(_ec0){var tkid,_ec1=this.trackMap,_ec2=this.layer,_ec3=_ec2._trackIdField;dojo.forEach(_ec0,function(_ec4){var _ec5=_ec4.attributes;tkid=_ec5[_ec3];var ary=(_ec1[tkid]=(_ec1[tkid]||[]));ary.push(_ec4);});var _ec6=_ec2._startTimeField,_ec7=_ec2.objectIdField;var _ec8=function(a,b){var _ec9=a.attributes[_ec6],_eca=b.attributes[_ec6];if(_ec9===_eca){return (a.attributes[_ec7]<b.attributes[_ec7])?-1:1;}else{return (_ec9<_eca)?-1:1;}};for(tkid in _ec1){_ec1[tkid].sort(_ec8);}},drawTracks:function(){var _ecb=this.container;if(!_ecb){return;}var _ecc=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_ecd,_ece=this.layer._trackIdField,_ecf;for(tkid in _ecc){ary=_ecc[tkid];path=[];for(i=ary.length-1;i>=0;i--){_ecd=ary[i].geometry;if(_ecd){path.push([_ecd.x,_ecd.y]);}}_ecf={};_ecf[_ece]=tkid;if(path.length>0){_ecb.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr}),null,_ecf));}}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_ed0){var _ed1=_ed0._shape;_ed1&&_ed1._moveToFront();this._repaint(_ed0,null,true);},this.layer);},getLatestObservations:function(){var _ed2=[];if(!this.layer.renderer.latestObservationRenderer){return _ed2;}var _ed3=this.trackMap,tkid;for(tkid in _ed3){var ary=_ed3[tkid];_ed2.push(ary[ary.length-1]);}return _ed2;},clearTracks:function(){var _ed4=this.getLatestObservations();this.trackMap={};var _ed5=this.container;if(_ed5){_ed5.clear();}dojo.forEach(_ed4,function(_ed6){this._repaint(_ed6,null,true);},this.layer);},isLatestObservation:function(_ed7){var _ed8=this.layer._trackIdField;var _ed9=this.trackMap[_ed7.attributes[_ed8]];if(_ed9){return (_ed9[_ed9.length-1]===_ed7);}return false;},destroy:function(){var _eda=this.container;if(_eda){_eda.clear();_eda._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});});},"esri/dijit/editing/toolbars/ToolbarBase":function(){define("esri/dijit/editing/toolbars/ToolbarBase",["dijit","dojo","dojox","dojo/require!dijit/Toolbar,dijit/ToolbarSeparator"],function(_edb,dojo,_edc){dojo.provide("esri.dijit.editing.toolbars.ToolbarBase");dojo.require("dijit.Toolbar");dojo.require("dijit.ToolbarSeparator");dojo.declare("esri.dijit.editing.toolbars.ToolbarBase",[_edb.Toolbar],{_enabled:true,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(_edd,_ede){if(!_edd||!_edd.settings){return;}this._tools=[];this._tbConnects=[];this._initialize(_edd.settings);},postCreate:function(){this._createTools();this.deactivate();},destroy:function(){var _edf=this._tools;for(var tool in _edf){if(_edf.hasOwnProperty(tool)&&esri._isDefined(this._tools[tool])){this._tools[tool].destroy();}}dojo.forEach(this._tbConnects,"dojo.disconnect(item)");this.inherited(arguments);},activate:function(_ee0){this._enabled=true;},deactivate:function(){this._enabled=false;this._layer=null;this._geometryType=null;var _ee1=this._tools;for(var tool in _ee1){if(_ee1.hasOwnProperty(tool)){this._tools[tool].deactivate();this._tools[tool].setChecked(false);}}},isEnabled:function(){return _enabled;},setActiveSymbol:function(_ee2){this._activeSymbol=_ee2;},_getSymbol:function(){},_createTools:function(){},_initialize:function(_ee3){this._settings=_ee3;this._toolbar=_ee3.drawToolbar;this._editToolbar=_ee3.editToolbar;this._initializeToolbar();},_activateTool:function(tool,_ee4){if(this._activeTool){this._activeTool.deactivate();}if(_ee4===true&&this._activeTool==this._tools[tool]){this._activeTool.setChecked(false);this._activeTool=null;}else{this._activeTool=this._tools[tool];this._activeTool.setChecked(true);this._activeTool.activate(null);}},_createSeparator:function(){this.addChild(new _edb.ToolbarSeparator());}});});},"*now":function(r){r(["dojo/i18n!*preload*esri/dijit/editing/nls/Editor-all*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/dijit/editing/Editor-all",["dijit","dojo","dojox","dojo/require!esri/layers/FeatureLayer,esri/toolbars/_toolbar,esri/toolbars/draw,esri/toolbars/edit,esri/tasks/geometry,esri/dijit/AttributeInspector,esri/dijit/editing/AttachmentEditor,esri/dijit/editing/Editor,esri/dijit/editing/TemplatePicker,esri/dijit/editing/Util,esri/dijit/editing/SelectionHelper"],function(_ee5,dojo,_ee6){dojo.provide("esri.dijit.editing.Editor-all");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.toolbars._toolbar");dojo.require("esri.toolbars.draw");dojo.require("esri.toolbars.edit");dojo.require("esri.tasks.geometry");dojo.require("esri.dijit.AttributeInspector");dojo.require("esri.dijit.editing.AttachmentEditor");dojo.require("esri.dijit.editing.Editor");dojo.require("esri.dijit.editing.TemplatePicker");dojo.require("esri.dijit.editing.Util");dojo.require("esri.dijit.editing.SelectionHelper");});